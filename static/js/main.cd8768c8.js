/*! For license information please see main.cd8768c8.js.LICENSE.txt */
(()=>{var e={39:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=n(4421)},219:(e,t,n)=>{"use strict";var r=n(3763),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return r.isMemo(e)?i:s[e.$$typeof]||o}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=i;var l=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(f){var o=p(n);o&&o!==f&&e(t,o,r)}var i=u(n);d&&(i=i.concat(d(n)));for(var s=c(t),m=c(n),g=0;g<i.length;++g){var v=i[g];if(!a[v]&&(!r||!r[v])&&(!m||!m[v])&&(!s||!s[v])){var y=h(n,v);try{l(t,v,y)}catch(b){}}}}return t}},457:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A});var r=n(7868)},528:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler");Symbol.for("react.provider");var s=Symbol.for("react.consumer"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.for("react.view_transition"),m=Symbol.for("react.client.reference");function g(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case o:case i:case a:case u:case d:case f:return e;default:switch(e=e&&e.$$typeof){case c:case l:case p:case h:case s:return e;default:return t}}case r:return t}}}t.vM=l,t.lD=h},551:()=>{},579:(e,t,n)=>{"use strict";e.exports=n(1153)},869:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});n(5043);var r=n(3290),o=n(579);function a(e){const{styles:t,defaultTheme:n={}}=e,a="function"===typeof t?e=>{return t(void 0===(r=e)||null===r||0===Object.keys(r).length?n:e);var r}:t;return(0,o.jsx)(r.mL,{styles:a})}},918:(e,t,n)=>{"use strict";function r(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}n.d(t,{A:()=>r})},950:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=n(3468).A},1153:(e,t,n)=>{"use strict";var r=n(5043),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,a={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!c.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:o,type:e,key:l,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=l,t.jsxs=l},1234:()=>{},1475:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(7123);const o=e=>(0,r.A)(e)&&"classes"!==e},1668:(e,t,n)=>{"use strict";function r(e){return e&&e.ownerDocument||document}n.d(t,{A:()=>r})},1702:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout")},1722:(e,t,n)=>{"use strict";n.d(t,{Rk:()=>r,SF:()=>o,sk:()=>a});function r(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):n&&(r+=n+" ")})),r}var o=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},a=function(e,t,n){o(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var a=t;do{e.insert(t===a?"."+r:"",a,e.sheet,!0),a=a.next}while(void 0!==a)}}},1782:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(5043),o=n(4440);const a=function(e){const t=r.useRef(e);return(0,o.A)((()=>{t.current=e})),r.useRef((function(){return(0,t.current)(...arguments)})).current}},1958:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History")},2372:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>a});var r=n(9386);const o={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const a=o[t];return a?"".concat(n,"-").concat(a):"".concat(r.A.generate(e),"-").concat(t)}},2374:(e,t,n)=>{"use strict";t.A=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=o?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=e[i]}return r.default=e,n&&n.set(e,r),r}(n(5043)),o=n(3174);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=r.useContext(o.ThemeContext);return t&&(n=t,0!==Object.keys(n).length)?t:e;var n}},2427:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=n(1668).A},2430:function(e,t,n){var r;!function(o,a,i){var s,c=256,l=i.pow(c,6),u=i.pow(2,52),d=2*u,h=255;function p(e,t,n){var r=[],h=v(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(a)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(c):(e=new Uint8Array(c),(o.crypto||o.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=o.navigator,n=t&&t.plugins;return[+new Date,o,n,o.screen,y(a)]}}():e,3),r),p=new f(r),b=function(){for(var e=p.g(6),t=l,n=0;e<u;)e=(e+n)*c,t*=c,n=p.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,v(y(p.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,p),e.state=function(){return m(p,{})}),n?(i.random=e,t):e})(b,h,"global"in t?t.global:this==i,t.state)}function f(e){var t,n=e.length,r=this,o=0,a=r.i=r.j=0,i=r.S=[];for(n||(e=[n++]);o<c;)i[o]=o++;for(o=0;o<c;o++)i[o]=i[a=h&a+e[o%n]+(t=i[o])],i[a]=t;(r.g=function(e){for(var t,n=0,o=r.i,a=r.j,i=r.S;e--;)t=i[o=h&o+1],n=n*c+i[h&(i[o]=i[a=h&a+t])+(i[a]=t)];return r.i=o,r.j=a,n})(c)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,r=[],o=typeof e;if(t&&"object"==o)for(n in e)try{r.push(g(e[n],t-1))}catch(a){}return r.length?r:"string"==o?e:e+"\0"}function v(e,t){for(var n,r=e+"",o=0;o<r.length;)t[h&o]=h&(n^=19*t[h&o])+r.charCodeAt(o++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(v(i.random(),a),e.exports){e.exports=p;try{s=n(1234)}catch(b){}}else void 0===(r=function(){return p}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2456:(e,t,n)=>{"use strict";function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>null==t?e:function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];e.apply(this,r),t.apply(this,r)}),(()=>{}))}n.d(t,{A:()=>r})},2532:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(2372);function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const o={};return t.forEach((t=>{o[t]=(0,r.Ay)(e,t,n)})),o}},2730:(e,t,n)=>{"use strict";var r=n(5043),o=n(8853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,s={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,o,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var o=g.hasOwnProperty(t)?g[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var F=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=F&&e[F]||e["@@iterator"])?e:null}var P,L=Object.assign;function z(e){if(void 0===P)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||""}return"\n"+P+e}var B=!1;function U(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var o=l.stack.split("\n"),a=r.stack.split("\n"),i=o.length-1,s=a.length-1;1<=i&&0<=s&&o[i]!==a[s];)s--;for(;1<=i&&0<=s;i--,s--)if(o[i]!==a[s]){if(1!==i||1!==s)do{if(i--,0>--s||o[i]!==a[s]){var c="\n"+o[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=i&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function W(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case k:return"Portal";case C:return"Profiler";case I:return"StrictMode";case N:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return j(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){J(e,t);var n=G(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function ae(e,t){var n=G(t.value),r=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Se=null,Ie=null;function Ce(e){if(e=xo(e)){if("function"!==typeof ke)throw Error(a(280));var t=e.stateNode;t&&(t=ko(t),ke(e.stateNode,e.type,t))}}function Ae(e){Se?Ie?Ie.push(e):Ie=[e]:Se=e}function Ee(){if(Se){var e=Se,t=Ie;if(Ie=Se=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Te(e,t){return e(t)}function Ne(){}var Re=!1;function _e(e,t,n){if(Re)return e(t,n);Re=!0;try{return Te(e,t,n)}finally{Re=!1,(null!==Se||null!==Ie)&&(Ne(),Ee())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=ko(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Oe=!1;if(u)try{var Fe={};Object.defineProperty(Fe,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Fe,Fe),window.removeEventListener("test",Fe,Fe)}catch(ue){Oe=!1}function Me(e,t,n,r,o,a,i,s,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Pe=!1,Le=null,ze=!1,Be=null,Ue={onError:function(e){Pe=!0,Le=e}};function We(e,t,n,r,o,a,i,s,c){Pe=!1,Le=null,Me.apply(Ue,arguments)}function je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(je(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Ge(o),e;if(i===r)return Ge(o),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,c=o.child;c;){if(c===n){s=!0,n=o,r=i;break}if(c===r){s=!0,r=o,n=i;break}c=c.sibling}if(!s){for(c=i.child;c;){if(c===n){s=!0,n=i,r=o;break}if(c===r){s=!0,r=i,n=o;break}c=c.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ke=o.unstable_scheduleCallback,Xe=o.unstable_cancelCallback,Ye=o.unstable_shouldYield,Qe=o.unstable_requestPaint,Je=o.unstable_now,$e=o.unstable_getCurrentPriorityLevel,Ze=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,rt=o.unstable_IdlePriority,ot=null,at=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ct|0)|0},st=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes,i=268435455&n;if(0!==i){var s=i&~o;0!==s?r=dt(s):0!==(a&=i)&&(r=dt(a))}else 0!==(i=n&~o)?r=dt(i):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(a=t&-t)||16===o&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-it(t)),r|=e[n],t&=~o;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,St,It,Ct,At=!1,Et=[],Tt=null,Nt=null,Rt=null,_t=new Map,Dt=new Map,Ot=[],Ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":_t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Pt(e,t,n,r,o,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[o]},null!==t&&(null!==(t=xo(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Lt(e){var t=bo(e.target);if(null!==t){var n=je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Ct(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xo(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Bt(e,t,n){zt(e)&&n.delete(t)}function Ut(){At=!1,null!==Tt&&zt(Tt)&&(Tt=null),null!==Nt&&zt(Nt)&&(Nt=null),null!==Rt&&zt(Rt)&&(Rt=null),_t.forEach(Bt),Dt.forEach(Bt)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Ut)))}function jt(e){function t(t){return Wt(t,e)}if(0<Et.length){Wt(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&Wt(Tt,e),null!==Nt&&Wt(Nt,e),null!==Rt&&Wt(Rt,e),_t.forEach(t),Dt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Lt(n),null===n.blockedOn&&Ot.shift()}var Vt=x.ReactCurrentBatchConfig,Gt=!0;function Ht(e,t,n,r){var o=bt,a=Vt.transition;Vt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=o,Vt.transition=a}}function qt(e,t,n,r){var o=bt,a=Vt.transition;Vt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=o,Vt.transition=a}}function Kt(e,t,n,r){if(Gt){var o=Yt(e,t,n,r);if(null===o)Gr(e,t,r,Xt,n),Mt(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return Tt=Pt(Tt,e,t,n,r,o),!0;case"dragenter":return Nt=Pt(Nt,e,t,n,r,o),!0;case"mouseover":return Rt=Pt(Rt,e,t,n,r,o),!0;case"pointerover":var a=o.pointerId;return _t.set(a,Pt(_t.get(a)||null,e,t,n,r,o)),!0;case"gotpointercapture":return a=o.pointerId,Dt.set(a,Pt(Dt.get(a)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Ft.indexOf(e)){for(;null!==o;){var a=xo(o);if(null!==a&&wt(a),null===(a=Yt(e,t,n,r))&&Gr(e,t,r,Xt,n),a===o)break;o=a}null!==o&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=bo(e=we(r))))if(null===(t=je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,$t=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=$t,r=n.length,o="value"in Jt?Jt.value:Jt.textContent,a=o.length;for(e=0;e<r&&n[e]===o[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===o[a-t];t++);return Zt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,o,a){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(o):o[i]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(ln),dn=L({},ln,{view:0,detail:0}),hn=on(dn),pn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(an=e.screenX-cn.screenX,sn=e.screenY-cn.screenY):sn=an=0,cn=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=on(pn),mn=on(L({},pn,{dataTransfer:0})),gn=on(L({},dn,{relatedTarget:0})),vn=on(L({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),xn=on(L({},ln,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Cn(){return In}var An=L({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=on(An),Tn=on(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=on(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Rn=on(L({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),_n=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=on(_n),On=[9,13,27,32],Fn=u&&"CompositionEvent"in window,Mn=null;u&&"documentMode"in document&&(Mn=document.documentMode);var Pn=u&&"TextEvent"in window&&!Mn,Ln=u&&(!Fn||Mn&&8<Mn&&11>=Mn),zn=String.fromCharCode(32),Bn=!1;function Un(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ae(r),0<(t=qr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Kn=null;function Xn(e){zr(e,0)}function Yn(e){if(K(wo(e)))return e}function Qn(e,t){if("change"===e)return t}var Jn=!1;if(u){var $n;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}$n=Zn}else $n=!1;Jn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Kn=qn=null)}function nr(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];Hn(t,Kn,e,we(e)),_e(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function ar(e,t){if("click"===e)return Yn(t)}function ir(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!d.call(t,o)||!sr(e[o],t[o]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(r.start,o);r=void 0===r.end?a:Math.min(r.end,o),!e.extend&&a>r&&(o=r,r=a,a=o),o=ur(n,a);var i=ur(n,r);o&&i&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==X(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&cr(yr,r)||(yr=r,0<(r=qr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Ir={};function Cr(e){if(Sr[e])return Sr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ir)return Sr[e]=n[t];return e}u&&(Ir=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Ar=Cr("animationend"),Er=Cr("animationiteration"),Tr=Cr("animationstart"),Nr=Cr("transitionend"),Rr=new Map,_r="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Rr.set(e,t),c(t,[e])}for(var Or=0;Or<_r.length;Or++){var Fr=_r[Or];Dr(Fr.toLowerCase(),"on"+(Fr[0].toUpperCase()+Fr.slice(1)))}Dr(Ar,"onAnimationEnd"),Dr(Er,"onAnimationIteration"),Dr(Tr,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Nr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,i,s,c,l){if(We.apply(this,arguments),Pe){if(!Pe)throw Error(a(198));var u=Le;Pe=!1,Le=null,ze||(ze=!0,Be=u)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var s=r[i],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==a&&o.isPropagationStopped())break e;Lr(o,s,l),a=c}else for(i=0;i<r.length;i++){if(c=(s=r[i]).instance,l=s.currentTarget,s=s.listener,c!==a&&o.isPropagationStopped())break e;Lr(o,s,l),a=c}}}if(ze)throw e=Be,ze=!1,Be=null,e}function Br(e,t){var n=t[go];void 0===n&&(n=t[go]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Wr="_reactListening"+Math.random().toString(36).slice(2);function jr(e){if(!e[Wr]){e[Wr]=!0,i.forEach((function(t){"selectionchange"!==t&&(Pr.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wr]||(t[Wr]=!0,Ur("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Qt(t)){case 1:var o=Ht;break;case 4:o=qt;break;default:o=Kt}n=o.bind(null,t,n,e),o=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,o){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===i)for(i=r.return;null!==i;){var c=i.tag;if((3===c||4===c)&&((c=i.stateNode.containerInfo)===o||8===c.nodeType&&c.parentNode===o))return;i=i.return}for(;null!==s;){if(null===(i=bo(s)))return;if(5===(c=i.tag)||6===c){r=a=i;continue e}s=s.parentNode}}r=r.return}_e((function(){var r=a,o=we(n),i=[];e:{var s=Rr.get(e);if(void 0!==s){var c=un,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=En;break;case"focusin":l="focus",c=gn;break;case"focusout":l="blur",c=gn;break;case"beforeblur":case"afterblur":c=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Nn;break;case Ar:case Er:case Tr:c=vn;break;case Nr:c=Rn;break;case"scroll":c=hn;break;case"wheel":c=Dn;break;case"copy":case"cut":case"paste":c=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Tn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==s?s+"Capture":null:s;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=De(f,h))&&u.push(Hr(f,m,p)))),d)break;f=f.return}0<u.length&&(s=new c(s,l,null,n,o),i.push({event:s,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(l=n.relatedTarget||n.fromElement)||!bo(l)&&!l[mo])&&(c||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?bo(l):null)&&(l!==(d=je(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Tn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==c?s:wo(c),p=null==l?s:wo(l),(s=new u(m,f+"leave",c,n,o)).target=d,s.relatedTarget=p,m=null,bo(o)===r&&((u=new u(h,f+"enter",l,n,o)).target=p,u.relatedTarget=d,m=u),d=m,c&&l)e:{for(h=l,f=0,p=u=c;p;p=Kr(p))f++;for(p=0,m=h;m;m=Kr(m))p++;for(;0<f-p;)u=Kr(u),f--;for(;0<p-f;)h=Kr(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Kr(u),h=Kr(h)}u=null}else u=null;null!==c&&Xr(i,s,c,u,!1),null!==l&&null!==d&&Xr(i,d,l,u,!0)}if("select"===(c=(s=r?wo(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var g=Qn;else if(Gn(s))if(Jn)g=ir;else{g=or;var v=rr}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ar);switch(g&&(g=g(e,r))?Hn(i,g,n,o):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=r?wo(r):window,e){case"focusin":(Gn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(i,n,o);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(i,n,o)}var y;if(Fn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else jn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(jn||"onCompositionStart"!==b?"onCompositionEnd"===b&&jn&&(y=en()):($t="value"in(Jt=o)?Jt.value:Jt.textContent,jn=!0)),0<(v=qr(r,b)).length&&(b=new xn(b,e,null,n,o),i.push({event:b,listeners:v}),y?b.data=y:null!==(y=Wn(n))&&(b.data=y))),(y=Pn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Bn=!0,zn);case"textInput":return(e=t.data)===zn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(jn)return"compositionend"===e||!Fn&&Un(e,t)?(e=en(),Zt=$t=Jt=null,jn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(o=new xn("onBeforeInput","beforeinput",null,n,o),i.push({event:o,listeners:r}),o.data=y))}zr(i,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,a=o.stateNode;5===o.tag&&null!==a&&(o=a,null!=(a=De(e,n))&&r.unshift(Hr(e,a,o)),null!=(a=De(e,t))&&r.push(Hr(e,a,o))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,o){for(var a=t._reactName,i=[];null!==n&&n!==r;){var s=n,c=s.alternate,l=s.stateNode;if(null!==c&&c===r)break;5===s.tag&&null!==l&&(s=l,o?null!=(c=De(n,a))&&i.unshift(Hr(n,c,s)):o||null!=(c=De(n,a))&&i.push(Hr(n,c,s))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Yr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Qr,"")}function $r(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(a(425))}function Zr(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ro="function"===typeof setTimeout?setTimeout:void 0,oo="function"===typeof clearTimeout?clearTimeout:void 0,ao="function"===typeof Promise?Promise:void 0,io="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ao?function(e){return ao.resolve(null).then(e).catch(so)}:ro;function so(e){setTimeout((function(){throw e}))}function co(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void jt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);jt(t)}function lo(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ho=Math.random().toString(36).slice(2),po="__reactFiber$"+ho,fo="__reactProps$"+ho,mo="__reactContainer$"+ho,go="__reactEvents$"+ho,vo="__reactListeners$"+ho,yo="__reactHandles$"+ho;function bo(e){var t=e[po];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mo]||n[po]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=uo(e);null!==e;){if(n=e[po])return n;e=uo(e)}return t}n=(e=n).parentNode}return null}function xo(e){return!(e=e[po]||e[mo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function ko(e){return e[fo]||null}var So=[],Io=-1;function Co(e){return{current:e}}function Ao(e){0>Io||(e.current=So[Io],So[Io]=null,Io--)}function Eo(e,t){Io++,So[Io]=e.current,e.current=t}var To={},No=Co(To),Ro=Co(!1),_o=To;function Do(e,t){var n=e.type.contextTypes;if(!n)return To;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,a={};for(o in n)a[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Oo(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Fo(){Ao(Ro),Ao(No)}function Mo(e,t,n){if(No.current!==To)throw Error(a(168));Eo(No,t),Eo(Ro,n)}function Po(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,V(e)||"Unknown",o));return L({},n,r)}function Lo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||To,_o=No.current,Eo(No,e),Eo(Ro,Ro.current),!0}function zo(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Po(e,t,_o),r.__reactInternalMemoizedMergedChildContext=e,Ao(Ro),Ao(No),Eo(No,e)):Ao(Ro),Eo(Ro,n)}var Bo=null,Uo=!1,Wo=!1;function jo(e){null===Bo?Bo=[e]:Bo.push(e)}function Vo(){if(!Wo&&null!==Bo){Wo=!0;var e=0,t=bt;try{var n=Bo;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Bo=null,Uo=!1}catch(o){throw null!==Bo&&(Bo=Bo.slice(e+1)),Ke(Ze,Vo),o}finally{bt=t,Wo=!1}}return null}var Go=[],Ho=0,qo=null,Ko=0,Xo=[],Yo=0,Qo=null,Jo=1,$o="";function Zo(e,t){Go[Ho++]=Ko,Go[Ho++]=qo,qo=e,Ko=t}function ea(e,t,n){Xo[Yo++]=Jo,Xo[Yo++]=$o,Xo[Yo++]=Qo,Qo=e;var r=Jo;e=$o;var o=32-it(r)-1;r&=~(1<<o),n+=1;var a=32-it(t)+o;if(30<a){var i=o-o%5;a=(r&(1<<i)-1).toString(32),r>>=i,o-=i,Jo=1<<32-it(t)+o|n<<o|r,$o=a+e}else Jo=1<<a|n<<o|r,$o=e}function ta(e){null!==e.return&&(Zo(e,1),ea(e,1,0))}function na(e){for(;e===qo;)qo=Go[--Ho],Go[Ho]=null,Ko=Go[--Ho],Go[Ho]=null;for(;e===Qo;)Qo=Xo[--Yo],Xo[Yo]=null,$o=Xo[--Yo],Xo[Yo]=null,Jo=Xo[--Yo],Xo[Yo]=null}var ra=null,oa=null,aa=!1,ia=null;function sa(e,t){var n=_l(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ca(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ra=e,oa=lo(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ra=e,oa=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qo?{id:Jo,overflow:$o}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=_l(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ra=e,oa=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ua(e){if(aa){var t=oa;if(t){var n=t;if(!ca(e,t)){if(la(e))throw Error(a(418));t=lo(n.nextSibling);var r=ra;t&&ca(e,t)?sa(r,n):(e.flags=-4097&e.flags|2,aa=!1,ra=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,aa=!1,ra=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ra=e}function ha(e){if(e!==ra)return!1;if(!aa)return da(e),aa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oa)){if(la(e))throw pa(),Error(a(418));for(;t;)sa(e,t),t=lo(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oa=lo(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oa=null}}else oa=ra?lo(e.stateNode.nextSibling):null;return!0}function pa(){for(var e=oa;e;)e=lo(e.nextSibling)}function fa(){oa=ra=null,aa=!1}function ma(e){null===ia?ia=[e]:ia.push(e)}var ga=x.ReactCurrentBatchConfig;function va(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var o=r,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=o.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ya(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ba(e){return(0,e._init)(e._payload)}function xa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Ol(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Ll(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function l(e,t,n,r){var a=n.type;return a===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===D&&ba(a)===t.type)?((r=o(t,n.props)).ref=va(e,t,n),r.return=e,r):((r=Fl(n.type,n.key,n.props,null,e.mode,r)).ref=va(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zl(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Ml(n,e.mode,r,a)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ll(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Fl(t.type,t.key,t.props,null,e.mode,n)).ref=va(e,null,t),n.return=e,n;case k:return(t=zl(t,e.mode,n)).return=e,t;case D:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Ml(t,e.mode,n,null)).return=e,t;ya(e,t)}return null}function p(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==o?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===o?l(e,t,n,r):null;case k:return n.key===o?u(e,t,n,r):null;case D:return p(e,t,(o=n._init)(n._payload),r)}if(te(n)||M(n))return null!==o?null:d(e,t,n,r,null);ya(e,n)}return null}function f(e,t,n,r,o){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,o);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case D:return f(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||M(r))return d(t,e=e.get(n)||null,r,o,null);ya(t,r)}return null}function m(o,a,s,c){for(var l=null,u=null,d=a,m=a=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(o,d,s[m],c);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(o,d),a=i(v,a,m),null===u?l=v:u.sibling=v,u=v,d=g}if(m===s.length)return n(o,d),aa&&Zo(o,m),l;if(null===d){for(;m<s.length;m++)null!==(d=h(o,s[m],c))&&(a=i(d,a,m),null===u?l=d:u.sibling=d,u=d);return aa&&Zo(o,m),l}for(d=r(o,d);m<s.length;m++)null!==(g=f(d,o,m,s[m],c))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),a=i(g,a,m),null===u?l=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(o,e)})),aa&&Zo(o,m),l}function g(o,s,c,l){var u=M(c);if("function"!==typeof u)throw Error(a(150));if(null==(c=u.call(c)))throw Error(a(151));for(var d=u=null,m=s,g=s=0,v=null,y=c.next();null!==m&&!y.done;g++,y=c.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(o,m,y.value,l);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(o,m),s=i(b,s,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(o,m),aa&&Zo(o,g),u;if(null===m){for(;!y.done;g++,y=c.next())null!==(y=h(o,y.value,l))&&(s=i(y,s,g),null===d?u=y:d.sibling=y,d=y);return aa&&Zo(o,g),u}for(m=r(o,m);!y.done;g++,y=c.next())null!==(y=f(m,o,g,y.value,l))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=i(y,s,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(o,e)})),aa&&Zo(o,g),u}return function e(r,a,i,c){if("object"===typeof i&&null!==i&&i.type===S&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var l=i.key,u=a;null!==u;){if(u.key===l){if((l=i.type)===S){if(7===u.tag){n(r,u.sibling),(a=o(u,i.props.children)).return=r,r=a;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===D&&ba(l)===u.type){n(r,u.sibling),(a=o(u,i.props)).ref=va(r,u,i),a.return=r,r=a;break e}n(r,u);break}t(r,u),u=u.sibling}i.type===S?((a=Ml(i.props.children,r.mode,c,i.key)).return=r,r=a):((c=Fl(i.type,i.key,i.props,null,r.mode,c)).ref=va(r,a,i),c.return=r,r=c)}return s(r);case k:e:{for(u=i.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){n(r,a.sibling),(a=o(a,i.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=zl(i,r.mode,c)).return=r,r=a}return s(r);case D:return e(r,a,(u=i._init)(i._payload),c)}if(te(i))return m(r,a,i,c);if(M(i))return g(r,a,i,c);ya(r,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==a&&6===a.tag?(n(r,a.sibling),(a=o(a,i)).return=r,r=a):(n(r,a),(a=Ll(i,r.mode,c)).return=r,r=a),s(r)):n(r,a)}}var wa=xa(!0),ka=xa(!1),Sa=Co(null),Ia=null,Ca=null,Aa=null;function Ea(){Aa=Ca=Ia=null}function Ta(e){var t=Sa.current;Ao(Sa),e._currentValue=t}function Na(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ra(e,t){Ia=e,Aa=Ca=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function _a(e){var t=e._currentValue;if(Aa!==e)if(e={context:e,memoizedValue:t,next:null},null===Ca){if(null===Ia)throw Error(a(308));Ca=e,Ia.dependencies={lanes:0,firstContext:e}}else Ca=Ca.next=e;return t}var Da=null;function Oa(e){null===Da?Da=[e]:Da.push(e)}function Fa(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,Oa(t)):(n.next=o.next,o.next=n),t.interleaved=n,Ma(e,r)}function Ma(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Pa=!1;function La(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function za(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ba(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tc)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Ma(e,n)}return null===(o=r.interleaved)?(t.next=t,Oa(r)):(t.next=o.next,o.next=t),r.interleaved=t,Ma(e,n)}function Wa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function ja(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?o=a=i:a=a.next=i,n=n.next}while(null!==n);null===a?o=a=t:a=a.next=t}else o=a=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Va(e,t,n,r){var o=e.updateQueue;Pa=!1;var a=o.firstBaseUpdate,i=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var c=s,l=c.next;c.next=null,null===i?a=l:i.next=l,i=c;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(null!==a){var d=o.baseState;for(i=0,u=l=c=null,s=a;;){var h=s.lane,p=s.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=L({},d,h);break e;case 2:Pa=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=o.effects)?o.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=p,c=d):u=u.next=p,i|=h;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(h=s).next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}if(null===u&&(c=d),o.baseState=c,o.firstBaseUpdate=l,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{i|=o.lane,o=o.next}while(o!==t)}else null===a&&(o.shared.lanes=0);Pc|=i,e.lanes=i,e.memoizedState=d}}function Ga(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!==typeof o)throw Error(a(191,o));o.call(r)}}}var Ha={},qa=Co(Ha),Ka=Co(Ha),Xa=Co(Ha);function Ya(e){if(e===Ha)throw Error(a(174));return e}function Qa(e,t){switch(Eo(Xa,t),Eo(Ka,e),Eo(qa,Ha),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ao(qa),Eo(qa,t)}function Ja(){Ao(qa),Ao(Ka),Ao(Xa)}function $a(e){Ya(Xa.current);var t=Ya(qa.current),n=ce(t,e.type);t!==n&&(Eo(Ka,e),Eo(qa,n))}function Za(e){Ka.current===e&&(Ao(qa),Ao(Ka))}var ei=Co(0);function ti(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ni=[];function ri(){for(var e=0;e<ni.length;e++)ni[e]._workInProgressVersionPrimary=null;ni.length=0}var oi=x.ReactCurrentDispatcher,ai=x.ReactCurrentBatchConfig,ii=0,si=null,ci=null,li=null,ui=!1,di=!1,hi=0,pi=0;function fi(){throw Error(a(321))}function mi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function gi(e,t,n,r,o,i){if(ii=i,si=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,oi.current=null===e||null===e.memoizedState?Zi:es,e=n(r,o),di){i=0;do{if(di=!1,hi=0,25<=i)throw Error(a(301));i+=1,li=ci=null,t.updateQueue=null,oi.current=ts,e=n(r,o)}while(di)}if(oi.current=$i,t=null!==ci&&null!==ci.next,ii=0,li=ci=si=null,ui=!1,t)throw Error(a(300));return e}function vi(){var e=0!==hi;return hi=0,e}function yi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?si.memoizedState=li=e:li=li.next=e,li}function bi(){if(null===ci){var e=si.alternate;e=null!==e?e.memoizedState:null}else e=ci.next;var t=null===li?si.memoizedState:li.next;if(null!==t)li=t,ci=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ci=e).memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},null===li?si.memoizedState=li=e:li=li.next=e}return li}function xi(e,t){return"function"===typeof t?t(e):t}function wi(e){var t=bi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=ci,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(null!==o){i=o.next,r=r.baseState;var c=s=null,l=null,u=i;do{var d=u.lane;if((ii&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=h,s=r):l=l.next=h,si.lanes|=d,Pc|=d}u=u.next}while(null!==u&&u!==i);null===l?s=r:l.next=c,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{i=o.lane,si.lanes|=i,Pc|=i,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ki(e){var t=bi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);sr(i,t.memoizedState)||(bs=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Si(){}function Ii(e,t){var n=si,r=bi(),o=t(),i=!sr(r.memoizedState,o);if(i&&(r.memoizedState=o,bs=!0),r=r.queue,Pi(Ei.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(n.flags|=2048,_i(9,Ai.bind(null,n,r,o,t),void 0,null),null===Nc)throw Error(a(349));0!==(30&ii)||Ci(n,t,o)}return o}function Ci(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=si.updateQueue)?(t={lastEffect:null,stores:null},si.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ai(e,t,n,r){t.value=n,t.getSnapshot=r,Ti(t)&&Ni(e)}function Ei(e,t,n){return n((function(){Ti(t)&&Ni(e)}))}function Ti(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Ni(e){var t=Ma(e,1);null!==t&&nl(t,e,1,-1)}function Ri(e){var t=yi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:e},t.queue=e,e=e.dispatch=Xi.bind(null,si,e),[t.memoizedState,e]}function _i(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=si.updateQueue)?(t={lastEffect:null,stores:null},si.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Di(){return bi().memoizedState}function Oi(e,t,n,r){var o=yi();si.flags|=e,o.memoizedState=_i(1|t,n,void 0,void 0===r?null:r)}function Fi(e,t,n,r){var o=bi();r=void 0===r?null:r;var a=void 0;if(null!==ci){var i=ci.memoizedState;if(a=i.destroy,null!==r&&mi(r,i.deps))return void(o.memoizedState=_i(t,n,a,r))}si.flags|=e,o.memoizedState=_i(1|t,n,a,r)}function Mi(e,t){return Oi(8390656,8,e,t)}function Pi(e,t){return Fi(2048,8,e,t)}function Li(e,t){return Fi(4,2,e,t)}function zi(e,t){return Fi(4,4,e,t)}function Bi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ui(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fi(4,4,Bi.bind(null,t,e),n)}function Wi(){}function ji(e,t){var n=bi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Vi(e,t){var n=bi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mi(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Gi(e,t,n){return 0===(21&ii)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),si.lanes|=n,Pc|=n,e.baseState=!0),t)}function Hi(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ai.transition;ai.transition={};try{e(!1),t()}finally{bt=n,ai.transition=r}}function qi(){return bi().memoizedState}function Ki(e,t,n){var r=tl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Yi(e))Qi(t,n);else if(null!==(n=Fa(e,t,n,r))){nl(n,e,r,el()),Ji(n,t,r)}}function Xi(e,t,n){var r=tl(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yi(e))Qi(t,o);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,s=a(i,n);if(o.hasEagerState=!0,o.eagerState=s,sr(s,i)){var c=t.interleaved;return null===c?(o.next=o,Oa(t)):(o.next=c.next,c.next=o),void(t.interleaved=o)}}catch(l){}null!==(n=Fa(e,t,o,r))&&(nl(n,e,r,o=el()),Ji(n,t,r))}}function Yi(e){var t=e.alternate;return e===si||null!==t&&t===si}function Qi(e,t){di=ui=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ji(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var $i={readContext:_a,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},Zi={readContext:_a,useCallback:function(e,t){return yi().memoizedState=[e,void 0===t?null:t],e},useContext:_a,useEffect:Mi,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oi(4194308,4,Bi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oi(4,2,e,t)},useMemo:function(e,t){var n=yi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yi();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ki.bind(null,si,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},yi().memoizedState=e},useState:Ri,useDebugValue:Wi,useDeferredValue:function(e){return yi().memoizedState=e},useTransition:function(){var e=Ri(!1),t=e[0];return e=Hi.bind(null,e[1]),yi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=si,o=yi();if(aa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Nc)throw Error(a(349));0!==(30&ii)||Ci(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,Mi(Ei.bind(null,r,i,e),[e]),r.flags|=2048,_i(9,Ai.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=yi(),t=Nc.identifierPrefix;if(aa){var n=$o;t=":"+t+"R"+(n=(Jo&~(1<<32-it(Jo)-1)).toString(32)+n),0<(n=hi++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:_a,useCallback:ji,useContext:_a,useEffect:Pi,useImperativeHandle:Ui,useInsertionEffect:Li,useLayoutEffect:zi,useMemo:Vi,useReducer:wi,useRef:Di,useState:function(){return wi(xi)},useDebugValue:Wi,useDeferredValue:function(e){return Gi(bi(),ci.memoizedState,e)},useTransition:function(){return[wi(xi)[0],bi().memoizedState]},useMutableSource:Si,useSyncExternalStore:Ii,useId:qi,unstable_isNewReconciler:!1},ts={readContext:_a,useCallback:ji,useContext:_a,useEffect:Pi,useImperativeHandle:Ui,useInsertionEffect:Li,useLayoutEffect:zi,useMemo:Vi,useReducer:ki,useRef:Di,useState:function(){return ki(xi)},useDebugValue:Wi,useDeferredValue:function(e){var t=bi();return null===ci?t.memoizedState=e:Gi(t,ci.memoizedState,e)},useTransition:function(){return[ki(xi)[0],bi().memoizedState]},useMutableSource:Si,useSyncExternalStore:Ii,useId:qi,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var os={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=el(),o=tl(e),a=Ba(r,o);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,o))&&(nl(t,e,o,r),Wa(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=el(),o=tl(e),a=Ba(r,o);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,o))&&(nl(t,e,o,r),Wa(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=el(),r=tl(e),o=Ba(n,r);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=Ua(e,o,r))&&(nl(t,e,r,n),Wa(t,e,r))}};function as(e,t,n,r,o,a,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(o,a))}function is(e,t,n){var r=!1,o=To,a=t.contextType;return"object"===typeof a&&null!==a?a=_a(a):(o=Oo(t)?_o:No.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Do(e,o):To),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=os,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&os.enqueueReplaceState(t,t.state,null)}function cs(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},La(e);var a=t.contextType;"object"===typeof a&&null!==a?o.context=_a(a):(a=Oo(t)?_o:No.current,o.context=Do(e,a)),o.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(rs(e,t,a,n),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&os.enqueueReplaceState(o,o.state,null),Va(e,n,o,r),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function ls(e,t){try{var n="",r=t;do{n+=W(r),r=r.return}while(r);var o=n}catch(a){o="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:o,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var hs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Ba(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gc||(Gc=!0,Hc=r),ds(0,t)},n}function fs(e,t,n){(n=Ba(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){ds(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!==typeof r&&(null===qc?qc=new Set([this]):qc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=Cl.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,r,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ba(-1,1)).tag=2,Ua(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var ys=x.ReactCurrentOwner,bs=!1;function xs(e,t,n,r){t.child=null===e?ka(t,null,n,r):wa(t,e.child,n,r)}function ws(e,t,n,r,o){n=n.render;var a=t.ref;return Ra(t,o),r=gi(e,t,n,r,a,o),n=vi(),null===e||bs?(aa&&n&&ta(t),t.flags|=1,xs(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gs(e,t,o))}function ks(e,t,n,r,o){if(null===e){var a=n.type;return"function"!==typeof a||Dl(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Fl(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ss(e,t,a,r,o))}if(a=e.child,0===(e.lanes&o)){var i=a.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(i,r)&&e.ref===t.ref)return Gs(e,t,o)}return t.flags|=1,(e=Ol(a,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,o){if(null!==e){var a=e.memoizedProps;if(cr(a,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=a,0===(e.lanes&o))return t.lanes=e.lanes,Gs(e,t,o);0!==(131072&e.flags)&&(bs=!0)}}return As(e,t,n,r,o)}function Is(e,t,n){var r=t.pendingProps,o=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Eo(Oc,Dc),Dc|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Eo(Oc,Dc),Dc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Eo(Oc,Dc),Dc|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Eo(Oc,Dc),Dc|=r;return xs(e,t,o,n),t.child}function Cs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function As(e,t,n,r,o){var a=Oo(n)?_o:No.current;return a=Do(t,a),Ra(t,o),n=gi(e,t,n,r,a,o),r=vi(),null===e||bs?(aa&&r&&ta(t),t.flags|=1,xs(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gs(e,t,o))}function Es(e,t,n,r,o){if(Oo(n)){var a=!0;Lo(t)}else a=!1;if(Ra(t,o),null===t.stateNode)Vs(e,t),is(t,n,r),cs(t,n,r,o),r=!0;else if(null===e){var i=t.stateNode,s=t.memoizedProps;i.props=s;var c=i.context,l=n.contextType;"object"===typeof l&&null!==l?l=_a(l):l=Do(t,l=Oo(n)?_o:No.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof i.getSnapshotBeforeUpdate;d||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==r||c!==l)&&ss(t,i,r,l),Pa=!1;var h=t.memoizedState;i.state=h,Va(t,r,i,o),c=t.memoizedState,s!==r||h!==c||Ro.current||Pa?("function"===typeof u&&(rs(t,n,u,r),c=t.memoizedState),(s=Pa||as(t,n,s,r,h,c,l))?(d||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=l,r=s):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,za(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:ns(t.type,s),i.props=l,d=t.pendingProps,h=i.context,"object"===typeof(c=n.contextType)&&null!==c?c=_a(c):c=Do(t,c=Oo(n)?_o:No.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==d||h!==c)&&ss(t,i,r,c),Pa=!1,h=t.memoizedState,i.state=h,Va(t,r,i,o);var f=t.memoizedState;s!==d||h!==f||Ro.current||Pa?("function"===typeof p&&(rs(t,n,p,r),f=t.memoizedState),(l=Pa||as(t,n,l,r,h,f,c)||!1)?(u||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,f,c),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,f,c)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),i.props=r,i.state=f,i.context=c,r=l):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ts(e,t,n,r,a,o)}function Ts(e,t,n,r,o,a){Cs(e,t);var i=0!==(128&t.flags);if(!r&&!i)return o&&zo(t,n,!1),Gs(e,t,a);r=t.stateNode,ys.current=t;var s=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=wa(t,e.child,null,a),t.child=wa(t,null,s,a)):xs(e,t,s,a),t.memoizedState=r.state,o&&zo(t,n,!0),t.child}function Ns(e){var t=e.stateNode;t.pendingContext?Mo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mo(0,t.context,!1),Qa(e,t.containerInfo)}function Rs(e,t,n,r,o){return fa(),ma(o),t.flags|=256,xs(e,t,n,r),t.child}var _s,Ds,Os,Fs,Ms={dehydrated:null,treeContext:null,retryLane:0};function Ps(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t,n){var r,o=t.pendingProps,i=ei.current,s=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Eo(ei,1&i),null===e)return ua(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=o.children,e=o.fallback,s?(o=t.mode,s=t.child,c={mode:"hidden",children:c},0===(1&o)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Pl(c,o,0,null),e=Ml(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ps(n),t.memoizedState=Ms,e):zs(t,c));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,o,i,s){if(n)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,r=us(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=Pl({mode:"visible",children:r.children},o,0,null),(i=Ml(i,o,s,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,0!==(1&t.mode)&&wa(t,e.child,null,s),t.child.memoizedState=Ps(s),t.memoizedState=Ms,i);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var c=r.dgst;return r=c,Bs(e,t,s,r=us(i=Error(a(419)),r,void 0))}if(c=0!==(s&e.childLanes),bs||c){if(null!==(r=Nc)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(r.suspendedLanes|s))?0:o)&&o!==i.retryLane&&(i.retryLane=o,Ma(e,o),nl(r,e,o,-1))}return ml(),Bs(e,t,s,r=us(Error(a(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=El.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,oa=lo(o.nextSibling),ra=t,aa=!0,ia=null,null!==e&&(Xo[Yo++]=Jo,Xo[Yo++]=$o,Xo[Yo++]=Qo,Jo=e.id,$o=e.overflow,Qo=t),t=zs(t,r.children),t.flags|=4096,t)}(e,t,c,o,r,i,n);if(s){s=o.fallback,c=t.mode,r=(i=e.child).sibling;var l={mode:"hidden",children:o.children};return 0===(1&c)&&t.child!==i?((o=t.child).childLanes=0,o.pendingProps=l,t.deletions=null):(o=Ol(i,l)).subtreeFlags=14680064&i.subtreeFlags,null!==r?s=Ol(r,s):(s=Ml(s,c,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,c=null===(c=e.child.memoizedState)?Ps(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~n,t.memoizedState=Ms,o}return e=(s=e.child).sibling,o=Ol(s,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function zs(e,t){return(t=Pl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,n,r){return null!==r&&ma(r),wa(t,e.child,null,n),(e=zs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Na(e.return,t,n)}function Ws(e,t,n,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o)}function js(e,t,n){var r=t.pendingProps,o=r.revealOrder,a=r.tail;if(xs(e,t,r.children,n),0!==(2&(r=ei.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,n,t);else if(19===e.tag)Us(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Eo(ei,r),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ti(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Ws(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ti(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Ws(t,!0,n,null,a);break;case"together":Ws(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Pc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Ol(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ol(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hs(e,t){if(!aa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(na(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Oo(t.type)&&Fo(),qs(t),null;case 3:return r=t.stateNode,Ja(),Ao(Ro),Ao(No),ri(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ia&&(il(ia),ia=null))),Ds(e,t),qs(t),null;case 5:Za(t);var o=Ya(Xa.current);if(n=t.type,null!==e&&null!=t.stateNode)Os(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return qs(t),null}if(e=Ya(qa.current),ha(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[po]=t,r[fo]=i,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(o=0;o<Mr.length;o++)Br(Mr[o],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Q(r,i),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Br("invalid",r);break;case"textarea":oe(r,i),Br("invalid",r)}for(var c in ye(n,i),o=null,i)if(i.hasOwnProperty(c)){var l=i[c];"children"===c?"string"===typeof l?r.textContent!==l&&(!0!==i.suppressHydrationWarning&&$r(r.textContent,l,e),o=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==i.suppressHydrationWarning&&$r(r.textContent,l,e),o=["children",""+l]):s.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Br("scroll",r)}switch(n){case"input":q(r),Z(r,i,!0);break;case"textarea":q(r),ie(r);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(r.onclick=Zr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[po]=t,e[fo]=r,_s(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),o=r;break;case"iframe":case"object":case"embed":Br("load",e),o=r;break;case"video":case"audio":for(o=0;o<Mr.length;o++)Br(Mr[o],e);o=r;break;case"source":Br("error",e),o=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),o=r;break;case"details":Br("toggle",e),o=r;break;case"input":Q(e,r),o=Y(e,r),Br("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=L({},r,{value:void 0}),Br("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),Br("invalid",e)}for(i in ye(n,o),l=o)if(l.hasOwnProperty(i)){var u=l[i];"style"===i?ge(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(s.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Br("scroll",e):null!=u&&b(e,i,u,c))}switch(n){case"input":q(e),Z(e,r,!1);break;case"textarea":q(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Fs(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Ya(Xa.current),Ya(qa.current),ha(t)){if(r=t.stateNode,n=t.memoizedProps,r[po]=t,(i=r.nodeValue!==n)&&null!==(e=ra))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[po]=t,t.stateNode=r}return qs(t),null;case 13:if(Ao(ei),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(aa&&null!==oa&&0!==(1&t.mode)&&0===(128&t.flags))pa(),fa(),t.flags|=98560,i=!1;else if(i=ha(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[po]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),i=!1}else null!==ia&&(il(ia),ia=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ei.current)?0===Fc&&(Fc=3):ml())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return Ja(),Ds(e,t),null===e&&jr(t.stateNode.containerInfo),qs(t),null;case 10:return Ta(t.type._context),qs(t),null;case 19:if(Ao(ei),null===(i=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(c=i.rendering))if(r)Hs(i,!1);else{if(0!==Fc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=ti(e))){for(t.flags|=128,Hs(i,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(c=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,e=c.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Eo(ei,1&ei.current|2),t.child}e=e.sibling}null!==i.tail&&Je()>jc&&(t.flags|=128,r=!0,Hs(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ti(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hs(i,!0),null===i.tail&&"hidden"===i.tailMode&&!c.alternate&&!aa)return qs(t),null}else 2*Je()-i.renderingStartTime>jc&&1073741824!==n&&(t.flags|=128,r=!0,Hs(i,!1),t.lanes=4194304);i.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=i.last)?n.sibling=c:t.child=c,i.last=c)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Je(),t.sibling=null,n=ei.current,Eo(ei,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return dl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dc)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Xs(e,t){switch(na(t),t.tag){case 1:return Oo(t.type)&&Fo(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ja(),Ao(Ro),Ao(No),ri(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Za(t),null;case 13:if(Ao(ei),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ao(ei),null;case 4:return Ja(),null;case 10:return Ta(t.type._context),null;case 22:case 23:return dl(),null;default:return null}}_s=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ds=function(){},Os=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Ya(qa.current);var a,i=null;switch(n){case"input":o=Y(e,o),r=Y(e,r),i=[];break;case"select":o=L({},o,{value:void 0}),r=L({},r,{value:void 0}),i=[];break;case"textarea":o=re(e,o),r=re(e,r),i=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var c=o[u];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(c=null!=o?o[u]:void 0,r.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(a in c)!c.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&c[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(i||(i=[]),i.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(i=i||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(i=i||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Br("scroll",e),i||c===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Fs=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ys=!1,Qs=!1,Js="function"===typeof WeakSet?WeakSet:Set,$s=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Il(e,t,r)}else n.current=null}function ec(e,t,n){try{n()}catch(r){Il(e,t,r)}}var tc=!1;function nc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,void 0!==a&&ec(t,n,a)}o=o.next}while(o!==r)}}function rc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function oc(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ac(e){var t=e.alternate;null!==t&&(e.alternate=null,ac(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[po],delete t[fo],delete t[go],delete t[vo],delete t[yo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ic(e){return 5===e.tag||3===e.tag||4===e.tag}function sc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ic(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cc(e,t,n),e=e.sibling;null!==e;)cc(e,t,n),e=e.sibling}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}var uc=null,dc=!1;function hc(e,t,n){for(n=n.child;null!==n;)pc(e,t,n),n=n.sibling}function pc(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(ot,n)}catch(s){}switch(n.tag){case 5:Qs||Zs(n,t);case 6:var r=uc,o=dc;uc=null,hc(e,t,n),dc=o,null!==(uc=r)&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):uc.removeChild(n.stateNode));break;case 18:null!==uc&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?co(e.parentNode,n):1===e.nodeType&&co(e,n),jt(e)):co(uc,n.stateNode));break;case 4:r=uc,o=dc,uc=n.stateNode.containerInfo,dc=!0,hc(e,t,n),uc=r,dc=o;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var a=o,i=a.destroy;a=a.tag,void 0!==i&&(0!==(2&a)||0!==(4&a))&&ec(n,t,i),o=o.next}while(o!==r)}hc(e,t,n);break;case 1:if(!Qs&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Il(n,t,s)}hc(e,t,n);break;case 21:hc(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,hc(e,t,n),Qs=r):hc(e,t,n);break;default:hc(e,t,n)}}function fc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach((function(t){var r=Tl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function mc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,dc=!1;break e;case 3:case 4:uc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===uc)throw Error(a(160));pc(i,s,o),uc=null,dc=!1;var l=o.alternate;null!==l&&(l.return=null),o.return=null}catch(u){Il(o,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gc(t,e),t=t.sibling}function gc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),vc(e),4&r){try{nc(3,e,e.return),rc(3,e)}catch(g){Il(e,e.return,g)}try{nc(5,e,e.return)}catch(g){Il(e,e.return,g)}}break;case 1:mc(t,e),vc(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(mc(t,e),vc(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var o=e.stateNode;try{he(o,"")}catch(g){Il(e,e.return,g)}}if(4&r&&null!=(o=e.stateNode)){var i=e.memoizedProps,s=null!==n?n.memoizedProps:i,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===i.type&&null!=i.name&&J(o,i),be(c,s);var u=be(c,i);for(s=0;s<l.length;s+=2){var d=l[s],h=l[s+1];"style"===d?ge(o,h):"dangerouslySetInnerHTML"===d?de(o,h):"children"===d?he(o,h):b(o,d,h,u)}switch(c){case"input":$(o,i);break;case"textarea":ae(o,i);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?ne(o,!!i.multiple,f,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(o,!!i.multiple,i.defaultValue,!0):ne(o,!!i.multiple,i.multiple?[]:"",!1))}o[fo]=i}catch(g){Il(e,e.return,g)}}break;case 6:if(mc(t,e),vc(e),4&r){if(null===e.stateNode)throw Error(a(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(g){Il(e,e.return,g)}}break;case 3:if(mc(t,e),vc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(g){Il(e,e.return,g)}break;case 4:default:mc(t,e),vc(e);break;case 13:mc(t,e),vc(e),8192&(o=e.child).flags&&(i=null!==o.memoizedState,o.stateNode.isHidden=i,!i||null!==o.alternate&&null!==o.alternate.memoizedState||(Wc=Je())),4&r&&fc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(u=Qs)||d,mc(t,e),Qs=u):mc(t,e),vc(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for($s=e,d=e.child;null!==d;){for(h=$s=d;null!==$s;){switch(f=(p=$s).child,p.tag){case 0:case 11:case 14:case 15:nc(4,p,p.return);break;case 1:Zs(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Il(r,n,g)}}break;case 5:Zs(p,p.return);break;case 22:if(null!==p.memoizedState){wc(h);continue}}null!==f?(f.return=p,$s=f):wc(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{o=h.stateNode,u?"function"===typeof(i=o.style).setProperty?i.setProperty("display","none","important"):i.display="none":(c=h.stateNode,s=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=me("display",s))}catch(g){Il(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Il(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:mc(t,e),vc(e),4&r&&fc(e);case 21:}}function vc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ic(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(he(o,""),r.flags&=-33),lc(e,sc(e),o);break;case 3:case 4:var i=r.stateNode.containerInfo;cc(e,sc(e),i);break;default:throw Error(a(161))}}catch(s){Il(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yc(e,t,n){$s=e,bc(e,t,n)}function bc(e,t,n){for(var r=0!==(1&e.mode);null!==$s;){var o=$s,a=o.child;if(22===o.tag&&r){var i=null!==o.memoizedState||Ys;if(!i){var s=o.alternate,c=null!==s&&null!==s.memoizedState||Qs;s=Ys;var l=Qs;if(Ys=i,(Qs=c)&&!l)for($s=o;null!==$s;)c=(i=$s).child,22===i.tag&&null!==i.memoizedState?kc(o):null!==c?(c.return=i,$s=c):kc(o);for(;null!==a;)$s=a,bc(a,t,n),a=a.sibling;$s=o,Ys=s,Qs=l}xc(e)}else 0!==(8772&o.subtreeFlags)&&null!==a?(a.return=o,$s=a):xc(e)}}function xc(e){for(;null!==$s;){var t=$s;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||rc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Ga(t,i,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ga(t,s,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&jt(h)}}}break;default:throw Error(a(163))}Qs||512&t.flags&&oc(t)}catch(p){Il(t,t.return,p)}}if(t===e){$s=null;break}if(null!==(n=t.sibling)){n.return=t.return,$s=n;break}$s=t.return}}function wc(e){for(;null!==$s;){var t=$s;if(t===e){$s=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$s=n;break}$s=t.return}}function kc(e){for(;null!==$s;){var t=$s;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rc(4,t)}catch(c){Il(t,n,c)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(c){Il(t,o,c)}}var a=t.return;try{oc(t)}catch(c){Il(t,a,c)}break;case 5:var i=t.return;try{oc(t)}catch(c){Il(t,i,c)}}}catch(c){Il(t,t.return,c)}if(t===e){$s=null;break}var s=t.sibling;if(null!==s){s.return=t.return,$s=s;break}$s=t.return}}var Sc,Ic=Math.ceil,Cc=x.ReactCurrentDispatcher,Ac=x.ReactCurrentOwner,Ec=x.ReactCurrentBatchConfig,Tc=0,Nc=null,Rc=null,_c=0,Dc=0,Oc=Co(0),Fc=0,Mc=null,Pc=0,Lc=0,zc=0,Bc=null,Uc=null,Wc=0,jc=1/0,Vc=null,Gc=!1,Hc=null,qc=null,Kc=!1,Xc=null,Yc=0,Qc=0,Jc=null,$c=-1,Zc=0;function el(){return 0!==(6&Tc)?Je():-1!==$c?$c:$c=Je()}function tl(e){return 0===(1&e.mode)?1:0!==(2&Tc)&&0!==_c?_c&-_c:null!==ga.transition?(0===Zc&&(Zc=mt()),Zc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nl(e,t,n,r){if(50<Qc)throw Qc=0,Jc=null,Error(a(185));vt(e,n,r),0!==(2&Tc)&&e===Nc||(e===Nc&&(0===(2&Tc)&&(Lc|=n),4===Fc&&sl(e,_c)),rl(e,r),1===n&&0===Tc&&0===(1&t.mode)&&(jc=Je()+500,Uo&&Vo()))}function rl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-it(a),s=1<<i,c=o[i];-1===c?0!==(s&n)&&0===(s&r)||(o[i]=pt(s,t)):c<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=ht(e,e===Nc?_c:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Uo=!0,jo(e)}(cl.bind(null,e)):jo(cl.bind(null,e)),io((function(){0===(6&Tc)&&Vo()})),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nl(n,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ol(e,t){if($c=-1,Zc=0,0!==(6&Tc))throw Error(a(327));var n=e.callbackNode;if(kl()&&e.callbackNode!==n)return null;var r=ht(e,e===Nc?_c:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gl(e,r);else{t=r;var o=Tc;Tc|=2;var i=fl();for(Nc===e&&_c===t||(Vc=null,jc=Je()+500,hl(e,t));;)try{yl();break}catch(c){pl(e,c)}Ea(),Cc.current=i,Tc=o,null!==Rc?t=0:(Nc=null,_c=0,t=Fc)}if(0!==t){if(2===t&&(0!==(o=ft(e))&&(r=o,t=al(e,o))),1===t)throw n=Mc,hl(e,0),sl(e,r),rl(e,Je()),n;if(6===t)sl(e,r);else{if(o=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],a=o.getSnapshot;o=o.value;try{if(!sr(a(),o))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=gl(e,r))&&(0!==(i=ft(e))&&(r=i,t=al(e,i))),1===t))throw n=Mc,hl(e,0),sl(e,r),rl(e,Je()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:wl(e,Uc,Vc);break;case 3:if(sl(e,r),(130023424&r)===r&&10<(t=Wc+500-Je())){if(0!==ht(e,0))break;if(((o=e.suspendedLanes)&r)!==r){el(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ro(wl.bind(null,e,Uc,Vc),t);break}wl(e,Uc,Vc);break;case 4:if(sl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-it(r);i=1<<s,(s=t[s])>o&&(o=s),r&=~i}if(r=o,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ic(r/1960))-r)){e.timeoutHandle=ro(wl.bind(null,e,Uc,Vc),r);break}wl(e,Uc,Vc);break;default:throw Error(a(329))}}}return rl(e,Je()),e.callbackNode===n?ol.bind(null,e):null}function al(e,t){var n=Bc;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=gl(e,t))&&(t=Uc,Uc=n,null!==t&&il(t)),e}function il(e){null===Uc?Uc=e:Uc.push.apply(Uc,e)}function sl(e,t){for(t&=~zc,t&=~Lc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function cl(e){if(0!==(6&Tc))throw Error(a(327));kl();var t=ht(e,0);if(0===(1&t))return rl(e,Je()),null;var n=gl(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=al(e,r))}if(1===n)throw n=Mc,hl(e,0),sl(e,t),rl(e,Je()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wl(e,Uc,Vc),rl(e,Je()),null}function ll(e,t){var n=Tc;Tc|=1;try{return e(t)}finally{0===(Tc=n)&&(jc=Je()+500,Uo&&Vo())}}function ul(e){null!==Xc&&0===Xc.tag&&0===(6&Tc)&&kl();var t=Tc;Tc|=1;var n=Ec.transition,r=bt;try{if(Ec.transition=null,bt=1,e)return e()}finally{bt=r,Ec.transition=n,0===(6&(Tc=t))&&Vo()}}function dl(){Dc=Oc.current,Ao(Oc)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==Rc)for(n=Rc.return;null!==n;){var r=n;switch(na(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Fo();break;case 3:Ja(),Ao(Ro),Ao(No),ri();break;case 5:Za(r);break;case 4:Ja();break;case 13:case 19:Ao(ei);break;case 10:Ta(r.type._context);break;case 22:case 23:dl()}n=n.return}if(Nc=e,Rc=e=Ol(e.current,null),_c=Dc=t,Fc=0,Mc=null,zc=Lc=Pc=0,Uc=Bc=null,null!==Da){for(t=0;t<Da.length;t++)if(null!==(r=(n=Da[t]).interleaved)){n.interleaved=null;var o=r.next,a=n.pending;if(null!==a){var i=a.next;a.next=o,r.next=i}n.pending=r}Da=null}return e}function pl(e,t){for(;;){var n=Rc;try{if(Ea(),oi.current=$i,ui){for(var r=si.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ui=!1}if(ii=0,li=ci=si=null,di=!1,hi=0,Ac.current=null,null===n||null===n.return){Fc=1,Mc=t,Rc=null;break}e:{var i=e,s=n.return,c=n,l=t;if(t=_c,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=c,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,vs(f,s,c,0,t),1&f.mode&&ms(i,u,t),l=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}if(0===(1&t)){ms(i,u,t),ml();break e}l=Error(a(426))}else if(aa&&1&c.mode){var v=gs(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vs(v,s,c,0,t),ma(ls(l,c));break e}}i=l=ls(l,c),4!==Fc&&(Fc=2),null===Bc?Bc=[i]:Bc.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,ja(i,ps(0,l,t));break e;case 1:c=l;var y=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qc||!qc.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,ja(i,fs(i,c,t));break e}}i=i.return}while(null!==i)}xl(n)}catch(x){t=x,Rc===n&&null!==n&&(Rc=n=n.return);continue}break}}function fl(){var e=Cc.current;return Cc.current=$i,null===e?$i:e}function ml(){0!==Fc&&3!==Fc&&2!==Fc||(Fc=4),null===Nc||0===(268435455&Pc)&&0===(268435455&Lc)||sl(Nc,_c)}function gl(e,t){var n=Tc;Tc|=2;var r=fl();for(Nc===e&&_c===t||(Vc=null,hl(e,t));;)try{vl();break}catch(o){pl(e,o)}if(Ea(),Tc=n,Cc.current=r,null!==Rc)throw Error(a(261));return Nc=null,_c=0,Fc}function vl(){for(;null!==Rc;)bl(Rc)}function yl(){for(;null!==Rc&&!Ye();)bl(Rc)}function bl(e){var t=Sc(e.alternate,e,Dc);e.memoizedProps=e.pendingProps,null===t?xl(e):Rc=t,Ac.current=null}function xl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ks(n,t,Dc)))return void(Rc=n)}else{if(null!==(n=Xs(n,t)))return n.flags&=32767,void(Rc=n);if(null===e)return Fc=6,void(Rc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rc=t);Rc=t=e}while(null!==t);0===Fc&&(Fc=5)}function wl(e,t,n){var r=bt,o=Ec.transition;try{Ec.transition=null,bt=1,function(e,t,n,r){do{kl()}while(null!==Xc);if(0!==(6&Tc))throw Error(a(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-it(n),a=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~a}}(e,i),e===Nc&&(Rc=Nc=null,_c=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kc||(Kc=!0,Nl(tt,(function(){return kl(),null}))),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Ec.transition,Ec.transition=null;var s=bt;bt=1;var c=Tc;Tc|=4,Ac.current=null,function(e,t){if(eo=Gt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var s=0,c=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==o&&3!==h.nodeType||(c=s+o),h!==i||0!==r&&3!==h.nodeType||(l=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===o&&(c=s),p===i&&++d===r&&(l=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},Gt=!1,$s=t;null!==$s;)if(e=(t=$s).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$s=e;else for(;null!==$s;){t=$s;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(a(163))}}catch(w){Il(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,$s=e;break}$s=t.return}m=tc,tc=!1}(e,n),gc(n,e),fr(to),Gt=!!eo,to=eo=null,e.current=n,yc(n,e,o),Qe(),Tc=c,bt=s,Ec.transition=i}else e.current=n;if(Kc&&(Kc=!1,Xc=e,Yc=o),i=e.pendingLanes,0===i&&(qc=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(ot,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rl(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Gc)throw Gc=!1,e=Hc,Hc=null,e;0!==(1&Yc)&&0!==e.tag&&kl(),i=e.pendingLanes,0!==(1&i)?e===Jc?Qc++:(Qc=0,Jc=e):Qc=0,Vo()}(e,t,n,r)}finally{Ec.transition=o,bt=r}return null}function kl(){if(null!==Xc){var e=xt(Yc),t=Ec.transition,n=bt;try{if(Ec.transition=null,bt=16>e?16:e,null===Xc)var r=!1;else{if(e=Xc,Xc=null,Yc=0,0!==(6&Tc))throw Error(a(331));var o=Tc;for(Tc|=4,$s=e.current;null!==$s;){var i=$s,s=i.child;if(0!==(16&$s.flags)){var c=i.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for($s=u;null!==$s;){var d=$s;switch(d.tag){case 0:case 11:case 15:nc(8,d,i)}var h=d.child;if(null!==h)h.return=d,$s=h;else for(;null!==$s;){var p=(d=$s).sibling,f=d.return;if(ac(d),d===u){$s=null;break}if(null!==p){p.return=f,$s=p;break}$s=f}}}var m=i.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}$s=i}}if(0!==(2064&i.subtreeFlags)&&null!==s)s.return=i,$s=s;else e:for(;null!==$s;){if(0!==(2048&(i=$s).flags))switch(i.tag){case 0:case 11:case 15:nc(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,$s=y;break e}$s=i.return}}var b=e.current;for($s=b;null!==$s;){var x=(s=$s).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,$s=x;else e:for(s=b;null!==$s;){if(0!==(2048&(c=$s).flags))try{switch(c.tag){case 0:case 11:case 15:rc(9,c)}}catch(k){Il(c,c.return,k)}if(c===s){$s=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,$s=w;break e}$s=c.return}}if(Tc=o,Vo(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(ot,e)}catch(k){}r=!0}return r}finally{bt=n,Ec.transition=t}}return!1}function Sl(e,t,n){e=Ua(e,t=ps(0,t=ls(n,t),1),1),t=el(),null!==e&&(vt(e,1,t),rl(e,t))}function Il(e,t,n){if(3===e.tag)Sl(e,e,n);else for(;null!==t;){if(3===t.tag){Sl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qc||!qc.has(r))){t=Ua(t,e=fs(t,e=ls(n,e),1),1),e=el(),null!==t&&(vt(t,1,e),rl(t,e));break}}t=t.return}}function Cl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&n,Nc===e&&(_c&n)===n&&(4===Fc||3===Fc&&(130023424&_c)===_c&&500>Je()-Wc?hl(e,0):zc|=n),rl(e,t)}function Al(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=el();null!==(e=Ma(e,t))&&(vt(e,t,n),rl(e,n))}function El(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Al(e,n)}function Tl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Al(e,n)}function Nl(e,t){return Ke(e,t)}function Rl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _l(e,t,n,r){return new Rl(e,t,n,r)}function Dl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ol(e,t){var n=e.alternate;return null===n?((n=_l(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Fl(e,t,n,r,o,i){var s=2;if(r=e,"function"===typeof e)Dl(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Ml(n.children,o,i,t);case I:s=8,o|=8;break;case C:return(e=_l(12,n,t,2|o)).elementType=C,e.lanes=i,e;case N:return(e=_l(13,n,t,o)).elementType=N,e.lanes=i,e;case R:return(e=_l(19,n,t,o)).elementType=R,e.lanes=i,e;case O:return Pl(n,o,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:s=10;break e;case E:s=9;break e;case T:s=11;break e;case _:s=14;break e;case D:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=_l(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function Ml(e,t,n,r){return(e=_l(7,e,r,t)).lanes=n,e}function Pl(e,t,n,r){return(e=_l(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Ll(e,t,n){return(e=_l(6,e,null,t)).lanes=n,e}function zl(e,t,n){return(t=_l(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bl(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Ul(e,t,n,r,o,a,i,s,c){return e=new Bl(e,t,n,s,c),1===t?(t=1,!0===a&&(t|=8)):t=0,a=_l(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},La(a),e}function Wl(e){if(!e)return To;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Oo(n))return Po(e,n,t)}return t}function jl(e,t,n,r,o,a,i,s,c){return(e=Ul(n,r,!0,e,0,a,0,s,c)).context=Wl(null),n=e.current,(a=Ba(r=el(),o=tl(n))).callback=void 0!==t&&null!==t?t:null,Ua(n,a,o),e.current.lanes=o,vt(e,o,r),rl(e,r),e}function Vl(e,t,n,r){var o=t.current,a=el(),i=tl(o);return n=Wl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ba(a,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ua(o,t,i))&&(nl(e,o,i,a),Wa(e,o,i)),i}function Gl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ql(e,t){Hl(e,t),(e=e.alternate)&&Hl(e,t)}Sc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ro.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Ns(t),fa();break;case 5:$a(t);break;case 1:Oo(t.type)&&Lo(t);break;case 4:Qa(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Eo(Sa,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Eo(ei,1&ei.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ls(e,t,n):(Eo(ei,1&ei.current),null!==(e=Gs(e,t,n))?e.sibling:null);Eo(ei,1&ei.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return js(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Eo(ei,ei.current),r)break;return null;case 22:case 23:return t.lanes=0,Is(e,t,n)}return Gs(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,aa&&0!==(1048576&t.flags)&&ea(t,Ko,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vs(e,t),e=t.pendingProps;var o=Do(t,No.current);Ra(t,n),o=gi(null,t,r,e,o,n);var i=vi();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oo(r)?(i=!0,Lo(t)):i=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,La(t),o.updater=os,t.stateNode=o,o._reactInternals=t,cs(t,r,e,n),t=Ts(null,t,r,!0,i,n)):(t.tag=0,aa&&i&&ta(t),xs(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vs(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"===typeof e)return Dl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===_)return 14}return 2}(r),e=ns(r,e),o){case 0:t=As(null,t,r,e,n);break e;case 1:t=Es(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=ks(null,t,r,ns(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,As(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 1:return r=t.type,o=t.pendingProps,Es(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 3:e:{if(Ns(t),null===e)throw Error(a(387));r=t.pendingProps,o=(i=t.memoizedState).element,za(e,t),Va(t,r,null,n);var s=t.memoizedState;if(r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Rs(e,t,r,n,o=ls(Error(a(423)),t));break e}if(r!==o){t=Rs(e,t,r,n,o=ls(Error(a(424)),t));break e}for(oa=lo(t.stateNode.containerInfo.firstChild),ra=t,aa=!0,ia=null,n=ka(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===o){t=Gs(e,t,n);break e}xs(e,t,r,n)}t=t.child}return t;case 5:return $a(t),null===e&&ua(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,s=o.children,no(r,o)?s=null:null!==i&&no(r,i)&&(t.flags|=32),Cs(e,t),xs(e,t,s,n),t.child;case 6:return null===e&&ua(t),null;case 13:return Ls(e,t,n);case 4:return Qa(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wa(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,ws(e,t,r,o=t.elementType===r?o:ns(r,o),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,s=o.value,Eo(Sa,r._currentValue),r._currentValue=s,null!==i)if(sr(i.value,s)){if(i.children===o.children&&!Ro.current){t=Gs(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var c=i.dependencies;if(null!==c){s=i.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===i.tag){(l=Ba(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Na(i.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===i.tag)s=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(s=i.return))throw Error(a(341));s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Na(s,n,t),s=i.sibling}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===t){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}xs(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Ra(t,n),r=r(o=_a(o)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return o=ns(r=t.type,t.pendingProps),ks(e,t,r,o=ns(r.type,o),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:ns(r,o),Vs(e,t),t.tag=1,Oo(r)?(e=!0,Lo(t)):e=!1,Ra(t,n),is(t,r,o),cs(t,r,o,n),Ts(null,t,r,!0,e,n);case 19:return js(e,t,n);case 22:return Is(e,t,n)}throw Error(a(156,t.tag))};var Kl="function"===typeof reportError?reportError:function(e){console.error(e)};function Xl(e){this._internalRoot=e}function Yl(e){this._internalRoot=e}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $l(){}function Zl(e,t,n,r,o){var a=n._reactRootContainer;if(a){var i=a;if("function"===typeof o){var s=o;o=function(){var e=Gl(i);s.call(e)}}Vl(t,i,e,o)}else i=function(e,t,n,r,o){if(o){if("function"===typeof r){var a=r;r=function(){var e=Gl(i);a.call(e)}}var i=jl(t,r,e,0,null,!1,0,"",$l);return e._reactRootContainer=i,e[mo]=i.current,jr(8===e.nodeType?e.parentNode:e),ul(),i}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof r){var s=r;r=function(){var e=Gl(c);s.call(e)}}var c=Ul(e,0,!1,null,0,!1,0,"",$l);return e._reactRootContainer=c,e[mo]=c.current,jr(8===e.nodeType?e.parentNode:e),ul((function(){Vl(t,c,n,r)})),c}(n,t,e,o,r);return Gl(i)}Yl.prototype.render=Xl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Vl(e,t,null,null)},Yl.prototype.unmount=Xl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ul((function(){Vl(null,e,null,null)})),t[mo]=null}},Yl.prototype.unstable_scheduleHydration=function(e){if(e){var t=It();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rl(t,Je()),0===(6&Tc)&&(jc=Je()+500,Vo()))}break;case 13:ul((function(){var t=Ma(e,1);if(null!==t){var n=el();nl(t,e,1,n)}})),ql(e,1)}},kt=function(e){if(13===e.tag){var t=Ma(e,134217728);if(null!==t)nl(t,e,134217728,el());ql(e,134217728)}},St=function(e){if(13===e.tag){var t=tl(e),n=Ma(e,t);if(null!==n)nl(n,e,t,el());ql(e,t)}},It=function(){return bt},Ct=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=ko(r);if(!o)throw Error(a(90));K(r),$(r,o)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=ll,Ne=ul;var eu={usingClientEntryPoint:!1,Events:[xo,wo,ko,Ae,Ee,ll]},tu={findFiberByHostInstance:bo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{ot=ru.inject(nu),at=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ql(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Ql(e))throw Error(a(299));var n=!1,r="",o=Kl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Ul(e,1,!1,null,0,n,0,r,o),e[mo]=t.current,jr(8===e.nodeType?e.parentNode:e),new Xl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return ul(e)},t.hydrate=function(e,t,n){if(!Jl(t))throw Error(a(200));return Zl(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Ql(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,o=!1,i="",s=Kl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=jl(t,null,e,1,null!=n?n:null,o,0,i,s),e[mo]=t.current,jr(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Yl(t)},t.render=function(e,t,n){if(!Jl(t))throw Error(a(200));return Zl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jl(e))throw Error(a(40));return!!e._reactRootContainer&&(ul((function(){Zl(null,null,e,!1,(function(){e._reactRootContainer=null,e[mo]=null}))})),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jl(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Zl(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},2807:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M11 7 9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8z"}),"Login")},2954:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload")},3030:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(8168);function o(e,t){const n=(0,r.A)({},t);return Object.keys(e).forEach((a=>{if(a.toString().match(/^(components|slots)$/))n[a]=(0,r.A)({},e[a],n[a]);else if(a.toString().match(/^(componentsProps|slotProps)$/)){const i=e[a]||{},s=t[a];n[a]={},s&&Object.keys(s)?i&&Object.keys(i)?(n[a]=(0,r.A)({},s),Object.keys(i).forEach((e=>{n[a][e]=o(i[e],s[e])}))):n[a]=s:n[a]=i}else void 0===n[a]&&(n[a]=e[a])})),n}},3174:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalStyles:()=>k.A,StyledEngineProvider:()=>w,ThemeContext:()=>o.T,css:()=>v.AH,default:()=>S,internal_processStyles:()=>I,keyframes:()=>v.i7});var r=n(8168),o=n(9369),a=n(6598),i=n(9436),s=n(1722),c=n(5043),l=n(918),u=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,d=(0,l.A)((function(e){return u.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),h=function(e){return"theme"!==e},p=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?d:h},f=function(e,t,n){var r;if(t){var o=t.shouldForwardProp;r=e.__emotion_forwardProp&&o?function(t){return e.__emotion_forwardProp(t)&&o(t)}:o}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},m=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return(0,s.SF)(t,n,r),(0,i.s)((function(){return(0,s.sk)(t,n,r)})),null},g=function e(t,n){var i,l,u=t.__emotion_real===t,d=u&&t.__emotion_base||t;void 0!==n&&(i=n.label,l=n.target);var h=f(t,n,u),g=h||p(d),v=!g("as");return function(){var y=arguments,b=u&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&b.push("label:"+i+";"),null==y[0]||void 0===y[0].raw)b.push.apply(b,y);else{var x=y[0];b.push(x[0]);for(var w=y.length,k=1;k<w;k++)b.push(y[k],x[k])}var S=(0,o.w)((function(e,t,n){var r=v&&e.as||d,i="",u=[],f=e;if(null==e.theme){for(var y in f={},e)f[y]=e[y];f.theme=c.useContext(o.T)}"string"===typeof e.className?i=(0,s.Rk)(t.registered,u,e.className):null!=e.className&&(i=e.className+" ");var x=(0,a.J)(b.concat(u),t.registered,f);i+=t.key+"-"+x.name,void 0!==l&&(i+=" "+l);var w=v&&void 0===h?p(r):g,k={};for(var S in e)v&&"as"===S||w(S)&&(k[S]=e[S]);return k.className=i,n&&(k.ref=n),c.createElement(c.Fragment,null,c.createElement(m,{cache:t,serialized:x,isStringTag:"string"===typeof r}),c.createElement(r,k))}));return S.displayName=void 0!==i?i:"Styled("+("string"===typeof d?d:d.displayName||d.name||"Component")+")",S.defaultProps=t.defaultProps,S.__emotion_real=S,S.__emotion_base=d,S.__emotion_styles=b,S.__emotion_forwardProp=h,Object.defineProperty(S,"toString",{value:function(){return"."+l}}),S.withComponent=function(t,o){return e(t,(0,r.A)({},n,o,{shouldForwardProp:f(S,o,!0)})).apply(void 0,b)},S}}.bind(null);["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){g[e]=g(e)}));var v=n(3290),y=n(3803),b=n(579);let x;function w(e){const{injectFirst:t,children:n}=e;return t&&x?(0,b.jsx)(o.C,{value:x,children:n}):n}"object"===typeof document&&(x=(0,y.A)({key:"css",prepend:!0}));var k=n(869);function S(e,t){return g(e,t)}const I=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}},3234:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A,extendSxProp:()=>o.A,unstable_createStyleFunctionSx:()=>r.k,unstable_defaultSxConfig:()=>a.A});var r=n(8812),o=n(8698),a=n(7758)},3290:(e,t,n)=>{"use strict";n.d(t,{AH:()=>u,i7:()=>d,mL:()=>l});var r=n(9369),o=n(5043),a=n(1722),i=n(9436),s=n(6598),c=(n(3803),n(219),function(e,t){var n=arguments;if(null==t||!r.h.call(t,"css"))return o.createElement.apply(void 0,n);var a=n.length,i=new Array(a);i[0]=r.E,i[1]=(0,r.c)(e,t);for(var s=2;s<a;s++)i[s]=n[s];return o.createElement.apply(null,i)});!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(c||(c={}));var l=(0,r.w)((function(e,t){var n=e.styles,c=(0,s.J)([n],void 0,o.useContext(r.T)),l=o.useRef();return(0,i.i)((function(){var e=t.key+"-global",n=new t.sheet.constructor({key:e,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),r=!1,o=document.querySelector('style[data-emotion="'+e+" "+c.name+'"]');return t.sheet.tags.length&&(n.before=t.sheet.tags[0]),null!==o&&(r=!0,o.setAttribute("data-emotion",e),n.hydrate([o])),l.current=[n,r],function(){n.flush()}}),[t]),(0,i.i)((function(){var e=l.current,n=e[0];if(e[1])e[1]=!1;else{if(void 0!==c.next&&(0,a.sk)(t,c.next,!0),n.tags.length){var r=n.tags[n.tags.length-1].nextElementSibling;n.before=r,n.flush()}t.insert("",c,n,!1)}}),[t,c.name]),null}));function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.J)(t)}function d(){var e=u.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}},3319:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=n(1782).A},3375:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r="$$material"},3382:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c,getFunctionName:()=>a});var r=n(528);const o=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function a(e){const t="".concat(e).match(o);return t&&t[1]||""}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.displayName||e.name||a(e)||t}function s(e,t,n){const r=i(t);return e.displayName||(""!==r?"".concat(n,"(").concat(r,")"):n)}function c(e){if(null!=e){if("string"===typeof e)return e;if("function"===typeof e)return i(e,"Component");if("object"===typeof e)switch(e.$$typeof){case r.vM:return s(e,e.render,"ForwardRef");case r.lD:return s(e,e.type,"memo");default:return}}}},3462:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(5043),o=n(6564);function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.useMemo((()=>t.every((e=>null==e))?null:e=>{t.forEach((t=>{(0,o.A)(t,e)}))}),t)}},3468:(e,t,n)=>{"use strict";function r(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];clearTimeout(t),t=setTimeout((()=>{e.apply(this,o)}),n)}return r.clear=()=>{clearTimeout(t)},r}n.d(t,{A:()=>r})},3574:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r=n(5043),o=n(9303);let a=!0,i=!1;const s=new o.E,c={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function l(e){e.metaKey||e.altKey||e.ctrlKey||(a=!0)}function u(){a=!1}function d(){"hidden"===this.visibilityState&&i&&(a=!0)}function h(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch(n){}return a||function(e){const{type:t,tagName:n}=e;return!("INPUT"!==n||!c[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}const p=function(){const e=r.useCallback((e=>{var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",l,!0),t.addEventListener("mousedown",u,!0),t.addEventListener("pointerdown",u,!0),t.addEventListener("touchstart",u,!0),t.addEventListener("visibilitychange",d,!0))}),[]),t=r.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!h(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(i=!0,s.start(100,(()=>{i=!1})),t.current=!1,!0)},ref:e}}},3639:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home")},3654:(e,t,n)=>{"use strict";n.d(t,{A:()=>c,b:()=>s});var r=n(5043),o=n(3030),a=n(579);const i=r.createContext(void 0);function s(e){let{props:t,name:n}=e;return function(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const a=t.components[n];return a.defaultProps?(0,o.A)(a.defaultProps,r):a.styleOverrides||a.variants?r:(0,o.A)(a,r)}({props:t,name:n,theme:{components:r.useContext(i)}})}const c=function(e){let{value:t,children:n}=e;return(0,a.jsx)(i.Provider,{value:t,children:n})}},3656:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M12 22c4.97 0 9-4.03 9-9-4.97 0-9 4.03-9 9M5.6 10.25c0 1.38 1.12 2.5 2.5 2.5.53 0 1.01-.16 1.42-.44l-.02.19c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5l-.02-.19c.4.28.89.44 1.42.44 1.38 0 2.5-1.12 2.5-2.5 0-1-.59-1.85-1.43-2.25.84-.4 1.43-1.25 1.43-2.25 0-1.38-1.12-2.5-2.5-2.5-.53 0-1.01.16-1.42.44l.02-.19C14.5 2.12 13.38 1 12 1S9.5 2.12 9.5 3.5l.02.19c-.4-.28-.89-.44-1.42-.44-1.38 0-2.5 1.12-2.5 2.5 0 1 .59 1.85 1.43 2.25-.84.4-1.43 1.25-1.43 2.25M12 5.5c1.38 0 2.5 1.12 2.5 2.5s-1.12 2.5-2.5 2.5S9.5 9.38 9.5 8s1.12-2.5 2.5-2.5M3 13c0 4.97 4.03 9 9 9 0-4.97-4.03-9-9-9"}),"LocalFlorist")},3763:(e,t,n)=>{"use strict";e.exports=n(4983)},3803:(e,t,n)=>{"use strict";n.d(t,{A:()=>oe});var r=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),o=Math.abs,a=String.fromCharCode,i=Object.assign;function s(e){return e.trim()}function c(e,t,n){return e.replace(t,n)}function l(e,t){return e.indexOf(t)}function u(e,t){return 0|e.charCodeAt(t)}function d(e,t,n){return e.slice(t,n)}function h(e){return e.length}function p(e){return e.length}function f(e,t){return t.push(e),e}var m=1,g=1,v=0,y=0,b=0,x="";function w(e,t,n,r,o,a,i){return{value:e,root:t,parent:n,type:r,props:o,children:a,line:m,column:g,length:i,return:""}}function k(e,t){return i(w("",null,null,"",null,null,0),e,{length:-e.length},t)}function S(){return b=y>0?u(x,--y):0,g--,10===b&&(g=1,m--),b}function I(){return b=y<v?u(x,y++):0,g++,10===b&&(g=1,m++),b}function C(){return u(x,y)}function A(){return y}function E(e,t){return d(x,e,t)}function T(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function N(e){return m=g=1,v=h(x=e),y=0,[]}function R(e){return x="",e}function _(e){return s(E(y-1,F(91===e?e+2:40===e?e+1:e)))}function D(e){for(;(b=C())&&b<33;)I();return T(e)>2||T(b)>3?"":" "}function O(e,t){for(;--t&&I()&&!(b<48||b>102||b>57&&b<65||b>70&&b<97););return E(e,A()+(t<6&&32==C()&&32==I()))}function F(e){for(;I();)switch(b){case e:return y;case 34:case 39:34!==e&&39!==e&&F(b);break;case 40:41===e&&F(e);break;case 92:I()}return y}function M(e,t){for(;I()&&e+b!==57&&(e+b!==84||47!==C()););return"/*"+E(t,y-1)+"*"+a(47===e?e:I())}function P(e){for(;!T(C());)I();return E(e,y)}var L="-ms-",z="-moz-",B="-webkit-",U="comm",W="rule",j="decl",V="@keyframes";function G(e,t){for(var n="",r=p(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function H(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case j:return e.return=e.return||e.value;case U:return"";case V:return e.return=e.value+"{"+G(e.children,r)+"}";case W:e.value=e.props.join(",")}return h(n=G(e.children,r))?e.return=e.value+"{"+n+"}":""}function q(e){return R(K("",null,null,null,[""],e=N(e),0,[0],e))}function K(e,t,n,r,o,i,s,d,p){for(var m=0,g=0,v=s,y=0,b=0,x=0,w=1,k=1,E=1,T=0,N="",R=o,F=i,L=r,z=N;k;)switch(x=T,T=I()){case 40:if(108!=x&&58==u(z,v-1)){-1!=l(z+=c(_(T),"&","&\f"),"&\f")&&(E=-1);break}case 34:case 39:case 91:z+=_(T);break;case 9:case 10:case 13:case 32:z+=D(x);break;case 92:z+=O(A()-1,7);continue;case 47:switch(C()){case 42:case 47:f(Y(M(I(),A()),t,n),p);break;default:z+="/"}break;case 123*w:d[m++]=h(z)*E;case 125*w:case 59:case 0:switch(T){case 0:case 125:k=0;case 59+g:-1==E&&(z=c(z,/\f/g,"")),b>0&&h(z)-v&&f(b>32?Q(z+";",r,n,v-1):Q(c(z," ","")+";",r,n,v-2),p);break;case 59:z+=";";default:if(f(L=X(z,t,n,m,g,o,d,N,R=[],F=[],v),i),123===T)if(0===g)K(z,t,L,L,R,i,v,d,F);else switch(99===y&&110===u(z,3)?100:y){case 100:case 108:case 109:case 115:K(e,L,L,r&&f(X(e,L,L,0,0,o,d,N,o,R=[],v),F),o,F,v,d,r?R:F);break;default:K(z,L,L,L,[""],F,0,d,F)}}m=g=b=0,w=E=1,N=z="",v=s;break;case 58:v=1+h(z),b=x;default:if(w<1)if(123==T)--w;else if(125==T&&0==w++&&125==S())continue;switch(z+=a(T),T*w){case 38:E=g>0?1:(z+="\f",-1);break;case 44:d[m++]=(h(z)-1)*E,E=1;break;case 64:45===C()&&(z+=_(I())),y=C(),g=v=h(N=z+=P(A())),T++;break;case 45:45===x&&2==h(z)&&(w=0)}}return i}function X(e,t,n,r,a,i,l,u,h,f,m){for(var g=a-1,v=0===a?i:[""],y=p(v),b=0,x=0,k=0;b<r;++b)for(var S=0,I=d(e,g+1,g=o(x=l[b])),C=e;S<y;++S)(C=s(x>0?v[S]+" "+I:c(I,/&\f/g,v[S])))&&(h[k++]=C);return w(e,t,n,0===a?W:u,h,f,m)}function Y(e,t,n){return w(e,t,n,U,a(b),d(e,2,-2),0)}function Q(e,t,n,r){return w(e,t,n,j,d(e,0,r),d(e,r+1,-1),r)}var J=function(e,t,n){for(var r=0,o=0;r=o,o=C(),38===r&&12===o&&(t[n]=1),!T(o);)I();return E(e,y)},$=function(e,t){return R(function(e,t){var n=-1,r=44;do{switch(T(r)){case 0:38===r&&12===C()&&(t[n]=1),e[n]+=J(y-1,t,n);break;case 2:e[n]+=_(r);break;case 4:if(44===r){e[++n]=58===C()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=a(r)}}while(r=I());return e}(N(e),t))},Z=new WeakMap,ee=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Z.get(n))&&!r){Z.set(e,!0);for(var o=[],a=$(t,o),i=n.props,s=0,c=0;s<a.length;s++)for(var l=0;l<i.length;l++,c++)e.props[c]=o[s]?a[s].replace(/&\f/g,i[l]):i[l]+" "+a[s]}}},te=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function ne(e,t){switch(function(e,t){return 45^u(e,0)?(((t<<2^u(e,0))<<2^u(e,1))<<2^u(e,2))<<2^u(e,3):0}(e,t)){case 5103:return B+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return B+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return B+e+z+e+L+e+e;case 6828:case 4268:return B+e+L+e+e;case 6165:return B+e+L+"flex-"+e+e;case 5187:return B+e+c(e,/(\w+).+(:[^]+)/,B+"box-$1$2"+L+"flex-$1$2")+e;case 5443:return B+e+L+"flex-item-"+c(e,/flex-|-self/,"")+e;case 4675:return B+e+L+"flex-line-pack"+c(e,/align-content|flex-|-self/,"")+e;case 5548:return B+e+L+c(e,"shrink","negative")+e;case 5292:return B+e+L+c(e,"basis","preferred-size")+e;case 6060:return B+"box-"+c(e,"-grow","")+B+e+L+c(e,"grow","positive")+e;case 4554:return B+c(e,/([^-])(transform)/g,"$1"+B+"$2")+e;case 6187:return c(c(c(e,/(zoom-|grab)/,B+"$1"),/(image-set)/,B+"$1"),e,"")+e;case 5495:case 3959:return c(e,/(image-set\([^]*)/,B+"$1$`$1");case 4968:return c(c(e,/(.+:)(flex-)?(.*)/,B+"box-pack:$3"+L+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+B+e+e;case 4095:case 3583:case 4068:case 2532:return c(e,/(.+)-inline(.+)/,B+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(h(e)-1-t>6)switch(u(e,t+1)){case 109:if(45!==u(e,t+4))break;case 102:return c(e,/(.+:)(.+)-([^]+)/,"$1"+B+"$2-$3$1"+z+(108==u(e,t+3)?"$3":"$2-$3"))+e;case 115:return~l(e,"stretch")?ne(c(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==u(e,t+1))break;case 6444:switch(u(e,h(e)-3-(~l(e,"!important")&&10))){case 107:return c(e,":",":"+B)+e;case 101:return c(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+B+(45===u(e,14)?"inline-":"")+"box$3$1"+B+"$2$3$1"+L+"$2box$3")+e}break;case 5936:switch(u(e,t+11)){case 114:return B+e+L+c(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return B+e+L+c(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return B+e+L+c(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return B+e+L+e+e}return e}var re=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case j:e.return=ne(e.value,e.length);break;case V:return G([k(e,{value:c(e.value,"@","@"+B)})],r);case W:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return G([k(e,{props:[c(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return G([k(e,{props:[c(t,/:(plac\w+)/,":"+B+"input-$1")]}),k(e,{props:[c(t,/:(plac\w+)/,":-moz-$1")]}),k(e,{props:[c(t,/:(plac\w+)/,L+"input-$1")]})],r)}return""}))}}],oe=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var o,a,i=e.stylisPlugins||re,s={},c=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;c.push(e)}));var l,u,d=[H,(u=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&u(e)})],h=function(e){var t=p(e);return function(n,r,o,a){for(var i="",s=0;s<t;s++)i+=e[s](n,r,o,a)||"";return i}}([ee,te].concat(i,d));a=function(e,t,n,r){l=n,G(q(e?e+"{"+t.styles+"}":t.styles),h),r&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new r({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:a};return f.sheet.hydrate(c),f}},3815:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(9172);const o=function(e,t){return t?(0,r.A)(e,t,{clone:!1}):e}},3940:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(1668);function o(e){return(0,r.A)(e).defaultView||window}},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,m(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var o,a={},i=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)k.call(t,o)&&!I.hasOwnProperty(o)&&(a[o]=t[o]);var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===a[o]&&(a[o]=c[o]);return{$$typeof:n,type:e,key:i,ref:s,props:a,_owner:S.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,o,a,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return i=i(c=e),e=""===a?"."+T(c,0):a,w(i)?(o="",null!=e&&(o=e.replace(E,"$&/")+"/"),N(i,t,o,"",(function(e){return e}))):null!=i&&(A(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,o+(!i.key||c&&c.key===i.key?"":(""+i.key).replace(E,"$&/")+"/")+e)),t.push(i)),1;if(c=0,a=""===a?".":a+":",w(e))for(var l=0;l<e.length;l++){var u=a+T(s=e[l],l);c+=N(s,t,o,u,i)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(s=e.next()).done;)c+=N(s=s.value,t,o,u=a+T(s,l++),i);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function R(e,t,n){if(null==e)return e;var r=[],o=0;return N(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function _(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},O={transition:null},F={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=o,t.Profiler=i,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=m({},e.props),a=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)k.call(t,l)&&!I.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}return{$$typeof:n,type:e.type,key:a,ref:i,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:_}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},4327:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"}),"Image")},4334:(e,t,n)=>{var r=n(7359),o=n(7066),a=n(9016),i=n(9538),s=n(6288),c=n(5262),l=n(2430);l.alea=r,l.xor128=o,l.xorwow=a,l.xorshift7=i,l.xor4096=s,l.tychei=c,e.exports=l},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4421:(e,t,n)=>{"use strict";n.r(t),n.d(t,{capitalize:()=>o.A,createChainedFunction:()=>a,createSvgIcon:()=>i.A,debounce:()=>s.A,deprecatedPropType:()=>c,isMuiElement:()=>l.A,ownerDocument:()=>u.A,ownerWindow:()=>d.A,requirePropFactory:()=>h,setRef:()=>p,unstable_ClassNameGenerator:()=>w,unstable_useEnhancedEffect:()=>f.A,unstable_useId:()=>m.A,unsupportedProp:()=>g,useControlled:()=>v.A,useEventCallback:()=>y.A,useForkRef:()=>b.A,useIsFocusVisible:()=>x.A});var r=n(9386),o=n(6803);const a=n(2456).A;var i=n(9662),s=n(950);const c=function(e,t){return()=>null};var l=n(7328),u=n(2427),d=n(6078);const h=function(e,t){return()=>null};const p=n(6564).A;var f=n(5013),m=n(5879);const g=function(e,t,n,r,o){return null};var v=n(5420),y=n(3319),b=n(5849),x=n(3574);const w={configure:e=>{r.A.configure(e)}}},4440:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(5043);const o="undefined"!==typeof window?r.useLayoutEffect:r.useEffect},4530:()=>{},4535:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>s});var r=n(8052),o=n(5170),a=n(3375),i=n(1475);const s=(0,r.Ay)({themeId:a.A,defaultTheme:o.A,rootShouldForwardProp:i.A})},4545:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)([(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3.2"},"0"),(0,a.jsx)("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"PhotoCamera")},4634:e=>{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4802:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},4853:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(8587),o=n(8168);const a=["values","unit","step"],i=e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>(0,o.A)({},e,{[t.key]:t.val})),{})};function s(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:s=5}=e,c=(0,r.A)(e,a),l=i(t),u=Object.keys(l);function d(e){const r="number"===typeof t[e]?t[e]:e;return"@media (min-width:".concat(r).concat(n,")")}function h(e){const r="number"===typeof t[e]?t[e]:e;return"@media (max-width:".concat(r-s/100).concat(n,")")}function p(e,r){const o=u.indexOf(r);return"@media (min-width:".concat("number"===typeof t[e]?t[e]:e).concat(n,") and ")+"(max-width:".concat((-1!==o&&"number"===typeof t[u[o]]?t[u[o]]:r)-s/100).concat(n,")")}return(0,o.A)({keys:u,values:l,up:d,down:h,between:p,only:function(e){return u.indexOf(e)+1<u.length?p(e,u[u.indexOf(e)+1]):d(e)},not:function(e){const t=u.indexOf(e);return 0===t?d(u[1]):t===u.length-1?h(u[t]):p(e,u[u.indexOf(e)+1]).replace("@media","@media not all and")},unit:n},c)}},4893:e=>{e.exports=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n},e.exports.__esModule=!0,e.exports.default=e.exports},4983:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,i=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case d:case a:case s:case i:case p:return e;default:switch(e=e&&e.$$typeof){case l:case h:case g:case m:case c:return e;default:return t}}case o:return t}}}function k(e){return w(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=l,t.ContextProvider=c,t.Element=r,t.ForwardRef=h,t.Fragment=a,t.Lazy=g,t.Memo=m,t.Portal=o,t.Profiler=s,t.StrictMode=i,t.Suspense=p,t.isAsyncMode=function(e){return k(e)||w(e)===u},t.isConcurrentMode=k,t.isContextConsumer=function(e){return w(e)===l},t.isContextProvider=function(e){return w(e)===c},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===h},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===g},t.isMemo=function(e){return w(e)===m},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===i},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===d||e===s||e===i||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===c||e.$$typeof===l||e.$$typeof===h||e.$$typeof===y||e.$$typeof===b||e.$$typeof===x||e.$$typeof===v)},t.typeOf=w},4989:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A,private_createBreakpoints:()=>o.A,unstable_applyStyles:()=>a.A});var r=n(8280),o=n(4853),a=n(9703)},4994:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},5013:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=n(4440).A},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5170:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(8279).A)()},5194:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M20 8h-2.81c-.45-.78-1.07-1.45-1.82-1.96L17 4.41 15.59 3l-2.17 2.17C12.96 5.06 12.49 5 12 5c-.49 0-.96.06-1.41.17L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20zm-6 8h-4v-2h4zm0-4h-4v-2h4z"}),"BugReport")},5262:function(e,t,n){var r;!function(e,o){function a(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.tychei=s}(0,e=n.nmd(e),n.amdD)},5420:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(5043);const o=function(e){let{controlled:t,default:n,name:o,state:a="value"}=e;const{current:i}=r.useRef(void 0!==t),[s,c]=r.useState(n);return[i?t:s,r.useCallback((e=>{i||c(e)}),[])]}},5817:()=>{},5844:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>s});var o=n(5043);let a=0;const i=(r||(r=n.t(o,2)))["useId".toString()];function s(e){if(void 0!==i){const t=i();return null!=e?e:t}return function(e){const[t,n]=o.useState(e),r=e||t;return o.useEffect((()=>{null==t&&(a+=1,n("mui-".concat(a)))}),[t]),r}(e)}},5849:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=n(3462).A},5879:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=n(5844).A},5940:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"m17.73 12.02 3.98-3.98c.39-.39.39-1.02 0-1.41l-4.34-4.34a.9959.9959 0 0 0-1.41 0l-3.98 3.98L8 2.29C7.8 2.1 7.55 2 7.29 2c-.25 0-.51.1-.7.29L2.25 6.63c-.39.39-.39 1.02 0 1.41l3.98 3.98L2.25 16c-.39.39-.39 1.02 0 1.41l4.34 4.34c.39.39 1.02.39 1.41 0l3.98-3.98 3.98 3.98c.2.2.45.29.71.29.26 0 .51-.1.71-.29l4.34-4.34c.39-.39.39-1.02 0-1.41zM12 9c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m-4.71 1.96L3.66 7.34l3.63-3.63 3.62 3.62zM10 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m2 2c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m2-4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m2.66 9.34-3.63-3.62 3.63-3.63 3.62 3.62z"}),"Healing")},6078:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=n(3940).A},6288:function(e,t,n){var r;!function(e,o){function a(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,a=t.i;return t.w=r=r+1640531527|0,n=o[a+34&127],e=o[a=a+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[a]=n^e,t.i=a,n+(r^r>>>16)|0},function(e,t){var n,r,o,a,i,s=[],c=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,c=Math.max(c,t.length)),o=0,a=-32;a<c;++a)t&&(r^=t.charCodeAt((a+32)%t.length)),0===a&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=i+1640531527|0,o=0==(n=s[127&a]^=r+i)?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,a=512;a>0;--a)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;e.w=i,e.X=s,e.i=o}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.X&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xor4096=s}(0,e=n.nmd(e),n.amdD)},6300:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School")},6564:(e,t,n)=>{"use strict";function r(e,t){"function"===typeof e?e(t):e&&(e.current=t)}n.d(t,{A:()=>r})},6598:(e,t,n)=>{"use strict";n.d(t,{J:()=>g});var r={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},o=n(918),a=!1,i=/[A-Z]|^ms/g,s=/_EMO_([^_]+?)_([^]*?)_EMO_/g,c=function(e){return 45===e.charCodeAt(1)},l=function(e){return null!=e&&"boolean"!==typeof e},u=(0,o.A)((function(e){return c(e)?e:e.replace(i,"-$&").toLowerCase()})),d=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(s,(function(e,t,n){return f={name:t,styles:n,next:f},t}))}return 1===r[e]||c(e)||"number"!==typeof t||0===t?t:t+"px"},h="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function p(e,t,n){if(null==n)return"";var r=n;if(void 0!==r.__emotion_styles)return r;switch(typeof n){case"boolean":return"";case"object":var o=n;if(1===o.anim)return f={name:o.name,styles:o.styles,next:f},o.name;var i=n;if(void 0!==i.styles){var s=i.next;if(void 0!==s)for(;void 0!==s;)f={name:s.name,styles:s.styles,next:f},s=s.next;return i.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=p(e,t,n[o])+";";else for(var i in n){var s=n[i];if("object"!==typeof s){var c=s;null!=t&&void 0!==t[c]?r+=i+"{"+t[c]+"}":l(c)&&(r+=u(i)+":"+d(i,c)+";")}else{if("NO_COMPONENT_SELECTOR"===i&&a)throw new Error(h);if(!Array.isArray(s)||"string"!==typeof s[0]||null!=t&&void 0!==t[s[0]]){var f=p(e,t,s);switch(i){case"animation":case"animationName":r+=u(i)+":"+f+";";break;default:r+=i+"{"+f+"}"}}else for(var m=0;m<s.length;m++)l(s[m])&&(r+=u(i)+":"+d(i,s[m])+";")}}return r}(e,t,n);case"function":if(void 0!==e){var c=f,m=n(e);return f=c,p(e,t,m)}}var g=n;if(null==t)return g;var v=t[g];return void 0!==v?v:g}var f,m=/label:\s*([^\s;{]+)\s*(;|$)/g;function g(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,o="";f=void 0;var a=e[0];null==a||void 0===a.raw?(r=!1,o+=p(n,t,a)):o+=a[0];for(var i=1;i<e.length;i++){if(o+=p(n,t,e[i]),r)o+=a[i]}m.lastIndex=0;for(var s,c="";null!==(s=m.exec(o));)c+="-"+s[1];var l=function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(o)+c;return{name:l,styles:o,next:f}}},6803:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=n(7598).A},6893:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"Group")},6940:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)([(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3.2"},"0"),(0,a.jsx)("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt")},7029:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,n){"use strict";n.r(t);var r=n("react"),o=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)},i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function s(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise((function(n,r){t.call(navigator,e,n,r)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var c=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return o(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;this.unmounted=!1,s()?(e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")):t.onUserMediaError("getUserMedia not supported")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(s()){var n=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),o=e.minScreenshotWidth!==t.minScreenshotWidth,a=e.minScreenshotHeight!==t.minScreenshotHeight;(r||o||a)&&(this.canvas=null,this.ctx=null),(n||r)&&(this.stopAndCleanup(),this.requestUserMedia())}else t.onUserMediaError("getUserMedia not supported")},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map((function(t){e.removeTrack(t),t.stop()})),e.getAudioTracks().map((function(t){e.removeTrack(t),t.stop()}))):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,n=this.props;if(!t.hasUserMedia)return null;var r=this.getCanvas(e);return r&&r.toDataURL(n.screenshotFormat,n.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,n=this.props;if(!this.video)return null;if(!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var r=this.video.videoWidth,o=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var a=r/o;o=(r=n.minScreenshotWidth||this.video.clientWidth)/a,n.minScreenshotHeight&&o<n.minScreenshotHeight&&(r=(o=n.minScreenshotHeight)*a)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===e||void 0===e?void 0:e.width)||r,this.canvas.height=(null===e||void 0===e?void 0:e.height)||o,this.ctx=this.canvas.getContext("2d")}var i=this.ctx,s=this.canvas;return i&&s&&(s.width=(null===e||void 0===e?void 0:e.width)||s.width,s.height=(null===e||void 0===e?void 0:e.height)||s.height,n.mirrored&&(i.translate(s.width,0),i.scale(-1,1)),i.imageSmoothingEnabled=n.imageSmoothing,i.drawImage(this.video,0,0,(null===e||void 0===e?void 0:e.width)||s.width,(null===e||void 0===e?void 0:e.height)||s.height),n.mirrored&&(i.scale(-1,1),i.translate(-s.width,0))),s},t.prototype.requestUserMedia=function(){var e=this,n=this.props,r=function(r,o){var a={video:"undefined"===typeof o||o};n.audio&&(a.audio="undefined"===typeof r||r),e.requestUserMediaId++;var i=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(a).then((function(n){e.unmounted||i!==e.requestUserMediaId?t.stopMediaStream(n):e.handleUserMedia(null,n)})).catch((function(t){e.handleUserMedia(t)}))};if("mediaDevices"in navigator)r(n.audioConstraints,n.videoConstraints);else{var o=function(e){return{optional:[{sourceId:e}]}},a=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources((function(e){var t=null,i=null;e.forEach((function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(i=e.id)}));var s=a(n.audioConstraints);s&&(t=s);var c=a(n.videoConstraints);c&&(i=c),r(o(t),o(i))}))}},t.prototype.handleUserMedia=function(e,t){var n=this.props;if(e||!t)return this.setState({hasUserMedia:!1}),void n.onUserMediaError(e);this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(r){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}n.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,n=this.props,o=n.audio,s=(n.forceScreenshotSourceSize,n.disablePictureInPicture),c=(n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),l=n.style,u=void 0===l?{}:l,d=n.children,h=i(n,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),p=c?a(a({},u),{transform:(u.transform||"")+" scaleX(-1)"}):u,f={getScreenshot:this.getScreenshot.bind(this)};return r.createElement(r.Fragment,null,r.createElement("video",a({autoPlay:!0,disablePictureInPicture:s,src:t.src,muted:!o,playsInline:!0,ref:function(t){e.video=t},style:p},h)),d&&d(f))},t.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(r.Component);t.default=c},react:function(t,n){t.exports=e}}).default},e.exports=r(n(5043))},7066:function(e,t,n){var r;!function(e,o){function a(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xor128=s}(0,e=n.nmd(e),n.amdD)},7123:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}},7162:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>s,BO:()=>i,Yn:()=>a});var r=n(7598),o=n(9751);function a(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){const n="vars.".concat(t).split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=n)return n}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function i(e,t,n){let r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||o:a(e,n)||o,t&&(r=t(r,o,e)),r}const s=function(e){const{prop:t,cssProperty:n=e.prop,themeKey:s,transform:c}=e,l=e=>{if(null==e[t])return null;const l=e[t],u=a(e.theme,s)||{};return(0,o.NI)(e,l,(e=>{let o=i(u,c,e);return e===o&&"string"===typeof e&&(o=i(u,c,"".concat(t).concat("default"===e?"":(0,r.A)(e)),e)),!1===n?o:{[n]:o}}))};return l.propTypes={},l.filterProps=[t],l}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<a(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,i=o>>>1;r<i;){var s=2*(r+1)-1,c=e[s],l=s+1,u=e[l];if(0>a(c,n))l<o&&0>a(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[s]=n,r=s);else{if(!(l<o&&0>a(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(l,t)}t=r(u)}}function w(e){if(g=!1,x(e),!m)if(null!==r(l))m=!0,O(k);else{var t=r(u);null!==t&&F(w,t.startTime-e)}}function k(e,n){m=!1,g&&(g=!1,y(A),A=-1),f=!0;var a=p;try{for(x(n),h=r(l);null!==h&&(!(h.expirationTime>n)||e&&!N());){var i=h.callback;if("function"===typeof i){h.callback=null,p=h.priorityLevel;var s=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(l)&&o(l),x(n)}else o(l);h=r(l)}if(null!==h)var c=!0;else{var d=r(u);null!==d&&F(w,d.startTime-n),c=!1}return c}finally{h=null,p=a,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,I=!1,C=null,A=-1,E=5,T=-1;function N(){return!(t.unstable_now()-T<E)}function R(){if(null!==C){var e=t.unstable_now();T=e;var n=!0;try{n=C(!0,e)}finally{n?S():(I=!1,C=null)}}else I=!1}if("function"===typeof b)S=function(){b(R)};else if("undefined"!==typeof MessageChannel){var _=new MessageChannel,D=_.port2;_.port1.onmessage=R,S=function(){D.postMessage(null)}}else S=function(){v(R,0)};function O(e){C=e,I||(I=!0,S())}function F(e,n){A=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,O(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,o,a){var i=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>i?(e.sortIndex=a,n(u,e),null===r(l)&&e===r(u)&&(g?(y(A),A=-1):g=!0,F(w,a-i))):(e.sortIndex=s,n(l,e),m||f||(m=!0,O(k))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},7266:(e,t,n)=>{"use strict";var r=n(4994);t.X4=p,t.e$=f,t.tL=g,t.eM=function(e,t){const n=h(e),r=h(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},t.a=m;var o=r(n(457)),a=r(n(9214));function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,a.default)(e,t,n)}function s(e){e=e.slice(1);const t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g");let n=e.match(t);return n&&1===n[0].length&&(n=n.map((e=>e+e))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", "),")"):""}function c(e){if(e.type)return e;if("#"===e.charAt(0))return c(s(e));const t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error((0,o.default)(9,e));let r,a=e.substring(t+1,e.length-1);if("color"===n){if(a=a.split(" "),r=a.shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error((0,o.default)(10,r))}else a=a.split(",");return a=a.map((e=>parseFloat(e))),{type:n,values:a,colorSpace:r}}const l=e=>{const t=c(e);return t.values.slice(0,3).map(((e,n)=>-1!==t.type.indexOf("hsl")&&0!==n?"".concat(e,"%"):e)).join(" ")};function u(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return-1!==t.indexOf("rgb")?r=r.map(((e,t)=>t<3?parseInt(e,10):e)):-1!==t.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=-1!==t.indexOf("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(t,"(").concat(r,")")}function d(e){e=c(e);const{values:t}=e,n=t[0],r=t[1]/100,o=t[2]/100,a=r*Math.min(o,1-o),i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return o-a*Math.max(Math.min(t-3,9-t,1),-1)};let s="rgb";const l=[Math.round(255*i(0)),Math.round(255*i(8)),Math.round(255*i(4))];return"hsla"===e.type&&(s+="a",l.push(t[3])),u({type:s,values:l})}function h(e){let t="hsl"===(e=c(e)).type||"hsla"===e.type?c(d(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function p(e,t){return e=c(e),t=i(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,u(e)}function f(e,t){if(e=c(e),t=i(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return u(e)}function m(e,t){if(e=c(e),t=i(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return u(e)}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return h(e)>.5?f(e,t):m(e,t)}},7328:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(5043);const o=function(e,t){var n,o;return r.isValidElement(e)&&-1!==t.indexOf(null!=(n=e.type.muiName)?n:null==(o=e.type)||null==(o=o._payload)||null==(o=o.value)?void 0:o.muiName)}},7353:e=>{e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(C){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var o={},a={};function i(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=a[e])?r:(n=c(e,(0|e)<0?-1:0,!0),i&&(a[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=o[e])?r:(n=c(e,e<0?-1:0,!1),i&&(o[e]=n),n)}function s(e,t){if(isNaN(e))return t?v:g;if(t){if(e<0)return v;if(e>=p)return k}else{if(e<=-f)return S;if(e+1>=f)return w}return e<0?s(-e,t).neg():c(e%h|0,e/h|0,t)}function c(e,t,r){return new n(e,t,r)}n.fromInt=i,n.fromNumber=s,n.fromBits=c;var l=Math.pow;function u(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(e.substring(1),t,n).neg();for(var o=s(l(n,8)),a=g,i=0;i<e.length;i+=8){var c=Math.min(8,e.length-i),d=parseInt(e.substring(i,i+c),n);if(c<8){var h=s(l(n,c));a=a.mul(h).add(s(d))}else a=(a=a.mul(o)).add(s(d))}return a.unsigned=t,a}function d(e,t){return"number"===typeof e?s(e,t):"string"===typeof e?u(e,t):c(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=u,n.fromValue=d;var h=4294967296,p=h*h,f=p/2,m=i(1<<24),g=i(0);n.ZERO=g;var v=i(0,!0);n.UZERO=v;var y=i(1);n.ONE=y;var b=i(1,!0);n.UONE=b;var x=i(-1);n.NEG_ONE=x;var w=c(-1,2147483647,!1);n.MAX_VALUE=w;var k=c(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var S=c(0,-2147483648,!1);n.MIN_VALUE=S;var I=n.prototype;I.toInt=function(){return this.unsigned?this.low>>>0:this.low},I.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},I.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=s(l(e,6),this.unsigned),a=this,i="";;){var c=a.div(o),u=(a.sub(c.mul(o)).toInt()>>>0).toString(e);if((a=c).isZero())return u+i;for(;u.length<6;)u="0"+u;i=""+u+i}},I.getHighBits=function(){return this.high},I.getHighBitsUnsigned=function(){return this.high>>>0},I.getLowBits=function(){return this.low},I.getLowBitsUnsigned=function(){return this.low>>>0},I.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},I.isZero=function(){return 0===this.high&&0===this.low},I.eqz=I.isZero,I.isNegative=function(){return!this.unsigned&&this.high<0},I.isPositive=function(){return this.unsigned||this.high>=0},I.isOdd=function(){return 1===(1&this.low)},I.isEven=function(){return 0===(1&this.low)},I.equals=function(e){return r(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},I.eq=I.equals,I.notEquals=function(e){return!this.eq(e)},I.neq=I.notEquals,I.ne=I.notEquals,I.lessThan=function(e){return this.comp(e)<0},I.lt=I.lessThan,I.lessThanOrEqual=function(e){return this.comp(e)<=0},I.lte=I.lessThanOrEqual,I.le=I.lessThanOrEqual,I.greaterThan=function(e){return this.comp(e)>0},I.gt=I.greaterThan,I.greaterThanOrEqual=function(e){return this.comp(e)>=0},I.gte=I.greaterThanOrEqual,I.ge=I.greaterThanOrEqual,I.compare=function(e){if(r(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},I.comp=I.compare,I.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(y)},I.neg=I.negate,I.add=function(e){r(e)||(e=d(e));var t=this.high>>>16,n=65535&this.high,o=this.low>>>16,a=65535&this.low,i=e.high>>>16,s=65535&e.high,l=e.low>>>16,u=0,h=0,p=0,f=0;return p+=(f+=a+(65535&e.low))>>>16,h+=(p+=o+l)>>>16,u+=(h+=n+s)>>>16,u+=t+i,c((p&=65535)<<16|(f&=65535),(u&=65535)<<16|(h&=65535),this.unsigned)},I.subtract=function(e){return r(e)||(e=d(e)),this.add(e.neg())},I.sub=I.subtract,I.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=d(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(S))return e.isOdd()?S:g;if(e.eq(S))return this.isOdd()?S:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=65535&this.high,a=this.low>>>16,i=65535&this.low,l=e.high>>>16,u=65535&e.high,h=e.low>>>16,p=65535&e.low,f=0,v=0,y=0,b=0;return y+=(b+=i*p)>>>16,v+=(y+=a*p)>>>16,y&=65535,v+=(y+=i*h)>>>16,f+=(v+=o*p)>>>16,v&=65535,f+=(v+=a*h)>>>16,v&=65535,f+=(v+=i*u)>>>16,f+=n*p+o*h+a*u+i*l,c((y&=65535)<<16|(b&=65535),(f&=65535)<<16|(v&=65535),this.unsigned)},I.mul=I.multiply,I.divide=function(e){if(r(e)||(e=d(e)),e.isZero())throw Error("division by zero");var n,o,a;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return b;a=v}else{if(this.eq(S))return e.eq(y)||e.eq(x)?S:e.eq(S)?y:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:x:(o=this.sub(e.mul(n)),a=n.add(o.div(e)));if(e.eq(S))return this.unsigned?v:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=g}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(n)/Math.LN2),u=i<=48?1:l(2,i-48),h=s(n),p=h.mul(e);p.isNegative()||p.gt(o);)p=(h=s(n-=u,this.unsigned)).mul(e);h.isZero()&&(h=y),a=a.add(h),o=o.sub(p)}return a},I.div=I.divide,I.modulo=function(e){return r(e)||(e=d(e)),t?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},I.mod=I.modulo,I.rem=I.modulo,I.not=function(){return c(~this.low,~this.high,this.unsigned)},I.and=function(e){return r(e)||(e=d(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},I.or=function(e){return r(e)||(e=d(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},I.xor=function(e){return r(e)||(e=d(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},I.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},I.shl=I.shiftLeft,I.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},I.shr=I.shiftRight,I.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},I.shru=I.shiftRightUnsigned,I.shr_u=I.shiftRightUnsigned,I.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},I.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},I.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},I.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},I.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},7359:function(e,t,n){var r;!function(e,o){function a(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new a(e),r=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,r&&("object"==typeof r&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.alea=s}(0,e=n.nmd(e),n.amdD)},7566:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd")},7598:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(7868);function o(e){if("string"!==typeof e)throw new Error((0,r.A)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},7758:(e,t,n)=>{"use strict";n.d(t,{A:()=>F});var r=n(8604),o=n(7162),a=n(3815);const i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>(t.filterProps.forEach((n=>{e[n]=t})),e)),{}),o=e=>Object.keys(e).reduce(((t,n)=>r[n]?(0,a.A)(t,r[n](e)):t),{});return o.propTypes={},o.filterProps=t.reduce(((e,t)=>e.concat(t.filterProps)),[]),o};var s=n(9751);function c(e){return"number"!==typeof e?e:"".concat(e,"px solid")}function l(e,t){return(0,o.Ay)({prop:e,themeKey:"borders",transform:t})}const u=l("border",c),d=l("borderTop",c),h=l("borderRight",c),p=l("borderBottom",c),f=l("borderLeft",c),m=l("borderColor"),g=l("borderTopColor"),v=l("borderRightColor"),y=l("borderBottomColor"),b=l("borderLeftColor"),x=l("outline",c),w=l("outlineColor"),k=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=(0,r.MA)(e.theme,"shape.borderRadius",4,"borderRadius"),n=e=>({borderRadius:(0,r._W)(t,e)});return(0,s.NI)(e,e.borderRadius,n)}return null};k.propTypes={},k.filterProps=["borderRadius"];i(u,d,h,p,f,m,g,v,y,b,k,x,w);const S=e=>{if(void 0!==e.gap&&null!==e.gap){const t=(0,r.MA)(e.theme,"spacing",8,"gap"),n=e=>({gap:(0,r._W)(t,e)});return(0,s.NI)(e,e.gap,n)}return null};S.propTypes={},S.filterProps=["gap"];const I=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=(0,r.MA)(e.theme,"spacing",8,"columnGap"),n=e=>({columnGap:(0,r._W)(t,e)});return(0,s.NI)(e,e.columnGap,n)}return null};I.propTypes={},I.filterProps=["columnGap"];const C=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=(0,r.MA)(e.theme,"spacing",8,"rowGap"),n=e=>({rowGap:(0,r._W)(t,e)});return(0,s.NI)(e,e.rowGap,n)}return null};C.propTypes={},C.filterProps=["rowGap"];i(S,I,C,(0,o.Ay)({prop:"gridColumn"}),(0,o.Ay)({prop:"gridRow"}),(0,o.Ay)({prop:"gridAutoFlow"}),(0,o.Ay)({prop:"gridAutoColumns"}),(0,o.Ay)({prop:"gridAutoRows"}),(0,o.Ay)({prop:"gridTemplateColumns"}),(0,o.Ay)({prop:"gridTemplateRows"}),(0,o.Ay)({prop:"gridTemplateAreas"}),(0,o.Ay)({prop:"gridArea"}));function A(e,t){return"grey"===t?t:e}i((0,o.Ay)({prop:"color",themeKey:"palette",transform:A}),(0,o.Ay)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:A}),(0,o.Ay)({prop:"backgroundColor",themeKey:"palette",transform:A}));function E(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}const T=(0,o.Ay)({prop:"width",transform:E}),N=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var n,r;const o=(null==(n=e.theme)||null==(n=n.breakpoints)||null==(n=n.values)?void 0:n[t])||s.zu[t];return o?"px"!==(null==(r=e.theme)||null==(r=r.breakpoints)?void 0:r.unit)?{maxWidth:"".concat(o).concat(e.theme.breakpoints.unit)}:{maxWidth:o}:{maxWidth:E(t)}};return(0,s.NI)(e,e.maxWidth,t)}return null};N.filterProps=["maxWidth"];const R=(0,o.Ay)({prop:"minWidth",transform:E}),_=(0,o.Ay)({prop:"height",transform:E}),D=(0,o.Ay)({prop:"maxHeight",transform:E}),O=(0,o.Ay)({prop:"minHeight",transform:E}),F=((0,o.Ay)({prop:"size",cssProperty:"width",transform:E}),(0,o.Ay)({prop:"size",cssProperty:"height",transform:E}),i(T,N,R,_,D,O,(0,o.Ay)({prop:"boxSizing"})),{border:{themeKey:"borders",transform:c},borderTop:{themeKey:"borders",transform:c},borderRight:{themeKey:"borders",transform:c},borderBottom:{themeKey:"borders",transform:c},borderLeft:{themeKey:"borders",transform:c},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:c},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:k},color:{themeKey:"palette",transform:A},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:A},backgroundColor:{themeKey:"palette",transform:A},p:{style:r.Ms},pt:{style:r.Ms},pr:{style:r.Ms},pb:{style:r.Ms},pl:{style:r.Ms},px:{style:r.Ms},py:{style:r.Ms},padding:{style:r.Ms},paddingTop:{style:r.Ms},paddingRight:{style:r.Ms},paddingBottom:{style:r.Ms},paddingLeft:{style:r.Ms},paddingX:{style:r.Ms},paddingY:{style:r.Ms},paddingInline:{style:r.Ms},paddingInlineStart:{style:r.Ms},paddingInlineEnd:{style:r.Ms},paddingBlock:{style:r.Ms},paddingBlockStart:{style:r.Ms},paddingBlockEnd:{style:r.Ms},m:{style:r.Lc},mt:{style:r.Lc},mr:{style:r.Lc},mb:{style:r.Lc},ml:{style:r.Lc},mx:{style:r.Lc},my:{style:r.Lc},margin:{style:r.Lc},marginTop:{style:r.Lc},marginRight:{style:r.Lc},marginBottom:{style:r.Lc},marginLeft:{style:r.Lc},marginX:{style:r.Lc},marginY:{style:r.Lc},marginInline:{style:r.Lc},marginInlineStart:{style:r.Lc},marginInlineEnd:{style:r.Lc},marginBlock:{style:r.Lc},marginBlockStart:{style:r.Lc},marginBlockEnd:{style:r.Lc},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:S},rowGap:{style:C},columnGap:{style:I},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:E},maxWidth:{style:N},minWidth:{transform:E},height:{transform:E},maxHeight:{transform:E},minHeight:{transform:E},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}})},7868:(e,t,n)=>{"use strict";function r(e){let t="https://mui.com/production-error/?code="+e;for(let n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}n.d(t,{A:()=>r})},7918:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A});var r=n(7598)},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8052:(e,t,n)=>{"use strict";var r=n(4994);t.Ay=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=m,rootShouldForwardProp:r=f,slotShouldForwardProp:c=f}=e,u=e=>(0,l.default)((0,o.default)({},e,{theme:v((0,o.default)({},e,{defaultTheme:n,themeId:t}))}));return u.__mui_systemSx=!0,function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.internal_processStyles)(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:d,slot:p,skipVariantsResolver:m,skipSx:x,overridesResolver:w=y(g(p))}=l,k=(0,a.default)(l,h),S=void 0!==m?m:p&&"Root"!==p&&"root"!==p||!1,I=x||!1;let C=f;"Root"===p||"root"===p?C=r:p?C=c:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(C=void 0);const A=(0,i.default)(e,(0,o.default)({shouldForwardProp:C,label:undefined},k)),E=e=>"function"===typeof e&&e.__emotion_real!==e||(0,s.isPlainObject)(e)?r=>b(e,(0,o.default)({},r,{theme:v({theme:r.theme,defaultTheme:n,themeId:t})})):e,T=function(r){let a=E(r);for(var i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];const l=s?s.map(E):[];d&&w&&l.push((e=>{const r=v((0,o.default)({},e,{defaultTheme:n,themeId:t}));if(!r.components||!r.components[d]||!r.components[d].styleOverrides)return null;const a=r.components[d].styleOverrides,i={};return Object.entries(a).forEach((t=>{let[n,a]=t;i[n]=b(a,(0,o.default)({},e,{theme:r}))})),w(e,i)})),d&&!S&&l.push((e=>{var r;const a=v((0,o.default)({},e,{defaultTheme:n,themeId:t}));return b({variants:null==a||null==(r=a.components)||null==(r=r[d])?void 0:r.variants},(0,o.default)({},e,{theme:a}))})),I||l.push(u);const h=l.length-s.length;if(Array.isArray(r)&&h>0){const e=new Array(h).fill("");a=[...r,...e],a.raw=[...r.raw,...e]}const p=A(a,...l);return e.muiName&&(p.muiName=e.muiName),p};return A.withConfig&&(T.withConfig=A.withConfig),T}};var o=r(n(4634)),a=r(n(4893)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(3174)),s=n(9482),c=(r(n(7918)),r(n(3382)),r(n(4989))),l=r(n(3234));const u=["ownerState"],d=["variants"],h=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function f(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const m=(0,c.default)(),g=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function v(e){let{defaultTheme:t,theme:n,themeId:r}=e;return o=n,0===Object.keys(o).length?t:n[r]||n;var o}function y(e){return e?(t,n)=>n[e]:null}function b(e,t){let{ownerState:n}=t,r=(0,a.default)(t,u);const i="function"===typeof e?e((0,o.default)({ownerState:n},r)):e;if(Array.isArray(i))return i.flatMap((e=>b(e,(0,o.default)({ownerState:n},r))));if(i&&"object"===typeof i&&Array.isArray(i.variants)){const{variants:e=[]}=i;let t=(0,a.default)(i,d);return e.forEach((e=>{let a=!0;"function"===typeof e.props?a=e.props((0,o.default)({ownerState:n},r,n)):Object.keys(e.props).forEach((t=>{(null==n?void 0:n[t])!==e.props[t]&&r[t]!==e.props[t]&&(a=!1)})),a&&(Array.isArray(t)||(t=[t]),t.push("function"===typeof e.style?e.style((0,o.default)({ownerState:n},r,n)):e.style))})),t}return i}},8108:()=>{},8168:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(null,arguments)}n.d(t,{A:()=>r})},8206:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});n(5043);var r=n(3654);n(579);function o(e){return(0,r.b)(e)}},8279:(e,t,n)=>{"use strict";n.d(t,{A:()=>B});var r=n(8168),o=n(8587),a=n(7868),i=n(9172),s=n(7758),c=n(8812),l=n(8280);var u=n(7266);const d={black:"#000",white:"#fff"},h={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},p={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},f={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},m={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},g={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},v={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},y={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},b=["mode","contrastThreshold","tonalOffset"],x={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:d.white,default:d.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},w={text:{primary:d.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:d.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function k(e,t,n,r){const o=r.light||r,a=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=(0,u.a)(e.main,o):"dark"===t&&(e.dark=(0,u.e$)(e.main,a)))}function S(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:s=.2}=e,c=(0,o.A)(e,b),l=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:g[200],light:g[50],dark:g[400]}:{main:g[700],light:g[400],dark:g[800]}}(t),S=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:p[200],light:p[50],dark:p[400]}:{main:p[500],light:p[300],dark:p[700]}}(t),I=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:f[500],light:f[300],dark:f[700]}:{main:f[700],light:f[400],dark:f[800]}}(t),C=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:v[400],light:v[300],dark:v[700]}:{main:v[700],light:v[500],dark:v[900]}}(t),A=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:y[400],light:y[300],dark:y[700]}:{main:y[800],light:y[500],dark:y[900]}}(t),E=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:m[400],light:m[300],dark:m[700]}:{main:"#ed6c02",light:m[500],dark:m[900]}}(t);function T(e){return(0,u.eM)(e,w.text.primary)>=n?w.text.primary:x.text.primary}const N=e=>{let{color:t,name:n,mainShade:o=500,lightShade:i=300,darkShade:c=700}=e;if(t=(0,r.A)({},t),!t.main&&t[o]&&(t.main=t[o]),!t.hasOwnProperty("main"))throw new Error((0,a.A)(11,n?" (".concat(n,")"):"",o));if("string"!==typeof t.main)throw new Error((0,a.A)(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return k(t,"light",i,s),k(t,"dark",c,s),t.contrastText||(t.contrastText=T(t.main)),t},R={dark:w,light:x};return(0,i.A)((0,r.A)({common:(0,r.A)({},d),mode:t,primary:N({color:l,name:"primary"}),secondary:N({color:S,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:N({color:I,name:"error"}),warning:N({color:E,name:"warning"}),info:N({color:C,name:"info"}),success:N({color:A,name:"success"}),grey:h,contrastThreshold:n,getContrastText:T,augmentColor:N,tonalOffset:s},R[t]),c)}const I=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const C={textTransform:"uppercase"},A='"Roboto", "Helvetica", "Arial", sans-serif';function E(e,t){const n="function"===typeof t?t(e):t,{fontFamily:a=A,fontSize:s=14,fontWeightLight:c=300,fontWeightRegular:l=400,fontWeightMedium:u=500,fontWeightBold:d=700,htmlFontSize:h=16,allVariants:p,pxToRem:f}=n,m=(0,o.A)(n,I);const g=s/14,v=f||(e=>"".concat(e/h*g,"rem")),y=(e,t,n,o,i)=>{return(0,r.A)({fontFamily:a,fontWeight:e,fontSize:v(t),lineHeight:n},a===A?{letterSpacing:"".concat((s=o/t,Math.round(1e5*s)/1e5),"em")}:{},i,p);var s},b={h1:y(c,96,1.167,-1.5),h2:y(c,60,1.2,-.5),h3:y(l,48,1.167,0),h4:y(l,34,1.235,.25),h5:y(l,24,1.334,0),h6:y(u,20,1.6,.15),subtitle1:y(l,16,1.75,.15),subtitle2:y(u,14,1.57,.1),body1:y(l,16,1.5,.15),body2:y(l,14,1.43,.15),button:y(u,14,1.75,.4,C),caption:y(l,12,1.66,.4),overline:y(l,12,2.66,1,C),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,i.A)((0,r.A)({htmlFontSize:h,pxToRem:v,fontFamily:a,fontSize:s,fontWeightLight:c,fontWeightRegular:l,fontWeightMedium:u,fontWeightBold:d},b),m,{clone:!1})}function T(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}const N=["none",T(0,2,1,-1,0,1,1,0,0,1,3,0),T(0,3,1,-2,0,2,2,0,0,1,5,0),T(0,3,3,-2,0,3,4,0,0,1,8,0),T(0,2,4,-1,0,4,5,0,0,1,10,0),T(0,3,5,-1,0,5,8,0,0,1,14,0),T(0,3,5,-1,0,6,10,0,0,1,18,0),T(0,4,5,-2,0,7,10,1,0,2,16,1),T(0,5,5,-3,0,8,10,1,0,3,14,2),T(0,5,6,-3,0,9,12,1,0,3,16,2),T(0,6,6,-3,0,10,14,1,0,4,18,3),T(0,6,7,-4,0,11,15,1,0,4,20,3),T(0,7,8,-4,0,12,17,2,0,5,22,4),T(0,7,8,-4,0,13,19,2,0,5,24,4),T(0,7,9,-4,0,14,21,2,0,5,26,4),T(0,8,9,-5,0,15,22,2,0,6,28,5),T(0,8,10,-5,0,16,24,2,0,6,30,5),T(0,8,11,-5,0,17,26,2,0,6,32,5),T(0,9,11,-5,0,18,28,2,0,7,34,6),T(0,9,12,-6,0,19,29,2,0,7,36,6),T(0,10,13,-6,0,20,31,3,0,8,38,7),T(0,10,13,-6,0,21,33,3,0,8,40,7),T(0,10,14,-6,0,22,35,3,0,8,42,7),T(0,11,14,-7,0,23,36,3,0,9,44,8),T(0,11,15,-7,0,24,38,3,0,9,46,8)],R=["duration","easing","delay"],_={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},D={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function O(e){return"".concat(Math.round(e),"ms")}function F(e){if(!e)return 0;const t=e/36;return Math.round(10*(4+15*t**.25+t/5))}function M(e){const t=(0,r.A)({},_,e.easing),n=(0,r.A)({},D,e.duration);return(0,r.A)({getAutoHeightDuration:F,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:a=n.standard,easing:i=t.easeInOut,delay:s=0}=r;(0,o.A)(r,R);return(Array.isArray(e)?e:[e]).map((e=>"".concat(e," ").concat("string"===typeof a?a:O(a)," ").concat(i," ").concat("string"===typeof s?s:O(s)))).join(",")}},e,{easing:t,duration:n})}const P={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},L=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mixins:t={},palette:n={},transitions:u={},typography:d={}}=e,h=(0,o.A)(e,L);if(e.vars&&void 0===e.generateCssVars)throw new Error((0,a.A)(18));const p=S(n),f=(0,l.A)(e);let m=(0,i.A)(f,{mixins:(g=f.breakpoints,v=t,(0,r.A)({toolbar:{minHeight:56,[g.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[g.up("sm")]:{minHeight:64}}},v)),palette:p,shadows:N.slice(),typography:E(p,d),transitions:M(u),zIndex:(0,r.A)({},P)});var g,v;m=(0,i.A)(m,h);for(var y=arguments.length,b=new Array(y>1?y-1:0),x=1;x<y;x++)b[x-1]=arguments[x];return m=b.reduce(((e,t)=>(0,i.A)(e,t)),m),m.unstable_sxConfig=(0,r.A)({},s.A,null==h?void 0:h.unstable_sxConfig),m.unstable_sx=function(e){return(0,c.A)({sx:e,theme:this})},m}const B=z},8280:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r=n(8168),o=n(8587),a=n(9172),i=n(4853);const s={borderRadius:4};var c=n(8604);var l=n(8812),u=n(7758),d=n(9703);const h=["breakpoints","palette","spacing","shape"];const p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:n={},spacing:p,shape:f={}}=e,m=(0,o.A)(e,h),g=(0,i.A)(t),v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;const t=(0,c.LX)({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0===n.length?[1]:n).map((e=>{const n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}(p);let y=(0,a.A)({breakpoints:g,direction:"ltr",components:{},palette:(0,r.A)({mode:"light"},n),spacing:v,shape:(0,r.A)({},s,f)},m);y.applyStyles=d.A;for(var b=arguments.length,x=new Array(b>1?b-1:0),w=1;w<b;w++)x[w-1]=arguments[w];return y=x.reduce(((e,t)=>(0,a.A)(e,t)),y),y.unstable_sxConfig=(0,r.A)({},u.A,null==m?void 0:m.unstable_sxConfig),y.unstable_sx=function(e){return(0,l.A)({sx:e,theme:this})},y}},8387:(e,t,n)=>{"use strict";function r(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=r(e[t]))&&(o&&(o+=" "),o+=n)}else for(n in e)e[n]&&(o&&(o+=" "),o+=n);return o}n.d(t,{A:()=>o});const o=function(){for(var e,t,n=0,o="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=r(e))&&(o&&(o+=" "),o+=t);return o}},8587:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}n.d(t,{A:()=>r})},8590:()=>{},8604:(e,t,n)=>{"use strict";n.d(t,{LX:()=>f,MA:()=>p,_W:()=>m,Lc:()=>y,Ms:()=>b});var r=n(9751),o=n(7162),a=n(3815);const i={m:"margin",p:"padding"},s={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},c={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},l=function(e){const t={};return n=>(void 0===t[n]&&(t[n]=e(n)),t[n])}((e=>{if(e.length>2){if(!c[e])return[e];e=c[e]}const[t,n]=e.split(""),r=i[t],o=s[n]||"";return Array.isArray(o)?o.map((e=>r+e)):[r+o]})),u=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],d=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],h=[...u,...d];function p(e,t,n,r){var a;const i=null!=(a=(0,o.Yn)(e,t,!1))?a:n;return"number"===typeof i?e=>"string"===typeof e?e:i*e:Array.isArray(i)?e=>"string"===typeof e?e:i[e]:"function"===typeof i?i:()=>{}}function f(e){return p(e,"spacing",8)}function m(e,t){if("string"===typeof t||null==t)return t;const n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:"-".concat(n)}function g(e,t,n,o){if(-1===t.indexOf(n))return null;const a=function(e,t){return n=>e.reduce(((e,r)=>(e[r]=m(t,n),e)),{})}(l(n),o),i=e[n];return(0,r.NI)(e,i,a)}function v(e,t){const n=f(e.theme);return Object.keys(e).map((r=>g(e,t,r,n))).reduce(a.A,{})}function y(e){return v(e,u)}function b(e){return v(e,d)}function x(e){return v(e,h)}y.propTypes={},y.filterProps=u,b.propTypes={},b.filterProps=d,x.propTypes={},x.filterProps=h},8610:(e,t,n)=>{"use strict";function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r={};return Object.keys(e).forEach((o=>{r[o]=e[o].reduce(((e,r)=>{if(r){const o=t(r);""!==o&&e.push(o),n&&n[r]&&e.push(n[r])}return e}),[]).join(" ")})),r}n.d(t,{A:()=>r})},8698:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(8168),o=n(8587),a=n(9172),i=n(7758);const s=["sx"],c=e=>{var t,n;const r={systemProps:{},otherProps:{}},o=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:i.A;return Object.keys(e).forEach((t=>{o[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]})),r};function l(e){const{sx:t}=e,n=(0,o.A)(e,s),{systemProps:i,otherProps:l}=c(n);let u;return u=Array.isArray(t)?[i,...t]:"function"===typeof t?function(){const e=t(...arguments);return(0,a.Q)(e)?(0,r.A)({},i,e):i}:(0,r.A)({},i,t),(0,r.A)({},l,{sx:u})}},8812:(e,t,n)=>{"use strict";n.d(t,{A:()=>u,k:()=>c});var r=n(7598),o=n(3815),a=n(7162),i=n(9751),s=n(7758);function c(){function e(e,t,n,o){const s={[e]:t,theme:n},c=o[e];if(!c)return{[e]:t};const{cssProperty:l=e,themeKey:u,transform:d,style:h}=c;if(null==t)return null;if("typography"===u&&"inherit"===t)return{[e]:t};const p=(0,a.Yn)(n,u)||{};if(h)return h(s);return(0,i.NI)(s,t,(t=>{let n=(0,a.BO)(p,d,t);return t===n&&"string"===typeof t&&(n=(0,a.BO)(p,d,"".concat(e).concat("default"===t?"":(0,r.A)(t)),t)),!1===l?n:{[l]:n}}))}return function t(n){var r;const{sx:a,theme:c={}}=n||{};if(!a)return null;const l=null!=(r=c.unstable_sxConfig)?r:s.A;function u(n){let r=n;if("function"===typeof n)r=n(c);else if("object"!==typeof n)return n;if(!r)return null;const a=(0,i.EU)(c.breakpoints),s=Object.keys(a);let u=a;return Object.keys(r).forEach((n=>{const a=(s=r[n],d=c,"function"===typeof s?s(d):s);var s,d;if(null!==a&&void 0!==a)if("object"===typeof a)if(l[n])u=(0,o.A)(u,e(n,a,c,l));else{const e=(0,i.NI)({theme:c},a,(e=>({[n]:e})));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>e.concat(Object.keys(t))),[]),o=new Set(r);return t.every((e=>o.size===Object.keys(e).length))}(e,a)?u=(0,o.A)(u,e):u[n]=t({sx:a,theme:c})}else u=(0,o.A)(u,e(n,a,c,l))})),(0,i.vf)(s,u)}return Array.isArray(a)?a.map(u):u(a)}}const l=c();l.filterProps=["sx"];const u=l},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},9016:function(e,t,n){var r;!function(e,o){function a(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xorwow=s}(0,e=n.nmd(e),n.amdD)},9120:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")},9172:(e,t,n)=>{"use strict";n.d(t,{A:()=>s,Q:()=>a});var r=n(8168),o=n(5043);function a(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function i(e){if(o.isValidElement(e)||!a(e))return e;const t={};return Object.keys(e).forEach((n=>{t[n]=i(e[n])})),t}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const c=n.clone?(0,r.A)({},e):e;return a(e)&&a(t)&&Object.keys(t).forEach((r=>{o.isValidElement(t[r])?c[r]=t[r]:a(t[r])&&Object.prototype.hasOwnProperty.call(e,r)&&a(e[r])?c[r]=s(e[r],t[r],n):n.clone?c[r]=a(t[r])?i(t[r]):t[r]:c[r]=t[r]})),c}},9214:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,n))}},9303:(e,t,n)=>{"use strict";n.d(t,{E:()=>i,A:()=>s});var r=n(5043);const o={};const a=[];class i{constructor(){this.currentId=null,this.clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new i}start(e,t){this.clear(),this.currentId=setTimeout((()=>{this.currentId=null,t()}),e)}}function s(){const e=function(e,t){const n=r.useRef(o);return n.current===o&&(n.current=e(t)),n}(i.create).current;var t;return t=e.disposeEffect,r.useEffect(t,a),e}},9369:(e,t,n)=>{"use strict";n.d(t,{C:()=>l,E:()=>g,T:()=>d,c:()=>f,h:()=>h,w:()=>u});var r=n(5043),o=n(3803),a=n(1722),i=n(6598),s=n(9436),c=r.createContext("undefined"!==typeof HTMLElement?(0,o.A)({key:"css"}):null),l=c.Provider,u=function(e){return(0,r.forwardRef)((function(t,n){var o=(0,r.useContext)(c);return e(t,o,n)}))},d=r.createContext({});var h={}.hasOwnProperty,p="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",f=function(e,t){var n={};for(var r in t)h.call(t,r)&&(n[r]=t[r]);return n[p]=e,n},m=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return(0,a.SF)(t,n,r),(0,s.s)((function(){return(0,a.sk)(t,n,r)})),null},g=u((function(e,t,n){var o=e.css;"string"===typeof o&&void 0!==t.registered[o]&&(o=t.registered[o]);var s=e[p],c=[o],l="";"string"===typeof e.className?l=(0,a.Rk)(t.registered,c,e.className):null!=e.className&&(l=e.className+" ");var u=(0,i.J)(c,void 0,r.useContext(d));l+=t.key+"-"+u.name;var f={};for(var g in e)h.call(e,g)&&"css"!==g&&g!==p&&(f[g]=e[g]);return f.className=l,n&&(f.ref=n),r.createElement(r.Fragment,null,r.createElement(m,{cache:t,serialized:u,isStringTag:"string"===typeof s}),r.createElement(s,f))}))},9386:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const r=e=>e,o=(()=>{let e=r;return{configure(t){e=t},generate:t=>e(t),reset(){e=r}}})()},9436:(e,t,n)=>{"use strict";var r;n.d(t,{i:()=>s,s:()=>i});var o=n(5043),a=!!(r||(r=n.t(o,2))).useInsertionEffect&&(r||(r=n.t(o,2))).useInsertionEffect,i=a||function(e){return e()},s=a||o.useLayoutEffect},9482:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.A,isPlainObject:()=>r.Q});var r=n(9172)},9538:function(e,t,n){var r;!function(e,o){function a(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.x&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xorshift7=s}(0,e=n.nmd(e),n.amdD)},9611:(e,t,n)=>{"use strict";var r=n(4994);t.A=void 0;var o=r(n(39)),a=n(579);t.A=(0,o.default)((0,a.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu")},9662:(e,t,n)=>{"use strict";n.d(t,{A:()=>b});var r=n(8168),o=n(5043),a=n(8587),i=n(8387),s=n(8610),c=n(6803),l=n(8206),u=n(4535),d=n(2532),h=n(2372);function p(e){return(0,h.Ay)("MuiSvgIcon",e)}(0,d.A)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var f=n(579);const m=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],g=(0,u.Ay)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"inherit"!==n.color&&t["color".concat((0,c.A)(n.color))],t["fontSize".concat((0,c.A)(n.fontSize))]]}})((e=>{let{theme:t,ownerState:n}=e;var r,o,a,i,s,c,l,u,d,h,p,f,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:n.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(r=t.transitions)||null==(o=r.create)?void 0:o.call(r,"fill",{duration:null==(a=t.transitions)||null==(a=a.duration)?void 0:a.shorter}),fontSize:{inherit:"inherit",small:(null==(i=t.typography)||null==(s=i.pxToRem)?void 0:s.call(i,20))||"1.25rem",medium:(null==(c=t.typography)||null==(l=c.pxToRem)?void 0:l.call(c,24))||"1.5rem",large:(null==(u=t.typography)||null==(d=u.pxToRem)?void 0:d.call(u,35))||"2.1875rem"}[n.fontSize],color:null!=(h=null==(p=(t.vars||t).palette)||null==(p=p[n.color])?void 0:p.main)?h:{action:null==(f=(t.vars||t).palette)||null==(f=f.action)?void 0:f.active,disabled:null==(m=(t.vars||t).palette)||null==(m=m.action)?void 0:m.disabled,inherit:void 0}[n.color]}})),v=o.forwardRef((function(e,t){const n=(0,l.b)({props:e,name:"MuiSvgIcon"}),{children:u,className:d,color:h="inherit",component:v="svg",fontSize:y="medium",htmlColor:b,inheritViewBox:x=!1,titleAccess:w,viewBox:k="0 0 24 24"}=n,S=(0,a.A)(n,m),I=o.isValidElement(u)&&"svg"===u.type,C=(0,r.A)({},n,{color:h,component:v,fontSize:y,instanceFontSize:e.fontSize,inheritViewBox:x,viewBox:k,hasSvgAsChild:I}),A={};x||(A.viewBox=k);const E=(e=>{const{color:t,fontSize:n,classes:r}=e,o={root:["root","inherit"!==t&&"color".concat((0,c.A)(t)),"fontSize".concat((0,c.A)(n))]};return(0,s.A)(o,p,r)})(C);return(0,f.jsxs)(g,(0,r.A)({as:v,className:(0,i.A)(E.root,d),focusable:"false",color:b,"aria-hidden":!w||void 0,role:w?"img":void 0,ref:t},A,S,I&&u.props,{ownerState:C,children:[I?u.props.children:u,w?(0,f.jsx)("title",{children:w}):null]}))}));v.muiName="SvgIcon";const y=v;function b(e,t){function n(n,o){return(0,f.jsx)(y,(0,r.A)({"data-testid":"".concat(t,"Icon"),ref:o},n,{children:e}))}return n.muiName=y.muiName,o.memo(o.forwardRef(n))}},9703:(e,t,n)=>{"use strict";function r(e,t){const n=this;if(n.vars&&"function"===typeof n.getColorSchemeSelector){const r=n.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)");return{[r]:t}}return n.palette.mode===e?t:{}}n.d(t,{A:()=>r})},9751:(e,t,n)=>{"use strict";n.d(t,{EU:()=>s,NI:()=>i,iZ:()=>l,kW:()=>u,vf:()=>c,zu:()=>o});var r=n(9172);const o={xs:0,sm:600,md:900,lg:1200,xl:1536},a={keys:["xs","sm","md","lg","xl"],up:e=>"@media (min-width:".concat(o[e],"px)")};function i(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const e=r.breakpoints||a;return t.reduce(((r,o,a)=>(r[e.up(e.keys[a])]=n(t[a]),r)),{})}if("object"===typeof t){const e=r.breakpoints||a;return Object.keys(t).reduce(((r,a)=>{if(-1!==Object.keys(e.values||o).indexOf(a)){r[e.up(a)]=n(t[a],a)}else{const e=a;r[e]=t[e]}return r}),{})}return n(t)}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return(null==(t=e.keys)?void 0:t.reduce(((t,n)=>(t[e.up(n)]={},t)),{}))||{}}function c(e,t){return e.reduce(((e,t)=>{const n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function l(e){const t=s(e);for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];const i=[t,...o].reduce(((e,t)=>(0,r.A)(e,t)),{});return c(Object.keys(t),i)}function u(e){let{values:t,breakpoints:n,base:r}=e;const o=r||function(e,t){if("object"!==typeof e)return{};const n={},r=Object.keys(t);return Array.isArray(e)?r.forEach(((t,r)=>{r<e.length&&(n[t]=!0)})):r.forEach((t=>{null!=e[t]&&(n[t]=!0)})),n}(t,n),a=Object.keys(o);if(0===a.length)return t;let i;return a.reduce(((e,n,r)=>(Array.isArray(t)?(e[n]=null!=t[r]?t[r]:t[i],i=r):"object"===typeof t?(e[n]=null!=t[n]?t[n]:t[i],i=n):e[n]=t,e)),{})}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"===typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>i[e]=()=>r[e]));return i.default=()=>r,n.d(a,i),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e={};n.r(e),n.d(e,{assertParamsValid:()=>HF,computeFlatOffset:()=>oM,computeOutShape:()=>KF,getNormalizedAxes:()=>JF,isSliceContinous:()=>rM,maskToAxes:()=>qF,parseSliceParams:()=>aM,sliceInfo:()=>iM,startForAxis:()=>tM,startIndicesWithElidedDims:()=>$F,stopForAxis:()=>nM,stopIndicesWithElidedDims:()=>ZF,stridesForAxis:()=>eM,stridesWithElidedDims:()=>XF});var t={};n.r(t),n.d(t,{collectGatherOpShapeInfo:()=>IB,computeOutShape:()=>SB,segOpComputeOptimalWindowSize:()=>kB});var r={};n.r(r),n.d(r,{ERF_A1:()=>Uz,ERF_A2:()=>Wz,ERF_A3:()=>jz,ERF_A4:()=>Vz,ERF_A5:()=>Gz,ERF_P:()=>Bz,PARALLELIZE_THRESHOLD:()=>Cz,RowPartitionType:()=>xz,SELU_SCALE:()=>zz,SELU_SCALEALPHA:()=>Lz,applyActivation:()=>SL,assertAndGetBroadcastShape:()=>CF,assertAxesAreInnerMostDims:()=>gP,assertParamsConsistent:()=>yz,assignToTypedArray:()=>Qz,axesAreInnerMostDims:()=>hP,calculateShapes:()=>Pz,checkEinsumDimSizes:()=>aB,checkPadOnDimRoundingMode:()=>CM,combineLocations:()=>pP,combineRaggedTensorToTensorShapes:()=>wz,complexWithEvenIndex:()=>Kz,complexWithOddIndex:()=>Xz,computeConv2DInfo:()=>fM,computeConv3DInfo:()=>mM,computeDefaultPad:()=>gM,computeDilation2DInfo:()=>dM,computeOptimalWindowSize:()=>Az,computeOutAndReduceShapes:()=>fP,computeOutShape:()=>bz,computePool2DInfo:()=>hM,computePool3DInfo:()=>pM,convertConv2DDataFormat:()=>IM,decodeEinsumEquation:()=>rB,eitherStridesOrDilationsAreOne:()=>kM,expandShapeToKeepDim:()=>mP,exponent:()=>$z,exponents:()=>Jz,fromStringArrayToUint8:()=>AB,fromUint8ToStringArray:()=>CB,getAxesPermutation:()=>vP,getBroadcastDims:()=>SF,getComplexWithIndex:()=>Yz,getEinsumComputePath:()=>iB,getEinsumPermutation:()=>oB,getFusedBiasGradient:()=>kL,getFusedDyActivation:()=>wL,getImageCenter:()=>Ez,getInnerMostAxes:()=>bP,getPermuted:()=>Nz,getRaggedRank:()=>Sz,getReductionAxes:()=>IF,getReshaped:()=>Tz,getReshapedPermuted:()=>Rz,getRowPartitionTypesHelper:()=>kz,getSliceBeginCoords:()=>_z,getSliceSize:()=>Dz,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>uB,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>dB,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>hB,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>mB,getSparseReshapeInputOutputMismatchErrorMessage:()=>vB,getSparseReshapeInputOutputMultipleErrorMessage:()=>gB,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>pB,getSparseReshapeNegativeOutputDimErrorMessage:()=>fB,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>wB,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>yB,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>bB,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>xB,getUndoAxesPermutation:()=>yP,isIdentityPermutation:()=>sB,log:()=>D_,mergeRealAndImagArrays:()=>Hz,prepareAndValidate:()=>Oz,prepareSplitSize:()=>lB,segment_util:()=>t,shouldFuse:()=>IL,slice_util:()=>e,splitRealAndImagArrays:()=>qz,stridesOrDilationsArePositive:()=>SM,tupleValuesAreOne:()=>wM,upcastType:()=>RD,validateDefaultValueShape:()=>Iz,validateInput:()=>Mz,validateUpdateShape:()=>Fz,warn:()=>__});var o={};n.r(o),n.d(o,{mx:()=>IY,XI:()=>gQ,Nk:()=>vQ,f6:()=>bQ,ct:()=>bY,YG:()=>kQ,hH:()=>TQ,z3:()=>hJ,sG:()=>SJ,uM:()=>TJ,vS:()=>HJ,qB:()=>ZJ,GG:()=>t$,lg:()=>i$,rq:()=>r$,cu:()=>b$,WR:()=>g$,GE:()=>k$,px:()=>I$,jC:()=>B$,He:()=>j$,hE:()=>$$,BF:()=>oJ,Dk:()=>cZ,cl:()=>gZ,_B:()=>NZ,ub:()=>FZ,_f:()=>LZ,Ku:()=>VZ,qy:()=>HZ,Zy:()=>r0,bu:()=>i0,zv:()=>uY,dH:()=>OY,HS:()=>hQ,yH:()=>A0,l3:()=>T0,z9:()=>R0,x6:()=>M0,_m:()=>j0,eW:()=>K0,GK:()=>Q0,SP:()=>Z0,yr:()=>t1,dl:()=>FJ,Dw:()=>s1,xT:()=>d1,_X:()=>UY,wz:()=>y1});var a,i=n(5043),s=n.t(i,2),c=n(4391);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(a||(a={}));const u="popstate";function d(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function p(e,t){return{usr:e.state,key:e.key,idx:t}}function f(e,t,n,r){return void 0===n&&(n=null),l({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function m(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function g(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function v(e,t,n,r){void 0===r&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,s=o.history,c=a.Pop,h=null,g=v();function v(){return(s.state||{idx:null}).idx}function y(){c=a.Pop;let e=v(),t=null==e?null:e-g;g=e,h&&h({action:c,location:x.location,delta:t})}function b(e){let t="null"!==o.location.origin?o.location.origin:o.location.href,n="string"===typeof e?e:m(e);return n=n.replace(/ $/,"%20"),d(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,s.replaceState(l({},s.state,{idx:g}),""));let x={get action(){return c},get location(){return e(o,s)},listen(e){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(u,y),h=e,()=>{o.removeEventListener(u,y),h=null}},createHref:e=>t(o,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){c=a.Push;let r=f(x.location,e,t);n&&n(r,e),g=v()+1;let l=p(r,g),u=x.createHref(r);try{s.pushState(l,"",u)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;o.location.assign(u)}i&&h&&h({action:c,location:x.location,delta:1})},replace:function(e,t){c=a.Replace;let r=f(x.location,e,t);n&&n(r,e),g=v();let o=p(r,g),l=x.createHref(r);s.replaceState(o,"",l),i&&h&&h({action:c,location:x.location,delta:0})},go:e=>s.go(e)};return x}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,n){return void 0===n&&(n="/"),x(e,t,n,!1)}function x(e,t,n,r){let o=F(("string"===typeof t?g(t):t).pathname||"/",n);if(null==o)return null;let a=w(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(a);let i=null;for(let s=0;null==i&&s<a.length;++s){let e=O(o);i=_(a[s],e,r)}return i}function w(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let o=(e,o,a)=>{let i={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};i.relativePath.startsWith("/")&&(d(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(r.length));let s=B([r,i.relativePath]),c=n.concat(i);e.children&&e.children.length>0&&(d(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),w(e.children,t,c,s)),(null!=e.path||e.index)&&t.push({path:s,score:R(s,e.index),routesMeta:c})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of k(e.path))o(e,t,r);else o(e,t)})),t}function k(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,o=n.endsWith("?"),a=n.replace(/\?$/,"");if(0===r.length)return o?[a,""]:[a];let i=k(r.join("/")),s=[];return s.push(...i.map((e=>""===e?a:[a,e].join("/")))),o&&s.push(...i),s.map((t=>e.startsWith("/")&&""===t?"/":t))}const S=/^:[\w-]+$/,I=3,C=2,A=1,E=10,T=-2,N=e=>"*"===e;function R(e,t){let n=e.split("/"),r=n.length;return n.some(N)&&(r+=T),t&&(r+=C),n.filter((e=>!N(e))).reduce(((e,t)=>e+(S.test(t)?I:""===t?A:E)),r)}function _(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,o={},a="/",i=[];for(let s=0;s<r.length;++s){let e=r[s],c=s===r.length-1,l="/"===a?t:t.slice(a.length)||"/",u=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:c},l),d=e.route;if(!u&&c&&n&&!r[r.length-1].route.index&&(u=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},l)),!u)return null;Object.assign(o,u.params),i.push({params:o,pathname:B([a,u.pathname]),pathnameBase:U(B([a,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(a=B([a,u.pathnameBase]))}return i}function D(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))");let a=new RegExp(o,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let a=o[0],i=a.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:o}=t;if("*"===r){let e=s[n]||"";i=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const c=s[n];return e[r]=o&&!c?void 0:(c||"").replace(/%2F/g,"/"),e}),{}),pathname:a,pathnameBase:i,pattern:e}}function O(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function F(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function M(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function P(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function L(e,t){let n=P(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function z(e,t,n,r){let o;void 0===r&&(r=!1),"string"===typeof e?o=g(e):(o=l({},e),d(!o.pathname||!o.pathname.includes("?"),M("?","pathname","search",o)),d(!o.pathname||!o.pathname.includes("#"),M("#","pathname","hash",o)),d(!o.search||!o.search.includes("#"),M("#","search","hash",o)));let a,i=""===e||""===o.pathname,s=i?"/":o.pathname;if(null==s)a=n;else{let e=t.length-1;if(!r&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}a=e>=0?t[e]:"/"}let c=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:o=""}="string"===typeof e?g(e):e,a=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:a,search:W(r),hash:j(o)}}(o,a),u=s&&"/"!==s&&s.endsWith("/"),h=(i||"."===s)&&n.endsWith("/");return c.pathname.endsWith("/")||!u&&!h||(c.pathname+="/"),c}const B=e=>e.join("/").replace(/\/\/+/g,"/"),U=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),W=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",j=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function V(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const G=["post","put","patch","delete"],H=(new Set(G),["get",...G]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},q.apply(this,arguments)}const K=i.createContext(null);const X=i.createContext(null);const Y=i.createContext(null);const Q=i.createContext(null);const J=i.createContext({outlet:null,matches:[],isDataRoute:!1});const $=i.createContext(null);function Z(){return null!=i.useContext(Q)}function ee(){return Z()||d(!1),i.useContext(Q).location}function te(e){i.useContext(Y).static||i.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=i.useContext(J);return e?function(){let{router:e}=he(ue.UseNavigateStable),t=fe(de.UseNavigateStable),n=i.useRef(!1);te((()=>{n.current=!0}));let r=i.useCallback((function(r,o){void 0===o&&(o={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,q({fromRouteId:t},o)))}),[e,t]);return r}():function(){Z()||d(!1);let e=i.useContext(K),{basename:t,future:n,navigator:r}=i.useContext(Y),{matches:o}=i.useContext(J),{pathname:a}=ee(),s=JSON.stringify(L(o,n.v7_relativeSplatPath)),c=i.useRef(!1);te((()=>{c.current=!0}));let l=i.useCallback((function(n,o){if(void 0===o&&(o={}),!c.current)return;if("number"===typeof n)return void r.go(n);let i=z(n,JSON.parse(s),a,"path"===o.relative);null==e&&"/"!==t&&(i.pathname="/"===i.pathname?t:B([t,i.pathname])),(o.replace?r.replace:r.push)(i,o.state,o)}),[t,r,s,a,e]);return l}()}function re(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=i.useContext(Y),{matches:o}=i.useContext(J),{pathname:a}=ee(),s=JSON.stringify(L(o,r.v7_relativeSplatPath));return i.useMemo((()=>z(e,JSON.parse(s),a,"path"===n)),[e,s,a,n])}function oe(e,t,n,r){Z()||d(!1);let{navigator:o}=i.useContext(Y),{matches:s}=i.useContext(J),c=s[s.length-1],l=c?c.params:{},u=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let h,p=ee();if(t){var f;let e="string"===typeof t?g(t):t;"/"===u||(null==(f=e.pathname)?void 0:f.startsWith(u))||d(!1),h=e}else h=p;let m=h.pathname||"/",v=m;if("/"!==u){let e=u.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=b(e,{pathname:v});let x=le(y&&y.map((e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:B([u,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:B([u,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),s,n,r);return t&&x?i.createElement(Q.Provider,{value:{location:q({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:a.Pop}},x):x}function ae(){let e=function(){var e;let t=i.useContext($),n=pe(de.UseRouteError),r=fe(de.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=V(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:o},n):null,null)}const ie=i.createElement(ae,null);class se extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?i.createElement(J.Provider,{value:this.props.routeContext},i.createElement($.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ce(e){let{routeContext:t,match:n,children:r}=e,o=i.useContext(K);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(J.Provider,{value:t},r)}function le(e,t,n,r){var o;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var a;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(a=r)&&a.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let s=e,c=null==(o=n)?void 0:o.errors;if(null!=c){let e=s.findIndex((e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id])));e>=0||d(!1),s=s.slice(0,Math.min(s.length,e+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let i=0;i<s.length;i++){let e=s[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=i),e.route.id){let{loaderData:t,errors:r}=n,o=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||o){l=!0,s=u>=0?s.slice(0,u+1):[s[0]];break}}}return s.reduceRight(((e,r,o)=>{let a,d=!1,h=null,p=null;var f;n&&(a=c&&r.route.id?c[r.route.id]:void 0,h=r.route.errorElement||ie,l&&(u<0&&0===o?(f="route-fallback",!1||me[f]||(me[f]=!0),d=!0,p=null):u===o&&(d=!0,p=r.route.hydrateFallbackElement||null)));let m=t.concat(s.slice(0,o+1)),g=()=>{let t;return t=a?h:d?p:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:e,i.createElement(ce,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===o)?i.createElement(se,{location:n.location,revalidation:n.revalidation,component:h,error:a,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var ue=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ue||{}),de=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(de||{});function he(e){let t=i.useContext(K);return t||d(!1),t}function pe(e){let t=i.useContext(X);return t||d(!1),t}function fe(e){let t=function(){let e=i.useContext(J);return e||d(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||d(!1),n.route.id}const me={};function ge(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}s.startTransition;function ve(e){let{to:t,replace:n,state:r,relative:o}=e;Z()||d(!1);let{future:a,static:s}=i.useContext(Y),{matches:c}=i.useContext(J),{pathname:l}=ee(),u=ne(),h=z(t,L(c,a.v7_relativeSplatPath),l,"path"===o),p=JSON.stringify(h);return i.useEffect((()=>u(JSON.parse(p),{replace:n,state:r,relative:o})),[u,p,o,n,r]),null}function ye(e){d(!1)}function be(e){let{basename:t="/",children:n=null,location:r,navigationType:o=a.Pop,navigator:s,static:c=!1,future:l}=e;Z()&&d(!1);let u=t.replace(/^\/*/,"/"),h=i.useMemo((()=>({basename:u,navigator:s,static:c,future:q({v7_relativeSplatPath:!1},l)})),[u,l,s,c]);"string"===typeof r&&(r=g(r));let{pathname:p="/",search:f="",hash:m="",state:v=null,key:y="default"}=r,b=i.useMemo((()=>{let e=F(p,u);return null==e?null:{location:{pathname:e,search:f,hash:m,state:v,key:y},navigationType:o}}),[u,p,f,m,v,y,o]);return null==b?null:i.createElement(Y.Provider,{value:h},i.createElement(Q.Provider,{children:n,value:b}))}function xe(e){let{children:t,location:n}=e;return oe(we(t),n)}new Promise((()=>{}));i.Component;function we(e,t){void 0===t&&(t=[]);let n=[];return i.Children.forEach(e,((e,r)=>{if(!i.isValidElement(e))return;let o=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,we(e.props.children,o));e.type!==ye&&d(!1),e.props.index&&e.props.children&&d(!1);let a={id:e.props.id||o.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=we(e.props.children,o)),n.push(a)})),n}var ke=n(7950),Se=n.t(ke,2);function Ie(){return Ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ie.apply(this,arguments)}function Ce(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Ae=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(_se){}new Map;const Ee=s.startTransition;Se.flushSync,s.useId;function Te(e){let{basename:t,children:n,future:r,window:o}=e,a=i.useRef();var s;null==a.current&&(a.current=(void 0===(s={window:o,v5Compat:!0})&&(s={}),v((function(e,t){let{pathname:n,search:r,hash:o}=e.location;return f("",{pathname:n,search:r,hash:o},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:m(t)}),null,s)));let c=a.current,[l,u]=i.useState({action:c.action,location:c.location}),{v7_startTransition:d}=r||{},h=i.useCallback((e=>{d&&Ee?Ee((()=>u(e))):u(e)}),[u,d]);return i.useLayoutEffect((()=>c.listen(h)),[c,h]),i.useEffect((()=>ge(r)),[r]),i.createElement(be,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:c,future:r})}const Ne="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Re=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_e=i.forwardRef((function(e,t){let n,{onClick:r,relative:o,reloadDocument:a,replace:s,state:c,target:l,to:u,preventScrollReset:h,viewTransition:p}=e,f=Ce(e,Ae),{basename:g}=i.useContext(Y),v=!1;if("string"===typeof u&&Re.test(u)&&(n=u,Ne))try{let e=new URL(window.location.href),t=u.startsWith("//")?new URL(e.protocol+u):new URL(u),n=F(t.pathname,g);t.origin===e.origin&&null!=n?u=n+t.search+t.hash:v=!0}catch(_se){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;Z()||d(!1);let{basename:r,navigator:o}=i.useContext(Y),{hash:a,pathname:s,search:c}=re(e,{relative:n}),l=s;return"/"!==r&&(l="/"===s?r:B([r,s])),o.createHref({pathname:l,search:c,hash:a})}(u,{relative:o}),b=function(e,t){let{target:n,replace:r,state:o,preventScrollReset:a,relative:s,viewTransition:c}=void 0===t?{}:t,l=ne(),u=ee(),d=re(e,{relative:s});return i.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:m(u)===m(d);l(e,{replace:n,state:o,preventScrollReset:a,relative:s,viewTransition:c})}}),[u,l,d,r,o,n,e,a,s,c])}(u,{replace:s,state:c,target:l,preventScrollReset:h,relative:o,viewTransition:p});return i.createElement("a",Ie({},f,{href:n||y,onClick:v||a?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:l}))}));var De,Oe;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(De||(De={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Oe||(Oe={}));var Fe=n(8168),Me=n(8587);const Pe=i.createContext(null);function Le(){return i.useContext(Pe)}const ze="function"===typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__";var Be=n(579);const Ue=function(e){const{children:t,theme:n}=e,r=Le(),o=i.useMemo((()=>{const e=null===r?n:function(e,t){if("function"===typeof t)return t(e);return(0,Fe.A)({},e,t)}(r,n);return null!=e&&(e[ze]=null!==r),e}),[n,r]);return(0,Be.jsx)(Pe.Provider,{value:o,children:t})};var We=n(9369);const je=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=i.useContext(We.T);return t&&(n=t,0!==Object.keys(n).length)?t:e;var n},Ve=["value"],Ge=i.createContext();const He=()=>{const e=i.useContext(Ge);return null!=e&&e},qe=function(e){let{value:t}=e,n=(0,Me.A)(e,Ve);return(0,Be.jsx)(Ge.Provider,(0,Fe.A)({value:null==t||t},n))};var Ke=n(3654);const Xe={};function Ye(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return i.useMemo((()=>{const o=e&&t[e]||t;if("function"===typeof n){const a=n(o),i=e?(0,Fe.A)({},t,{[e]:a}):a;return r?()=>i:i}return e?(0,Fe.A)({},t,{[e]:n}):(0,Fe.A)({},t,n)}),[e,t,n,r])}const Qe=function(e){const{children:t,theme:n,themeId:r}=e,o=je(Xe),a=Le()||Xe,i=Ye(r,o,n),s=Ye(r,a,n,!0),c="rtl"===i.direction;return(0,Be.jsx)(Ue,{theme:s,children:(0,Be.jsx)(We.T.Provider,{value:i,children:(0,Be.jsx)(qe,{value:c,children:(0,Be.jsx)(Ke.A,{value:null==i?void 0:i.components,children:t})})})})};var Je=n(3375);const $e=["theme"];function Ze(e){let{theme:t}=e,n=(0,Me.A)(e,$e);const r=t[Je.A];let o=r||t;return"function"!==typeof t&&(r&&!r.vars?o=(0,Fe.A)({},r,{vars:null}):t&&!t.vars&&(o=(0,Fe.A)({},t,{vars:null}))),(0,Be.jsx)(Qe,(0,Fe.A)({},n,{themeId:r?Je.A:void 0,theme:o}))}function et(e){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},et(e)}function tt(e){var t=function(e,t){if("object"!=et(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=et(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==et(t)?t:t+""}function nt(e,t,n){return(t=tt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(n),!0).forEach((function(t){nt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const at=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):55296===(64512&o)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++r)),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},it={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<e.length;o+=3){const t=e[o],a=o+1<e.length,i=a?e[o+1]:0,s=o+2<e.length,c=s?e[o+2]:0,l=t>>2,u=(3&t)<<4|i>>4;let d=(15&i)<<2|c>>6,h=63&c;s||(h=64,a||(d=64)),r.push(n[l],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(at(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const o=e[n++];if(o<128)t[r++]=String.fromCharCode(o);else if(o>191&&o<224){const a=e[n++];t[r++]=String.fromCharCode((31&o)<<6|63&a)}else if(o>239&&o<365){const a=((7&o)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],i=e[n++];t[r++]=String.fromCharCode((15&o)<<12|(63&a)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<e.length;){const t=n[e.charAt(o++)],a=o<e.length?n[e.charAt(o)]:0;++o;const i=o<e.length?n[e.charAt(o)]:64;++o;const s=o<e.length?n[e.charAt(o)]:64;if(++o,null==t||null==a||null==i||null==s)throw new st;const c=t<<2|a>>4;if(r.push(c),64!==i){const e=a<<4&240|i>>2;if(r.push(e),64!==s){const e=i<<6&192|s;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class st extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ct=function(e){return function(e){const t=at(e);return it.encodeByteArray(t,!0)}(e).replace(/\./g,"")},lt=function(e){try{return it.decodeString(e,!0)}catch(_se){console.error("base64Decode failed: ",_se)}return null};const ut=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,dt=()=>{try{return ut()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/Agroscan",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyCyiJ42A125uF5Lh02gh-_Y556TO91DmIg",REACT_APP_FIREBASE_APP_ID:"1:520364147553:web:81f752a0714c9469323b20",REACT_APP_FIREBASE_AUTH_DOMAIN:"agroscan-c6cbd.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-N35TXEBNV9",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"520364147553",REACT_APP_FIREBASE_PROJECT_ID:"agroscan-c6cbd",REACT_APP_FIREBASE_STORAGE_BUCKET:"agroscan-c6cbd.firebasestorage.app",REACT_APP_YOUTUBE_API_KEY:"AIzaSyDDJlg60fGLe4nuuNBaEkoUDmZJ6h9iB0A",REACT_APP_YOUTUBE_API_URL:"https://www.googleapis.com/youtube/v3"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(_se){return}const t=e&&lt(e[1]);return t&&JSON.parse(t)})()}catch(_se){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(_se))}},ht=e=>{var t,n;return null===(n=null===(t=dt())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},pt=e=>{const t=ht(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},ft=()=>{var e;return null===(e=dt())||void 0===e?void 0:e.config},mt=e=>{var t;return null===(t=dt())||void 0===t?void 0:t["_".concat(e)]};class gt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function vt(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,o=e.sub||e.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},e);return[ct(JSON.stringify({alg:"none",type:"JWT"})),ct(JSON.stringify(a)),""].join(".")}function yt(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function bt(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function xt(){try{return"object"===typeof indexedDB}catch(_se){return!1}}function wt(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{var e;t((null===(e=o.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class kt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,kt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,St.prototype.create)}}class St{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],o=r?function(e,t){return e.replace(It,((e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",a="".concat(this.serviceName,": ").concat(o," (").concat(n,").");return new kt(n,a,t)}}const It=/\{\$([^}]+)}/g;function Ct(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const o of n){if(!r.includes(o))return!1;const n=e[o],a=t[o];if(At(n)&&At(a)){if(!Ct(n,a))return!1}else if(n!==a)return!1}for(const o of r)if(!n.includes(o))return!1;return!0}function At(e){return null!==e&&"object"===typeof e}function Et(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Tt(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function Nt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Rt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=_t),void 0===r.error&&(r.error=_t),void 0===r.complete&&(r.complete=_t);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(_se){}})),this.observers.push(r),o}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(_se){"undefined"!==typeof console&&console.error&&console.error(_se)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function _t(){}function Dt(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),r=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+r)}function Ot(e){return e&&e._delegate?e._delegate:e}class Ft{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Mt="[DEFAULT]";class Pt{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new gt;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(_se){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(_se){if(r)return null;throw _se}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Mt})}catch(_se){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(_se){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(o)&&a.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),o=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;o.add(e),this.onInitCallbacks.set(r,o);const a=this.instances.get(r);return a&&e(a,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const o of n)try{o(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Lt(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(o){}return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt;return this.component?this.component.multipleInstances?e:Mt:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function Lt(e){return e===Mt?void 0:e}class zt{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Pt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Bt=[];var Ut;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Ut||(Ut={}));const Wt={debug:Ut.DEBUG,verbose:Ut.VERBOSE,info:Ut.INFO,warn:Ut.WARN,error:Ut.ERROR,silent:Ut.SILENT},jt=Ut.INFO,Vt={[Ut.DEBUG]:"log",[Ut.VERBOSE]:"log",[Ut.INFO]:"info",[Ut.WARN]:"warn",[Ut.ERROR]:"error"},Gt=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=Vt[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var o=arguments.length,a=new Array(o>2?o-2:0),i=2;i<o;i++)a[i-2]=arguments[i];console[r]("[".concat(n,"]  ").concat(e.name,":"),...a)};class Ht{constructor(e){this.name=e,this._logLevel=jt,this._logHandler=Gt,this._userLogHandler=null,Bt.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ut))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Wt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ut.DEBUG,...t),this._logHandler(this,Ut.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ut.VERBOSE,...t),this._logHandler(this,Ut.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ut.INFO,...t),this._logHandler(this,Ut.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ut.WARN,...t),this._logHandler(this,Ut.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ut.ERROR,...t),this._logHandler(this,Ut.ERROR,...t)}}let qt,Kt;const Xt=new WeakMap,Yt=new WeakMap,Qt=new WeakMap,Jt=new WeakMap,$t=new WeakMap;let Zt={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Yt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Qt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return nn(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function en(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Kt||(Kt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(rn(this),n),nn(Xt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return nn(e.apply(rn(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];const a=e.call(rn(this),t,...r);return Qt.set(a,t.sort?t.sort():[t]),nn(a)}}function tn(e){return"function"===typeof e?en(e):(e instanceof IDBTransaction&&function(e){if(Yt.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",a),e.removeEventListener("abort",a)},o=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",a),e.addEventListener("abort",a)}));Yt.set(e,t)}(e),t=e,(qt||(qt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,Zt):e);var t}function nn(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",a)},o=()=>{t(nn(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&Xt.set(t,e)})).catch((()=>{})),$t.set(t,e),t}(e);if(Jt.has(e))return Jt.get(e);const t=tn(e);return t!==e&&(Jt.set(e,t),$t.set(t,e)),t}const rn=e=>$t.get(e);const on=["get","getKey","getAll","getAllKeys","count"],an=["put","add","delete","clear"],sn=new Map;function cn(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(sn.get(t))return sn.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=an.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!on.includes(n))return;const a=async function(e){const t=this.transaction(e,o?"readwrite":"readonly");let a=t.store;for(var i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];return r&&(a=a.index(s.shift())),(await Promise.all([a[n](...s),o&&t.done]))[0]};return sn.set(t,a),a}Zt=(e=>ot(ot({},e),{},{get:(t,n,r)=>cn(t,n)||e.get(t,n,r),has:(t,n)=>!!cn(t,n)||e.has(t,n)}))(Zt);class ln{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const un="@firebase/app",dn="0.9.13",hn=new Ht("@firebase/app"),pn="@firebase/app-compat",fn="@firebase/analytics-compat",mn="@firebase/analytics",gn="@firebase/app-check-compat",vn="@firebase/app-check",yn="@firebase/auth",bn="@firebase/auth-compat",xn="@firebase/database",wn="@firebase/database-compat",kn="@firebase/functions",Sn="@firebase/functions-compat",In="@firebase/installations",Cn="@firebase/installations-compat",An="@firebase/messaging",En="@firebase/messaging-compat",Tn="@firebase/performance",Nn="@firebase/performance-compat",Rn="@firebase/remote-config",_n="@firebase/remote-config-compat",Dn="@firebase/storage",On="@firebase/storage-compat",Fn="@firebase/firestore",Mn="@firebase/firestore-compat",Pn="firebase",Ln="[DEFAULT]",zn={[un]:"fire-core",[pn]:"fire-core-compat",[mn]:"fire-analytics",[fn]:"fire-analytics-compat",[vn]:"fire-app-check",[gn]:"fire-app-check-compat",[yn]:"fire-auth",[bn]:"fire-auth-compat",[xn]:"fire-rtdb",[wn]:"fire-rtdb-compat",[kn]:"fire-fn",[Sn]:"fire-fn-compat",[In]:"fire-iid",[Cn]:"fire-iid-compat",[An]:"fire-fcm",[En]:"fire-fcm-compat",[Tn]:"fire-perf",[Nn]:"fire-perf-compat",[Rn]:"fire-rc",[_n]:"fire-rc-compat",[Dn]:"fire-gcs",[On]:"fire-gcs-compat",[Fn]:"fire-fst",[Mn]:"fire-fst-compat","fire-js":"fire-js",[Pn]:"fire-js-all"},Bn=new Map,Un=new Map;function Wn(e,t){try{e.container.addComponent(t)}catch(_se){hn.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),_se)}}function jn(e){const t=e.name;if(Un.has(t))return hn.debug("There were multiple attempts to register component ".concat(t,".")),!1;Un.set(t,e);for(const n of Bn.values())Wn(n,e);return!0}function Vn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const Gn=new St("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Hn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ft("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gn.create("app-deleted",{appName:this._name})}}const qn="9.23.0";function Kn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:Ln,automaticDataCollectionEnabled:!1},t),o=r.name;if("string"!==typeof o||!o)throw Gn.create("bad-app-name",{appName:String(o)});if(n||(n=ft()),!n)throw Gn.create("no-options");const a=Bn.get(o);if(a){if(Ct(n,a.options)&&Ct(r,a.config))return a;throw Gn.create("duplicate-app",{appName:o})}const i=new zt(o);for(const c of Un.values())i.addComponent(c);const s=new Hn(n,r,i);return Bn.set(o,s),s}function Xn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ln;const t=Bn.get(e);if(!t&&e===Ln&&ft())return Kn();if(!t)throw Gn.create("no-app",{appName:e});return t}function Yn(e,t,n){var r;let o=null!==(r=zn[e])&&void 0!==r?r:e;n&&(o+="-".concat(n));const a=o.match(/\s|\//),i=t.match(/\s|\//);if(a||i){const e=['Unable to register library "'.concat(o,'" with version "').concat(t,'":')];return a&&e.push('library name "'.concat(o,'" contains illegal characters (whitespace or "/")')),a&&i&&e.push("and"),i&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void hn.warn(e.join(" "))}jn(new Ft("".concat(o,"-version"),(()=>({library:o,version:t})),"VERSION"))}const Qn="firebase-heartbeat-store";let Jn=null;function $n(){return Jn||(Jn=function(e,t){let{blocked:n,upgrade:r,blocking:o,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),s=nn(i);return r&&i.addEventListener("upgradeneeded",(e=>{r(nn(i.result),e.oldVersion,e.newVersion,nn(i.transaction),e)})),n&&i.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),s.then((e=>{a&&e.addEventListener("close",(()=>a())),o&&e.addEventListener("versionchange",(e=>o(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),s}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Qn)}}).catch((e=>{throw Gn.create("idb-open",{originalErrorMessage:e.message})}))),Jn}async function Zn(e,t){try{const n=(await $n()).transaction(Qn,"readwrite"),r=n.objectStore(Qn);await r.put(t,er(e)),await n.done}catch(_se){if(_se instanceof kt)hn.warn(_se.message);else{const t=Gn.create("idb-set",{originalErrorMessage:null===_se||void 0===_se?void 0:_se.message});hn.warn(t.message)}}}function er(e){return"".concat(e.name,"!").concat(e.options.appId)}class tr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new rr(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=nr();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=nr(),{heartbeatsToSend:t,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const o of e){const e=n.find((e=>e.agent===o.agent));if(e){if(e.dates.push(o.date),or(n)>t){e.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),or(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=ct(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function nr(){return(new Date).toISOString().substring(0,10)}class rr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!xt()&&wt().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=await $n();return await t.transaction(Qn).objectStore(Qn).get(er(e))}catch(_se){if(_se instanceof kt)hn.warn(_se.message);else{const t=Gn.create("idb-get",{originalErrorMessage:null===_se||void 0===_se?void 0:_se.message});hn.warn(t.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Zn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Zn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function or(e){return ct(JSON.stringify({version:2,heartbeats:e})).length}var ar;ar="",jn(new Ft("platform-logger",(e=>new ln(e)),"PRIVATE")),jn(new Ft("heartbeat",(e=>new tr(e)),"PRIVATE")),Yn(un,dn,ar),Yn(un,dn,"esm2017"),Yn("fire-js","");Yn("firebase","9.23.0","app");var ir,sr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},cr={},lr=lr||{},ur=sr||self;function dr(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function hr(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var pr="closure_uid_"+(1e9*Math.random()>>>0),fr=0;function mr(e,t,n){return e.call.apply(e.bind,arguments)}function gr(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function vr(e,t,n){return(vr=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?mr:gr).apply(null,arguments)}function yr(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function br(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return t.prototype[n].apply(e,o)}}function xr(){this.s=this.s,this.o=this.o}xr.prototype.s=!1,xr.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,pr)&&e[pr]||(e[pr]=++fr))},xr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const wr=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function kr(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Sr(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(dr(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let o=0;o<r;o++)e[n+o]=t[o]}else e.push(t)}}function Ir(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Ir.prototype.h=function(){this.defaultPrevented=!0};var Cr=function(){if(!ur.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{ur.addEventListener("test",(()=>{}),t),ur.removeEventListener("test",(()=>{}),t)}catch(n){}return e}();function Ar(e){return/^[\s\xa0]*$/.test(e)}function Er(){var e=ur.navigator;return e&&(e=e.userAgent)?e:""}function Tr(e){return-1!=Er().indexOf(e)}function Nr(e){return Nr[" "](e),e}Nr[" "]=function(){};var Rr,_r,Dr=Tr("Opera"),Or=Tr("Trident")||Tr("MSIE"),Fr=Tr("Edge"),Mr=Fr||Or,Pr=Tr("Gecko")&&!(-1!=Er().toLowerCase().indexOf("webkit")&&!Tr("Edge"))&&!(Tr("Trident")||Tr("MSIE"))&&!Tr("Edge"),Lr=-1!=Er().toLowerCase().indexOf("webkit")&&!Tr("Edge");function zr(){var e=ur.document;return e?e.documentMode:void 0}e:{var Br="",Ur=function(){var e=Er();return Pr?/rv:([^\);]+)(\)|;)/.exec(e):Fr?/Edge\/([\d\.]+)/.exec(e):Or?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Lr?/WebKit\/(\S+)/.exec(e):Dr?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Ur&&(Br=Ur?Ur[1]:""),Or){var Wr=zr();if(null!=Wr&&Wr>parseFloat(Br)){Rr=String(Wr);break e}}Rr=Br}if(ur.document&&Or){var jr=zr();_r=jr||(parseInt(Rr,10)||void 0)}else _r=void 0;var Vr=_r;function Gr(e,t){if(Ir.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Pr){e:{try{Nr(t.nodeName);var o=!0;break e}catch(a){}o=!1}o||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:Hr[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Gr.$.h.call(this)}}br(Gr,Ir);var Hr={2:"touch",3:"pen",4:"mouse"};Gr.prototype.h=function(){Gr.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var qr="closure_listenable_"+(1e6*Math.random()|0),Kr=0;function Xr(e,t,n,r,o){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=o,this.key=++Kr,this.fa=this.ia=!1}function Yr(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Qr(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function Jr(e){const t={};for(const n in e)t[n]=e[n];return t}const $r="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Zr(e,t){let n,r;for(let o=1;o<arguments.length;o++){for(n in r=arguments[o],r)e[n]=r[n];for(let t=0;t<$r.length;t++)n=$r[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function eo(e){this.src=e,this.g={},this.h=0}function to(e,t){var n=t.type;if(n in e.g){var r,o=e.g[n],a=wr(o,t);(r=0<=a)&&Array.prototype.splice.call(o,a,1),r&&(Yr(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function no(e,t,n,r){for(var o=0;o<e.length;++o){var a=e[o];if(!a.fa&&a.listener==t&&a.capture==!!n&&a.la==r)return o}return-1}eo.prototype.add=function(e,t,n,r,o){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var i=no(e,t,r,o);return-1<i?(t=e[i],n||(t.ia=!1)):((t=new Xr(t,this.src,a,!!r,o)).ia=n,e.push(t)),t};var ro="closure_lm_"+(1e6*Math.random()|0),oo={};function ao(e,t,n,r,o){if(r&&r.once)return so(e,t,n,r,o);if(Array.isArray(t)){for(var a=0;a<t.length;a++)ao(e,t[a],n,r,o);return null}return n=mo(n),e&&e[qr]?e.O(t,n,hr(r)?!!r.capture:!!r,o):io(e,t,n,!1,r,o)}function io(e,t,n,r,o,a){if(!t)throw Error("Invalid event type");var i=hr(o)?!!o.capture:!!o,s=po(e);if(s||(e[ro]=s=new eo(e)),(n=s.add(t,n,r,i,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=ho;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Cr||(o=i),void 0===o&&(o=!1),e.addEventListener(t.toString(),r,o);else if(e.attachEvent)e.attachEvent(uo(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function so(e,t,n,r,o){if(Array.isArray(t)){for(var a=0;a<t.length;a++)so(e,t[a],n,r,o);return null}return n=mo(n),e&&e[qr]?e.P(t,n,hr(r)?!!r.capture:!!r,o):io(e,t,n,!0,r,o)}function co(e,t,n,r,o){if(Array.isArray(t))for(var a=0;a<t.length;a++)co(e,t[a],n,r,o);else r=hr(r)?!!r.capture:!!r,n=mo(n),e&&e[qr]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=no(a=e.g[t],n,r,o))&&(Yr(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=po(e))&&(t=e.g[t.toString()],e=-1,t&&(e=no(t,n,r,o)),(n=-1<e?t[e]:null)&&lo(n))}function lo(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[qr])to(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(uo(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=po(t))?(to(n,e),0==n.h&&(n.src=null,t[ro]=null)):Yr(e)}}}function uo(e){return e in oo?oo[e]:oo[e]="on"+e}function ho(e,t){if(e.fa)e=!0;else{t=new Gr(t,this);var n=e.listener,r=e.la||e.src;e.ia&&lo(e),e=n.call(r,t)}return e}function po(e){return(e=e[ro])instanceof eo?e:null}var fo="__closure_events_fn_"+(1e9*Math.random()>>>0);function mo(e){return"function"===typeof e?e:(e[fo]||(e[fo]=function(t){return e.handleEvent(t)}),e[fo])}function go(){xr.call(this),this.i=new eo(this),this.S=this,this.J=null}function vo(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new Ir(t,e);else if(t instanceof Ir)t.target=t.target||e;else{var o=t;Zr(t=new Ir(r,e),o)}if(o=!0,n)for(var a=n.length-1;0<=a;a--){var i=t.g=n[a];o=yo(i,r,!0,t)&&o}if(o=yo(i=t.g=e,r,!0,t)&&o,o=yo(i,r,!1,t)&&o,n)for(a=0;a<n.length;a++)o=yo(i=t.g=n[a],r,!1,t)&&o}function yo(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var o=!0,a=0;a<t.length;++a){var i=t[a];if(i&&!i.fa&&i.capture==n){var s=i.listener,c=i.la||i.src;i.ia&&to(e.i,i),o=!1!==s.call(c,r)&&o}}return o&&!r.defaultPrevented}br(go,xr),go.prototype[qr]=!0,go.prototype.removeEventListener=function(e,t,n,r){co(this,e,t,n,r)},go.prototype.N=function(){if(go.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Yr(n[r]);delete t.g[e],t.h--}}this.J=null},go.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},go.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var bo=ur.JSON.stringify;function xo(){var e=Eo;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var wo=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new ko),(e=>e.reset()));class ko{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function So(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Io(e){ur.setTimeout((()=>{throw e}),0)}let Co,Ao=!1,Eo=new class{constructor(){this.h=this.g=null}add(e,t){const n=wo.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},To=()=>{const e=ur.Promise.resolve(void 0);Co=()=>{e.then(No)}};var No=()=>{for(var e;e=xo();){try{e.h.call(e.g)}catch(n){Io(n)}var t=wo;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Ao=!1};function Ro(e,t){go.call(this),this.h=e||1,this.g=t||ur,this.j=vr(this.qb,this),this.l=Date.now()}function _o(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Do(e,t,n){if("function"===typeof e)n&&(e=vr(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=vr(e.handleEvent,e)}return 2147483647<Number(t)?-1:ur.setTimeout(e,t||0)}function Oo(e){e.g=Do((()=>{e.g=null,e.i&&(e.i=!1,Oo(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}br(Ro,go),(ir=Ro.prototype).ga=!1,ir.T=null,ir.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),vo(this,"tick"),this.ga&&(_o(this),this.start()))}},ir.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ir.N=function(){Ro.$.N.call(this),_o(this),delete this.g};class Fo extends xr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Oo(this)}N(){super.N(),this.g&&(ur.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mo(e){xr.call(this),this.h=e,this.g={}}br(Mo,xr);var Po=[];function Lo(e,t,n,r){Array.isArray(n)||(n&&(Po[0]=n.toString()),n=Po);for(var o=0;o<n.length;o++){var a=ao(t,n[o],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function zo(e){Qr(e.g,(function(e,t){this.g.hasOwnProperty(t)&&lo(e)}),e),e.g={}}function Bo(){this.g=!0}function Uo(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var o=r[1];if(Array.isArray(o)&&!(1>o.length)){var a=o[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var i=1;i<o.length;i++)o[i]=""}}}return bo(n)}catch(s){return t}}(e,n)+(r?" "+r:"")}))}Mo.prototype.N=function(){Mo.$.N.call(this),zo(this)},Mo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Bo.prototype.Ea=function(){this.g=!1},Bo.prototype.info=function(){};var Wo={},jo=null;function Vo(){return jo=jo||new go}function Go(e){Ir.call(this,Wo.Ta,e)}function Ho(e){const t=Vo();vo(t,new Go(t))}function qo(e,t){Ir.call(this,Wo.STAT_EVENT,e),this.stat=t}function Ko(e){const t=Vo();vo(t,new qo(t,e))}function Xo(e,t){Ir.call(this,Wo.Ua,e),this.size=t}function Yo(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return ur.setTimeout((function(){e()}),t)}Wo.Ta="serverreachability",br(Go,Ir),Wo.STAT_EVENT="statevent",br(qo,Ir),Wo.Ua="timingevent",br(Xo,Ir);var Qo={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Jo={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function $o(){}function Zo(e){return e.h||(e.h=e.i())}function ea(){}$o.prototype.h=null;var ta,na={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ra(){Ir.call(this,"d")}function oa(){Ir.call(this,"c")}function aa(){}function ia(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Mo(this),this.P=ca,e=Mr?125:void 0,this.V=new Ro(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new sa}function sa(){this.i=null,this.g="",this.h=!1}br(ra,Ir),br(oa,Ir),br(aa,$o),aa.prototype.g=function(){return new XMLHttpRequest},aa.prototype.i=function(){return{}},ta=new aa;var ca=45e3,la={},ua={};function da(e,t,n){e.L=1,e.v=Ra(Ca(t)),e.s=n,e.S=!0,ha(e,null)}function ha(e,t){e.G=Date.now(),ga(e),e.A=Ca(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),Va(n.i,"t",r),e.C=0,n=e.l.J,e.h=new sa,e.g=Gi(e.l,n?t:null,!e.s),0<e.O&&(e.M=new Fo(vr(e.Pa,e,e.g),e.O)),Lo(e.U,e.g,"readystatechange",e.nb),t=e.I?Jr(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Ho(),function(e,t,n,r,o,a){e.info((function(){if(e.g)if(a)for(var i="",s=a.split("&"),c=0;c<s.length;c++){var l=s[c].split("=");if(1<l.length){var u=l[0];l=l[1];var d=u.split("_");i=2<=d.length&&"type"==d[1]?i+(u+"=")+l+"&":i+(u+"=redacted&")}}else i=null;else i=a;return"XMLHTTP REQ ("+r+") [attempt "+o+"]: "+t+"\n"+n+"\n"+i}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function pa(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function fa(e,t,n){let r,o=!0;for(;!e.J&&e.C<n.length;){if(r=ma(e,n),r==ua){4==t&&(e.o=4,Ko(14),o=!1),Uo(e.j,e.m,null,"[Incomplete Response]");break}if(r==la){e.o=4,Ko(15),Uo(e.j,e.m,n,"[Invalid Chunk]"),o=!1;break}Uo(e.j,e.m,r,null),wa(e,r)}pa(e)&&r!=ua&&r!=la&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Ko(16),o=!1),e.i=e.i&&o,o?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Pi(t),t.M=!0,Ko(11))):(Uo(e.j,e.m,n,"[Invalid Chunked Response]"),xa(e),ba(e))}function ma(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?ua:(n=Number(t.substring(n,r)),isNaN(n)?la:(r+=1)+n>t.length?ua:(t=t.slice(r,r+n),e.C=r+n,t))}function ga(e){e.Y=Date.now()+e.P,va(e,e.P)}function va(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Yo(vr(e.lb,e),t)}function ya(e){e.B&&(ur.clearTimeout(e.B),e.B=null)}function ba(e){0==e.l.H||e.J||Bi(e.l,e)}function xa(e){ya(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,_o(e.V),zo(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function wa(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Qa(n.i,e)))if(!e.K&&Qa(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(l){r=null}if(Array.isArray(r)&&3==r.length){var o=r;if(0==o[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;zi(n),Ti(n)}Mi(n),Ko(18)}}else n.Fa=o[1],0<n.Fa-n.V&&37500>o[2]&&n.G&&0==n.A&&!n.v&&(n.v=Yo(vr(n.ib,n),6e3));if(1>=Ya(n.i)&&n.oa){try{n.oa()}catch(l){}n.oa=void 0}}else Wi(n,11)}else if((e.K||n.g==e)&&zi(n),!Ar(t))for(o=n.Ja.g.parse(t),t=0;t<o.length;t++){let l=o[t];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const t=l[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const o=l[4];null!=o&&(n.Ga=o,n.l.info("SVER="+n.Ga));const u=l[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=r.i;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(Ja(a,a.h),a.h=null))}if(r.F){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,Na(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var i=e;if((r=n).wa=Vi(r,r.J?r.pa:null,r.Y),i.K){$a(r.i,i);var s=i,c=r.L;c&&s.setTimeout(c),s.B&&(ya(s),ga(s)),r.g=i}else Fi(r);0<n.j.length&&Ri(n)}else"stop"!=l[0]&&"close"!=l[0]||Wi(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Wi(n,7):Ei(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}Ho()}catch(l){}}function ka(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(dr(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(dr(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(dr(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),o=r.length,a=0;a<o;a++)t.call(void 0,r[a],n&&n[a],e)}(ir=ia.prototype).setTimeout=function(e){this.P=e},ir.nb=function(e){e=e.target;const t=this.M;t&&3==wi(e)?t.l():this.Pa(e)},ir.Pa=function(e){try{if(e==this.g)e:{const u=wi(this.g);var t=this.g.Ia();this.g.da();if(!(3>u)&&(3!=u||Mr||this.g&&(this.h.h||this.g.ja()||ki(this.g)))){this.J||4!=u||7==t||Ho(),ya(this);var n=this.g.da();this.ca=n;t:if(pa(this)){var r=ki(this.g);e="";var o=r.length,a=4==wi(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){xa(this),ba(this);var i="";break t}this.h.i=new ur.TextDecoder}for(t=0;t<o;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:a&&t==o-1});r.splice(0,o),this.h.g+=e,this.C=0,i=this.h.g}else i=this.g.ja();if(this.i=200==n,function(e,t,n,r,o,a,i){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+o+"]: "+t+"\n"+n+"\n"+a+" "+i}))}(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var s,c=this.g;if((s=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ar(s)){var l=s;break t}}l=null}if(!(n=l)){this.i=!1,this.o=3,Ko(12),xa(this),ba(this);break e}Uo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wa(this,n)}this.S?(fa(this,u,i),Mr&&this.i&&3==u&&(Lo(this.U,this.V,"tick",this.mb),this.V.start())):(Uo(this.j,this.m,i,null),wa(this,i)),4==u&&xa(this),this.i&&!this.J&&(4==u?Bi(this.l,this):(this.i=!1,ga(this)))}else(function(e){const t={};e=(e.g&&2<=wi(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(Ar(e[r]))continue;var n=So(e[r]);const o=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const a=t[o]||[];t[o]=a,a.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<i.indexOf("Unknown SID")?(this.o=3,Ko(12)):(this.o=0,Ko(13)),xa(this),ba(this)}}}catch(u){}},ir.mb=function(){if(this.g){var e=wi(this.g),t=this.g.ja();this.C<t.length&&(ya(this),fa(this,e,t),this.i&&4!=e&&ga(this))}},ir.cancel=function(){this.J=!0,xa(this)},ir.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(Ho(),Ko(17)),xa(this),this.o=2,ba(this)):va(this,this.Y-e)};var Sa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ia(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Ia){this.h=e.h,Aa(this,e.j),this.s=e.s,this.g=e.g,Ea(this,e.m),this.l=e.l;var t=e.i,n=new Ba;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Ta(this,n),this.o=e.o}else e&&(t=String(e).match(Sa))?(this.h=!1,Aa(this,t[1]||"",!0),this.s=_a(t[2]||""),this.g=_a(t[3]||"",!0),Ea(this,t[4]),this.l=_a(t[5]||"",!0),Ta(this,t[6]||"",!0),this.o=_a(t[7]||"")):(this.h=!1,this.i=new Ba(null,this.h))}function Ca(e){return new Ia(e)}function Aa(e,t,n){e.j=n?_a(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ea(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Ta(e,t,n){t instanceof Ba?(e.i=t,function(e,t){t&&!e.j&&(Ua(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Wa(this,t),Va(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Da(t,La)),e.i=new Ba(t,e.h))}function Na(e,t,n){e.i.set(t,n)}function Ra(e){return Na(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function _a(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Da(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Oa),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Oa(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ia.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Da(t,Fa,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Da(t,Fa,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Da(n,"/"==n.charAt(0)?Pa:Ma,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Da(n,za)),e.join("")};var Fa=/[#\/\?@]/g,Ma=/[#\?:]/g,Pa=/[#\?]/g,La=/[#\?@]/g,za=/#/g;function Ba(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Ua(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),o=null;if(0<=r){var a=e[n].substring(0,r);o=e[n].substring(r+1)}else a=e[n];t(a,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Wa(e,t){Ua(e),t=Ga(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function ja(e,t){return Ua(e),t=Ga(e,t),e.g.has(t)}function Va(e,t,n){Wa(e,t),0<n.length&&(e.i=null,e.g.set(Ga(e,t),kr(n)),e.h+=n.length)}function Ga(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(ir=Ba.prototype).add=function(e,t){Ua(this),this.i=null,e=Ga(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},ir.forEach=function(e,t){Ua(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},ir.ta=function(){Ua(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const o=e[r];for(let e=0;e<o.length;e++)n.push(t[r])}return n},ir.Z=function(e){Ua(this);let t=[];if("string"===typeof e)ja(this,e)&&(t=t.concat(this.g.get(Ga(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},ir.set=function(e,t){return Ua(this),this.i=null,ja(this,e=Ga(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},ir.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},ir.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const a=encodeURIComponent(String(r)),i=this.Z(r);for(r=0;r<i.length;r++){var o=a;""!==i[r]&&(o+="="+encodeURIComponent(String(i[r]))),e.push(o)}}return this.i=e.join("&")};var Ha=class{constructor(e,t){this.g=e,this.map=t}};function qa(e){this.l=e||Ka,ur.PerformanceNavigationTiming?e=0<(e=ur.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(ur.g&&ur.g.Ka&&ur.g.Ka()&&ur.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ka=10;function Xa(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ya(e){return e.h?1:e.g?e.g.size:0}function Qa(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Ja(e,t){e.g?e.g.add(t):e.h=t}function $a(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Za(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return kr(e.i)}qa.prototype.cancel=function(){if(this.i=Za(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var ei,ti=class{stringify(e){return ur.JSON.stringify(e,void 0)}parse(e){return ur.JSON.parse(e,void 0)}};function ni(){this.g=new ti}function ri(e,t,n){const r=n||"";try{ka(e,(function(e,n){let o=e;hr(e)&&(o=bo(e)),t.push(r+n+"="+encodeURIComponent(o))}))}catch(_se){throw t.push(r+"type="+encodeURIComponent("_badmap")),_se}}function oi(e,t,n,r,o){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,o(r)}catch(a){}}function ai(e){this.l=e.fc||null,this.j=e.ob||!1}function ii(e,t){go.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=si,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}br(ai,$o),ai.prototype.g=function(){return new ii(this.l,this.j)},ai.prototype.i=(ei={},function(){return ei}),br(ii,go);var si=0;function ci(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function li(e){e.readyState=4,e.l=null,e.j=null,e.A=null,ui(e)}function ui(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(ir=ii.prototype).open=function(e,t){if(this.readyState!=si)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,ui(this)},ir.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||ur).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},ir.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,li(this)),this.readyState=si},ir.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,ui(this)),this.g&&(this.readyState=3,ui(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof ur.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ci(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},ir.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?li(this):ui(this),3==this.readyState&&ci(this)}},ir.Za=function(e){this.g&&(this.response=this.responseText=e,li(this))},ir.Ya=function(e){this.g&&(this.response=e,li(this))},ir.ka=function(){this.g&&li(this)},ir.setRequestHeader=function(e,t){this.v.append(e,t)},ir.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},ir.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ii.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var di=ur.JSON.parse;function hi(e){go.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=pi,this.L=this.M=!1}br(hi,go);var pi="",fi=/^https?$/i,mi=["POST","PUT"];function gi(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,vi(e),bi(e)}function vi(e){e.F||(e.F=!0,vo(e,"complete"),vo(e,"error"))}function yi(e){if(e.h&&"undefined"!=typeof lr&&(!e.C[1]||4!=wi(e)||2!=e.da()))if(e.v&&4==wi(e))Do(e.La,0,e);else if(vo(e,"readystatechange"),4==wi(e)){e.h=!1;try{const s=e.da();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===s){var o=String(e.I).match(Sa)[1]||null;!o&&ur.self&&ur.self.location&&(o=ur.self.location.protocol.slice(0,-1)),r=!fi.test(o?o.toLowerCase():"")}n=r}if(n)vo(e,"complete"),vo(e,"success");else{e.m=6;try{var a=2<wi(e)?e.g.statusText:""}catch(i){a=""}e.j=a+" ["+e.da()+"]",vi(e)}}finally{bi(e)}}}function bi(e,t){if(e.g){xi(e);const n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||vo(e,"ready");try{n.onreadystatechange=r}catch(_se){}}}function xi(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(ur.clearTimeout(e.A),e.A=null)}function wi(e){return e.g?e.g.readyState:0}function ki(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case pi:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Es){return null}}function Si(e){let t="";return Qr(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Ii(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Si(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Na(e,t,n))}function Ci(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Ai(e){this.Ga=0,this.j=[],this.l=new Bo,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Ci("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Ci("baseRetryDelayMs",5e3,e),this.hb=Ci("retryDelaySeedMs",1e4,e),this.eb=Ci("forwardChannelMaxRetries",2,e),this.xa=Ci("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new qa(e&&e.concurrentRequestLimit),this.Ja=new ni,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Ei(e){if(Ni(e),3==e.H){var t=e.W++,n=Ca(e.I);if(Na(n,"SID",e.K),Na(n,"RID",t),Na(n,"TYPE","terminate"),Di(e,n),(t=new ia(e,e.l,t)).L=2,t.v=Ra(Ca(n)),n=!1,ur.navigator&&ur.navigator.sendBeacon)try{n=ur.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&ur.Image&&((new Image).src=t.v,n=!0),n||(t.g=Gi(t.l,null),t.g.ha(t.v)),t.G=Date.now(),ga(t)}ji(e)}function Ti(e){e.g&&(Pi(e),e.g.cancel(),e.g=null)}function Ni(e){Ti(e),e.u&&(ur.clearTimeout(e.u),e.u=null),zi(e),e.i.cancel(),e.m&&("number"===typeof e.m&&ur.clearTimeout(e.m),e.m=null)}function Ri(e){if(!Xa(e.i)&&!e.m){e.m=!0;var t=e.Na;Co||To(),Ao||(Co(),Ao=!0),Eo.add(t,e),e.C=0}}function _i(e,t){var n;n=t?t.m:e.W++;const r=Ca(e.I);Na(r,"SID",e.K),Na(r,"RID",n),Na(r,"AID",e.V),Di(e,r),e.o&&e.s&&Ii(r,e.o,e.s),n=new ia(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Oi(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Ja(e.i,n),da(n,r,t)}function Di(e,t){e.na&&Qr(e.na,(function(e,n){Na(t,n,e)})),e.h&&ka({},(function(e,n){Na(t,n,e)}))}function Oi(e,t,n){n=Math.min(e.j.length,n);var r=e.h?vr(e.h.Va,e.h,e):null;e:{var o=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=o[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let i=0;i<n;i++){let n=o[i].g;const s=o[i].map;if(n-=t,0>n)t=Math.max(0,o[i].g-100),a=!1;else try{ri(s,e,"req"+n+"_")}catch(zs){r&&r(s)}}if(a){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function Fi(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Co||To(),Ao||(Co(),Ao=!0),Eo.add(t,e),e.A=0}}function Mi(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=Yo(vr(e.Ma,e),Ui(e,e.A)),e.A++,!0)}function Pi(e){null!=e.B&&(ur.clearTimeout(e.B),e.B=null)}function Li(e){e.g=new ia(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Ca(e.wa);Na(t,"RID","rpc"),Na(t,"SID",e.K),Na(t,"AID",e.V),Na(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Na(t,"TO",e.qa),Na(t,"TYPE","xmlhttp"),Di(e,t),e.o&&e.s&&Ii(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Ra(Ca(t)),n.s=null,n.S=!0,ha(n,e)}function zi(e){null!=e.v&&(ur.clearTimeout(e.v),e.v=null)}function Bi(e,t){var n=null;if(e.g==t){zi(e),Pi(e),e.g=null;var r=2}else{if(!Qa(e.i,t))return;n=t.F,$a(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var o=e.C;vo(r=Vo(),new Xo(r,n)),Ri(e)}else Fi(e);else if(3==(o=t.o)||0==o&&0<t.ca||!(1==r&&function(e,t){return!(Ya(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=Yo(vr(e.Na,e,t),Ui(e,e.C)),e.C++,!0))}(e,t)||2==r&&Mi(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),o){case 1:Wi(e,5);break;case 4:Wi(e,10);break;case 3:Wi(e,6);break;default:Wi(e,2)}}function Ui(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Wi(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=vr(e.pb,e);n||(n=new Ia("//www.google.com/images/cleardot.gif"),ur.location&&"http"==ur.location.protocol||Aa(n,"https"),Ra(n)),function(e,t){const n=new Bo;if(ur.Image){const r=new Image;r.onload=yr(oi,n,r,"TestLoadImage: loaded",!0,t),r.onerror=yr(oi,n,r,"TestLoadImage: error",!1,t),r.onabort=yr(oi,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=yr(oi,n,r,"TestLoadImage: timeout",!1,t),ur.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Ko(2);e.H=0,e.h&&e.h.za(t),ji(e),Ni(e)}function ji(e){if(e.H=0,e.ma=[],e.h){const t=Za(e.i);0==t.length&&0==e.j.length||(Sr(e.ma,t),Sr(e.ma,e.j),e.i.i.length=0,kr(e.j),e.j.length=0),e.h.ya()}}function Vi(e,t,n){var r=n instanceof Ia?Ca(n):new Ia(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Ea(r,r.m);else{var o=ur.location;r=o.protocol,t=t?t+"."+o.hostname:o.hostname,o=+o.port;var a=new Ia(null);r&&Aa(a,r),t&&(a.g=t),o&&Ea(a,o),n&&(a.l=n),r=a}return n=e.F,t=e.Da,n&&t&&Na(r,n,t),Na(r,"VER",e.ra),Di(e,r),r}function Gi(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new hi(new ai({ob:!0})):new hi(e.va)).Oa(e.J),t}function Hi(){}function qi(){if(Or&&!(10<=Number(Vr)))throw Error("Environmental error: no available transport.")}function Ki(e,t){go.call(this),this.g=new Ai(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Ar(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Ar(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Qi(this)}function Xi(e){ra.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Yi(){oa.call(this),this.status=1}function Qi(e){this.g=e}function Ji(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function $i(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var o=0;16>o;++o)r[o]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(o=0;16>o;++o)r[o]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],o=e.g[2];var a=e.g[3],i=t+(a^n&(o^a))+r[0]+3614090360&4294967295;i=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=(n=(o=(a=(t=n+(i<<7&4294967295|i>>>25))+((i=a+(o^t&(n^o))+r[1]+3905402710&4294967295)<<12&4294967295|i>>>20))+((i=o+(n^a&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^o&(a^t))+r[3]+3250441966&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^n&(o^a))+r[4]+4118548399&4294967295)<<7&4294967295|i>>>25))+((i=a+(o^t&(n^o))+r[5]+1200080426&4294967295)<<12&4294967295|i>>>20))+((i=o+(n^a&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^o&(a^t))+r[7]+4249261313&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^n&(o^a))+r[8]+1770035416&4294967295)<<7&4294967295|i>>>25))+((i=a+(o^t&(n^o))+r[9]+2336552879&4294967295)<<12&4294967295|i>>>20))+((i=o+(n^a&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^o&(a^t))+r[11]+2304563134&4294967295)<<22&4294967295|i>>>10))+((i=t+(a^n&(o^a))+r[12]+1804603682&4294967295)<<7&4294967295|i>>>25))+((i=a+(o^t&(n^o))+r[13]+4254626195&4294967295)<<12&4294967295|i>>>20))+((i=o+(n^a&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|i>>>15))+((i=n+(t^o&(a^t))+r[15]+1236535329&4294967295)<<22&4294967295|i>>>10))+((i=t+(o^a&(n^o))+r[1]+4129170786&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^o&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|i>>>23))+((i=o+(t^n&(a^t))+r[11]+643717713&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(o^a))+r[0]+3921069994&4294967295)<<20&4294967295|i>>>12))+((i=t+(o^a&(n^o))+r[5]+3593408605&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^o&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|i>>>23))+((i=o+(t^n&(a^t))+r[15]+3634488961&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(o^a))+r[4]+3889429448&4294967295)<<20&4294967295|i>>>12))+((i=t+(o^a&(n^o))+r[9]+568446438&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^o&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|i>>>23))+((i=o+(t^n&(a^t))+r[3]+4107603335&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(o^a))+r[8]+1163531501&4294967295)<<20&4294967295|i>>>12))+((i=t+(o^a&(n^o))+r[13]+2850285829&4294967295)<<5&4294967295|i>>>27))+((i=a+(n^o&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|i>>>23))+((i=o+(t^n&(a^t))+r[7]+1735328473&4294967295)<<14&4294967295|i>>>18))+((i=n+(a^t&(o^a))+r[12]+2368359562&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^o^a)+r[5]+4294588738&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^o)+r[8]+2272392833&4294967295)<<11&4294967295|i>>>21))+((i=o+(a^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|i>>>16))+((i=n+(o^a^t)+r[14]+4259657740&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^o^a)+r[1]+2763975236&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^o)+r[4]+1272893353&4294967295)<<11&4294967295|i>>>21))+((i=o+(a^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|i>>>16))+((i=n+(o^a^t)+r[10]+3200236656&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^o^a)+r[13]+681279174&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^o)+r[0]+3936430074&4294967295)<<11&4294967295|i>>>21))+((i=o+(a^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|i>>>16))+((i=n+(o^a^t)+r[6]+76029189&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^o^a)+r[9]+3654602809&4294967295)<<4&4294967295|i>>>28))+((i=a+(t^n^o)+r[12]+3873151461&4294967295)<<11&4294967295|i>>>21))+((i=o+(a^t^n)+r[15]+530742520&4294967295)<<16&4294967295|i>>>16))+((i=n+(o^a^t)+r[2]+3299628645&4294967295)<<23&4294967295|i>>>9))+((i=t+(o^(n|~a))+r[0]+4096336452&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~o))+r[7]+1126891415&4294967295)<<10&4294967295|i>>>22))+((i=o+(t^(a|~n))+r[14]+2878612391&4294967295)<<15&4294967295|i>>>17))+((i=n+(a^(o|~t))+r[5]+4237533241&4294967295)<<21&4294967295|i>>>11))+((i=t+(o^(n|~a))+r[12]+1700485571&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~o))+r[3]+2399980690&4294967295)<<10&4294967295|i>>>22))+((i=o+(t^(a|~n))+r[10]+4293915773&4294967295)<<15&4294967295|i>>>17))+((i=n+(a^(o|~t))+r[1]+2240044497&4294967295)<<21&4294967295|i>>>11))+((i=t+(o^(n|~a))+r[8]+1873313359&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~o))+r[15]+4264355552&4294967295)<<10&4294967295|i>>>22))+((i=o+(t^(a|~n))+r[6]+2734768916&4294967295)<<15&4294967295|i>>>17))+((i=n+(a^(o|~t))+r[13]+1309151649&4294967295)<<21&4294967295|i>>>11))+((a=(t=n+((i=t+(o^(n|~a))+r[4]+4149444226&4294967295)<<6&4294967295|i>>>26))+((i=a+(n^(t|~o))+r[11]+3174756917&4294967295)<<10&4294967295|i>>>22))^((o=a+((i=o+(t^(a|~n))+r[2]+718787259&4294967295)<<15&4294967295|i>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(o+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+o&4294967295,e.g[3]=e.g[3]+a&4294967295}function Zi(e,t){this.h=t;for(var n=[],r=!0,o=e.length-1;0<=o;o--){var a=0|e[o];r&&a==t||(n[o]=a,r=!1)}this.g=n}(ir=hi.prototype).Oa=function(e){this.M=e},ir.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ta.g(),this.C=this.u?Zo(this.u):Zo(ta),this.g.onreadystatechange=vr(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(a){return void gi(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var o in r)n.set(o,r[o]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),o=ur.FormData&&e instanceof ur.FormData,!(0<=wr(mi,t))||r||o||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,s]of n)this.g.setRequestHeader(i,s);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{xi(this),0<this.B&&((this.L=function(e){return Or&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=vr(this.ua,this)):this.A=Do(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){gi(this,a)}},ir.ua=function(){"undefined"!=typeof lr&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,vo(this,"timeout"),this.abort(8))},ir.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,vo(this,"complete"),vo(this,"abort"),bi(this))},ir.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),bi(this,!0)),hi.$.N.call(this)},ir.La=function(){this.s||(this.G||this.v||this.l?yi(this):this.kb())},ir.kb=function(){yi(this)},ir.isActive=function(){return!!this.g},ir.da=function(){try{return 2<wi(this)?this.g.status:-1}catch(ei){return-1}},ir.ja=function(){try{return this.g?this.g.responseText:""}catch(ei){return""}},ir.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),di(t)}},ir.Ia=function(){return this.m},ir.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(ir=Ai.prototype).ra=8,ir.H=1,ir.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const o=new ia(this,this.l,e);let a=this.s;if(this.U&&(a?(a=Jr(a),Zr(a,this.U)):a=this.U),null!==this.o||this.O||(o.I=a,a=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Oi(this,o,t),Na(n=Ca(this.I),"RID",e),Na(n,"CVER",22),this.F&&Na(n,"X-HTTP-Session-Id",this.F),Di(this,n),a&&(this.O?t="headers="+encodeURIComponent(String(Si(a)))+"&"+t:this.o&&Ii(n,this.o,a)),Ja(this.i,o),this.bb&&Na(n,"TYPE","init"),this.P?(Na(n,"$req",t),Na(n,"SID","null"),o.aa=!0,da(o,n,null)):da(o,n,t),this.H=2}}else 3==this.H&&(e?_i(this,e):0==this.j.length||Xa(this.i)||_i(this))},ir.Ma=function(){if(this.u=null,Li(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Yo(vr(this.jb,this),e)}},ir.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Ko(10),Ti(this),Li(this))},ir.ib=function(){null!=this.v&&(this.v=null,Ti(this),Mi(this),Ko(19))},ir.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Ko(2)):(this.l.info("Failed to ping google.com"),Ko(1))},ir.isActive=function(){return!!this.h&&this.h.isActive(this)},(ir=Hi.prototype).Ba=function(){},ir.Aa=function(){},ir.za=function(){},ir.ya=function(){},ir.isActive=function(){return!0},ir.Va=function(){},qi.prototype.g=function(e,t){return new Ki(e,t)},br(Ki,go),Ki.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Ko(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Vi(e,null,e.Y),Ri(e)},Ki.prototype.close=function(){Ei(this.g)},Ki.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=bo(e),e=n);t.j.push(new Ha(t.fb++,e)),3==t.H&&Ri(t)},Ki.prototype.N=function(){this.g.h=null,delete this.j,Ei(this.g),delete this.g,Ki.$.N.call(this)},br(Xi,ra),br(Yi,oa),br(Qi,Hi),Qi.prototype.Ba=function(){vo(this.g,"a")},Qi.prototype.Aa=function(e){vo(this.g,new Xi(e))},Qi.prototype.za=function(e){vo(this.g,new Yi)},Qi.prototype.ya=function(){vo(this.g,"b")},br(Ji,(function(){this.blockSize=-1})),Ji.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ji.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,o=this.h,a=0;a<t;){if(0==o)for(;a<=n;)$i(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(r[o++]=e.charCodeAt(a++),o==this.blockSize){$i(this,r),o=0;break}}else for(;a<t;)if(r[o++]=e[a++],o==this.blockSize){$i(this,r),o=0;break}}this.h=o,this.i+=t},Ji.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var es={};function ts(e){return-128<=e&&128>e?function(e,t){var n=es;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new Zi([0|e],0>e?-1:0)})):new Zi([0|e],0>e?-1:0)}function ns(e){if(isNaN(e)||!isFinite(e))return os;if(0>e)return ls(ns(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=rs;return new Zi(t,0)}var rs=4294967296,os=ts(0),as=ts(1),is=ts(16777216);function ss(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function cs(e){return-1==e.h}function ls(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new Zi(n,~e.h).add(as)}function us(e,t){return e.add(ls(t))}function ds(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function hs(e,t){this.g=e,this.h=t}function ps(e,t){if(ss(t))throw Error("division by zero");if(ss(e))return new hs(os,os);if(cs(e))return t=ps(ls(e),t),new hs(ls(t.g),ls(t.h));if(cs(t))return t=ps(e,ls(t)),new hs(ls(t.g),t.h);if(30<e.g.length){if(cs(e)||cs(t))throw Error("slowDivide_ only works with positive integers.");for(var n=as,r=t;0>=r.X(e);)n=fs(n),r=fs(r);var o=ms(n,1),a=ms(r,1);for(r=ms(r,2),n=ms(n,2);!ss(r);){var i=a.add(r);0>=i.X(e)&&(o=o.add(n),a=i),r=ms(r,1),n=ms(n,1)}return t=us(e,o.R(t)),new hs(o,t)}for(o=os;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),i=(a=ns(n)).R(t);cs(i)||0<i.X(e);)i=(a=ns(n-=r)).R(t);ss(a)&&(a=as),o=o.add(a),e=us(e,i)}return new hs(o,e)}function fs(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new Zi(n,e.h)}function ms(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,o=[],a=0;a<r;a++)o[a]=0<t?e.D(a+n)>>>t|e.D(a+n+1)<<32-t:e.D(a+n);return new Zi(o,e.h)}(ir=Zi.prototype).ea=function(){if(cs(this))return-ls(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:rs+r)*t,t*=rs}return e},ir.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(ss(this))return"0";if(cs(this))return"-"+ls(this).toString(e);for(var t=ns(Math.pow(e,6)),n=this,r="";;){var o=ps(n,t).g,a=((0<(n=us(n,o.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(ss(n=o))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},ir.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},ir.X=function(e){return cs(e=us(this,e))?-1:ss(e)?0:1},ir.abs=function(){return cs(this)?ls(this):this},ir.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,o=0;o<=t;o++){var a=r+(65535&this.D(o))+(65535&e.D(o)),i=(a>>>16)+(this.D(o)>>>16)+(e.D(o)>>>16);r=i>>>16,a&=65535,i&=65535,n[o]=i<<16|a}return new Zi(n,-2147483648&n[n.length-1]?-1:0)},ir.R=function(e){if(ss(this)||ss(e))return os;if(cs(this))return cs(e)?ls(this).R(ls(e)):ls(ls(this).R(e));if(cs(e))return ls(this.R(ls(e)));if(0>this.X(is)&&0>e.X(is))return ns(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var o=0;o<e.g.length;o++){var a=this.D(r)>>>16,i=65535&this.D(r),s=e.D(o)>>>16,c=65535&e.D(o);n[2*r+2*o]+=i*c,ds(n,2*r+2*o),n[2*r+2*o+1]+=a*c,ds(n,2*r+2*o+1),n[2*r+2*o+1]+=i*s,ds(n,2*r+2*o+1),n[2*r+2*o+2]+=a*s,ds(n,2*r+2*o+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new Zi(n,0)},ir.gb=function(e){return ps(this,e).h},ir.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new Zi(n,this.h&e.h)},ir.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new Zi(n,this.h|e.h)},ir.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new Zi(n,this.h^e.h)},qi.prototype.createWebChannel=qi.prototype.g,Ki.prototype.send=Ki.prototype.u,Ki.prototype.open=Ki.prototype.m,Ki.prototype.close=Ki.prototype.close,Qo.NO_ERROR=0,Qo.TIMEOUT=8,Qo.HTTP_ERROR=6,Jo.COMPLETE="complete",ea.EventType=na,na.OPEN="a",na.CLOSE="b",na.ERROR="c",na.MESSAGE="d",go.prototype.listen=go.prototype.O,hi.prototype.listenOnce=hi.prototype.P,hi.prototype.getLastError=hi.prototype.Sa,hi.prototype.getLastErrorCode=hi.prototype.Ia,hi.prototype.getStatus=hi.prototype.da,hi.prototype.getResponseJson=hi.prototype.Wa,hi.prototype.getResponseText=hi.prototype.ja,hi.prototype.send=hi.prototype.ha,hi.prototype.setWithCredentials=hi.prototype.Oa,Ji.prototype.digest=Ji.prototype.l,Ji.prototype.reset=Ji.prototype.reset,Ji.prototype.update=Ji.prototype.j,Zi.prototype.add=Zi.prototype.add,Zi.prototype.multiply=Zi.prototype.R,Zi.prototype.modulo=Zi.prototype.gb,Zi.prototype.compare=Zi.prototype.X,Zi.prototype.toNumber=Zi.prototype.ea,Zi.prototype.toString=Zi.prototype.toString,Zi.prototype.getBits=Zi.prototype.D,Zi.fromNumber=ns,Zi.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return ls(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=ns(Math.pow(n,8)),o=os,a=0;a<t.length;a+=8){var i=Math.min(8,t.length-a),s=parseInt(t.substring(a,a+i),n);8>i?(i=ns(Math.pow(n,i)),o=o.R(i).add(ns(s))):o=(o=o.R(r)).add(ns(s))}return o};var gs=cr.createWebChannelTransport=function(){return new qi},vs=cr.getStatEventTarget=function(){return Vo()},ys=cr.ErrorCode=Qo,bs=cr.EventType=Jo,xs=cr.Event=Wo,ws=cr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ks=cr.FetchXmlHttpFactory=ai,Ss=cr.WebChannel=ea,Is=cr.XhrIo=hi,Cs=cr.Md5=Ji,As=cr.Integer=Zi;const Es="@firebase/firestore";class Ts{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ts.UNAUTHENTICATED=new Ts(null),Ts.GOOGLE_CREDENTIALS=new Ts("google-credentials-uid"),Ts.FIRST_PARTY=new Ts("first-party-uid"),Ts.MOCK_USER=new Ts("mock-user");let Ns="9.23.0";const Rs=new Ht("@firebase/firestore");function _s(){return Rs.logLevel}function Ds(e){if(Rs.logLevel<=Ut.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const o=n.map(Ms);Rs.debug("Firestore (".concat(Ns,"): ").concat(e),...o)}}function Os(e){if(Rs.logLevel<=Ut.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const o=n.map(Ms);Rs.error("Firestore (".concat(Ns,"): ").concat(e),...o)}}function Fs(e){if(Rs.logLevel<=Ut.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const o=n.map(Ms);Rs.warn("Firestore (".concat(Ns,"): ").concat(e),...o)}}function Ms(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Ps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(Ns,") INTERNAL ASSERTION FAILED: ")+e;throw Os(t),new Error(t)}function Ls(e,t){e||Ps()}function zs(e,t){return e}const Bs={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Us extends kt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Ws{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class js{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class Vs{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ts.UNAUTHENTICATED)))}shutdown(){}}class Gs{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Hs{constructor(e){this.t=e,this.currentUser=Ts.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let o=new Ws;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ws,e.enqueueRetryable((()=>r(this.currentUser)))};const a=()=>{const t=o;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},i=e=>{Ds("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit((e=>i(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?i(e):(Ds("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ws)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Ds("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Ls("string"==typeof t.accessToken),new js(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ls(null===e||"string"==typeof e),new Ts(e)}}class qs{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=Ts.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Ks{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new qs(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(Ts.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Xs{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ys{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&Ds("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.T;return this.T=e.token,Ds("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{Ds("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?r(e):Ds("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Ls("string"==typeof e.token),this.T=e.token,new Xs(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Qs(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Js{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=Qs(40);for(let o=0;o<r.length;++o)n.length<20&&r[o]<t&&(n+=e.charAt(r[o]%62))}return n}}function $s(e,t){return e<t?-1:e>t?1:0}function Zs(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class ec{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Us(Bs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Us(Bs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Us(Bs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Us(Bs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ec.fromMillis(Date.now())}static fromDate(e){return ec.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new ec(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$s(this.nanoseconds,e.nanoseconds):$s(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class tc{constructor(e){this.timestamp=e}static fromTimestamp(e){return new tc(e)}static min(){return new tc(new ec(0,0))}static max(){return new tc(new ec(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class nc{constructor(e,t,n){void 0===t?t=0:t>e.length&&Ps(),void 0===n?n=e.length-t:n>e.length-t&&Ps(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===nc.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof nc?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),o=t.get(r);if(n<o)return-1;if(n>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class rc extends nc{construct(e,t,n){return new rc(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const o of n){if(o.indexOf("//")>=0)throw new Us(Bs.INVALID_ARGUMENT,"Invalid segment (".concat(o,"). Paths must not contain // in them."));e.push(...o.split("/").filter((e=>e.length>0)))}return new rc(e)}static emptyPath(){return new rc([])}}const oc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ac extends nc{construct(e,t,n){return new ac(e,t,n)}static isValidIdentifier(e){return oc.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ac.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ac(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const o=()=>{if(0===n.length)throw new Us(Bs.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let a=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Us(Bs.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Us(Bs.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(a=!a,r++):"."!==t||a?(n+=t,r++):(o(),r++)}if(o(),a)throw new Us(Bs.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ac(t)}static emptyPath(){return new ac([])}}class ic{constructor(e){this.path=e}static fromPath(e){return new ic(rc.fromString(e))}static fromName(e){return new ic(rc.fromString(e).popFirst(5))}static empty(){return new ic(rc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===rc.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return rc.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ic(new rc(e.slice()))}}class sc{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}sc.UNKNOWN_ID=-1;function cc(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,o=tc.fromTimestamp(1e9===r?new ec(n+1,0):new ec(n,r));return new uc(o,ic.empty(),t)}function lc(e){return new uc(e.readTime,e.key,-1)}class uc{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new uc(tc.min(),ic.empty(),-1)}static max(){return new uc(tc.max(),ic.empty(),-1)}}function dc(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ic.comparator(e.documentKey,t.documentKey),0!==n?n:$s(e.largestBatchId,t.largestBatchId))}const hc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pc{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function fc(e){if(e.code!==Bs.FAILED_PRECONDITION||e.message!==hc)throw e;Ds("LocalStore","Unexpectedly lost primary lease")}class mc{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ps(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new mc(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof mc?t:mc.resolve(t)}catch(e){return mc.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):mc.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):mc.reject(t)}static resolve(e){return new mc(((t,n)=>{t(e)}))}static reject(e){return new mc(((t,n)=>{n(e)}))}static waitFor(e){return new mc(((t,n)=>{let r=0,o=0,a=!1;e.forEach((e=>{++r,e.next((()=>{++o,a&&o===r&&t()}),(e=>n(e)))})),a=!0,o===r&&t()}))}static or(e){let t=mc.resolve(!1);for(const n of e)t=t.next((e=>e?mc.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new mc(((n,r)=>{const o=e.length,a=new Array(o);let i=0;for(let s=0;s<o;s++){const c=s;t(e[c]).next((e=>{a[c]=e,++i,i===o&&n(a)}),(e=>r(e)))}}))}static doWhile(e,t){return new mc(((n,r)=>{const o=()=>{!0===e()?t().next((()=>{o()}),r):n()};o()}))}}function gc(e){return"IndexedDbTransactionError"===e.name}class vc{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function yc(e){return null==e}function bc(e){return 0===e&&1/e==-1/0}function xc(e){return"number"==typeof e&&Number.isInteger(e)&&!bc(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}vc.ct=-1;const wc=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],kc=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Sc=kc;function Ic(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Cc(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Ac(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ec{constructor(e,t){this.comparator=e,this.root=t||Nc.EMPTY}insert(e,t){return new Ec(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Nc.BLACK,null,null))}remove(e){return new Ec(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nc.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push("".concat(t,":").concat(n)),!1))),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tc(this.root,e,this.comparator,!0)}}class Tc{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(0===o){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nc{constructor(e,t,n,r,o){this.key=e,this.value=t,this.color=null!=n?n:Nc.RED,this.left=null!=r?r:Nc.EMPTY,this.right=null!=o?o:Nc.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,o){return new Nc(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=o?o:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const o=n(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===o?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Nc.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Nc.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nc.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ps();if(this.right.isRed())throw Ps();const e=this.left.check();if(e!==this.right.check())throw Ps();return e+(this.isRed()?0:1)}}Nc.EMPTY=null,Nc.RED=!0,Nc.BLACK=!1,Nc.EMPTY=new class{constructor(){this.size=0}get key(){throw Ps()}get value(){throw Ps()}get color(){throw Ps()}get left(){throw Ps()}get right(){throw Ps()}copy(e,t,n,r,o){return this}insert(e,t,n){return new Nc(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Rc{constructor(e){this.comparator=e,this.data=new Ec(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _c(this.data.getIterator())}getIteratorFrom(e){return new _c(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Rc))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Rc(this.comparator);return t.data=e,t}}class _c{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Dc{constructor(e){this.fields=e,e.sort(ac.comparator)}static empty(){return new Dc([])}unionWith(e){let t=new Rc(ac.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Dc(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Zs(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Oc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Fc{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Oc("Invalid base64 string: "+e):e}}(e);return new Fc(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Fc(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $s(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fc.EMPTY_BYTE_STRING=new Fc("");const Mc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pc(e){if(Ls(!!e),"string"==typeof e){let t=0;const n=Mc.exec(e);if(Ls(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Lc(e.seconds),nanos:Lc(e.nanos)}}function Lc(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function zc(e){return"string"==typeof e?Fc.fromBase64String(e):Fc.fromUint8Array(e)}function Bc(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Uc(e){const t=e.mapValue.fields.__previous_value__;return Bc(t)?Uc(t):t}function Wc(e){const t=Pc(e.mapValue.fields.__local_write_time__.timestampValue);return new ec(t.seconds,t.nanos)}class jc{constructor(e,t,n,r,o,a,i,s,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=i,this.longPollingOptions=s,this.useFetchStreams=c}}class Vc{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Vc("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Vc&&e.projectId===this.projectId&&e.database===this.database}}const Gc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Hc(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Bc(e)?4:al(e)?9007199254740991:10:Ps()}function qc(e,t){if(e===t)return!0;const n=Hc(e);if(n!==Hc(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Wc(e).isEqual(Wc(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Pc(e.timestampValue),r=Pc(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return zc(e.bytesValue).isEqual(zc(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Lc(e.geoPointValue.latitude)===Lc(t.geoPointValue.latitude)&&Lc(e.geoPointValue.longitude)===Lc(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Lc(e.integerValue)===Lc(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Lc(e.doubleValue),r=Lc(t.doubleValue);return n===r?bc(n)===bc(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Zs(e.arrayValue.values||[],t.arrayValue.values||[],qc);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Ic(n)!==Ic(r))return!1;for(const o in n)if(n.hasOwnProperty(o)&&(void 0===r[o]||!qc(n[o],r[o])))return!1;return!0}(e,t);default:return Ps()}}function Kc(e,t){return void 0!==(e.values||[]).find((e=>qc(e,t)))}function Xc(e,t){if(e===t)return 0;const n=Hc(e),r=Hc(t);if(n!==r)return $s(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return $s(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Lc(e.integerValue||e.doubleValue),r=Lc(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Yc(e.timestampValue,t.timestampValue);case 4:return Yc(Wc(e),Wc(t));case 5:return $s(e.stringValue,t.stringValue);case 6:return function(e,t){const n=zc(e),r=zc(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let o=0;o<n.length&&o<r.length;o++){const e=$s(n[o],r[o]);if(0!==e)return e}return $s(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=$s(Lc(e.latitude),Lc(t.latitude));return 0!==n?n:$s(Lc(e.longitude),Lc(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let o=0;o<n.length&&o<r.length;++o){const e=Xc(n[o],r[o]);if(e)return e}return $s(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Gc.mapValue&&t===Gc.mapValue)return 0;if(e===Gc.mapValue)return 1;if(t===Gc.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),o=t.fields||{},a=Object.keys(o);r.sort(),a.sort();for(let i=0;i<r.length&&i<a.length;++i){const e=$s(r[i],a[i]);if(0!==e)return e;const t=Xc(n[r[i]],o[a[i]]);if(0!==t)return t}return $s(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Ps()}}function Yc(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return $s(e,t);const n=Pc(e),r=Pc(t),o=$s(n.seconds,r.seconds);return 0!==o?o:$s(n.nanos,r.nanos)}function Qc(e){return Jc(e)}function Jc(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Pc(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?zc(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,ic.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Jc(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const o of t)r?r=!1:n+=",",n+="".concat(o,":").concat(Jc(e.fields[o]));return n+"}"}(e.mapValue):Ps();var t,n}function $c(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Zc(e){return!!e&&"integerValue"in e}function el(e){return!!e&&"arrayValue"in e}function tl(e){return!!e&&"nullValue"in e}function nl(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function rl(e){return!!e&&"mapValue"in e}function ol(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Cc(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ol(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ol(e.arrayValue.values[n]);return t}return Object.assign({},e)}function al(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class il{constructor(e){this.value=e}static empty(){return new il({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!rl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ol(t)}setAll(e){let t=ac.emptyPath(),n={},r=[];e.forEach(((e,o)=>{if(!t.isImmediateParentOf(o)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=o.popLast()}e?n[o.lastSegment()]=ol(e):r.push(o.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,n,r)}delete(e){const t=this.field(e.popLast());rl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];rl(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Cc(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new il(ol(this.value))}}function sl(e){const t=[];return Cc(e.fields,((e,n)=>{const r=new ac([e]);if(rl(n)){const e=sl(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Dc(t)}class cl{constructor(e,t,n,r,o,a,i){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=o,this.data=a,this.documentState=i}static newInvalidDocument(e){return new cl(e,0,tc.min(),tc.min(),tc.min(),il.empty(),0)}static newFoundDocument(e,t,n,r){return new cl(e,1,t,tc.min(),n,r,0)}static newNoDocument(e,t){return new cl(e,2,t,tc.min(),tc.min(),il.empty(),0)}static newUnknownDocument(e,t){return new cl(e,3,t,tc.min(),tc.min(),il.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(tc.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=il.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=il.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tc.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof cl&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cl(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ll{constructor(e,t){this.position=e,this.inclusive=t}}function ul(e,t,n){let r=0;for(let o=0;o<e.position.length;o++){const a=t[o],i=e.position[o];if(r=a.field.isKeyField()?ic.comparator(ic.fromName(i.referenceValue),n.key):Xc(i,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function dl(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!qc(e.position[n],t.position[n]))return!1;return!0}class hl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function pl(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class fl{}class ml extends fl{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Sl(e,t,n):"array-contains"===t?new El(e,n):"in"===t?new Tl(e,n):"not-in"===t?new Nl(e,n):"array-contains-any"===t?new Rl(e,n):new ml(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Il(e,n):new Cl(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Xc(t,this.value)):null!==t&&Hc(this.value)===Hc(t)&&this.matchesComparison(Xc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ps()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class gl extends fl{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new gl(e,t)}matches(e){return vl(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft((e=>e.isInequality()));return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function vl(e){return"and"===e.op}function yl(e){return bl(e)&&vl(e)}function bl(e){for(const t of e.filters)if(t instanceof gl)return!1;return!0}function xl(e){if(e instanceof ml)return e.field.canonicalString()+e.op.toString()+Qc(e.value);if(yl(e))return e.filters.map((e=>xl(e))).join(",");{const t=e.filters.map((e=>xl(e))).join(",");return"".concat(e.op,"(").concat(t,")")}}function wl(e,t){return e instanceof ml?function(e,t){return t instanceof ml&&e.op===t.op&&e.field.isEqual(t.field)&&qc(e.value,t.value)}(e,t):e instanceof gl?function(e,t){return t instanceof gl&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&wl(n,t.filters[r])),!0)}(e,t):void Ps()}function kl(e){return e instanceof ml?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Qc(e.value))}(e):e instanceof gl?function(e){return e.op.toString()+" {"+e.getFilters().map(kl).join(" ,")+"}"}(e):"Filter"}class Sl extends ml{constructor(e,t,n){super(e,t,n),this.key=ic.fromName(n.referenceValue)}matches(e){const t=ic.comparator(e.key,this.key);return this.matchesComparison(t)}}class Il extends ml{constructor(e,t){super(e,"in",t),this.keys=Al("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Cl extends ml{constructor(e,t){super(e,"not-in",t),this.keys=Al("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Al(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>ic.fromName(e.referenceValue)))}class El extends ml{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return el(t)&&Kc(t.arrayValue,this.value)}}class Tl extends ml{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Kc(this.value.arrayValue,t)}}class Nl extends ml{constructor(e,t){super(e,"not-in",t)}matches(e){if(Kc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Kc(this.value.arrayValue,t)}}class Rl extends ml{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!el(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Kc(this.value.arrayValue,e)))}}class _l{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=o,this.startAt=a,this.endAt=i,this.dt=null}}function Dl(e){return new _l(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Ol(e){const t=zs(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>xl(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),yc(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Qc(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Qc(e))).join(",")),t.dt=e}return t.dt}function Fl(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!pl(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!wl(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!dl(e.startAt,t.startAt)&&dl(e.endAt,t.endAt)}function Ml(e){return ic.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Pl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=o,this.limitType=a,this.startAt=i,this.endAt=s,this.wt=null,this._t=null,this.startAt,this.endAt}}function Ll(e,t,n,r,o,a,i,s){return new Pl(e,t,n,r,o,a,i,s)}function zl(e){return new Pl(e)}function Bl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Ul(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Wl(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function jl(e){return null!==e.collectionGroup}function Vl(e){const t=zs(e);if(null===t.wt){t.wt=[];const e=Wl(t),n=Ul(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new hl(e)),t.wt.push(new hl(ac.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new hl(ac.keyField(),e))}}}return t.wt}function Gl(e){const t=zs(e);if(!t._t)if("F"===t.limitType)t._t=Dl(t.path,t.collectionGroup,Vl(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const o of Vl(t)){const t="desc"===o.dir?"asc":"desc";e.push(new hl(o.field,t))}const n=t.endAt?new ll(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ll(t.startAt.position,t.startAt.inclusive):null;t._t=Dl(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t._t}function Hl(e,t){t.getFirstInequalityField(),Wl(e);const n=e.filters.concat([t]);return new Pl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function ql(e,t,n){return new Pl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Kl(e,t){return Fl(Gl(e),Gl(t))&&e.limitType===t.limitType}function Xl(e){return"".concat(Ol(Gl(e)),"|lt:").concat(e.limitType)}function Yl(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((e=>kl(e))).join(", "),"]")),yc(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e))).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Qc(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Qc(e))).join(",")),"Target(".concat(t,")")}(Gl(e)),"; limitType=").concat(e.limitType,")")}function Ql(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ic.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Vl(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=ul(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Vl(e),t))&&!(e.endAt&&!function(e,t,n){const r=ul(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Vl(e),t))}(e,t)}function Jl(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function $l(e){return(t,n)=>{let r=!1;for(const o of Vl(e)){const e=Zl(o,t,n);if(0!==e)return e;r=r||o.field.isKeyField()}return 0}}function Zl(e,t,n){const r=e.field.isKeyField()?ic.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),o=n.data.field(e);return null!==r&&null!==o?Xc(r,o):Ps()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Ps()}}class eu{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,o]of n)if(this.equalsFn(r,e))return o}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Cc(this.inner,((t,n)=>{for(const[r,o]of n)e(r,o)}))}isEmpty(){return Ac(this.inner)}size(){return this.innerSize}}const tu=new Ec(ic.comparator);function nu(){return tu}const ru=new Ec(ic.comparator);function ou(){let e=ru;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const o of n)e=e.insert(o.key,o);return e}function au(e){let t=ru;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function iu(){return cu()}function su(){return cu()}function cu(){return new eu((e=>e.toString()),((e,t)=>e.isEqual(t)))}const lu=new Ec(ic.comparator),uu=new Rc(ic.comparator);function du(){let e=uu;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const o of n)e=e.add(o);return e}const hu=new Rc($s);function pu(){return hu}function fu(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bc(t)?"-0":t}}function mu(e){return{integerValue:""+e}}function gu(e,t){return xc(t)?mu(t):fu(e,t)}class vu{constructor(){this._=void 0}}function yu(e,t,n){return e instanceof wu?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Bc(t)&&(t=Uc(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof ku?Su(e,t):e instanceof Iu?Cu(e,t):function(e,t){const n=xu(e,t),r=Eu(n)+Eu(e.gt);return Zc(n)&&Zc(e.gt)?mu(r):fu(e.serializer,r)}(e,t)}function bu(e,t,n){return e instanceof ku?Su(e,t):e instanceof Iu?Cu(e,t):n}function xu(e,t){return e instanceof Au?Zc(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class wu extends vu{}class ku extends vu{constructor(e){super(),this.elements=e}}function Su(e,t){const n=Tu(t);for(const r of e.elements)n.some((e=>qc(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Iu extends vu{constructor(e){super(),this.elements=e}}function Cu(e,t){let n=Tu(t);for(const r of e.elements)n=n.filter((e=>!qc(e,r)));return{arrayValue:{values:n}}}class Au extends vu{constructor(e,t){super(),this.serializer=e,this.gt=t}}function Eu(e){return Lc(e.integerValue||e.doubleValue)}function Tu(e){return el(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Nu{constructor(e,t){this.field=e,this.transform=t}}class Ru{constructor(e,t){this.version=e,this.transformResults=t}}class _u{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new _u}static exists(e){return new _u(void 0,e)}static updateTime(e){return new _u(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Du(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ou{}function Fu(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Gu(e.key,_u.none()):new Bu(e.key,e.data,_u.none());{const n=e.data,r=il.empty();let o=new Rc(ac.comparator);for(let e of t.fields)if(!o.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),o=o.add(e)}return new Uu(e.key,r,new Dc(o.toArray()),_u.none())}}function Mu(e,t,n){e instanceof Bu?function(e,t,n){const r=e.value.clone(),o=ju(e.fieldTransforms,t,n.transformResults);r.setAll(o),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Uu?function(e,t,n){if(!Du(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=ju(e.fieldTransforms,t,n.transformResults),o=t.data;o.setAll(Wu(e)),o.setAll(r),t.convertToFoundDocument(n.version,o).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Pu(e,t,n,r){return e instanceof Bu?function(e,t,n,r){if(!Du(e.precondition,t))return n;const o=e.value.clone(),a=Vu(e.fieldTransforms,r,t);return o.setAll(a),t.convertToFoundDocument(t.version,o).setHasLocalMutations(),null}(e,t,n,r):e instanceof Uu?function(e,t,n,r){if(!Du(e.precondition,t))return n;const o=Vu(e.fieldTransforms,r,t),a=t.data;return a.setAll(Wu(e)),a.setAll(o),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Du(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Lu(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),o=xu(r.transform,e||null);null!=o&&(null===n&&(n=il.empty()),n.set(r.field,o))}return n||null}function zu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Zs(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof ku&&t instanceof ku||e instanceof Iu&&t instanceof Iu?Zs(e.elements,t.elements,qc):e instanceof Au&&t instanceof Au?qc(e.gt,t.gt):e instanceof wu&&t instanceof wu}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Bu extends Ou{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Uu extends Ou{constructor(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Wu(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function ju(e,t,n){const r=new Map;Ls(e.length===n.length);for(let o=0;o<n.length;o++){const a=e[o],i=a.transform,s=t.data.field(a.field);r.set(a.field,bu(i,s,n[o]))}return r}function Vu(e,t,n){const r=new Map;for(const o of e){const e=o.transform,a=n.data.field(o.field);r.set(o.field,yu(e,a,t))}return r}class Gu extends Ou{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Hu extends Ou{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qu{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Mu(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Pu(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Pu(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=su();return this.mutations.forEach((r=>{const o=e.get(r.key),a=o.overlayedDocument;let i=this.applyToLocalView(a,o.mutatedFields);i=t.has(r.key)?null:i;const s=Fu(a,i);null!==s&&n.set(r.key,s),a.isValidDocument()||a.convertToNoDocument(tc.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),du())}isEqual(e){return this.batchId===e.batchId&&Zs(this.mutations,e.mutations,((e,t)=>zu(e,t)))&&Zs(this.baseMutations,e.baseMutations,((e,t)=>zu(e,t)))}}class Ku{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ls(e.mutations.length===n.length);let r=lu;const o=e.mutations;for(let a=0;a<o.length;a++)r=r.insert(o[a].key,n[a].version);return new Ku(e,t,n,r)}}class Xu{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Yu{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qu,Ju;function $u(e){switch(e){default:return Ps();case Bs.CANCELLED:case Bs.UNKNOWN:case Bs.DEADLINE_EXCEEDED:case Bs.RESOURCE_EXHAUSTED:case Bs.INTERNAL:case Bs.UNAVAILABLE:case Bs.UNAUTHENTICATED:return!1;case Bs.INVALID_ARGUMENT:case Bs.NOT_FOUND:case Bs.ALREADY_EXISTS:case Bs.PERMISSION_DENIED:case Bs.FAILED_PRECONDITION:case Bs.ABORTED:case Bs.OUT_OF_RANGE:case Bs.UNIMPLEMENTED:case Bs.DATA_LOSS:return!0}}function Zu(e){if(void 0===e)return Os("GRPC error has no .code"),Bs.UNKNOWN;switch(e){case Qu.OK:return Bs.OK;case Qu.CANCELLED:return Bs.CANCELLED;case Qu.UNKNOWN:return Bs.UNKNOWN;case Qu.DEADLINE_EXCEEDED:return Bs.DEADLINE_EXCEEDED;case Qu.RESOURCE_EXHAUSTED:return Bs.RESOURCE_EXHAUSTED;case Qu.INTERNAL:return Bs.INTERNAL;case Qu.UNAVAILABLE:return Bs.UNAVAILABLE;case Qu.UNAUTHENTICATED:return Bs.UNAUTHENTICATED;case Qu.INVALID_ARGUMENT:return Bs.INVALID_ARGUMENT;case Qu.NOT_FOUND:return Bs.NOT_FOUND;case Qu.ALREADY_EXISTS:return Bs.ALREADY_EXISTS;case Qu.PERMISSION_DENIED:return Bs.PERMISSION_DENIED;case Qu.FAILED_PRECONDITION:return Bs.FAILED_PRECONDITION;case Qu.ABORTED:return Bs.ABORTED;case Qu.OUT_OF_RANGE:return Bs.OUT_OF_RANGE;case Qu.UNIMPLEMENTED:return Bs.UNIMPLEMENTED;case Qu.DATA_LOSS:return Bs.DATA_LOSS;default:return Ps()}}(Ju=Qu||(Qu={}))[Ju.OK=0]="OK",Ju[Ju.CANCELLED=1]="CANCELLED",Ju[Ju.UNKNOWN=2]="UNKNOWN",Ju[Ju.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ju[Ju.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ju[Ju.NOT_FOUND=5]="NOT_FOUND",Ju[Ju.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ju[Ju.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ju[Ju.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ju[Ju.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ju[Ju.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ju[Ju.ABORTED=10]="ABORTED",Ju[Ju.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ju[Ju.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ju[Ju.INTERNAL=13]="INTERNAL",Ju[Ju.UNAVAILABLE=14]="UNAVAILABLE",Ju[Ju.DATA_LOSS=15]="DATA_LOSS";class ed{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return td}static getOrCreateInstance(){return null===td&&(td=new ed),td}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach((t=>t(e)))}}let td=null;function nd(){return new TextEncoder}const rd=new As([4294967295,4294967295],0);function od(e){const t=nd().encode(e),n=new Cs;return n.update(t),new Uint8Array(n.digest())}function ad(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),o=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new As([n,r],0),new As([o,a],0)]}class id{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new sd("Invalid padding: ".concat(t));if(n<0)throw new sd("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new sd("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new sd("Invalid padding when bitmap length is 0: ".concat(t));this.It=8*e.length-t,this.Tt=As.fromNumber(this.It)}Et(e,t,n){let r=e.add(t.multiply(As.fromNumber(n)));return 1===r.compare(rd)&&(r=new As([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=od(e),[n,r]=ad(t);for(let o=0;o<this.hashCount;o++){const e=this.Et(n,r,o);if(!this.At(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new id(o,r,t);return n.forEach((e=>a.insert(e))),a}insert(e){if(0===this.It)return;const t=od(e),[n,r]=ad(t);for(let o=0;o<this.hashCount;o++){const e=this.Et(n,r,o);this.Rt(e)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class sd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class cd{constructor(e,t,n,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ld.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new cd(tc.min(),r,new Ec($s),nu(),du())}}class ld{constructor(e,t,n,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ld(n,t,du(),du(),du())}}class ud{constructor(e,t,n,r){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=r}}class dd{constructor(e,t){this.targetId=e,this.Vt=t}}class hd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fc.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class pd{constructor(){this.St=0,this.Dt=gd(),this.Ct=Fc.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=du(),t=du(),n=du();return this.Dt.forEach(((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ps()}})),new ld(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=gd()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class fd{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=nu(),this.zt=md(),this.Wt=new Ec($s)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,(t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:Ps()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach(((e,n)=>{this.te(n)&&t(n)}))}ne(e){var t;const n=e.targetId,r=e.Vt.count,o=this.se(n);if(o){const a=o.target;if(Ml(a))if(0===r){const e=new ic(a.path);this.Yt(n,e,cl.newNoDocument(e,tc.min()))}else Ls(1===r);else{const o=this.ie(n);if(o!==r){const r=this.re(e,o);if(0!==r){this.ee(n);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=ed.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,o,a,i,s,c;const l={localCacheCount:t,existenceFilterCount:n.count},u=n.unchangedNames;return u&&(l.bloomFilter={applied:0===e,hashCount:null!==(r=null==u?void 0:u.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(i=null===(a=null===(o=null==u?void 0:u.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==i?i:0,padding:null!==(c=null===(s=null==u?void 0:u.bits)||void 0===s?void 0:s.padding)&&void 0!==c?c:0}),l}(r,o,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:r}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:o="",padding:a=0},hashCount:i=0}=n;let s,c;try{s=zc(o).toUint8Array()}catch(e){if(e instanceof Oc)return Fs("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{c=new id(s,a,i)}catch(e){return Fs(e instanceof sd?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===c.It?1:r!==t-this.oe(e.targetId,c)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let r=0;return n.forEach((n=>{const o=this.Gt.ue(),a="projects/".concat(o.projectId,"/databases/").concat(o.database,"/documents/").concat(n.path.canonicalString());t.vt(a)||(this.Yt(e,n,null),r++)})),r}ce(e){const t=new Map;this.Qt.forEach(((n,r)=>{const o=this.se(r);if(o){if(n.current&&Ml(o.target)){const t=new ic(o.target.path);null!==this.jt.get(t)||this.ae(r,t)||this.Yt(r,t,cl.newNoDocument(t,e))}n.Mt&&(t.set(r,n.Ot()),n.Ft())}}));let n=du();this.zt.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.jt.forEach(((t,n)=>n.setReadTime(e)));const r=new cd(e,t,this.Wt,this.jt,n);return this.jt=nu(),this.zt=md(),this.Wt=new Ec($s),r}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new pd,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Rc($s),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Ds("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new pd),this.Gt.getRemoteKeysForTarget(e).forEach((t=>{this.Yt(e,t,null)}))}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function md(){return new Ec(ic.comparator)}function gd(){return new Ec(ic.comparator)}const vd={asc:"ASCENDING",desc:"DESCENDING"},yd={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bd={and:"AND",or:"OR"};class xd{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wd(e,t){return e.useProto3Json||yc(t)?t:{value:t}}function kd(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Sd(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Id(e,t){return kd(e,t.toTimestamp())}function Cd(e){return Ls(!!e),tc.fromTimestamp(function(e){const t=Pc(e);return new ec(t.seconds,t.nanos)}(e))}function Ad(e,t){return function(e){return new rc(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Ed(e){const t=rc.fromString(e);return Ls(Kd(t)),t}function Td(e,t){return Ad(e.databaseId,t.path)}function Nd(e,t){const n=Ed(t);if(n.get(1)!==e.databaseId.projectId)throw new Us(Bs.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Us(Bs.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ic(Od(n))}function Rd(e,t){return Ad(e.databaseId,t)}function _d(e){const t=Ed(e);return 4===t.length?rc.emptyPath():Od(t)}function Dd(e){return new rc(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Od(e){return Ls(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Fd(e,t,n){return{name:Td(e,t),fields:n.value.mapValue.fields}}function Md(e,t){let n;if(t instanceof Bu)n={update:Fd(e,t.key,t.value)};else if(t instanceof Gu)n={delete:Td(e,t.key)};else if(t instanceof Uu)n={update:Fd(e,t.key,t.data),updateMask:qd(t.fieldMask)};else{if(!(t instanceof Hu))return Ps();n={verify:Td(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof wu)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ku)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Iu)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Au)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Ps()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Id(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ps()}(e,t.precondition)),n}function Pd(e,t){return{documents:[Rd(e,t.path)]}}function Ld(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Rd(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Rd(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const o=function(e){if(0!==e.length)return Hd(gl.create(e,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const a=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Vd(e.field),direction:Ud(e.dir)}}(e)))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const i=wd(e,t.limit);var s;return null!==i&&(n.structuredQuery.limit=i),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function zd(e){let t=_d(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let o=null;if(r>0){Ls(1===r);const e=n.from[0];e.allDescendants?o=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){const t=Bd(e);return t instanceof gl&&yl(t)?t.getFilters():[t]}(n.where));let i=[];n.orderBy&&(i=n.orderBy.map((e=>function(e){return new hl(Gd(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let s=null;n.limit&&(s=function(e){let t;return t="object"==typeof e?e.value:e,yc(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new ll(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new ll(n,t)}(n.endAt)),Ll(t,o,i,a,s,"F",c,l)}function Bd(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Gd(e.unaryFilter.field);return ml.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Gd(e.unaryFilter.field);return ml.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Gd(e.unaryFilter.field);return ml.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Gd(e.unaryFilter.field);return ml.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ps()}}(e):void 0!==e.fieldFilter?function(e){return ml.create(Gd(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ps()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return gl.create(e.compositeFilter.filters.map((e=>Bd(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Ps()}}(e.compositeFilter.op))}(e):Ps()}function Ud(e){return vd[e]}function Wd(e){return yd[e]}function jd(e){return bd[e]}function Vd(e){return{fieldPath:e.canonicalString()}}function Gd(e){return ac.fromServerFormat(e.fieldPath)}function Hd(e){return e instanceof ml?function(e){if("=="===e.op){if(nl(e.value))return{unaryFilter:{field:Vd(e.field),op:"IS_NAN"}};if(tl(e.value))return{unaryFilter:{field:Vd(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(nl(e.value))return{unaryFilter:{field:Vd(e.field),op:"IS_NOT_NAN"}};if(tl(e.value))return{unaryFilter:{field:Vd(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vd(e.field),op:Wd(e.op),value:e.value}}}(e):e instanceof gl?function(e){const t=e.getFilters().map((e=>Hd(e)));return 1===t.length?t[0]:{compositeFilter:{op:jd(e.op),filters:t}}}(e):Ps()}function qd(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Kd(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Xd{constructor(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:tc.min(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:tc.min(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Fc.EMPTY_BYTE_STRING,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=i,this.expectedCount=s}withSequenceNumber(e){return new Xd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Xd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Yd{constructor(e){this.fe=e}}function Qd(e){const t=zd({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?ql(t,t.limit,"L"):t}class Jd{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Lc(e.integerValue));else if("doubleValue"in e){const n=Lc(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),bc(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie("".concat(n.seconds||"")),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(zc(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?al(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Ps()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const r of Object.keys(n))this.Te(r,t),this.me(n[r],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const r of n)this.me(r,t)}ve(e,t){this.ye(t,37),ic.fromName(e).path.forEach((e=>{this.ye(t,60),this.be(e,t)}))}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}Jd.Ve=new Jd;class $d{constructor(){this.rn=new Zd}addToCollectionParentIndex(e,t){return this.rn.add(t),mc.resolve()}getCollectionParents(e,t){return mc.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return mc.resolve()}deleteFieldIndex(e,t){return mc.resolve()}getDocumentsMatchingTarget(e,t){return mc.resolve(null)}getIndexType(e,t){return mc.resolve(0)}getFieldIndexes(e,t){return mc.resolve([])}getNextCollectionGroupToUpdate(e){return mc.resolve(null)}getMinOffset(e,t){return mc.resolve(uc.min())}getMinOffsetFromCollectionGroup(e,t){return mc.resolve(uc.min())}updateCollectionGroup(e,t,n){return mc.resolve()}updateIndexEntries(e,t){return mc.resolve()}}class Zd{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Rc(rc.comparator),o=!r.has(n);return this.index[t]=r.add(n),o}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Rc(rc.comparator)).toArray()}}new Uint8Array(0);class eh{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new eh(e,eh.DEFAULT_COLLECTION_PERCENTILE,eh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}eh.DEFAULT_COLLECTION_PERCENTILE=10,eh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,eh.DEFAULT=new eh(41943040,eh.DEFAULT_COLLECTION_PERCENTILE,eh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),eh.DISABLED=new eh(-1,0,0);class th{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new th(0)}static Mn(){return new th(-1)}}class nh{constructor(){this.changes=new eu((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,cl.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?mc.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class rh{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class oh{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Pu(n.mutation,e,Dc.empty(),ec.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,du()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:du();const r=iu();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=ou();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=iu();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,du())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let o=nu();const a=cu(),i=cu();return t.forEach(((e,t)=>{const i=n.get(t.key);r.has(t.key)&&(void 0===i||i.mutation instanceof Uu)?o=o.insert(t.key,t):void 0!==i?(a.set(t.key,i.mutation.getFieldMask()),Pu(i.mutation,t,i.mutation.getFieldMask(),ec.now())):a.set(t.key,Dc.empty())})),this.recalculateAndSaveOverlays(e,o).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>{var n;return i.set(e,new rh(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),i)))}recalculateAndSaveOverlays(e,t){const n=cu();let r=new Ec(((e,t)=>e-t)),o=du();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const o of e)o.keys().forEach((e=>{const a=t.get(e);if(null===a)return;let i=n.get(e)||Dc.empty();i=o.applyToLocalView(a,i),n.set(e,i);const s=(r.get(o.batchId)||du()).add(e);r=r.insert(o.batchId,s)}))})).next((()=>{const a=[],i=r.getReverseIterator();for(;i.hasNext();){const r=i.getNext(),s=r.key,c=r.value,l=su();c.forEach((e=>{if(!o.has(e)){const r=Fu(t.get(e),n.get(e));null!==r&&l.set(e,r),o=o.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,s,l))}return mc.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return ic.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):jl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((o=>{const a=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-o.size):mc.resolve(iu());let i=-1,s=o;return a.next((t=>mc.forEach(t,((t,n)=>(i<n.largestBatchId&&(i=n.largestBatchId),o.get(t)?mc.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{s=s.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,o))).next((()=>this.computeViews(e,s,t,du()))).next((e=>({batchId:i,changes:au(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ic(t)).next((e=>{let t=ou();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let o=ou();return this.indexManager.getCollectionParents(e,r).next((a=>mc.forEach(a,(a=>{const i=function(e,t){return new Pl(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,i,n).next((e=>{e.forEach(((e,t)=>{o=o.insert(e,t)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)))).next((e=>{r.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,cl.newInvalidDocument(r)))}));let n=ou();return e.forEach(((e,o)=>{const a=r.get(e);void 0!==a&&Pu(a.mutation,o,Dc.empty(),ec.now()),Ql(t,o)&&(n=n.insert(e,o))})),n}))}}class ah{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return mc.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Cd(n.createTime)}),mc.resolve()}getNamedQuery(e,t){return mc.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:Qd(e.bundledQuery),readTime:Cd(e.readTime)}}(t)),mc.resolve()}}class ih{constructor(){this.overlays=new Ec(ic.comparator),this.ls=new Map}getOverlay(e,t){return mc.resolve(this.overlays.get(t))}getOverlays(e,t){const n=iu();return mc.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.we(e,t,r)})),mc.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.ls.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.ls.delete(n)),mc.resolve()}getOverlaysForCollection(e,t,n){const r=iu(),o=t.length+1,a=new ic(t.child("")),i=this.overlays.getIteratorFrom(a);for(;i.hasNext();){const e=i.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===o&&e.largestBatchId>n&&r.set(e.getKey(),e)}return mc.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let o=new Ec(((e,t)=>e-t));const a=this.overlays.getIterator();for(;a.hasNext();){const e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=o.get(e.largestBatchId);null===t&&(t=iu(),o=o.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const i=iu(),s=o.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach(((e,t)=>i.set(e,t))),!(i.size()>=r)););return mc.resolve(i)}we(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Xu(t,n));let o=this.ls.get(t);void 0===o&&(o=du(),this.ls.set(t,o)),this.ls.set(t,o.add(n.key))}}class sh{constructor(){this.fs=new Rc(ch.ds),this.ws=new Rc(ch._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new ch(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.ys(new ch(e,t))}ps(e,t){e.forEach((e=>this.removeReference(e,t)))}Is(e){const t=new ic(new rc([])),n=new ch(t,e),r=new ch(t,e+1),o=[];return this.ws.forEachInRange([n,r],(e=>{this.ys(e),o.push(e.key)})),o}Ts(){this.fs.forEach((e=>this.ys(e)))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new ic(new rc([])),n=new ch(t,e),r=new ch(t,e+1);let o=du();return this.ws.forEachInRange([n,r],(e=>{o=o.add(e.key)})),o}containsKey(e){const t=new ch(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ch{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return ic.comparator(e.key,t.key)||$s(e.As,t.As)}static _s(e,t){return $s(e.As,t.As)||ic.comparator(e.key,t.key)}}class lh{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Rc(ch.ds)}checkEmpty(e){return mc.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const o=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new qu(o,t,n,r);this.mutationQueue.push(a);for(const i of r)this.Rs=this.Rs.add(new ch(i.key,o)),this.indexManager.addToCollectionParentIndex(e,i.key.path.popLast());return mc.resolve(a)}lookupMutationBatch(e,t){return mc.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.bs(n),o=r<0?0:r;return mc.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return mc.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return mc.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ch(t,0),r=new ch(t,Number.POSITIVE_INFINITY),o=[];return this.Rs.forEachInRange([n,r],(e=>{const t=this.Ps(e.As);o.push(t)})),mc.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Rc($s);return t.forEach((e=>{const t=new ch(e,0),r=new ch(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,r],(e=>{n=n.add(e.As)}))})),mc.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let o=n;ic.isDocumentKey(o)||(o=o.child(""));const a=new ch(new ic(o),0);let i=new Rc($s);return this.Rs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(i=i.add(e.As)),!0)}),a),mc.resolve(this.Vs(i))}Vs(e){const t=[];return e.forEach((e=>{const n=this.Ps(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Ls(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return mc.forEach(t.mutations,(r=>{const o=new ch(r.key,t.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Rs=n}))}Cn(e){}containsKey(e,t){const n=new ch(t,0),r=this.Rs.firstAfterOrEqual(n);return mc.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,mc.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class uh{constructor(e){this.Ds=e,this.docs=new Ec(ic.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),o=r?r.size:0,a=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return mc.resolve(n?n.document.mutableCopy():cl.newInvalidDocument(t))}getEntries(e,t){let n=nu();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():cl.newInvalidDocument(e))})),mc.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let o=nu();const a=t.path,i=new ic(a.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i}}=s.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||dc(lc(i),n)<=0||(r.has(i.key)||Ql(t,i))&&(o=o.insert(i.key,i.mutableCopy()))}return mc.resolve(o)}getAllFromCollectionGroup(e,t,n,r){Ps()}Cs(e,t){return mc.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new dh(this)}getSize(e){return mc.resolve(this.size)}}class dh extends nh{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.os.addEntry(e,r)):this.os.removeEntry(n)})),mc.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class hh{constructor(e){this.persistence=e,this.xs=new eu((e=>Ol(e)),Fl),this.lastRemoteSnapshotVersion=tc.min(),this.highestTargetId=0,this.Ns=0,this.ks=new sh,this.targetCount=0,this.Ms=th.kn()}forEachTarget(e,t){return this.xs.forEach(((e,n)=>t(n))),mc.resolve()}getLastRemoteSnapshotVersion(e){return mc.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return mc.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),mc.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),mc.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new th(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,mc.resolve()}updateTargetData(e,t){return this.Fn(t),mc.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,mc.resolve()}removeTargets(e,t,n){let r=0;const o=[];return this.xs.forEach(((a,i)=>{i.sequenceNumber<=t&&null===n.get(i.targetId)&&(this.xs.delete(a),o.push(this.removeMatchingKeysForTargetId(e,i.targetId)),r++)})),mc.waitFor(o).next((()=>r))}getTargetCount(e){return mc.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return mc.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),mc.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const r=this.persistence.referenceDelegate,o=[];return r&&t.forEach((t=>{o.push(r.markPotentiallyOrphaned(e,t))})),mc.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),mc.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return mc.resolve(n)}containsKey(e,t){return mc.resolve(this.ks.containsKey(t))}}class ph{constructor(e,t){this.$s={},this.overlays={},this.Os=new vc(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new hh(this),this.indexManager=new $d,this.remoteDocumentCache=function(e){return new uh(e)}((e=>this.referenceDelegate.Ls(e))),this.serializer=new Yd(t),this.qs=new ah(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ih,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new lh(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Ds("MemoryPersistence","Starting transaction:",e);const r=new fh(this.Os.next());return this.referenceDelegate.Us(),n(r).next((e=>this.referenceDelegate.Ks(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Gs(e,t){return mc.or(Object.values(this.$s).map((n=>()=>n.containsKey(e,t))))}}class fh extends pc{constructor(e){super(),this.currentSequenceNumber=e}}class mh{constructor(e){this.persistence=e,this.Qs=new sh,this.js=null}static zs(e){return new mh(e)}get Ws(){if(this.js)return this.js;throw Ps()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),mc.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),mc.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),mc.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach((e=>this.Ws.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Ws.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mc.forEach(this.Ws,(n=>{const r=ic.fromPath(n);return this.Hs(e,r).next((e=>{e||t.removeEntry(r,tc.min())}))})).next((()=>(this.js=null,t.apply(e))))}updateLimboDocument(e,t){return this.Hs(e,t).next((e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())}))}Ls(e){return 0}Hs(e,t){return mc.or([()=>mc.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class gh{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=r}static Li(e,t){let n=du(),r=du();for(const o of t.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new gh(e,t.fromCache,n,r)}}class vh{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ki(e,t).next((o=>o||this.Gi(e,t,r,n))).next((n=>n||this.Qi(e,t)))}Ki(e,t){if(Bl(t))return mc.resolve(null);let n=Gl(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=ql(t,null,"F"),n=Gl(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const o=du(...r);return this.Ui.getDocuments(e,o).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const a=this.ji(t,r);return this.zi(t,a,o,n.readTime)?this.Ki(e,ql(t,null,"F")):this.Wi(e,a,t,n)}))))})))))}Gi(e,t,n,r){return Bl(t)||r.isEqual(tc.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next((o=>{const a=this.ji(t,o);return this.zi(t,a,n,r)?this.Qi(e,t):(_s()<=Ut.DEBUG&&Ds("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Yl(t)),this.Wi(e,a,t,cc(r,-1)))}))}ji(e,t){let n=new Rc($l(e));return t.forEach(((t,r)=>{Ql(e,r)&&(n=n.add(r))})),n}zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const o="F"===e.limitType?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}Qi(e,t){return _s()<=Ut.DEBUG&&Ds("QueryEngine","Using full collection scan to execute query:",Yl(t)),this.Ui.getDocumentsMatchingQuery(e,t,uc.min())}Wi(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class yh{constructor(e,t,n,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new Ec($s),this.Yi=new eu((e=>Ol(e)),Fl),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oh(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ji)))}}function bh(e,t,n,r){return new yh(e,t,n,r)}async function xh(e,t){const n=zs(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((o=>(r=o,n.tr(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const o=[],a=[];let i=du();for(const e of r){o.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}for(const e of t){a.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}return n.localDocuments.getDocuments(e,i).next((e=>({er:e,removedBatchIds:o,addedBatchIds:a})))}))}))}function wh(e){const t=zs(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Bs.getLastRemoteSnapshotVersion(e)))}function kh(e,t,n){let r=du(),o=du();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=nu();return n.forEach(((n,a)=>{const i=e.get(n);a.isFoundDocument()!==i.isFoundDocument()&&(o=o.add(n)),a.isNoDocument()&&a.version.isEqual(tc.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!i.isValidDocument()||a.version.compareTo(i.version)>0||0===a.version.compareTo(i.version)&&i.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Ds("LocalStore","Ignoring outdated watch update for ",n,". Current version:",i.version," Watch version:",a.version)})),{nr:r,sr:o}}))}function Sh(e,t){const n=zs(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Ih(e,t){const n=zs(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Bs.getTargetData(e,t).next((o=>o?(r=o,mc.resolve(r)):n.Bs.allocateTargetId(e).next((o=>(r=new Xd(t,o,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}async function Ch(e,t,n){const r=zs(e),o=r.Ji.get(t),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,(e=>r.persistence.referenceDelegate.removeTarget(e,o)))}catch(e){if(!gc(e))throw e;Ds("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ji=r.Ji.remove(t),r.Yi.delete(o.target)}function Ah(e,t,n){const r=zs(e);let o=tc.min(),a=du();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=zs(e),o=r.Yi.get(n);return void 0!==o?mc.resolve(r.Ji.get(o)):r.Bs.getTargetData(t,n)}(r,e,Gl(t)).next((t=>{if(t)return o=t.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{a=e}))})).next((()=>r.Hi.getDocumentsMatchingQuery(e,t,n?o:tc.min(),n?a:du()))).next((e=>(Eh(r,Jl(t),e),{documents:e,ir:a})))))}function Eh(e,t,n){let r=e.Xi.get(t)||tc.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Xi.set(t,r)}class Th{constructor(){this.activeTargetIds=pu()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Nh{constructor(){this.Hr=new Th,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Th,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Rh{Yr(e){}shutdown(){}}class _h{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Ds("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Ds("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Dh=null;function Oh(){return null===Dh?Dh=268435456+Math.round(2147483648*Math.random()):Dh++,"0x"+Dh.toString(16)}const Fh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Mh{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Ph="WebChannelConnection";class Lh extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,r,o){const a=Oh(),i=this.To(e,t);Ds("RestConnection","Sending RPC '".concat(e,"' ").concat(a,":"),i,n);const s={};return this.Eo(s,r,o),this.Ao(e,i,s,n).then((t=>(Ds("RestConnection","Received RPC '".concat(e,"' ").concat(a,": "),t),t)),(t=>{throw Fs("RestConnection","RPC '".concat(e,"' ").concat(a," failed with error: "),t,"url: ",i,"request:",n),t}))}vo(e,t,n,r,o,a){return this.Io(e,t,n,r,o)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ns,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}To(e,t){const n=Fh[e];return"".concat(this.mo,"/v1/").concat(t,":").concat(n)}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,r){const o=Oh();return new Promise(((a,i)=>{const s=new Is;s.setWithCredentials(!0),s.listenOnce(bs.COMPLETE,(()=>{try{switch(s.getLastErrorCode()){case ys.NO_ERROR:const t=s.getResponseJson();Ds(Ph,"XHR for RPC '".concat(e,"' ").concat(o," received:"),JSON.stringify(t)),a(t);break;case ys.TIMEOUT:Ds(Ph,"RPC '".concat(e,"' ").concat(o," timed out")),i(new Us(Bs.DEADLINE_EXCEEDED,"Request time out"));break;case ys.HTTP_ERROR:const n=s.getStatus();if(Ds(Ph,"RPC '".concat(e,"' ").concat(o," failed with status:"),n,"response text:",s.getResponseText()),n>0){let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Bs).indexOf(t)>=0?t:Bs.UNKNOWN}(t.status);i(new Us(e,t.message))}else i(new Us(Bs.UNKNOWN,"Server responded with status "+s.getStatus()))}else i(new Us(Bs.UNAVAILABLE,"Connection failed."));break;default:Ps()}}finally{Ds(Ph,"RPC '".concat(e,"' ").concat(o," completed."))}}));const c=JSON.stringify(r);Ds(Ph,"RPC '".concat(e,"' ").concat(o," sending request:"),r),s.send(t,"POST",c,n,15)}))}Ro(e,t,n){const r=Oh(),o=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=gs(),i=vs(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(s.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(s.xmlHttpFactory=new ks({})),this.Eo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;const l=o.join("");Ds(Ph,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(l),s);const u=a.createWebChannel(l,s);let d=!1,h=!1;const p=new Mh({ro:t=>{h?Ds(Ph,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(Ds(Ph,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),Ds(Ph,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},oo:()=>u.close()}),f=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return f(u,Ss.EventType.OPEN,(()=>{h||Ds(Ph,"RPC '".concat(e,"' stream ").concat(r," transport opened."))})),f(u,Ss.EventType.CLOSE,(()=>{h||(h=!0,Ds(Ph,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.wo())})),f(u,Ss.EventType.ERROR,(t=>{h||(h=!0,Fs(Ph,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),p.wo(new Us(Bs.UNAVAILABLE,"The operation could not be completed")))})),f(u,Ss.EventType.MESSAGE,(t=>{var n;if(!h){const o=t.data[0];Ls(!!o);const a=o,i=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(i){Ds(Ph,"RPC '".concat(e,"' stream ").concat(r," received error:"),i);const t=i.status;let n=function(e){const t=Qu[e];if(void 0!==t)return Zu(t)}(t),o=i.message;void 0===n&&(n=Bs.INTERNAL,o="Unknown error status: "+t+" with message "+i.message),h=!0,p.wo(new Us(n,o)),u.close()}else Ds(Ph,"RPC '".concat(e,"' stream ").concat(r," received:"),o),p._o(o)}})),f(i,xs.STAT_EVENT,(t=>{t.stat===ws.PROXY?Ds(Ph,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===ws.NOPROXY&&Ds(Ph,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((()=>{p.fo()}),0),p}}function zh(){return"undefined"!=typeof document?document:null}function Bh(e){return new xd(e,!0)}class Uh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ii=e,this.timerId=t,this.Po=n,this.bo=r,this.Vo=o,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),r=Math.max(0,t-n);r>0&&Ds("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.So," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,(()=>(this.Co=Date.now(),e()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class Wh{constructor(e,t,n,r,o,a,i,s){this.ii=e,this.$o=n,this.Oo=r,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=i,this.listener=s,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Uh(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(()=>this.zo())))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===Bs.RESOURCE_EXHAUSTED?(Os(t.toString()),Os("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===Bs.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Fo===t&&this.Zo(n,r)}),(t=>{e((()=>{const e=new Us(Bs.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)}))}))}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo((()=>{n((()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,(()=>(this.Ko()&&(this.state=3),Promise.resolve()))),this.listener.uo())))})),this.stream.ao((e=>{n((()=>this.tu(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Go(){this.state=5,this.qo.No((async()=>{this.state=0,this.start()}))}tu(e){return Ds("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget((()=>this.Fo===e?t():(Ds("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class jh extends Wh{constructor(e,t,n,r,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,a),this.serializer=o}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Ps()}(t.targetChange.targetChangeType||"NO_CHANGE"),o=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(Ls(void 0===t||"string"==typeof t),Fc.fromBase64String(t||"")):(Ls(void 0===t||t instanceof Uint8Array),Fc.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,s=i&&function(e){const t=void 0===e.code?Bs.UNKNOWN:Zu(e.code);return new Us(t,e.message||"")}(i);n=new hd(r,o,a,s||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const o=Nd(e,r.document.name),a=Cd(r.document.updateTime),i=r.document.createTime?Cd(r.document.createTime):tc.min(),s=new il({mapValue:{fields:r.document.fields}}),c=cl.newFoundDocument(o,a,i,s),l=r.targetIds||[],u=r.removedTargetIds||[];n=new ud(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const o=Nd(e,r.document),a=r.readTime?Cd(r.readTime):tc.min(),i=cl.newNoDocument(o,a),s=r.removedTargetIds||[];n=new ud([],s,i.key,i)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const o=Nd(e,r.document),a=r.removedTargetIds||[];n=new ud([],a,o,null)}else{if(!("filter"in t))return Ps();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:o}=e,a=new Yu(r,o),i=e.targetId;n=new dd(i,a)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return tc.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?tc.min():t.readTime?Cd(t.readTime):tc.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=Dd(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Ml(r)?{documents:Pd(e,r)}:{query:Ld(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Sd(e,t.resumeToken);const r=wd(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(tc.min())>0){n.readTime=kd(e,t.snapshotVersion.toTimestamp());const r=wd(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ps()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=Dd(this.serializer),t.removeTarget=e,this.Wo(t)}}class Vh extends Wh{constructor(e,t,n,r,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.serializer=o,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(Ls(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(Ls(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Cd(e.updateTime):Cd(t);return n.isEqual(tc.min())&&(n=Cd(t)),new Ru(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Cd(e.commitTime);return this.listener.cu(n,t)}return Ls(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Dd(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Md(this.serializer,e)))};this.Wo(t)}}class Gh extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new Us(Bs.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((r=>{let[o,a]=r;return this.connection.Io(e,t,n,o,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Bs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Us(Bs.UNKNOWN,e.toString())}))}vo(e,t,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((o=>{let[a,i]=o;return this.connection.vo(e,t,n,a,i,r)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Bs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Us(Bs.UNKNOWN,e.toString())}))}terminate(){this.lu=!0}}class Hh{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve()))))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.mu?(Os(t),this.mu=!1):Ds("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class qh{constructor(e,t,n,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=o,this.Pu.Yr((e=>{n.enqueueAndForget((async()=>{tp(this)&&(Ds("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=zs(e);t.vu.add(4),await Xh(t),t.bu.set("Unknown"),t.vu.delete(4),await Kh(t)}(this))}))})),this.bu=new Hh(n,r)}}async function Kh(e){if(tp(e))for(const t of e.Ru)await t(!0)}async function Xh(e){for(const t of e.Ru)await t(!1)}function Yh(e,t){const n=zs(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),ep(n)?Zh(n):bp(n).Ko()&&Jh(n,t))}function Qh(e,t){const n=zs(e),r=bp(n);n.Au.delete(t),r.Ko()&&$h(n,t),0===n.Au.size&&(r.Ko()?r.jo():tp(n)&&n.bu.set("Unknown"))}function Jh(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(tc.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}bp(e).su(t)}function $h(e,t){e.Vu.qt(t),bp(e).iu(t)}function Zh(e){e.Vu=new fd({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),bp(e).start(),e.bu.gu()}function ep(e){return tp(e)&&!bp(e).Uo()&&e.Au.size>0}function tp(e){return 0===zs(e).vu.size}function np(e){e.Vu=void 0}async function rp(e){e.Au.forEach(((t,n)=>{Jh(e,t)}))}async function op(e,t){np(e),ep(e)?(e.bu.Iu(t),Zh(e)):e.bu.set("Unknown")}async function ap(e,t,n){if(e.bu.set("Online"),t instanceof hd&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Au.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Au.delete(r),e.Vu.removeTarget(r))}(e,t)}catch(n){Ds("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ip(e,n)}else if(t instanceof ud?e.Vu.Ht(t):t instanceof dd?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(tc.min()))try{const t=await wh(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const o=e.Au.get(r);o&&e.Au.set(r,o.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.Au.get(t);if(!r)return;e.Au.set(t,r.withResumeToken(Fc.EMPTY_BYTE_STRING,r.snapshotVersion)),$h(e,t);const o=new Xd(r.target,t,n,r.sequenceNumber);Jh(e,o)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Ds("RemoteStore","Failed to raise snapshot:",t),await ip(e,t)}}async function ip(e,t,n){if(!gc(t))throw t;e.vu.add(1),await Xh(e),e.bu.set("Offline"),n||(n=()=>wh(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Ds("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await Kh(e)}))}function sp(e,t){return t().catch((n=>ip(e,n,t)))}async function cp(e){const t=zs(e),n=xp(t);let r=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;lp(t);)try{const e=await Sh(t.localStore,r);if(null===e){0===t.Eu.length&&n.jo();break}r=e.batchId,up(t,e)}catch(e){await ip(t,e)}dp(t)&&hp(t)}function lp(e){return tp(e)&&e.Eu.length<10}function up(e,t){e.Eu.push(t);const n=xp(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function dp(e){return tp(e)&&!xp(e).Uo()&&e.Eu.length>0}function hp(e){xp(e).start()}async function pp(e){xp(e).hu()}async function fp(e){const t=xp(e);for(const n of e.Eu)t.uu(n.mutations)}async function mp(e,t,n){const r=e.Eu.shift(),o=Ku.from(r,t,n);await sp(e,(()=>e.remoteSyncer.applySuccessfulWrite(o))),await cp(e)}async function gp(e,t){t&&xp(e).ou&&await async function(e,t){if($u(n=t.code)&&n!==Bs.ABORTED){const n=e.Eu.shift();xp(e).Qo(),await sp(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await cp(e)}var n}(e,t),dp(e)&&hp(e)}async function vp(e,t){const n=zs(e);n.asyncQueue.verifyOperationInProgress(),Ds("RemoteStore","RemoteStore received new credentials");const r=tp(n);n.vu.add(3),await Xh(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await Kh(n)}async function yp(e,t){const n=zs(e);t?(n.vu.delete(2),await Kh(n)):t||(n.vu.add(2),await Xh(n),n.bu.set("Unknown"))}function bp(e){return e.Su||(e.Su=function(e,t,n){const r=zs(e);return r.fu(),new jh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:rp.bind(null,e),ao:op.bind(null,e),nu:ap.bind(null,e)}),e.Ru.push((async t=>{t?(e.Su.Qo(),ep(e)?Zh(e):e.bu.set("Unknown")):(await e.Su.stop(),np(e))}))),e.Su}function xp(e){return e.Du||(e.Du=function(e,t,n){const r=zs(e);return r.fu(),new Vh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:pp.bind(null,e),ao:gp.bind(null,e),au:fp.bind(null,e),cu:mp.bind(null,e)}),e.Ru.push((async t=>{t?(e.Du.Qo(),await cp(e)):(await e.Du.stop(),e.Eu.length>0&&(Ds("RemoteStore","Stopping write stream with ".concat(e.Eu.length," pending writes")),e.Eu=[]))}))),e.Du}class wp{constructor(e,t,n,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=o,this.deferred=new Ws,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,o){const a=Date.now()+n,i=new wp(e,t,a,r,o);return i.start(n),i}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Us(Bs.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function kp(e,t){if(Os("AsyncQueue","".concat(t,": ").concat(e)),gc(e))return new Us(Bs.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Sp{constructor(e){this.comparator=e?(t,n)=>e(t,n)||ic.comparator(t.key,n.key):(e,t)=>ic.comparator(e.key,t.key),this.keyedMap=ou(),this.sortedSet=new Ec(this.comparator)}static emptySet(e){return new Sp(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Sp))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Sp;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ip{constructor(){this.Cu=new Ec(ic.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Ps():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Cp{constructor(e,t,n,r,o,a,i,s,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=i,this.excludesMetadataChanges=s,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,o){const a=[];return t.forEach((e=>{a.push({type:0,doc:e})})),new Cp(e,t,Sp.emptySet(t),a,n,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Ap{constructor(){this.Nu=void 0,this.listeners=[]}}class Ep{constructor(){this.queries=new eu((e=>Xl(e)),Kl),this.onlineState="Unknown",this.ku=new Set}}async function Tp(e,t){const n=zs(e),r=t.query;let o=!1,a=n.queries.get(r);if(a||(o=!0,a=new Ap),o)try{a.Nu=await n.onListen(r)}catch(e){const n=kp(e,"Initialization of query '".concat(Yl(t.query),"' failed"));return void t.onError(n)}n.queries.set(r,a),a.listeners.push(t),t.Mu(n.onlineState),a.Nu&&t.$u(a.Nu)&&Dp(n)}async function Np(e,t){const n=zs(e),r=t.query;let o=!1;const a=n.queries.get(r);if(a){const e=a.listeners.indexOf(t);e>=0&&(a.listeners.splice(e,1),o=0===a.listeners.length)}if(o)return n.queries.delete(r),n.onUnlisten(r)}function Rp(e,t){const n=zs(e);let r=!1;for(const o of t){const e=o.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.$u(o)&&(r=!0);t.Nu=o}}r&&Dp(n)}function _p(e,t,n){const r=zs(e),o=r.queries.get(t);if(o)for(const a of o.listeners)a.onError(n);r.queries.delete(t)}function Dp(e){e.ku.forEach((e=>{e.next()}))}class Op{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Cp(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=Cp.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class Fp{constructor(e){this.key=e}}class Mp{constructor(e){this.key=e}}class Pp{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=du(),this.mutatedKeys=du(),this.tc=$l(e),this.ec=new Sp(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new Ip,r=t?t.ec:this.ec;let o=t?t.mutatedKeys:this.mutatedKeys,a=r,i=!1;const s="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const l=r.get(e),u=Ql(this.query,t)?t:null,d=!!l&&this.mutatedKeys.has(l.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let p=!1;l&&u?l.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),p=!0):this.rc(l,u)||(n.track({type:2,doc:u}),p=!0,(s&&this.tc(u,s)>0||c&&this.tc(u,c)<0)&&(i=!0)):!l&&u?(n.track({type:0,doc:u}),p=!0):l&&!u&&(n.track({type:1,doc:l}),p=!0,(s||c)&&(i=!0)),p&&(u?(a=a.add(u),o=h?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))})),null!==this.query.limit)for(;a.size>this.query.limit;){const e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),o=o.delete(e.key),n.track({type:1,doc:e})}return{ec:a,ic:n,zi:i,mutatedKeys:o}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const o=e.ic.xu();o.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ps()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc))),this.oc(n);const a=t?this.uc():[],i=0===this.Zu.size&&this.current?1:0,s=i!==this.Xu;return this.Xu=i,0!==o.length||s?{snapshot:new Cp(this.query,e.ec,r,o,e.mutatedKeys,0===i,s,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:a}:{cc:a}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Ip,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach((e=>this.Yu=this.Yu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Yu=this.Yu.delete(e))),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=du(),this.ec.forEach((e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))}));const t=[];return e.forEach((e=>{this.Zu.has(e)||t.push(new Mp(e))})),this.Zu.forEach((n=>{e.has(n)||t.push(new Fp(n))})),t}hc(e){this.Yu=e.ir,this.Zu=du();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return Cp.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Lp{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class zp{constructor(e){this.key=e,this.fc=!1}}class Bp{constructor(e,t,n,r,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.dc={},this.wc=new eu((e=>Xl(e)),Kl),this._c=new Map,this.mc=new Set,this.gc=new Ec(ic.comparator),this.yc=new Map,this.Ic=new sh,this.Tc={},this.Ec=new Map,this.Ac=th.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function Up(e,t){const n=of(e);let r,o;const a=n.wc.get(t);if(a)r=a.targetId,n.sharedClientState.addLocalQueryTarget(r),o=a.view.lc();else{const e=await Ih(n.localStore,Gl(t)),a=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,o=await Wp(n,t,r,"current"===a,e.resumeToken),n.isPrimaryClient&&Yh(n.remoteStore,e)}return o}async function Wp(e,t,n,r,o){e.Rc=(t,n,r)=>async function(e,t,n,r){let o=t.view.sc(n);o.zi&&(o=await Ah(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.sc(n,o)})));const a=r&&r.targetChanges.get(t.targetId),i=t.view.applyChanges(o,e.isPrimaryClient,a);return $p(e,t.targetId,i.cc),i.snapshot}(e,t,n,r);const a=await Ah(e.localStore,t,!0),i=new Pp(t,a.ir),s=i.sc(a.documents),c=ld.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,o),l=i.applyChanges(s,e.isPrimaryClient,c);$p(e,n,l.cc);const u=new Lp(t,n,i);return e.wc.set(t,u),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),l.snapshot}async function jp(e,t){const n=zs(e),r=n.wc.get(t),o=n._c.get(r.targetId);if(o.length>1)return n._c.set(r.targetId,o.filter((e=>!Kl(e,t)))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Ch(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),Qh(n.remoteStore,r.targetId),Qp(n,r.targetId)})).catch(fc)):(Qp(n,r.targetId),await Ch(n.localStore,r.targetId,!0))}async function Vp(e,t){const n=zs(e);try{const e=await function(e,t){const n=zs(e),r=t.snapshotVersion;let o=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const a=n.Zi.newChangeBuffer({trackRemovals:!0});o=n.Ji;const i=[];t.targetChanges.forEach(((a,s)=>{const c=o.get(s);if(!c)return;i.push(n.Bs.removeMatchingKeys(e,a.removedDocuments,s).next((()=>n.Bs.addMatchingKeys(e,a.addedDocuments,s))));let l=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(s)?l=l.withResumeToken(Fc.EMPTY_BYTE_STRING,tc.min()).withLastLimboFreeSnapshotVersion(tc.min()):a.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(a.resumeToken,r)),o=o.insert(s,l),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,a)&&i.push(n.Bs.updateTargetData(e,l))}));let s=nu(),c=du();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&i.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),i.push(kh(e,a,t.documentUpdates).next((e=>{s=e.nr,c=e.sr}))),!r.isEqual(tc.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next((t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,r)));i.push(t)}return mc.waitFor(i).next((()=>a.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,s,c))).next((()=>s))})).then((e=>(n.Ji=o,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.yc.get(t);r&&(Ls(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.fc=!0:e.modifiedDocuments.size>0?Ls(r.fc):e.removedDocuments.size>0&&(Ls(r.fc),r.fc=!1))})),await tf(n,e,t)}catch(e){await fc(e)}}function Gp(e,t,n){const r=zs(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wc.forEach(((n,r)=>{const o=r.view.Mu(t);o.snapshot&&e.push(o.snapshot)})),function(e,t){const n=zs(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const o of n.listeners)o.Mu(t)&&(r=!0)})),r&&Dp(n)}(r.eventManager,t),e.length&&r.dc.nu(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Hp(e,t,n){const r=zs(e);r.sharedClientState.updateQueryState(t,"rejected",n);const o=r.yc.get(t),a=o&&o.key;if(a){let e=new Ec(ic.comparator);e=e.insert(a,cl.newNoDocument(a,tc.min()));const n=du().add(a),o=new cd(tc.min(),new Map,new Ec($s),e,n);await Vp(r,o),r.gc=r.gc.remove(a),r.yc.delete(t),ef(r)}else await Ch(r.localStore,t,!1).then((()=>Qp(r,t,n))).catch(fc)}async function qp(e,t){const n=zs(e),r=t.batch.batchId;try{const e=await function(e,t){const n=zs(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),o=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const o=n.batch,a=o.keys();let i=mc.resolve();return a.forEach((e=>{i=i.next((()=>r.getEntry(t,e))).next((t=>{const a=n.docVersions.get(e);Ls(null!==a),t.version.compareTo(a)<0&&(o.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),i.next((()=>e.mutationQueue.removeMutationBatch(t,o)))}(n,e,t,o).next((()=>o.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=du();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Yp(n,r,null),Xp(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await tf(n,e)}catch(e){await fc(e)}}async function Kp(e,t,n){const r=zs(e);try{const e=await function(e,t){const n=zs(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Ls(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Yp(r,t,n),Xp(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await tf(r,e)}catch(n){await fc(n)}}function Xp(e,t){(e.Ec.get(t)||[]).forEach((e=>{e.resolve()})),e.Ec.delete(t)}function Yp(e,t,n){const r=zs(e);let o=r.Tc[r.currentUser.toKey()];if(o){const e=o.get(t);e&&(n?e.reject(n):e.resolve(),o=o.remove(t)),r.Tc[r.currentUser.toKey()]=o}}function Qp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e._c.get(t))e.wc.delete(r),n&&e.dc.Pc(r,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach((t=>{e.Ic.containsKey(t)||Jp(e,t)}))}function Jp(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(Qh(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),ef(e))}function $p(e,t,n){for(const r of n)r instanceof Fp?(e.Ic.addReference(r.key,t),Zp(e,r)):r instanceof Mp?(Ds("SyncEngine","Document no longer in limbo: "+r.key),e.Ic.removeReference(r.key,t),e.Ic.containsKey(r.key)||Jp(e,r.key)):Ps()}function Zp(e,t){const n=t.key,r=n.path.canonicalString();e.gc.get(n)||e.mc.has(r)||(Ds("SyncEngine","New document in limbo: "+n),e.mc.add(r),ef(e))}function ef(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new ic(rc.fromString(t)),r=e.Ac.next();e.yc.set(r,new zp(n)),e.gc=e.gc.insert(n,r),Yh(e.remoteStore,new Xd(Gl(zl(n.path)),r,"TargetPurposeLimboResolution",vc.ct))}}async function tf(e,t,n){const r=zs(e),o=[],a=[],i=[];r.wc.isEmpty()||(r.wc.forEach(((e,s)=>{i.push(r.Rc(s,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){o.push(e);const t=gh.Li(s.targetId,e);a.push(t)}})))})),await Promise.all(i),r.dc.nu(o),await async function(e,t){const n=zs(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>mc.forEach(t,(t=>mc.forEach(t.Fi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>mc.forEach(t.Bi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!gc(e))throw e;Ds("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ji.get(e),r=t.snapshotVersion,o=t.withLastLimboFreeSnapshotVersion(r);n.Ji=n.Ji.insert(e,o)}}}(r.localStore,a))}async function nf(e,t){const n=zs(e);if(!n.currentUser.isEqual(t)){Ds("SyncEngine","User change. New user:",t.toKey());const e=await xh(n.localStore,t);n.currentUser=t,function(e){e.Ec.forEach((e=>{e.forEach((e=>{e.reject(new Us(Bs.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ec.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await tf(n,e.er)}}function rf(e,t){const n=zs(e),r=n.yc.get(t);if(r&&r.fc)return du().add(r.key);{let e=du();const r=n._c.get(t);if(!r)return e;for(const t of r){const r=n.wc.get(t);e=e.unionWith(r.view.nc)}return e}}function of(e){const t=zs(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Vp.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=rf.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Hp.bind(null,t),t.dc.nu=Rp.bind(null,t.eventManager),t.dc.Pc=_p.bind(null,t.eventManager),t}function af(e){const t=zs(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=qp.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Kp.bind(null,t),t}class sf{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Bh(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return bh(this.persistence,new vh,e.initialUser,this.serializer)}createPersistence(e){return new ph(mh.zs,this.serializer)}createSharedClientState(e){return new Nh}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class cf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Gp(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=nf.bind(null,this.syncEngine),await yp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ep}createDatastore(e){const t=Bh(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Lh(r));var r;return function(e,t,n,r){return new Gh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,o=e=>Gp(this.syncEngine,e,0),a=_h.D()?new _h:new Rh,new qh(t,n,r,o,a);var t,n,r,o,a}createSyncEngine(e,t){return function(e,t,n,r,o,a,i){const s=new Bp(e,t,n,r,o,a);return i&&(s.vc=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=zs(e);Ds("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await Xh(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}class lf{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Os("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class uf{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ts.UNAUTHENTICATED,this.clientId=Js.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Ds("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Ds("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Us(Bs.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ws;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(_se){const n=kp(_se,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function df(e,t){e.asyncQueue.verifyOperationInProgress(),Ds("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await xh(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function hf(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ff(e);Ds("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>vp(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>vp(t.remoteStore,n))),e._onlineComponents=t}function pf(e){return"FirebaseError"===e.name?e.code===Bs.FAILED_PRECONDITION||e.code===Bs.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function ff(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ds("FirestoreClient","Using user provided OfflineComponentProvider");try{await df(e,e._uninitializedComponentsProvider._offline)}catch(_se){const n=_se;if(!pf(n))throw n;Fs("Error using user provided cache. Falling back to memory cache: "+n),await df(e,new sf)}}else Ds("FirestoreClient","Using default OfflineComponentProvider"),await df(e,new sf);return e._offlineComponents}async function mf(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ds("FirestoreClient","Using user provided OnlineComponentProvider"),await hf(e,e._uninitializedComponentsProvider._online)):(Ds("FirestoreClient","Using default OnlineComponentProvider"),await hf(e,new cf))),e._onlineComponents}function gf(e){return mf(e).then((e=>e.syncEngine))}async function vf(e){const t=await mf(e),n=t.eventManager;return n.onListen=Up.bind(null,t.syncEngine),n.onUnlisten=jp.bind(null,t.syncEngine),n}function yf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Ws;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,o){const a=new lf({next:a=>{t.enqueueAndForget((()=>Np(e,i)));const s=a.docs.has(n);!s&&a.fromCache?o.reject(new Us(Bs.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?o.reject(new Us(Bs.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(a)},error:e=>o.reject(e)}),i=new Op(zl(n.path),a,{includeMetadataChanges:!0,Ku:!0});return Tp(e,i)}(await vf(e),e.asyncQueue,t,n,r))),r.promise}function bf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Ws;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,o){const a=new lf({next:n=>{t.enqueueAndForget((()=>Np(e,i))),n.fromCache&&"server"===r.source?o.reject(new Us(Bs.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(n)},error:e=>o.reject(e)}),i=new Op(n,a,{includeMetadataChanges:!0,Ku:!0});return Tp(e,i)}(await vf(e),e.asyncQueue,t,n,r))),r.promise}function xf(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const wf=new Map;function kf(e,t,n){if(!n)throw new Us(Bs.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Sf(e){if(!ic.isDocumentKey(e))throw new Us(Bs.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function If(e){if(ic.isDocumentKey(e))throw new Us(Bs.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Cf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":Ps()}function Af(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Us(Bs.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Cf(e);throw new Us(Bs.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}class Ef{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Us(Bs.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Us(Bs.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Us(Bs.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xf(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Us(Bs.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Us(Bs.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Us(Bs.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class Tf{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ef({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Us(Bs.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Us(Bs.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ef(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Vs;switch(e.type){case"firstParty":return new Ks(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Us(Bs.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=wf.get(e);t&&(Ds("ComponentProvider","Removing Datastore"),wf.delete(e),t.terminate())}(this),Promise.resolve()}}class Nf{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _f(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nf(this.firestore,e,this._key)}}class Rf{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Rf(this.firestore,e,this._query)}}class _f extends Rf{constructor(e,t,n){super(e,t,zl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nf(this.firestore,null,new ic(e))}withConverter(e){return new _f(this.firestore,e,this._path)}}function Df(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];if(e=Ot(e),kf("collection","path",t),e instanceof Tf){const n=rc.fromString(t,...r);return If(n),new _f(e,null,n)}{if(!(e instanceof Nf||e instanceof _f))throw new Us(Bs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(rc.fromString(t,...r));return If(n),new _f(e.firestore,null,n)}}function Of(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];if(e=Ot(e),1===arguments.length&&(t=Js.A()),kf("doc","path",t),e instanceof Tf){const n=rc.fromString(t,...r);return Sf(n),new Nf(e,null,new ic(n))}{if(!(e instanceof Nf||e instanceof _f))throw new Us(Bs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(rc.fromString(t,...r));return Sf(n),new Nf(e.firestore,e instanceof _f?e.converter:null,new ic(n))}}class Ff{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Uh(this,"async_queue_retry"),this.Xc=()=>{const e=zh();e&&Ds("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=zh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=zh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise((()=>{}));const t=new Ws;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Qc.push(e),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!gc(e))throw e;Ds("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(e){const t=this.Gc.then((()=>(this.Hc=!0,e().catch((e=>{this.Wc=e,this.Hc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Os("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Hc=!1,e))))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const r=wp.createAndSchedule(this,e,t,n,(e=>this.na(e)));return this.zc.push(r),r}Zc(){this.Wc&&Ps()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then((()=>{this.zc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()}))}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function Mf(e){return function(e){if("object"!=typeof e||null===e)return!1;const t=e;for(const n of["next","error","complete"])if(n in t&&"function"==typeof t[n])return!0;return!1}(e)}class Pf extends Tf{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Ff,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||zf(this),this._firestoreClient.terminate()}}function Lf(e){return e._firestoreClient||zf(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function zf(e){var t,n,r;const o=e._freezeSettings(),a=function(e,t,n,r){return new jc(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,xf(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,o);e._firestoreClient=new uf(e._authCredentials,e._appCheckCredentials,e._queue,a),(null===(n=o.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=o.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:o.cache.kind,_offline:o.cache._offlineComponentProvider,_online:o.cache._onlineComponentProvider})}class Bf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bf(Fc.fromBase64String(e))}catch(e){throw new Us(Bs.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Bf(Fc.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Uf{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Us(Bs.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ac(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Wf{constructor(e){this._methodName=e}}class jf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Us(Bs.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Us(Bs.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $s(this._lat,e._lat)||$s(this._long,e._long)}}const Vf=/^__.*__$/;class Gf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Uu(e,this.data,this.fieldMask,t,this.fieldTransforms):new Bu(e,this.data,t,this.fieldTransforms)}}class Hf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Uu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function qf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ps()}}class Kf{constructor(e,t,n,r,o,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===o&&this.ua(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Kf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return lm(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(qf(this.ca)&&Vf.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Xf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Bh(e)}ya(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Kf({ca:e,methodName:t,ga:n,path:ac.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yf(e){const t=e._freezeSettings(),n=Bh(e._databaseId);return new Xf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Qf(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=e.ya(a.merge||a.mergeFields?2:0,t,n,o);am("Data must be an object, but it was:",i,r);const s=rm(r,i);let c,l;if(a.merge)c=new Dc(i.fieldMask),l=i.fieldTransforms;else if(a.mergeFields){const e=[];for(const r of a.mergeFields){const o=im(t,r,n);if(!i.contains(o))throw new Us(Bs.INVALID_ARGUMENT,"Field '".concat(o,"' is specified in your field mask but missing from your input data."));um(e,o)||e.push(o)}c=new Dc(e),l=i.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=i.fieldTransforms;return new Gf(new il(s),c,l)}class Jf extends Wf{_toFieldTransform(e){if(2!==e.ca)throw 1===e.ca?e._a("".concat(this._methodName,"() can only appear at the top level of your update data")):e._a("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jf}}class $f extends Wf{_toFieldTransform(e){return new Nu(e.path,new wu)}isEqual(e){return e instanceof $f}}function Zf(e,t,n,r){const o=e.ya(1,t,n);am("Data must be an object, but it was:",o,r);const a=[],i=il.empty();Cc(r,((e,r)=>{const s=cm(t,e,n);r=Ot(r);const c=o.da(s);if(r instanceof Jf)a.push(s);else{const e=nm(r,c);null!=e&&(a.push(s),i.set(s,e))}}));const s=new Dc(a);return new Hf(i,s,o.fieldTransforms)}function em(e,t,n,r,o,a){const i=e.ya(1,t,n),s=[im(t,r,n)],c=[o];if(a.length%2!=0)throw new Us(Bs.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let h=0;h<a.length;h+=2)s.push(im(t,a[h])),c.push(a[h+1]);const l=[],u=il.empty();for(let h=s.length-1;h>=0;--h)if(!um(l,s[h])){const e=s[h];let t=c[h];t=Ot(t);const n=i.da(e);if(t instanceof Jf)l.push(e);else{const r=nm(t,n);null!=r&&(l.push(e),u.set(e,r))}}const d=new Dc(l);return new Hf(u,d,i.fieldTransforms)}function tm(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return nm(n,e.ya(r?4:3,t))}function nm(e,t){if(om(e=Ot(e)))return am("Unsupported field value:",t,e),rm(e,t);if(e instanceof Wf)return function(e,t){if(!qf(t.ca))throw t._a("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t._a("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const o of e){let e=nm(o,t.wa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Ot(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return gu(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ec.fromDate(e);return{timestampValue:kd(t.serializer,n)}}if(e instanceof ec){const n=new ec(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:kd(t.serializer,n)}}if(e instanceof jf)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Bf)return{bytesValue:Sd(t.serializer,e._byteString)};if(e instanceof Nf){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t._a("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Ad(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a("Unsupported field value: ".concat(Cf(e)))}(e,t)}function rm(e,t){const n={};return Ac(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Cc(e,((e,r)=>{const o=nm(r,t.ha(e));null!=o&&(n[e]=o)})),{mapValue:{fields:n}}}function om(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ec||e instanceof jf||e instanceof Bf||e instanceof Nf||e instanceof Wf)}function am(e,t,n){if(!om(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Cf(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}}function im(e,t,n){if((t=Ot(t))instanceof Uf)return t._internalPath;if("string"==typeof t)return cm(e,t);throw lm("Field path arguments must be of type string or ",e,!1,void 0,n)}const sm=new RegExp("[~\\*/\\[\\]]");function cm(e,t,n){if(t.search(sm)>=0)throw lm("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Uf(...t.split("."))._internalPath}catch(r){throw lm("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function lm(e,t,n,r,o){const a=r&&!r.isEmpty(),i=void 0!==o;let s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";let c="";return(a||i)&&(c+=" (found",a&&(c+=" in field ".concat(r)),i&&(c+=" in document ".concat(o)),c+=")"),new Us(Bs.INVALID_ARGUMENT,s+e+c)}function um(e,t){return e.some((e=>e.isEqual(t)))}class dm{constructor(e,t,n,r,o){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Nf(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new hm(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(pm("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class hm extends dm{data(){return super.data()}}function pm(e,t){return"string"==typeof t?cm(e,t):t instanceof Uf?t._internalPath:t._delegate._internalPath}function fm(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Us(Bs.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mm{}class gm extends mm{}function vm(e,t){let n=[];for(var r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];t instanceof mm&&n.push(t),n=n.concat(o),function(e){const t=e.filter((e=>e instanceof bm)).length,n=e.filter((e=>e instanceof ym)).length;if(t>1||t>0&&n>0)throw new Us(Bs.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)e=i._apply(e);return e}class ym extends gm{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new ym(e,t,n)}_apply(e){const t=this._parse(e);return Im(e._query,t),new Rf(e.firestore,e.converter,Hl(e._query,t))}_parse(e){const t=Yf(e.firestore),n=function(e,t,n,r,o,a,i){let s;if(o.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Us(Bs.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){Sm(i,a);const t=[];for(const n of i)t.push(km(r,e,n));s={arrayValue:{values:t}}}else s=km(r,e,i)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||Sm(i,a),s=tm(n,"where",i,"in"===a||"not-in"===a);return ml.create(o,a,s)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class bm extends mm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new bm(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:gl.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const o of r)Im(n,o),n=Hl(n,o)}(e._query,t),new Rf(e.firestore,e.converter,Hl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class xm extends gm{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new xm(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Us(Bs.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Us(Bs.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new hl(t,n);return function(e,t){if(null===Ul(e)){const n=Wl(e);null!==n&&Cm(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new Rf(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Pl(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function wm(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=pm("orderBy",e);return xm._create(n,t)}function km(e,t,n){if("string"==typeof(n=Ot(n))){if(""===n)throw new Us(Bs.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!jl(t)&&-1!==n.indexOf("/"))throw new Us(Bs.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(rc.fromString(n));if(!ic.isDocumentKey(r))throw new Us(Bs.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return $c(e,new ic(r))}if(n instanceof Nf)return $c(e,n._key);throw new Us(Bs.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Cf(n),"."))}function Sm(e,t){if(!Array.isArray(e)||0===e.length)throw new Us(Bs.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Im(e,t){if(t.isInequality()){const n=Wl(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new Us(Bs.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));const o=Ul(e);null!==o&&Cm(e,r,o)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Us(Bs.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Us(Bs.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}function Cm(e,t,n){if(!n.isEqual(t))throw new Us(Bs.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}class Am{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Hc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Lc(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Ps()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Cc(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new jf(Lc(e.latitude),Lc(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Uc(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Wc(e));default:return null}}convertTimestamp(e){const t=Pc(e);return new ec(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=rc.fromString(e);Ls(Kd(n));const r=new Vc(n.get(1),n.get(3)),o=new ic(n.popFirst(5));return r.isEqual(t)||Os("Document ".concat(o," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),o}}function Em(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Tm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Nm extends dm{constructor(e,t,n,r,o,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Rm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(pm("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Rm extends Nm{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class _m{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Tm(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Rm(this._firestore,this._userDataWriter,n.key,n,new Tm(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Us(Bs.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Rm(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Tm(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Rm(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Tm(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let o=-1,a=-1;return 0!==t.type&&(o=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Dm(t.type),doc:r,oldIndex:o,newIndex:a}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Dm(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ps()}}function Om(e){e=Af(e,Nf);const t=Af(e.firestore,Pf);return yf(Lf(t),e._key).then((n=>Bm(t,e,n)))}class Fm extends Am{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Nf(this.firestore,null,t)}}function Mm(e){e=Af(e,Rf);const t=Af(e.firestore,Pf),n=Lf(t),r=new Fm(t);return fm(e._query),bf(n,e._query).then((n=>new _m(t,r,e,n)))}function Pm(e,t,n){e=Af(e,Nf);const r=Af(e.firestore,Pf),o=Em(e.converter,t,n);return zm(r,[Qf(Yf(r),"setDoc",e._key,o,null!==e.converter,n).toMutation(e._key,_u.none())])}function Lm(e,t){const n=Af(e.firestore,Pf),r=Of(e),o=Em(e.converter,t);return zm(n,[Qf(Yf(e.firestore),"addDoc",r._key,o,null!==e.converter,{}).toMutation(r._key,_u.exists(!1))]).then((()=>r))}function zm(e,t){return function(e,t){const n=new Ws;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=af(e);try{const e=await function(e,t){const n=zs(e),r=ec.now(),o=t.reduce(((e,t)=>e.add(t.key)),du());let a,i;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let s=nu(),c=du();return n.Zi.getEntries(e,o).next((e=>{s=e,s.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,s))).next((o=>{a=o;const i=[];for(const e of t){const t=Lu(e,a.get(e.key).overlayedDocument);null!=t&&i.push(new Uu(e.key,t,sl(t.value.mapValue),_u.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,i,t)})).next((t=>{i=t;const r=t.applyToLocalDocumentSet(a,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:i.batchId,changes:au(a)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Tc[e.currentUser.toKey()];r||(r=new Ec($s)),r=r.insert(t,n),e.Tc[e.currentUser.toKey()]=r}(r,e.batchId,n),await tf(r,e.changes),await cp(r.remoteStore)}catch(e){const t=kp(e,"Failed to persist write");n.reject(t)}}(await gf(e),t,n))),n.promise}(Lf(e),t)}function Bm(e,t,n){const r=n.docs.get(t._key),o=new Fm(e);return new Nm(e,o,t._key,r,new Tm(n.hasPendingWrites,n.fromCache),t.converter)}function Um(){return new $f("serverTimestamp")}!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Ns=e}(qn),jn(new Ft("firestore",((e,n)=>{let{instanceIdentifier:r,options:o}=n;const a=e.getProvider("app").getImmediate(),i=new Pf(new Hs(e.getProvider("auth-internal")),new Ys(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Us(Bs.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vc(e.options.projectId,t)}(a,r),a);return o=Object.assign({useFetchStreams:t},o),i._setSettings(o),i}),"PUBLIC").setMultipleInstances(!0)),Yn(Es,"3.13.0",e),Yn(Es,"3.13.0","esm2017")}();function Wm(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function jm(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Vm=jm,Gm=new St("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Hm=new Ht("@firebase/auth");function qm(e){if(Hm.logLevel<=Ut.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Hm.error("Auth (".concat(qn,"): ").concat(e),...n)}}function Km(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Qm(e,...n)}function Xm(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Qm(e,...n)}function Ym(e,t,n){const r=Object.assign(Object.assign({},Vm()),{[t]:n});return new St("auth","Firebase",r).create(t,{appName:e.name})}function Qm(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Gm.create(e,...n)}function Jm(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];throw Qm(t,...r)}}function $m(e){const t="INTERNAL ASSERTION FAILED: "+e;throw qm(t),new Error(t)}function Zm(e,t){e||$m(t)}function eg(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function tg(){return"http:"===ng()||"https:"===ng()}function ng(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class rg{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zm(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yt())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(tg()||bt()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function og(e,t){Zm(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class ag{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void $m("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void $m("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void $m("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ig={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},sg=new rg(3e4,6e4);function cg(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function lg(e,t,n,r){return ug(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let o={},a={};r&&("GET"===t?a=r:o={body:JSON.stringify(r)});const i=Et(Object.assign({key:e.config.apiKey},a)).slice(1),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/json",e.languageCode&&(s["X-Firebase-Locale"]=e.languageCode),ag.fetch()(hg(e,e.config.apiHost,n,i),Object.assign({method:t,headers:s,referrerPolicy:"no-referrer"},o))}))}async function ug(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},ig),t);try{const t=new pg(e),o=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw fg(e,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const t=o.ok?a.errorMessage:a.error.message,[n,i]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw fg(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw fg(e,"email-already-in-use",a);if("USER_DISABLED"===n)throw fg(e,"user-disabled",a);const s=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw Ym(e,s,i);Km(e,s)}}catch(_se){if(_se instanceof kt)throw _se;Km(e,"network-request-failed",{message:String(_se)})}}async function dg(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const a=await lg(e,t,n,r,o);return"mfaPendingCredential"in a&&Km(e,"multi-factor-auth-required",{_serverResponse:a}),a}function hg(e,t,n,r){const o="".concat(t).concat(n,"?").concat(r);return e.config.emulator?og(e.config,o):"".concat(e.config.apiScheme,"://").concat(o)}class pg{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Xm(this.auth,"network-request-failed"))),sg.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function fg(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const o=Xm(e,t,r);return o.customData._tokenResponse=n,o}function mg(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(_se){}}function gg(e){return 1e3*Number(e)}function vg(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return qm("JWT malformed, contained fewer than 3 sections"),null;try{const e=lt(n);return e?JSON.parse(e):(qm("Failed to decode base64 JWT payload"),null)}catch(_se){return qm("Caught error parsing JWT payload as JSON",null===_se||void 0===_se?void 0:_se.toString()),null}}async function yg(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(_se){throw _se instanceof kt&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(_se)&&e.auth.currentUser===e&&await e.auth.signOut(),_se}}class bg{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(_se){return void((null===_se||void 0===_se?void 0:_se.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class xg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=mg(this.lastLoginAt),this.creationTime=mg(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function wg(e){var t;const n=e.auth,r=await e.getIdToken(),o=await yg(e,async function(e,t){return lg(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));Jm(null===o||void 0===o?void 0:o.users.length,n,"internal-error");const a=o.users[0];e._notifyReloadListener(a);const i=(null===(t=a.providerUserInfo)||void 0===t?void 0:t.length)?a.providerUserInfo.map((e=>{var{providerId:t}=e,n=Wm(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const s=(c=e.providerData,l=i,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,d=!(e.email&&a.passwordHash)&&!(null===s||void 0===s?void 0:s.length),h=!!u&&d,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new xg(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(e,p)}class kg{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Jm(e.idToken,"internal-error"),Jm("undefined"!==typeof e.idToken,"internal-error"),Jm("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){const t=vg(e);return Jm(t,"internal-error"),Jm("undefined"!==typeof t.exp,"internal-error"),Jm("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Jm(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:o}=await async function(e,t){const n=await ug(e,{},(async()=>{const n=Et({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:o}=e.config,a=hg(e,r,"/v1/token","key=".concat(o)),i=await e._getAdditionalHeaders();return i["Content-Type"]="application/x-www-form-urlencoded",ag.fetch()(a,{method:"POST",headers:i,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:o}=t,a=new kg;return n&&(Jm("string"===typeof n,"internal-error",{appName:e}),a.refreshToken=n),r&&(Jm("string"===typeof r,"internal-error",{appName:e}),a.accessToken=r),o&&(Jm("number"===typeof o,"internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new kg,this.toJSON())}_performRefresh(){return $m("not implemented")}}function Sg(e,t){Jm("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Ig{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,o=Wm(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new bg(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new xg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await yg(this,this.stsTokenManager.getToken(this.auth,e));return Jm(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Ot(e),r=await n.getIdToken(t),o=vg(r);Jm(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const a="object"===typeof o.firebase?o.firebase:void 0,i=null===a||void 0===a?void 0:a.sign_in_provider;return{claims:o,token:r,authTime:mg(gg(o.auth_time)),issuedAtTime:mg(gg(o.iat)),expirationTime:mg(gg(o.exp)),signInProvider:i||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Ot(e);await wg(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Jm(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ig(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Jm(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await wg(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await yg(this,async function(e,t){return lg(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,o,a,i,s,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(o=t.phoneNumber)&&void 0!==o?o:void 0,p=null!==(a=t.photoURL)&&void 0!==a?a:void 0,f=null!==(i=t.tenantId)&&void 0!==i?i:void 0,m=null!==(s=t._redirectEventId)&&void 0!==s?s:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:b,isAnonymous:x,providerData:w,stsTokenManager:k}=t;Jm(y&&k,e,"internal-error");const S=kg.fromJSON(this.name,k);Jm("string"===typeof y,e,"internal-error"),Sg(u,e.name),Sg(d,e.name),Jm("boolean"===typeof b,e,"internal-error"),Jm("boolean"===typeof x,e,"internal-error"),Sg(h,e.name),Sg(p,e.name),Sg(f,e.name),Sg(m,e.name),Sg(g,e.name),Sg(v,e.name);const I=new Ig({uid:y,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:x,photoURL:p,phoneNumber:h,tenantId:f,stsTokenManager:S,createdAt:g,lastLoginAt:v});return w&&Array.isArray(w)&&(I.providerData=w.map((e=>Object.assign({},e)))),m&&(I._redirectEventId=m),I}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new kg;r.updateFromServerResponse(t);const o=new Ig({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await wg(o),o}}const Cg=new Map;function Ag(e){Zm(e instanceof Function,"Expected a class definition");let t=Cg.get(e);return t?(Zm(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Cg.set(e,t),t)}class Eg{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Eg.type="NONE";const Tg=Eg;function Ng(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class Rg{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:o}=this.auth;this.fullUserKey=Ng(this.userKey,r.apiKey,o),this.fullPersistenceKey=Ng("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ig._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Rg(Ag(Tg),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let o=r[0]||Ag(Tg);const a=Ng(n,e.config.apiKey,e.name);let i=null;for(const l of t)try{const t=await l._get(a);if(t){const n=Ig._fromJSON(e,t);l!==o&&(i=n),o=l;break}}catch(c){}const s=r.filter((e=>e._shouldAllowMigration));return o._shouldAllowMigration&&s.length?(o=s[0],i&&await o._set(a,i.toJSON()),await Promise.all(t.map((async e=>{if(e!==o)try{await e._remove(a)}catch(c){}}))),new Rg(o,e,n)):new Rg(o,e,n)}}function _g(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Mg(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Dg(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Lg(t))return"Blackberry";if(zg(t))return"Webos";if(Og(t))return"Safari";if((t.includes("chrome/")||Fg(t))&&!t.includes("edge/"))return"Chrome";if(Pg(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Dg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();return/firefox\//i.test(e)}function Og(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Fg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();return/crios\//i.test(e)}function Mg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();return/iemobile/i.test(e)}function Pg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();return/android/i.test(e)}function Lg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();return/blackberry/i.test(e)}function zg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();return/webos/i.test(e)}function Bg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Ug(){return function(){const e=yt();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Wg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();return Bg(e)||Pg(e)||zg(e)||Lg(e)||/windows phone/i.test(e)||Mg(e)}function jg(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=_g(yt());break;case"Worker":t="".concat(_g(yt()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(qn,"/").concat(r)}async function Vg(e,t){return lg(e,"GET","/v2/recaptchaConfig",cg(e,t))}function Gg(e){return void 0!==e&&void 0!==e.enterprise}class Hg{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}function qg(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Xm("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Kg(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Xg{constructor(e){this.type="recaptcha-enterprise",this.auth=$g(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const o=window.grecaptcha;Gg(o)?o.enterprise.ready((()=>{o.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Vg(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Hg(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((o=>{if(!t&&Gg(window.grecaptcha))n(o,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));qg("https://www.google.com/recaptcha/enterprise.js?render="+o).then((()=>{n(o,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Yg(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=new Xg(e);let a;try{a=await o.verify(n)}catch(s){a=await o.verify(n,!0)}const i=Object.assign({},t);return r?Object.assign(i,{captchaResp:a}):Object.assign(i,{captchaResponse:a}),Object.assign(i,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(i,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),i}class Qg{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(_se){r(_se)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(_se){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===_se||void 0===_se?void 0:_se.message})}}}class Jg{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zg(this),this.idTokenSubscription=new Zg(this),this.beforeStateQueue=new Qg(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Gm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ag(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Rg.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(_se){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,a=null===r||void 0===r?void 0:r._redirectEventId,i=await this.tryRedirectSignIn(e);n&&n!==a||!(null===i||void 0===i?void 0:i.user)||(r=i.user,o=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(r)}catch(_se){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(_se)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Jm(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(_se){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await wg(e)}catch(_se){if((null===_se||void 0===_se?void 0:_se.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Ot(e):null;return t&&Jm(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Jm(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Ag(e))}))}async initializeRecaptchaConfig(){const e=await Vg(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new Hg(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){new Xg(this).verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new St("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ag(e)||this._popupRedirectResolver;Jm(t,this,"argument-error"),this.redirectPersistenceManager=await Rg.create(this,[Ag(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const o="function"===typeof t?t:t.next.bind(t),a=this._isInitialized?Promise.resolve():this._initializationPromise;return Jm(a,this,"internal-error"),a.then((()=>o(this.currentUser))),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Jm(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jg(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Hm.logLevel<=Ut.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Hm.warn("Auth (".concat(qn,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function $g(e){return Ot(e)}class Zg{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Rt(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Jm(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function ev(e,t,n){const r=$g(e);Jm(r._canInitEmulator,r,"emulator-config-failed"),Jm(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const o=!!(null===n||void 0===n?void 0:n.disableWarnings),a=tv(t),{host:i,port:s}=function(e){const t=tv(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(r);if(o){const e=o[1];return{host:e,port:nv(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:nv(t)}}}(t),c=null===s?"":":".concat(s);r.config.emulator={url:"".concat(a,"//").concat(i).concat(c,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:i,port:s,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:o})}),o||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function tv(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function nv(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class rv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return $m("not implemented")}_getIdTokenResponse(e){return $m("not implemented")}_linkToIdToken(e,t){return $m("not implemented")}_getReauthenticationResolver(e){return $m("not implemented")}}async function ov(e,t){return lg(e,"POST","/v1/accounts:update",t)}async function av(e,t){return dg(e,"POST","/v1/accounts:signInWithPassword",cg(e,t))}class iv extends rv{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new iv(e,t,"password")}static _fromEmailAndCode(e,t){return new iv(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await Yg(e,n,"signInWithPassword");return av(e,t)}return av(e,n).catch((async t=>{if(t.code==="auth/".concat("missing-recaptcha-token")){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await Yg(e,n,"signInWithPassword");return av(e,t)}return Promise.reject(t)}));case"emailLink":return async function(e,t){return dg(e,"POST","/v1/accounts:signInWithEmailLink",cg(e,t))}(e,{email:this._email,oobCode:this._password});default:Km(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ov(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return dg(e,"POST","/v1/accounts:signInWithEmailLink",cg(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Km(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function sv(e,t){return dg(e,"POST","/v1/accounts:signInWithIdp",cg(e,t))}class cv extends rv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new cv(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Km("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,o=Wm(t,["providerId","signInMethod"]);if(!n||!r)return null;const a=new cv(n,r);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){return sv(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,sv(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,sv(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Et(t)}return e}}const lv={USER_NOT_FOUND:"user-not-found"};class uv extends rv{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new uv({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new uv({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return dg(e,"POST","/v1/accounts:signInWithPhoneNumber",cg(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await dg(e,"POST","/v1/accounts:signInWithPhoneNumber",cg(e,t));if(n.temporaryProof)throw fg(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return dg(e,"POST","/v1/accounts:signInWithPhoneNumber",cg(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),lv)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:o}=e;return n||t||r||o?new uv({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:o}):null}}class dv{constructor(e){var t,n,r,o,a,i;const s=Tt(Nt(e)),c=null!==(t=s.apiKey)&&void 0!==t?t:null,l=null!==(n=s.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=s.mode)&&void 0!==r?r:null);Jm(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(o=s.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(a=s.languageCode)&&void 0!==a?a:null,this.tenantId=null!==(i=s.tenantId)&&void 0!==i?i:null}static parseLink(e){const t=function(e){const t=Tt(Nt(e)).link,n=t?Tt(Nt(t)).deep_link_id:null,r=Tt(Nt(e)).deep_link_id;return(r?Tt(Nt(r)).link:null)||r||n||t||e}(e);try{return new dv(t)}catch(n){return null}}}class hv{constructor(){this.providerId=hv.PROVIDER_ID}static credential(e,t){return iv._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=dv.parseLink(t);return Jm(n,"argument-error"),iv._fromEmailAndCode(e,n.code,n.tenantId)}}hv.PROVIDER_ID="password",hv.EMAIL_PASSWORD_SIGN_IN_METHOD="password",hv.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class pv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class fv extends pv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class mv extends fv{constructor(){super("facebook.com")}static credential(e){return cv._fromParams({providerId:mv.PROVIDER_ID,signInMethod:mv.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mv.credentialFromTaggedObject(e)}static credentialFromError(e){return mv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return mv.credential(t.oauthAccessToken)}catch(n){return null}}}mv.FACEBOOK_SIGN_IN_METHOD="facebook.com",mv.PROVIDER_ID="facebook.com";class gv extends fv{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return cv._fromParams({providerId:gv.PROVIDER_ID,signInMethod:gv.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return gv.credentialFromTaggedObject(e)}static credentialFromError(e){return gv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return gv.credential(n,r)}catch(o){return null}}}gv.GOOGLE_SIGN_IN_METHOD="google.com",gv.PROVIDER_ID="google.com";class vv extends fv{constructor(){super("github.com")}static credential(e){return cv._fromParams({providerId:vv.PROVIDER_ID,signInMethod:vv.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vv.credentialFromTaggedObject(e)}static credentialFromError(e){return vv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return vv.credential(t.oauthAccessToken)}catch(n){return null}}}vv.GITHUB_SIGN_IN_METHOD="github.com",vv.PROVIDER_ID="github.com";class yv extends fv{constructor(){super("twitter.com")}static credential(e,t){return cv._fromParams({providerId:yv.PROVIDER_ID,signInMethod:yv.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return yv.credentialFromTaggedObject(e)}static credentialFromError(e){return yv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return yv.credential(n,r)}catch(o){return null}}}async function bv(e,t){return dg(e,"POST","/v1/accounts:signUp",cg(e,t))}yv.TWITTER_SIGN_IN_METHOD="twitter.com",yv.PROVIDER_ID="twitter.com";class xv{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=await Ig._fromIdTokenResponse(e,n,r),a=wv(n);return new xv({user:o,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=wv(n);return new xv({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function wv(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class kv extends kt{constructor(e,t,n,r){var o;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,kv.prototype),this.customData={appName:e.name,tenantId:null!==(o=e.tenantId)&&void 0!==o?o:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new kv(e,t,n,r)}}function Sv(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw kv._fromErrorAndOperation(e,n,t,r);throw n}))}async function Iv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await yg(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return xv._forOperation(e,"link",r)}async function Cv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e,o="reauthenticate";try{const a=await yg(e,Sv(r,o,t,e),n);Jm(a.idToken,r,"internal-error");const i=vg(a.idToken);Jm(i,r,"internal-error");const{sub:s}=i;return Jm(e.uid===s,r,"user-mismatch"),xv._forOperation(e,o,a)}catch(_se){throw(null===_se||void 0===_se?void 0:_se.code)==="auth/".concat("user-not-found")&&Km(r,"user-mismatch"),_se}}async function Av(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="signIn",o=await Sv(e,r,t),a=await xv._fromIdTokenResponse(e,r,o);return n||await e._updateCurrentUser(a.user),a}async function Ev(e,t){return Av($g(e),t)}async function Tv(e,t,n){var r;const o=$g(e),a={returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"};let i;if(null===(r=o._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await Yg(o,a,"signUpPassword");i=bv(o,e)}else i=bv(o,a).catch((async e=>{if(e.code==="auth/".concat("missing-recaptcha-token")){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const e=await Yg(o,a,"signUpPassword");return bv(o,e)}return Promise.reject(e)}));const s=await i.catch((e=>Promise.reject(e))),c=await xv._fromIdTokenResponse(o,"signIn",s);return await o._updateCurrentUser(c.user),c}function Nv(e,t,n){return Ev(Ot(e),hv.credential(t,n))}async function Rv(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const o=Ot(e),a={idToken:await o.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},i=await yg(o,async function(e,t){return lg(e,"POST","/v1/accounts:update",t)}(o.auth,a));o.displayName=i.displayName||null,o.photoURL=i.photoUrl||null;const s=o.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));s&&(s.displayName=o.displayName,s.photoURL=o.photoURL),await o._updateTokensIfNecessary(i)}new WeakMap;const _v="__sak";class Dv{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(_v,"1"),this.storage.removeItem(_v),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Ov extends Dv{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=yt();return Og(e)||Bg(e)}()&&function(){try{return!(!window||window===window.top)}catch(_se){return!1}}(),this.fallbackToPolling=Wg(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},o=this.storage.getItem(n);Ug()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ov.type="LOCAL";const Fv=Ov;class Mv extends Dv{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Mv.type="SESSION";const Pv=Mv;class Lv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Lv(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:o}=t.data,a=this.handlersMap[r];if(!(null===a||void 0===a?void 0:a.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const i=Array.from(a).map((async e=>e(t.origin,o))),s=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(i);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:s})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function zv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Lv.receivers=[];class Bv{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,a;return new Promise(((i,s)=>{const c=zv("",20);r.port1.start();const l=setTimeout((()=>{s(new Error("unsupported_event"))}),n);a={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout((()=>{s(new Error("timeout"))}),3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),s(new Error("invalid_response"))}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{a&&this.removeMessageHandler(a)}))}}function Uv(){return window}function Wv(){return"undefined"!==typeof Uv().WorkerGlobalScope&&"function"===typeof Uv().importScripts}const jv="firebaseLocalStorageDb",Vv="firebaseLocalStorage",Gv="fbase_key";class Hv{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function qv(e,t){return e.transaction([Vv],t?"readwrite":"readonly").objectStore(Vv)}function Kv(){const e=indexedDB.open(jv,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Vv,{keyPath:Gv})}catch(_se){n(_se)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Vv)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(jv);return new Hv(e).toPromise()}(),t(await Kv()))}))}))}async function Xv(e,t,n){const r=qv(e,!0).put({[Gv]:t,value:n});return new Hv(r).toPromise()}function Yv(e,t){const n=qv(e,!0).delete(t);return new Hv(n).toPromise()}class Qv{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Kv()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(_se){if(t++>3)throw _se;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Wv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Lv._getInstance(Wv()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Bv(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Kv();return await Xv(e,_v,"1"),await Yv(e,_v),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Xv(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=qv(e,!1).get(t),r=await new Hv(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Yv(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=qv(e,!1).getAll();return new Hv(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:o}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(o)&&(this.notifyListeners(r,o),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Qv.type="LOCAL";const Jv=Qv;Kg("rcb"),new rg(3e4,6e4);const $v="recaptcha";async function Zv(e,t,n){var r;const o=await n.verify();try{let a;if(Jm("string"===typeof o,e,"argument-error"),Jm(n.type===$v,e,"argument-error"),a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){Jm("enroll"===t.type,e,"internal-error");const n=await function(e,t){return lg(e,"POST","/v2/accounts/mfaEnrollment:start",cg(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,recaptchaToken:o}});return n.phoneSessionInfo.sessionInfo}{Jm("signin"===t.type,e,"internal-error");const n=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;Jm(n,e,"missing-multi-factor-info");const i=await function(e,t){return lg(e,"POST","/v2/accounts/mfaSignIn:start",cg(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:o}});return i.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return lg(e,"POST","/v1/accounts:sendVerificationCode",cg(e,t))}(e,{phoneNumber:a.phoneNumber,recaptchaToken:o});return t}}finally{n._reset()}}class ey{constructor(e){this.providerId=ey.PROVIDER_ID,this.auth=$g(e)}verifyPhoneNumber(e,t){return Zv(this.auth,e,Ot(t))}static credential(e,t){return uv._fromVerification(e,t)}static credentialFromResult(e){const t=e;return ey.credentialFromTaggedObject(t)}static credentialFromError(e){return ey.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?uv._fromTokenResponse(n,r):null}}function ty(e,t){return t?Ag(t):(Jm(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}ey.PROVIDER_ID="phone",ey.PHONE_SIGN_IN_METHOD="phone";class ny extends rv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return sv(e,this._buildIdpRequest())}_linkToIdToken(e,t){return sv(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return sv(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ry(e){return Av(e.auth,new ny(e),e.bypassAuthState)}function oy(e){const{auth:t,user:n}=e;return Jm(n,t,"internal-error"),Cv(n,new ny(e),e.bypassAuthState)}async function ay(e){const{auth:t,user:n}=e;return Jm(n,t,"internal-error"),Iv(n,new ny(e),e.bypassAuthState)}class iy{constructor(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(_se){this.reject(_se)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:o,error:a,type:i}=e;if(a)return void this.reject(a);const s={auth:this.auth,requestUri:t,sessionId:n,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(s))}catch(_se){this.reject(_se)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ry;case"linkViaPopup":case"linkViaRedirect":return ay;case"reauthViaPopup":case"reauthViaRedirect":return oy;default:Km(this.auth,"internal-error")}}resolve(e){Zm(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zm(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sy=new rg(2e3,1e4);class cy extends iy{constructor(e,t,n,r,o){super(e,t,r,o),this.provider=n,this.authWindow=null,this.pollId=null,cy.currentPopupAction&&cy.currentPopupAction.cancel(),cy.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Jm(e,this.auth,"internal-error"),e}async onExecution(){Zm(1===this.filter.length,"Popup operations only handle one event");const e=zv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Xm(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Xm(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,cy.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Xm(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,sy.get())};e()}}cy.currentPopupAction=null;const ly=new Map;class uy extends iy{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ly.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=py(t),r=hy(e);if(!await r._isAvailable())return!1;const o="true"===await r._get(n);return await r._remove(n),o}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(_se){e=()=>Promise.reject(_se)}ly.set(this.auth._key(),e)}return this.bypassAuthState||ly.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function dy(e,t){ly.set(e._key(),t)}function hy(e){return Ag(e._redirectPersistence)}function py(e){return Ng("pendingRedirect",e.config.apiKey,e.name)}async function fy(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=$g(e),o=ty(r,t),a=new uy(r,o,n),i=await a.execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,t)),i}class my{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vy(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!vy(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Xm(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(gy(e))}saveEventToCache(e){this.cachedEventUids.add(gy(e)),this.lastProcessedEventTime=Date.now()}}function gy(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function vy(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const yy=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,by=/^https?/;async function xy(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return lg(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(wy(r))return}catch(n){}Km(e,"unauthorized-domain")}function wy(e){const t=eg(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const o=new URL(e);return""===o.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&o.hostname===r}if(!by.test(n))return!1;if(yy.test(e))return r===e;const o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(r)}const ky=new rg(3e4,6e4);function Sy(){const e=Uv().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}let Iy=null;function Cy(e){return Iy=Iy||function(e){return new Promise(((t,n)=>{var r,o,a;function i(){Sy(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Sy(),n(Xm(e,"network-request-failed"))},timeout:ky.get()})}if(null===(o=null===(r=Uv().gapi)||void 0===r?void 0:r.iframes)||void 0===o?void 0:o.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=Uv().gapi)||void 0===a?void 0:a.load)){const t=Kg("iframefcb");return Uv()[t]=()=>{gapi.load?i():n(Xm(e,"network-request-failed"))},qg("https://apis.google.com/js/api.js?onload=".concat(t)).catch((e=>n(e)))}i()}})).catch((e=>{throw Iy=null,e}))}(e),Iy}const Ay=new rg(5e3,15e3),Ey={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ty=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ny(e){const t=e.config;Jm(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?og(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:qn},o=Ty.get(e.config.apiHost);o&&(r.eid=o);const a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(Et(r).slice(1))}const Ry={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class _y{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(_se){}}}function Dy(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-o)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let s="";const c=Object.assign(Object.assign({},Ry),{width:r.toString(),height:o.toString(),top:a,left:i}),l=yt().toLowerCase();n&&(s=Fg(l)?"_blank":n),Dg(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce(((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")}),"");if(function(){var e;return Bg(arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==s)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new _y(null);const d=window.open(t||"",s,u);Jm(d,e,"popup-blocked");try{d.focus()}catch(_se){}return new _y(d)}const Oy="__/auth/handler",Fy="emulator/auth/handler",My=encodeURIComponent("fac");async function Py(e,t,n,r,o,a){Jm(e.config.authDomain,e,"auth-domain-config-required"),Jm(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:qn,eventId:o};if(t instanceof pv){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))i[e]=t}if(t instanceof fv){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(i.scopes=e.join(","))}e.tenantId&&(i.tid=e.tenantId);const s=i;for(const u of Object.keys(s))void 0===s[u]&&delete s[u];const c=await e._getAppCheckToken(),l=c?"#".concat(My,"=").concat(encodeURIComponent(c)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Oy);return og(t,Fy)}(e),"?").concat(Et(s).slice(1)).concat(l)}const Ly="webStorageSupport";const zy=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Pv,this._completeRedirectFn=fy,this._overrideRedirectResult=dy}async _openPopup(e,t,n,r){var o;Zm(null===(o=this.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");return Dy(e,await Py(e,t,n,eg(),r),zv())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Uv().location.href=e}(await Py(e,t,n,eg(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Zm(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await Cy(e),n=Uv().gapi;return Jm(n,e,"internal-error"),t.open({where:document.body,url:Ny(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ey,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const o=Xm(e,"network-request-failed"),a=Uv().setTimeout((()=>{r(o)}),Ay.get());function i(){Uv().clearTimeout(a),n(t)}t.ping(i).then(i,(()=>{r(o)}))}))))}(e),n=new my(e);return t.register("authEvent",(t=>{Jm(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ly,{type:Ly},(n=>{var r;const o=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Ly];void 0!==o&&t(!!o),Km(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=xy(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Wg()||Og()||Bg()}};var By="@firebase/auth",Uy="0.23.2";class Wy{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Jm(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const jy=mt("authIdTokenMaxAge")||300;let Vy=null;var Gy;Gy="Browser",jn(new Ft("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:i,authDomain:s}=r.options;Jm(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:i,authDomain:s,clientPlatform:Gy,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jg(Gy)},l=new Jg(r,o,a,c);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ag);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(l,n),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),jn(new Ft("auth-internal",(e=>(e=>new Wy(e))($g(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Yn(By,Uy,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Gy)),Yn(By,Uy,"esm2017");let Hy,qy;const Ky=new WeakMap,Xy=new WeakMap,Yy=new WeakMap,Qy=new WeakMap,Jy=new WeakMap;let $y={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Xy.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Yy.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return tb(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Zy(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(qy||(qy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(nb(this),n),tb(Ky.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return tb(e.apply(nb(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];const a=e.call(nb(this),t,...r);return Yy.set(a,t.sort?t.sort():[t]),tb(a)}}function eb(e){return"function"===typeof e?Zy(e):(e instanceof IDBTransaction&&function(e){if(Xy.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",a),e.removeEventListener("abort",a)},o=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",a),e.addEventListener("abort",a)}));Xy.set(e,t)}(e),t=e,(Hy||(Hy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,$y):e);var t}function tb(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",a)},o=()=>{t(tb(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&Ky.set(t,e)})).catch((()=>{})),Jy.set(t,e),t}(e);if(Qy.has(e))return Qy.get(e);const t=eb(e);return t!==e&&(Qy.set(e,t),Jy.set(t,e)),t}const nb=e=>Jy.get(e);const rb=["get","getKey","getAll","getAllKeys","count"],ob=["put","add","delete","clear"],ab=new Map;function ib(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(ab.get(t))return ab.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=ob.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!rb.includes(n))return;const a=async function(e){const t=this.transaction(e,o?"readwrite":"readonly");let a=t.store;for(var i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];return r&&(a=a.index(s.shift())),(await Promise.all([a[n](...s),o&&t.done]))[0]};return ab.set(t,a),a}!function(e){$y=e($y)}((e=>ot(ot({},e),{},{get:(t,n,r)=>ib(t,n)||e.get(t,n,r),has:(t,n)=>!!ib(t,n)||e.has(t,n)})));const sb="@firebase/installations",cb="0.6.4",lb=1e4,ub="w:".concat(cb),db="FIS_v2",hb=36e5,pb=new St("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function fb(e){return e instanceof kt&&e.code.includes("request-failed")}function mb(e){let{projectId:t}=e;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function gb(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function vb(e,t){const n=(await t.json()).error;return pb.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function yb(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function bb(e,t){let{refreshToken:n}=t;const r=yb(e);return r.append("Authorization",function(e){return"".concat(db," ").concat(e)}(n)),r}async function xb(e){const t=await e();return t.status>=500&&t.status<600?e():t}function wb(e){return new Promise((t=>{setTimeout(t,e)}))}const kb=/^[cdef][\w-]{21}$/;function Sb(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=function(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}(e);return t.substr(0,22)}(e);return kb.test(t)?t:""}catch(e){return""}}function Ib(e){return"".concat(e.appName,"!").concat(e.appId)}const Cb=new Map;function Ab(e,t){const n=Ib(e);Eb(n,t),function(e,t){const n=Nb();n&&n.postMessage({key:e,fid:t});Rb()}(n,t)}function Eb(e,t){const n=Cb.get(e);if(n)for(const r of n)r(t)}let Tb=null;function Nb(){return!Tb&&"BroadcastChannel"in self&&(Tb=new BroadcastChannel("[Firebase] FID Change"),Tb.onmessage=e=>{Eb(e.data.key,e.data.fid)}),Tb}function Rb(){0===Cb.size&&Tb&&(Tb.close(),Tb=null)}const _b="firebase-installations-store";let Db=null;function Ob(){return Db||(Db=function(e,t){let{blocked:n,upgrade:r,blocking:o,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),s=tb(i);return r&&i.addEventListener("upgradeneeded",(e=>{r(tb(i.result),e.oldVersion,e.newVersion,tb(i.transaction))})),n&&i.addEventListener("blocked",(()=>n())),s.then((e=>{a&&e.addEventListener("close",(()=>a())),o&&e.addEventListener("versionchange",(()=>o()))})).catch((()=>{})),s}("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(_b)}})),Db}async function Fb(e,t){const n=Ib(e),r=(await Ob()).transaction(_b,"readwrite"),o=r.objectStore(_b),a=await o.get(n);return await o.put(t,n),await r.done,a&&a.fid===t.fid||Ab(e,t.fid),t}async function Mb(e){const t=Ib(e),n=(await Ob()).transaction(_b,"readwrite");await n.objectStore(_b).delete(t),await n.done}async function Pb(e,t){const n=Ib(e),r=(await Ob()).transaction(_b,"readwrite"),o=r.objectStore(_b),a=await o.get(n),i=t(a);return void 0===i?await o.delete(n):await o.put(i,n),await r.done,!i||a&&a.fid===i.fid||Ab(e,i.fid),i}async function Lb(e){let t;const n=await Pb(e.appConfig,(n=>{const r=function(e){const t=e||{fid:Sb(),registrationStatus:0};return Ub(t)}(n),o=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(pb.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:o}=t;const a=mb(n),i=yb(n),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const c={fid:o,authVersion:db,appId:n.appId,sdkVersion:ub},l={method:"POST",headers:i,body:JSON.stringify(c)},u=await xb((()=>fetch(a,l)));if(u.ok){const e=await u.json();return{fid:e.fid||o,registrationStatus:2,refreshToken:e.refreshToken,authToken:gb(e.authToken)}}throw await vb("Create Installation",u)}(e,t);return Fb(e.appConfig,n)}catch(_se){throw fb(_se)&&409===_se.customData.serverCode?await Mb(e.appConfig):await Fb(e.appConfig,{fid:t.fid,registrationStatus:0}),_se}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:zb(e)}:{installationEntry:t}}(e,r);return t=o.registrationPromise,o.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function zb(e){let t=await Bb(e.appConfig);for(;1===t.registrationStatus;)await wb(100),t=await Bb(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Lb(e);return n||t}return t}function Bb(e){return Pb(e,(e=>{if(!e)throw pb.create("installation-not-found");return Ub(e)}))}function Ub(e){return 1===(t=e).registrationStatus&&t.registrationTime+lb<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Wb(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const o=function(e,t){let{fid:n}=t;return"".concat(mb(e),"/").concat(n,"/authTokens:generate")}(n,t),a=bb(n,t),i=r.getImmediate({optional:!0});if(i){const e=await i.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const s={installation:{sdkVersion:ub,appId:n.appId}},c={method:"POST",headers:a,body:JSON.stringify(s)},l=await xb((()=>fetch(o,c)));if(l.ok){return gb(await l.json())}throw await vb("Generate Auth Token",l)}async function jb(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await Pb(e.appConfig,(r=>{if(!Gb(r))throw pb.create("not-registered");const o=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+hb}(e)}(o))return r;if(1===o.requestStatus)return t=async function(e,t){let n=await Vb(e.appConfig);for(;1===n.authToken.requestStatus;)await wb(100),n=await Vb(e.appConfig);const r=n.authToken;return 0===r.requestStatus?jb(e,t):r}(e,n),r;{if(!navigator.onLine)throw pb.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await Wb(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await Fb(e.appConfig,r),n}catch(_se){if(!fb(_se)||401!==_se.customData.serverCode&&404!==_se.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Fb(e.appConfig,n)}else await Mb(e.appConfig);throw _se}}(e,n),n}}));return t?await t:r.authToken}function Vb(e){return Pb(e,(e=>{if(!Gb(e))throw pb.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+lb<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function Gb(e){return void 0!==e&&2===e.registrationStatus}async function Hb(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await Lb(e);t&&await t}(n);return(await jb(n,t)).token}function qb(e){return pb.create("missing-app-config-values",{valueName:e})}const Kb="installations",Xb=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw qb("App Configuration");if(!e.name)throw qb("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw qb(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Vn(t,"heartbeat"),_delete:()=>Promise.resolve()}},Yb=e=>{const t=Vn(e.getProvider("app").getImmediate(),Kb).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Lb(t);return r?r.catch(console.error):jb(t).catch(console.error),n.fid}(t),getToken:e=>Hb(t,e)}};jn(new Ft(Kb,Xb,"PUBLIC")),jn(new Ft("installations-internal",Yb,"PRIVATE")),Yn(sb,cb),Yn(sb,cb,"esm2017");const Qb="analytics",Jb="https://www.googletagmanager.com/gtag/js",$b=new Ht("@firebase/analytics"),Zb=new St("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function ex(e){if(!e.startsWith(Jb)){const t=Zb.create("invalid-gtag-resource",{gtagURL:e});return $b.warn(t.message),""}return e}function tx(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function nx(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:ex}),r=document.createElement("script"),o="".concat(Jb,"?l=").concat(e,"&id=").concat(t);r.src=n?null===n||void 0===n?void 0:n.createScriptURL(o):o,r.async=!0,document.head.appendChild(r)}function rx(e,t,n,r){return async function(o){try{for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];if("event"===o){const[r,o]=i;await async function(e,t,n,r,o){try{let a=[];if(o&&o.send_to){let e=o.send_to;Array.isArray(e)||(e=[e]);const r=await tx(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),o=e&&t[e.appId];if(!o){a=[];break}a.push(o)}}0===a.length&&(a=Object.values(t)),await Promise.all(a),e("event",r,o||{})}catch(_se){$b.error(_se)}}(e,t,n,r,o)}else if("config"===o){const[o,a]=i;await async function(e,t,n,r,o,a){const i=r[o];try{if(i)await t[i];else{const e=(await tx(n)).find((e=>e.measurementId===o));e&&await t[e.appId]}}catch(_se){$b.error(_se)}e("config",o,a)}(e,t,n,r,o,a)}else if("consent"===o){const[t]=i;e("consent","update",t)}else if("get"===o){const[t,n,r]=i;e("get",t,n,r)}else if("set"===o){const[t]=i;e("set",t)}else e(o,...i)}catch(_se){$b.error(_se)}}}const ox=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function ax(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function ix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ox,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:o,measurementId:a}=e.options;if(!r)throw Zb.create("no-app-id");if(!o){if(a)return{measurementId:a,appId:r};throw Zb.create("no-api-key")}const i=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},s=new cx;return setTimeout((async()=>{s.abort()}),void 0!==n?n:6e4),sx({appId:r,apiKey:o,measurementId:a},i,s,t)}async function sx(e,t,n){let{throttleEndTimeMillis:r,backoffCount:o}=t,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ox;var i;const{appId:s,measurementId:c}=e;try{await function(e,t){return new Promise(((n,r)=>{const o=Math.max(t-Date.now(),0),a=setTimeout(n,o);e.addEventListener((()=>{clearTimeout(a),r(Zb.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(n,r)}catch(_se){if(c)return $b.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(c)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===_se||void 0===_se?void 0:_se.message,"]")),{appId:s,measurementId:c};throw _se}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,o={method:"GET",headers:ax(r)},a="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),i=await fetch(a,o);if(200!==i.status&&304!==i.status){let e="";try{const n=await i.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(s){}throw Zb.create("config-fetch-failed",{httpStatus:i.status,responseMessage:e})}return i.json()}(e);return a.deleteThrottleMetadata(s),t}catch(_se){const r=_se;if(!function(e){if(!(e instanceof kt)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(r)){if(a.deleteThrottleMetadata(s),c)return $b.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(c)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===r||void 0===r?void 0:r.message,"]")),{appId:s,measurementId:c};throw _se}const l=503===Number(null===(i=null===r||void 0===r?void 0:r.customData)||void 0===i?void 0:i.httpStatus)?Dt(o,a.intervalMillis,30):Dt(o,a.intervalMillis),u={throttleEndTimeMillis:Date.now()+l,backoffCount:o+1};return a.setThrottleMetadata(s,u),$b.debug("Calling attemptFetch again in ".concat(l," millis")),sx(e,u,n,a)}}class cx{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let lx,ux;function dx(e){ux=e}function hx(e){lx=e}async function px(e,t,n,r,o,a,i){var s;const c=ix(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&$b.warn("The measurement ID in the local Firebase config (".concat(e.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(t.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((e=>$b.error(e))),t.push(c);const l=async function(){if(!xt())return $b.warn(Zb.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await wt()}catch(_se){return $b.warn(Zb.create("indexeddb-unavailable",{errorInfo:null===_se||void 0===_se?void 0:_se.toString()}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[u,d]=await Promise.all([c,l]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(Jb)&&n.src.includes(e))return n;return null})(a)||nx(a,u.measurementId),ux&&(o("consent","default",ux),dx(void 0)),o("js",new Date);const h=null!==(s=null===i||void 0===i?void 0:i.config)&&void 0!==s?s:{};return h.origin="firebase",h.update=!0,null!=d&&(h.firebase_id=d),o("config",u.measurementId,h),lx&&(o("set",lx),hx(void 0)),u.measurementId}class fx{constructor(e){this.app=e}_delete(){return delete mx[this.app.options.appId],Promise.resolve()}}let mx={},gx=[];const vx={};let yx,bx,xx="dataLayer",wx="gtag",kx=!1;function Sx(){const e=[];if(bt()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>"(".concat(t+1,") ").concat(e))).join(" "),n=Zb.create("invalid-analytics-context",{errorInfo:t});$b.warn(n.message)}}function Ix(e,t,n){Sx();const r=e.options.appId;if(!r)throw Zb.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Zb.create("no-api-key");$b.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(e.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=mx[r])throw Zb.create("already-exists",{id:r});if(!kx){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(xx);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,o){let a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[o]&&"function"===typeof window[o]&&(a=window[o]),window[o]=rx(a,e,t,n),{gtagCore:a,wrappedGtag:window[o]}}(mx,gx,vx,xx,wx);bx=e,yx=t,kx=!0}mx[r]=px(e,gx,vx,t,yx,xx,n);return new fx(e)}function Cx(e,t,n,r){e=Ot(e),async function(e,t,n,r,o){if(o&&o.global)e("event",n,r);else{const o=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:o}))}}(bx,mx[e.app.options.appId],t,n,r).catch((e=>$b.error(e)))}const Ax="@firebase/analytics",Ex="0.10.0";jn(new Ft(Qb,((e,t)=>{let{options:n}=t;return Ix(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),jn(new Ft("analytics-internal",(function(e){try{const t=e.getProvider(Qb).getImmediate();return{logEvent:(e,n,r)=>Cx(t,e,n,r)}}catch(_se){throw Zb.create("interop-component-reg-failed",{reason:_se})}}),"PRIVATE")),Yn(Ax,Ex),Yn(Ax,Ex,"esm2017");const Tx="firebasestorage.googleapis.com",Nx="storageBucket";class Rx extends kt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(Ox(e),"Firebase Storage: ".concat(t," (").concat(Ox(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Rx.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ox(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var _x,Dx;function Ox(e){return"storage/"+e}function Fx(){return new Rx(_x.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Mx(){return new Rx(_x.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Px(){return new Rx(_x.CANCELED,"User canceled the upload/download.")}function Lx(e){return new Rx(_x.INVALID_ARGUMENT,e)}function zx(){return new Rx(_x.APP_DELETED,"The Firebase app was deleted.")}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(_x||(_x={}));class Bx{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Bx.makeFromUrl(e,t)}catch(_se){return new Bx(e,"")}if(""===n.path)return n;throw r=e,new Rx(_x.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const o=new RegExp("^gs://"+r+"(/(.*))?$","i");function a(e){e.path_=decodeURIComponent(e.path)}const i=t.replace(/[.]/g,"\\."),s=[{regex:o,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(i,"/").concat("v[A-Za-z0-9_]+","/b/").concat(r,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://".concat(t===Tx?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(r,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:a}];for(let c=0;c<s.length;c++){const t=s[c],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let o=r[t.indices.path];o||(o=""),n=new Bx(e,o),t.postModify(n);break}}if(null==n)throw function(e){return new Rx(_x.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class Ux{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function Wx(e,t,n,r){if(r<t)throw Lx("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw Lx("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function jx(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function Vx(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),o=-1!==t.indexOf(e);return n||r||o}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Dx||(Dx={}));class Gx{constructor(e,t,n,r,o,a,i,s,c,l,u){let d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=i,this.errorCallback_=s,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=u,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new Hx(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Dx.NO_ERROR,o=n.getStatus();if(!t||Vx(o,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Dx.ABORT;return void e(!1,new Hx(!1,null,t))}const a=-1!==this.successCodes_.indexOf(o);e(!0,new Hx(a,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,o=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(o,o.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(_se){r(_se)}else if(null!==o){const e=Fx();e.serverResponse=o.getErrorText(),this.errorCallback_?r(this.errorCallback_(o,e)):r(e)}else if(t.canceled){r(this.appDelete_?zx():Px())}else{r(Mx())}};this.canceled_?t(0,new Hx(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,o=null,a=null,i=!1,s=0;function c(){return 2===s}let l=!1;function u(){if(!l){l=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function d(t){o=setTimeout((()=>{o=null,e(p,c())}),t)}function h(){a&&clearTimeout(a)}function p(e){if(l)return void h();for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(e)return h(),void u.call(null,e,...n);if(c()||i)return h(),void u.call(null,e,...n);let a;r<64&&(r*=2),1===s?(s=2,a=0):a=1e3*(r+Math.random()),d(a)}let f=!1;function m(e){f||(f=!0,h(),l||(null!==o?(e||(s=2),clearTimeout(o),d(0)):e||(s=1)))}return d(0),a=setTimeout((()=>{i=!0,m(!0)}),n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Hx{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function qx(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}class Kx{constructor(e,t){this._service=e,this._location=t instanceof Bx?t:Bx.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Kx(e,t)}get root(){const e=new Bx(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return qx(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new Bx(this._location.bucket,e);return new Kx(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Rx(_x.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Xx(e,t){const n=null===t||void 0===t?void 0:t[Nx];return null==n?null:Bx.makeFromBucketSpec(n,e)}class Yx{constructor(e,t,n,r,o){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=o,this._bucket=null,this._host=Tx,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Bx.makeFromBucketSpec(r,this._host):Xx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Bx.makeFromBucketSpec(this._url,e):this._bucket=Xx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Wx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Wx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Kx(this,e)}_makeRequest(e,t,n,r){let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new Ux(zx());{const a=function(e,t,n,r,o,a){let i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const s=jx(e.urlParams),c=e.url+s,l=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(l,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(l,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(l,a),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(l,r),new Gx(c,e.method,l,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,o,i)}(e,this._appId,n,r,t,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then((()=>this._requests.delete(a)),(()=>this._requests.delete(a))),a}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Qx="@firebase/storage",Jx="0.11.2",$x="storage";function Zx(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),o=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new Yx(r,o,a,n,qn)}jn(new Ft($x,Zx,"PUBLIC").setMultipleInstances(!0)),Yn(Qx,Jx,""),Yn(Qx,Jx,"esm2017");const ew=Kn({apiKey:"AIzaSyCyiJ42A125uF5Lh02gh-_Y556TO91DmIg",authDomain:"agroscan-c6cbd.firebaseapp.com",projectId:"agroscan-c6cbd",storageBucket:"agroscan-c6cbd.firebasestorage.app",messagingSenderId:"520364147553",appId:"1:520364147553:web:81f752a0714c9469323b20",measurementId:"G-N35TXEBNV9"}),tw=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xn();const t=Vn(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Vn(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Ct(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Km(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:zy,persistence:[Jv,Fv,Pv]}),r=mt("authTokenSyncURL");if(r){const e=(o=r,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>jy)return;const r=null===t||void 0===t?void 0:t.token;Vy!==r&&(Vy=r,await fetch(o,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){Ot(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(e,t,n,r){Ot(e).onIdTokenChanged(t,n,r)}(n,(t=>e(t)))}var o;const a=ht("auth");return a&&ev(n,"http://".concat(a)),n}(ew),nw=function(e,t){const n="string"==typeof e?e:t||"(default)",r=Vn("object"==typeof e?e:Xn(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=pt("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var o;const a=(e=Af(e,Tf))._getSettings(),i="".concat(t,":").concat(n);if("firestore.googleapis.com"!==a.host&&a.host!==i&&Fs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:i,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Ts.MOCK_USER;else{t=vt(r.mockUserToken,null===(o=e._app)||void 0===o?void 0:o.options.projectId);const a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new Us(Bs.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Ts(a)}e._authCredentials=new Gs(new js(t,n))}}(r,...e)}return r}(ew),rw=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xn(),t=arguments.length>1?arguments[1]:void 0;e=Ot(e);const n=Vn(e,$x).getImmediate({identifier:t}),r=pt("storage");r&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";const{mockUserToken:o}=r;o&&(e._overrideAuthToken="string"===typeof o?o:vt(o,e.app.options.projectId))}(e,t,n,r)}(n,...r)}(ew),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xn();e=Ot(e);const t=Vn(e,Qb);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Vn(e,Qb);if(n.isInitialized()){const e=n.getImmediate();if(Ct(t,n.getOptions()))return e;throw Zb.create("already-initialized")}const r=n.initialize({options:t})}(e)}(ew),(0,i.createContext)()),ow=e=>{let{children:t}=e;const[n,r]=(0,i.useState)(null),[o,a]=(0,i.useState)(!0);(0,i.useEffect)((()=>{const e=function(e,t,n,r){return Ot(e).onAuthStateChanged(t,n,r)}(tw,(async e=>{if(e){const t=(await Om(Of(nw,"users",e.uid))).data();r(ot(ot({},e),{},{displayName:(null===t||void 0===t?void 0:t.name)||e.displayName}))}else r(null);a(!1)}));return e}),[]);const s={currentUser:n,signup:async(e,t,n)=>{try{const r=(await Tv(tw,e,t)).user;return await Pm(Of(nw,"users",r.uid),{name:n,email:e,createdAt:(new Date).toISOString()}),r}catch(r){throw r}},login:async(e,t)=>{try{return(await Nv(tw,e,t)).user}catch(n){throw n}},logout:async()=>{try{await function(e){return Ot(e).signOut()}(tw)}catch(e){throw e}}};return(0,Be.jsx)(rw.Provider,{value:s,children:!o&&t})},aw=()=>{const e=(0,i.useContext)(rw);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};var iw=n(8279);const sw=(0,iw.A)({palette:{primary:{main:"#219653",light:"#6FCF97",dark:"#17643b",contrastText:"#fff"},secondary:{main:"#56CCF2",contrastText:"#fff"},background:{default:"#F7F9FA",paper:"#fff"},text:{primary:"#222",secondary:"#555"},grey:{100:"#F7F9FA",200:"#E0E0E0",300:"#BDBDBD",800:"#333"}},typography:{fontFamily:"Inter, Nunito, Roboto, Arial, sans-serif",h1:{fontWeight:800,fontSize:"2.5rem"},h2:{fontWeight:700,fontSize:"2rem"},h3:{fontWeight:700,fontSize:"1.5rem"},h4:{fontWeight:700,fontSize:"1.25rem"},h5:{fontWeight:700,fontSize:"1.1rem"},h6:{fontWeight:700,fontSize:"1rem"},button:{fontWeight:700,textTransform:"none"}},shape:{borderRadius:16},components:{MuiButton:{styleOverrides:{root:{borderRadius:12,fontWeight:700,boxShadow:"none",transition:"all 0.2s",padding:"10px 24px"}}},MuiCard:{styleOverrides:{root:{borderRadius:20,boxShadow:"0 2px 16px 0 rgba(33,150,83,0.07)",transition:"all 0.2s"}}},MuiPaper:{styleOverrides:{root:{borderRadius:20}}},MuiTabs:{styleOverrides:{root:{minHeight:44},indicator:{height:4,borderRadius:2,background:"linear-gradient(90deg, #219653 0%, #6FCF97 100%)"}}},MuiTab:{styleOverrides:{root:{fontWeight:700,minHeight:44}}}}});var cw=n(8387),lw=n(3174),uw=n(8812),dw=n(8698),hw=n(8280);const pw=(0,hw.A)();const fw=function(){return je(arguments.length>0&&void 0!==arguments[0]?arguments[0]:pw)},mw=["className","component"];var gw=n(9386),vw=n(2532);const yw=(0,vw.A)("MuiBox",["root"]),bw=(0,iw.A)(),xw=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:o}=e,a=(0,lw.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(uw.A),s=i.forwardRef((function(e,i){const s=fw(n),c=(0,dw.A)(e),{className:l,component:u="div"}=c,d=(0,Me.A)(c,mw);return(0,Be.jsx)(a,(0,Fe.A)({as:u,ref:i,className:(0,cw.A)(l,o?o(r):r),theme:t&&s[t]||s},d))}));return s}({themeId:Je.A,defaultTheme:bw,defaultClassName:yw.root,generateClassName:gw.A.generate}),ww=xw;var kw=n(8610),Sw=n(7266),Iw=n(4535),Cw=n(8206),Aw=n(2372);function Ew(e){return(0,Aw.Ay)("MuiDivider",e)}(0,vw.A)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);const Tw=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],Nw=(0,Iw.Ay)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.absolute&&t.absolute,t[n.variant],n.light&&t.light,"vertical"===n.orientation&&t.vertical,n.flexItem&&t.flexItem,n.children&&t.withChildren,n.children&&"vertical"===n.orientation&&t.withChildrenVertical,"right"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignRight,"left"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignLeft]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin"},n.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},n.light&&{borderColor:t.vars?"rgba(".concat(t.vars.palette.dividerChannel," / 0.08)"):(0,Sw.X4)(t.palette.divider,.08)},"inset"===n.variant&&{marginLeft:72},"middle"===n.variant&&"horizontal"===n.orientation&&{marginLeft:t.spacing(2),marginRight:t.spacing(2)},"middle"===n.variant&&"vertical"===n.orientation&&{marginTop:t.spacing(1),marginBottom:t.spacing(1)},"vertical"===n.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},n.flexItem&&{alignSelf:"stretch",height:"auto"})}),(e=>{let{ownerState:t}=e;return(0,Fe.A)({},t.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({},n.children&&"vertical"!==n.orientation&&{"&::before, &::after":{width:"100%",borderTop:"thin solid ".concat((t.vars||t).palette.divider),borderTopStyle:"inherit"}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({},n.children&&"vertical"===n.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:"thin solid ".concat((t.vars||t).palette.divider),borderLeftStyle:"inherit"}})}),(e=>{let{ownerState:t}=e;return(0,Fe.A)({},"right"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})})),Rw=(0,Iw.Ay)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.wrapper,"vertical"===n.orientation&&t.wrapperVertical]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({display:"inline-block",paddingLeft:"calc(".concat(t.spacing(1)," * 1.2)"),paddingRight:"calc(".concat(t.spacing(1)," * 1.2)")},"vertical"===n.orientation&&{paddingTop:"calc(".concat(t.spacing(1)," * 1.2)"),paddingBottom:"calc(".concat(t.spacing(1)," * 1.2)")})})),_w=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiDivider"}),{absolute:r=!1,children:o,className:a,component:i=(o?"div":"hr"),flexItem:s=!1,light:c=!1,orientation:l="horizontal",role:u=("hr"!==i?"separator":void 0),textAlign:d="center",variant:h="fullWidth"}=n,p=(0,Me.A)(n,Tw),f=(0,Fe.A)({},n,{absolute:r,component:i,flexItem:s,light:c,orientation:l,role:u,textAlign:d,variant:h}),m=(e=>{const{absolute:t,children:n,classes:r,flexItem:o,light:a,orientation:i,textAlign:s,variant:c}=e,l={root:["root",t&&"absolute",c,a&&"light","vertical"===i&&"vertical",o&&"flexItem",n&&"withChildren",n&&"vertical"===i&&"withChildrenVertical","right"===s&&"vertical"!==i&&"textAlignRight","left"===s&&"vertical"!==i&&"textAlignLeft"],wrapper:["wrapper","vertical"===i&&"wrapperVertical"]};return(0,kw.A)(l,Ew,r)})(f);return(0,Be.jsx)(Nw,(0,Fe.A)({as:i,className:(0,cw.A)(m.root,a),role:u,ref:t,ownerState:f},p,{children:o?(0,Be.jsx)(Rw,{className:m.wrapper,ownerState:f,children:o}):null}))}));_w.muiSkipListHighlight=!0;const Dw=_w;const Ow=i.createContext({});function Fw(e){return(0,Aw.Ay)("MuiList",e)}(0,vw.A)("MuiList",["root","padding","dense","subheader"]);const Mw=["children","className","component","dense","disablePadding","subheader"],Pw=(0,Iw.Ay)("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disablePadding&&t.padding,n.dense&&t.dense,n.subheader&&t.subheader]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})})),Lw=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiList"}),{children:r,className:o,component:a="ul",dense:s=!1,disablePadding:c=!1,subheader:l}=n,u=(0,Me.A)(n,Mw),d=i.useMemo((()=>({dense:s})),[s]),h=(0,Fe.A)({},n,{component:a,dense:s,disablePadding:c}),p=(e=>{const{classes:t,disablePadding:n,dense:r,subheader:o}=e,a={root:["root",!n&&"padding",r&&"dense",o&&"subheader"]};return(0,kw.A)(a,Fw,t)})(h);return(0,Be.jsx)(Ow.Provider,{value:d,children:(0,Be.jsxs)(Pw,(0,Fe.A)({as:a,className:(0,cw.A)(p.root,o),ref:t,ownerState:h},u,{children:[l,r]}))})})),zw=Lw;const Bw=function(e){return"string"===typeof e};var Uw=n(5849),Ww=n(3319),jw=n(3574);function Vw(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Gw(e,t){return Gw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gw(e,t)}function Hw(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Gw(e,t)}const qw=i.createContext(null);function Kw(e,t){var n=Object.create(null);return e&&i.Children.map(e,(function(e){return e})).forEach((function(e){n[e.key]=function(e){return t&&(0,i.isValidElement)(e)?t(e):e}(e)})),n}function Xw(e,t,n){return null!=n[t]?n[t]:e.props[t]}function Yw(e,t,n){var r=Kw(e.children),o=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,o=Object.create(null),a=[];for(var i in e)i in t?a.length&&(o[i]=a,a=[]):a.push(i);var s={};for(var c in t){if(o[c])for(r=0;r<o[c].length;r++){var l=o[c][r];s[o[c][r]]=n(l)}s[c]=n(c)}for(r=0;r<a.length;r++)s[a[r]]=n(a[r]);return s}(t,r);return Object.keys(o).forEach((function(a){var s=o[a];if((0,i.isValidElement)(s)){var c=a in t,l=a in r,u=t[a],d=(0,i.isValidElement)(u)&&!u.props.in;!l||c&&!d?l||!c||d?l&&c&&(0,i.isValidElement)(u)&&(o[a]=(0,i.cloneElement)(s,{onExited:n.bind(null,s),in:u.props.in,exit:Xw(s,"exit",e),enter:Xw(s,"enter",e)})):o[a]=(0,i.cloneElement)(s,{in:!1}):o[a]=(0,i.cloneElement)(s,{onExited:n.bind(null,s),in:!0,exit:Xw(s,"exit",e),enter:Xw(s,"enter",e)})}})),o}var Qw=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},Jw=function(e){function t(t,n){var r,o=(r=e.call(this,t,n)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r));return r.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},r}Hw(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n,r,o=t.children,a=t.handleExited;return{children:t.firstRender?(n=e,r=a,Kw(n.children,(function(e){return(0,i.cloneElement)(e,{onExited:r.bind(null,e),in:!0,appear:Xw(e,"appear",n),enter:Xw(e,"enter",n),exit:Xw(e,"exit",n)})}))):Yw(e,o,a),firstRender:!1}},n.handleExited=function(e,t){var n=Kw(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=(0,Fe.A)({},t.children);return delete n[e.key],{children:n}})))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=(0,Me.A)(e,["component","childFactory"]),o=this.state.contextValue,a=Qw(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?i.createElement(qw.Provider,{value:o},a):i.createElement(qw.Provider,{value:o},i.createElement(t,r,a))},t}(i.Component);Jw.propTypes={},Jw.defaultProps={component:"div",childFactory:function(e){return e}};const $w=Jw;var Zw=n(3290),ek=n(9303);const tk=function(e){const{className:t,classes:n,pulsate:r=!1,rippleX:o,rippleY:a,rippleSize:s,in:c,onExited:l,timeout:u}=e,[d,h]=i.useState(!1),p=(0,cw.A)(t,n.ripple,n.rippleVisible,r&&n.ripplePulsate),f={width:s,height:s,top:-s/2+a,left:-s/2+o},m=(0,cw.A)(n.child,d&&n.childLeaving,r&&n.childPulsate);return c||d||h(!0),i.useEffect((()=>{if(!c&&null!=l){const e=setTimeout(l,u);return()=>{clearTimeout(e)}}}),[l,c,u]),(0,Be.jsx)("span",{className:p,style:f,children:(0,Be.jsx)("span",{className:m})})};const nk=(0,vw.A)("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]);var rk,ok,ak,ik;const sk=["center","classes","className"];let ck,lk,uk,dk;const hk=(0,Zw.i7)(ck||(ck=rk||(rk=Vw(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"])))),pk=(0,Zw.i7)(lk||(lk=ok||(ok=Vw(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"])))),fk=(0,Zw.i7)(uk||(uk=ak||(ak=Vw(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"])))),mk=(0,Iw.Ay)("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),gk=(0,Iw.Ay)(tk,{name:"MuiTouchRipple",slot:"Ripple"})(dk||(dk=ik||(ik=Vw(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]))),nk.rippleVisible,hk,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),nk.ripplePulsate,(e=>{let{theme:t}=e;return t.transitions.duration.shorter}),nk.child,nk.childLeaving,pk,550,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),nk.childPulsate,fk,(e=>{let{theme:t}=e;return t.transitions.easing.easeInOut})),vk=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiTouchRipple"}),{center:r=!1,classes:o={},className:a}=n,s=(0,Me.A)(n,sk),[c,l]=i.useState([]),u=i.useRef(0),d=i.useRef(null);i.useEffect((()=>{d.current&&(d.current(),d.current=null)}),[c]);const h=i.useRef(!1),p=(0,ek.A)(),f=i.useRef(null),m=i.useRef(null),g=i.useCallback((e=>{const{pulsate:t,rippleX:n,rippleY:r,rippleSize:a,cb:i}=e;l((e=>[...e,(0,Be.jsx)(gk,{classes:{ripple:(0,cw.A)(o.ripple,nk.ripple),rippleVisible:(0,cw.A)(o.rippleVisible,nk.rippleVisible),ripplePulsate:(0,cw.A)(o.ripplePulsate,nk.ripplePulsate),child:(0,cw.A)(o.child,nk.child),childLeaving:(0,cw.A)(o.childLeaving,nk.childLeaving),childPulsate:(0,cw.A)(o.childPulsate,nk.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:a},u.current)])),u.current+=1,d.current=i}),[o]),v=i.useCallback((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};const{pulsate:o=!1,center:a=r||t.pulsate,fakeElement:i=!1}=t;if("mousedown"===(null==e?void 0:e.type)&&h.current)return void(h.current=!1);"touchstart"===(null==e?void 0:e.type)&&(h.current=!0);const s=i?null:m.current,c=s?s.getBoundingClientRect():{width:0,height:0,left:0,top:0};let l,u,d;if(a||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)l=Math.round(c.width/2),u=Math.round(c.height/2);else{const{clientX:t,clientY:n}=e.touches&&e.touches.length>0?e.touches[0]:e;l=Math.round(t-c.left),u=Math.round(n-c.top)}if(a)d=Math.sqrt((2*c.width**2+c.height**2)/3),d%2===0&&(d+=1);else{const e=2*Math.max(Math.abs((s?s.clientWidth:0)-l),l)+2,t=2*Math.max(Math.abs((s?s.clientHeight:0)-u),u)+2;d=Math.sqrt(e**2+t**2)}null!=e&&e.touches?null===f.current&&(f.current=()=>{g({pulsate:o,rippleX:l,rippleY:u,rippleSize:d,cb:n})},p.start(80,(()=>{f.current&&(f.current(),f.current=null)}))):g({pulsate:o,rippleX:l,rippleY:u,rippleSize:d,cb:n})}),[r,g,p]),y=i.useCallback((()=>{v({},{pulsate:!0})}),[v]),b=i.useCallback(((e,t)=>{if(p.clear(),"touchend"===(null==e?void 0:e.type)&&f.current)return f.current(),f.current=null,void p.start(0,(()=>{b(e,t)}));f.current=null,l((e=>e.length>0?e.slice(1):e)),d.current=t}),[p]);return i.useImperativeHandle(t,(()=>({pulsate:y,start:v,stop:b})),[y,v,b]),(0,Be.jsx)(mk,(0,Fe.A)({className:(0,cw.A)(nk.root,o.root,a),ref:m},s,{children:(0,Be.jsx)($w,{component:null,exit:!0,children:c})}))})),yk=vk;function bk(e){return(0,Aw.Ay)("MuiButtonBase",e)}const xk=(0,vw.A)("MuiButtonBase",["root","disabled","focusVisible"]),wk=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],kk=(0,Iw.Ay)("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},["&.".concat(xk.disabled)]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Sk=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiButtonBase"}),{action:r,centerRipple:o=!1,children:a,className:s,component:c="button",disabled:l=!1,disableRipple:u=!1,disableTouchRipple:d=!1,focusRipple:h=!1,LinkComponent:p="a",onBlur:f,onClick:m,onContextMenu:g,onDragLeave:v,onFocus:y,onFocusVisible:b,onKeyDown:x,onKeyUp:w,onMouseDown:k,onMouseLeave:S,onMouseUp:I,onTouchEnd:C,onTouchMove:A,onTouchStart:E,tabIndex:T=0,TouchRippleProps:N,touchRippleRef:R,type:_}=n,D=(0,Me.A)(n,wk),O=i.useRef(null),F=i.useRef(null),M=(0,Uw.A)(F,R),{isFocusVisibleRef:P,onFocus:L,onBlur:z,ref:B}=(0,jw.A)(),[U,W]=i.useState(!1);l&&U&&W(!1),i.useImperativeHandle(r,(()=>({focusVisible:()=>{W(!0),O.current.focus()}})),[]);const[j,V]=i.useState(!1);i.useEffect((()=>{V(!0)}),[]);const G=j&&!u&&!l;function H(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;return(0,Ww.A)((r=>{t&&t(r);return!n&&F.current&&F.current[e](r),!0}))}i.useEffect((()=>{U&&h&&!u&&j&&F.current.pulsate()}),[u,h,U,j]);const q=H("start",k),K=H("stop",g),X=H("stop",v),Y=H("stop",I),Q=H("stop",(e=>{U&&e.preventDefault(),S&&S(e)})),J=H("start",E),$=H("stop",C),Z=H("stop",A),ee=H("stop",(e=>{z(e),!1===P.current&&W(!1),f&&f(e)}),!1),te=(0,Ww.A)((e=>{O.current||(O.current=e.currentTarget),L(e),!0===P.current&&(W(!0),b&&b(e)),y&&y(e)})),ne=()=>{const e=O.current;return c&&"button"!==c&&!("A"===e.tagName&&e.href)},re=i.useRef(!1),oe=(0,Ww.A)((e=>{h&&!re.current&&U&&F.current&&" "===e.key&&(re.current=!0,F.current.stop(e,(()=>{F.current.start(e)}))),e.target===e.currentTarget&&ne()&&" "===e.key&&e.preventDefault(),x&&x(e),e.target===e.currentTarget&&ne()&&"Enter"===e.key&&!l&&(e.preventDefault(),m&&m(e))})),ae=(0,Ww.A)((e=>{h&&" "===e.key&&F.current&&U&&!e.defaultPrevented&&(re.current=!1,F.current.stop(e,(()=>{F.current.pulsate(e)}))),w&&w(e),m&&e.target===e.currentTarget&&ne()&&" "===e.key&&!e.defaultPrevented&&m(e)}));let ie=c;"button"===ie&&(D.href||D.to)&&(ie=p);const se={};"button"===ie?(se.type=void 0===_?"button":_,se.disabled=l):(D.href||D.to||(se.role="button"),l&&(se["aria-disabled"]=l));const ce=(0,Uw.A)(t,B,O);const le=(0,Fe.A)({},n,{centerRipple:o,component:c,disabled:l,disableRipple:u,disableTouchRipple:d,focusRipple:h,tabIndex:T,focusVisible:U}),ue=(e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:r,classes:o}=e,a={root:["root",t&&"disabled",n&&"focusVisible"]},i=(0,kw.A)(a,bk,o);return n&&r&&(i.root+=" ".concat(r)),i})(le);return(0,Be.jsxs)(kk,(0,Fe.A)({as:ie,className:(0,cw.A)(ue.root,s),ownerState:le,onBlur:ee,onClick:m,onContextMenu:K,onFocus:te,onKeyDown:oe,onKeyUp:ae,onMouseDown:q,onMouseLeave:Q,onMouseUp:Y,onDragLeave:X,onTouchEnd:$,onTouchMove:Z,onTouchStart:J,ref:ce,tabIndex:l?-1:T,type:_},se,D,{children:[a,G?(0,Be.jsx)(yk,(0,Fe.A)({ref:M,center:o},N)):null]}))})),Ik=Sk;var Ck=n(7328),Ak=n(5013);function Ek(e){return(0,Aw.Ay)("MuiListItem",e)}const Tk=(0,vw.A)("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]);function Nk(e){return(0,Aw.Ay)("MuiListItemButton",e)}const Rk=(0,vw.A)("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function _k(e){return(0,Aw.Ay)("MuiListItemSecondaryAction",e)}(0,vw.A)("MuiListItemSecondaryAction",["root","disableGutters"]);const Dk=["className"],Ok=(0,Iw.Ay)("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.disableGutters&&t.disableGutters]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"},t.disableGutters&&{right:0})})),Fk=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiListItemSecondaryAction"}),{className:r}=n,o=(0,Me.A)(n,Dk),a=i.useContext(Ow),s=(0,Fe.A)({},n,{disableGutters:a.disableGutters}),c=(e=>{const{disableGutters:t,classes:n}=e,r={root:["root",t&&"disableGutters"]};return(0,kw.A)(r,_k,n)})(s);return(0,Be.jsx)(Ok,(0,Fe.A)({className:(0,cw.A)(c.root,r),ownerState:s,ref:t},o))}));Fk.muiName="ListItemSecondaryAction";const Mk=Fk,Pk=["className"],Lk=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected","slotProps","slots"],zk=(0,Iw.Ay)("div",{name:"MuiListItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,"flex-start"===n.alignItems&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters,!n.disablePadding&&t.padding,n.button&&t.button,n.hasSecondaryAction&&t.secondaryAction]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!n.disablePadding&&(0,Fe.A)({paddingTop:8,paddingBottom:8},n.dense&&{paddingTop:4,paddingBottom:4},!n.disableGutters&&{paddingLeft:16,paddingRight:16},!!n.secondaryAction&&{paddingRight:48}),!!n.secondaryAction&&{["& > .".concat(Rk.root)]:{paddingRight:48}},{["&.".concat(Tk.focusVisible)]:{backgroundColor:(t.vars||t).palette.action.focus},["&.".concat(Tk.selected)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):(0,Sw.X4)(t.palette.primary.main,t.palette.action.selectedOpacity),["&.".concat(Tk.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):(0,Sw.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},["&.".concat(Tk.disabled)]:{opacity:(t.vars||t).palette.action.disabledOpacity}},"flex-start"===n.alignItems&&{alignItems:"flex-start"},n.divider&&{borderBottom:"1px solid ".concat((t.vars||t).palette.divider),backgroundClip:"padding-box"},n.button&&{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(Tk.selected,":hover")]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):(0,Sw.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):(0,Sw.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}}},n.hasSecondaryAction&&{paddingRight:48})})),Bk=(0,Iw.Ay)("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,t)=>t.container})({position:"relative"}),Uk=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiListItem"}),{alignItems:r="center",autoFocus:o=!1,button:a=!1,children:s,className:c,component:l,components:u={},componentsProps:d={},ContainerComponent:h="li",ContainerProps:{className:p}={},dense:f=!1,disabled:m=!1,disableGutters:g=!1,disablePadding:v=!1,divider:y=!1,focusVisibleClassName:b,secondaryAction:x,selected:w=!1,slotProps:k={},slots:S={}}=n,I=(0,Me.A)(n.ContainerProps,Pk),C=(0,Me.A)(n,Lk),A=i.useContext(Ow),E=i.useMemo((()=>({dense:f||A.dense||!1,alignItems:r,disableGutters:g})),[r,A.dense,f,g]),T=i.useRef(null);(0,Ak.A)((()=>{o&&T.current&&T.current.focus()}),[o]);const N=i.Children.toArray(s),R=N.length&&(0,Ck.A)(N[N.length-1],["ListItemSecondaryAction"]),_=(0,Fe.A)({},n,{alignItems:r,autoFocus:o,button:a,dense:E.dense,disabled:m,disableGutters:g,disablePadding:v,divider:y,hasSecondaryAction:R,selected:w}),D=(e=>{const{alignItems:t,button:n,classes:r,dense:o,disabled:a,disableGutters:i,disablePadding:s,divider:c,hasSecondaryAction:l,selected:u}=e,d={root:["root",o&&"dense",!i&&"gutters",!s&&"padding",c&&"divider",a&&"disabled",n&&"button","flex-start"===t&&"alignItemsFlexStart",l&&"secondaryAction",u&&"selected"],container:["container"]};return(0,kw.A)(d,Ek,r)})(_),O=(0,Uw.A)(T,t),F=S.root||u.Root||zk,M=k.root||d.root||{},P=(0,Fe.A)({className:(0,cw.A)(D.root,M.className,c),disabled:m},C);let L=l||"li";return a&&(P.component=l||"div",P.focusVisibleClassName=(0,cw.A)(Tk.focusVisible,b),L=Ik),R?(L=P.component||l?L:"div","li"===h&&("li"===L?L="div":"li"===P.component&&(P.component="div")),(0,Be.jsx)(Ow.Provider,{value:E,children:(0,Be.jsxs)(Bk,(0,Fe.A)({as:h,className:(0,cw.A)(D.container,p),ref:O,ownerState:_},I,{children:[(0,Be.jsx)(F,(0,Fe.A)({},M,!Bw(F)&&{as:L,ownerState:(0,Fe.A)({},_,M.ownerState)},P,{children:N})),N.pop()]}))})):(0,Be.jsx)(Ow.Provider,{value:E,children:(0,Be.jsxs)(F,(0,Fe.A)({},M,{as:L,ref:O},!Bw(F)&&{ownerState:(0,Fe.A)({},_,M.ownerState)},P,{children:[N,x&&(0,Be.jsx)(Mk,{children:x})]}))})})),Wk=Uk;var jk=n(1475);const Vk=["alignItems","autoFocus","component","children","dense","disableGutters","divider","focusVisibleClassName","selected","className"],Gk=(0,Iw.Ay)(Ik,{shouldForwardProp:e=>(0,jk.A)(e)||"classes"===e,name:"MuiListItemButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,"flex-start"===n.alignItems&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(Rk.selected)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):(0,Sw.X4)(t.palette.primary.main,t.palette.action.selectedOpacity),["&.".concat(Rk.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):(0,Sw.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},["&.".concat(Rk.selected,":hover")]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):(0,Sw.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.primary.mainChannel," / ").concat(t.vars.palette.action.selectedOpacity,")"):(0,Sw.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}},["&.".concat(Rk.focusVisible)]:{backgroundColor:(t.vars||t).palette.action.focus},["&.".concat(Rk.disabled)]:{opacity:(t.vars||t).palette.action.disabledOpacity}},n.divider&&{borderBottom:"1px solid ".concat((t.vars||t).palette.divider),backgroundClip:"padding-box"},"flex-start"===n.alignItems&&{alignItems:"flex-start"},!n.disableGutters&&{paddingLeft:16,paddingRight:16},n.dense&&{paddingTop:4,paddingBottom:4})})),Hk=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiListItemButton"}),{alignItems:r="center",autoFocus:o=!1,component:a="div",children:s,dense:c=!1,disableGutters:l=!1,divider:u=!1,focusVisibleClassName:d,selected:h=!1,className:p}=n,f=(0,Me.A)(n,Vk),m=i.useContext(Ow),g=i.useMemo((()=>({dense:c||m.dense||!1,alignItems:r,disableGutters:l})),[r,m.dense,c,l]),v=i.useRef(null);(0,Ak.A)((()=>{o&&v.current&&v.current.focus()}),[o]);const y=(0,Fe.A)({},n,{alignItems:r,dense:g.dense,disableGutters:l,divider:u,selected:h}),b=(e=>{const{alignItems:t,classes:n,dense:r,disabled:o,disableGutters:a,divider:i,selected:s}=e,c={root:["root",r&&"dense",!a&&"gutters",i&&"divider",o&&"disabled","flex-start"===t&&"alignItemsFlexStart",s&&"selected"]},l=(0,kw.A)(c,Nk,n);return(0,Fe.A)({},n,l)})(y),x=(0,Uw.A)(v,t);return(0,Be.jsx)(Ow.Provider,{value:g,children:(0,Be.jsx)(Gk,(0,Fe.A)({ref:x,href:f.href||f.to,component:(f.href||f.to)&&"div"===a?"button":a,focusVisibleClassName:(0,cw.A)(b.focusVisible,d),ownerState:y,className:(0,cw.A)(b.root,p)},f,{classes:b,children:s}))})})),qk=Hk;function Kk(e){return(0,Aw.Ay)("MuiListItemIcon",e)}(0,vw.A)("MuiListItemIcon",["root","alignItemsFlexStart"]);const Xk=["className"],Yk=(0,Iw.Ay)("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"flex-start"===n.alignItems&&t.alignItemsFlexStart]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex"},"flex-start"===n.alignItems&&{marginTop:8})})),Qk=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiListItemIcon"}),{className:r}=n,o=(0,Me.A)(n,Xk),a=i.useContext(Ow),s=(0,Fe.A)({},n,{alignItems:a.alignItems}),c=(e=>{const{alignItems:t,classes:n}=e,r={root:["root","flex-start"===t&&"alignItemsFlexStart"]};return(0,kw.A)(r,Kk,n)})(s);return(0,Be.jsx)(Yk,(0,Fe.A)({className:(0,cw.A)(c.root,r),ownerState:s,ref:t},o))})),Jk=Qk;var $k=n(6803);function Zk(e){return(0,Aw.Ay)("MuiTypography",e)}(0,vw.A)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const eS=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],tS=(0,Iw.Ay)("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t["align".concat((0,$k.A)(n.align))],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({margin:0},"inherit"===n.variant&&{font:"inherit"},"inherit"!==n.variant&&t.typography[n.variant],"inherit"!==n.align&&{textAlign:n.align},n.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.gutterBottom&&{marginBottom:"0.35em"},n.paragraph&&{marginBottom:16})})),nS={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},rS={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},oS=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiTypography"}),r=(e=>rS[e]||e)(n.color),o=(0,dw.A)((0,Fe.A)({},n,{color:r})),{align:a="inherit",className:i,component:s,gutterBottom:c=!1,noWrap:l=!1,paragraph:u=!1,variant:d="body1",variantMapping:h=nS}=o,p=(0,Me.A)(o,eS),f=(0,Fe.A)({},o,{align:a,color:r,className:i,component:s,gutterBottom:c,noWrap:l,paragraph:u,variant:d,variantMapping:h}),m=s||(u?"p":h[d]||nS[d])||"span",g=(e=>{const{align:t,gutterBottom:n,noWrap:r,paragraph:o,variant:a,classes:i}=e,s={root:["root",a,"inherit"!==e.align&&"align".concat((0,$k.A)(t)),n&&"gutterBottom",r&&"noWrap",o&&"paragraph"]};return(0,kw.A)(s,Zk,i)})(f);return(0,Be.jsx)(tS,(0,Fe.A)({as:m,ref:t,ownerState:f,className:(0,cw.A)(g.root,i)},p))})),aS=oS;function iS(e){return(0,Aw.Ay)("MuiListItemText",e)}const sS=(0,vw.A)("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),cS=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],lS=(0,Iw.Ay)("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{["& .".concat(sS.primary)]:t.primary},{["& .".concat(sS.secondary)]:t.secondary},t.root,n.inset&&t.inset,n.primary&&n.secondary&&t.multiline,n.dense&&t.dense]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},t.primary&&t.secondary&&{marginTop:6,marginBottom:6},t.inset&&{paddingLeft:56})})),uS=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiListItemText"}),{children:r,className:o,disableTypography:a=!1,inset:s=!1,primary:c,primaryTypographyProps:l,secondary:u,secondaryTypographyProps:d}=n,h=(0,Me.A)(n,cS),{dense:p}=i.useContext(Ow);let f=null!=c?c:r,m=u;const g=(0,Fe.A)({},n,{disableTypography:a,inset:s,primary:!!f,secondary:!!m,dense:p}),v=(e=>{const{classes:t,inset:n,primary:r,secondary:o,dense:a}=e,i={root:["root",n&&"inset",a&&"dense",r&&o&&"multiline"],primary:["primary"],secondary:["secondary"]};return(0,kw.A)(i,iS,t)})(g);return null==f||f.type===aS||a||(f=(0,Be.jsx)(aS,(0,Fe.A)({variant:p?"body2":"body1",className:v.primary,component:null!=l&&l.variant?void 0:"span",display:"block"},l,{children:f}))),null==m||m.type===aS||a||(m=(0,Be.jsx)(aS,(0,Fe.A)({variant:"body2",className:v.secondary,color:"text.secondary",display:"block"},d,{children:m}))),(0,Be.jsxs)(lS,(0,Fe.A)({className:(0,cw.A)(v.root,o),ownerState:g,ref:t},h,{children:[f,m]}))})),dS=uS;var hS=n(9662);const pS=(0,hS.A)((0,Be.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function fS(e){return(0,Aw.Ay)("MuiAvatar",e)}(0,vw.A)("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);var mS=n(3462);const gS=function(e,t,n){return void 0===e||Bw(e)?t:(0,Fe.A)({},t,{ownerState:(0,Fe.A)({},t.ownerState,n)})};const vS=function(e,t,n){return"function"===typeof e?e(t,n):e};const yS=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const n={};return Object.keys(e).filter((n=>n.match(/^on[A-Z]/)&&"function"===typeof e[n]&&!t.includes(n))).forEach((t=>{n[t]=e[t]})),n};const bS=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t]))).forEach((n=>{t[n]=e[n]})),t};const xS=function(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:o,className:a}=e;if(!t){const e=(0,cw.A)(null==n?void 0:n.className,a,null==o?void 0:o.className,null==r?void 0:r.className),t=(0,Fe.A)({},null==n?void 0:n.style,null==o?void 0:o.style,null==r?void 0:r.style),i=(0,Fe.A)({},n,o,r);return e.length>0&&(i.className=e),Object.keys(t).length>0&&(i.style=t),{props:i,internalRef:void 0}}const i=yS((0,Fe.A)({},o,r)),s=bS(r),c=bS(o),l=t(i),u=(0,cw.A)(null==l?void 0:l.className,null==n?void 0:n.className,a,null==o?void 0:o.className,null==r?void 0:r.className),d=(0,Fe.A)({},null==l?void 0:l.style,null==n?void 0:n.style,null==o?void 0:o.style,null==r?void 0:r.style),h=(0,Fe.A)({},l,n,c,s);return u.length>0&&(h.className=u),Object.keys(d).length>0&&(h.style=d),{props:h,internalRef:l.ref}},wS=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],kS=["component","slots","slotProps"],SS=["component"];function IS(e,t){const{className:n,elementType:r,ownerState:o,externalForwardedProps:a,getSlotOwnerState:i,internalForwardedProps:s}=t,c=(0,Me.A)(t,wS),{component:l,slots:u={[e]:void 0},slotProps:d={[e]:void 0}}=a,h=(0,Me.A)(a,kS),p=u[e]||r,f=vS(d[e],o),m=xS((0,Fe.A)({className:n},c,{externalForwardedProps:"root"===e?h:void 0,externalSlotProps:f})),{props:{component:g},internalRef:v}=m,y=(0,Me.A)(m.props,SS),b=(0,mS.A)(v,null==f?void 0:f.ref,t.ref),x=i?i(y):{},w=(0,Fe.A)({},o,x),k="root"===e?g||l:g,S=gS(p,(0,Fe.A)({},"root"===e&&!l&&!u[e]&&s,"root"!==e&&!u[e]&&s,y,k&&{as:k},{ref:b}),w);return Object.keys(x).forEach((e=>{delete S[e]})),[p,S]}const CS=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],AS=(0,Iw.Ay)("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],n.colorDefault&&t.colorDefault]}})((e=>{let{theme:t}=e;return{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:(0,Fe.A)({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:(0,Fe.A)({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]}})),ES=(0,Iw.Ay)("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(e,t)=>t.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),TS=(0,Iw.Ay)(pS,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(e,t)=>t.fallback})({width:"75%",height:"75%"});const NS=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiAvatar"}),{alt:r,children:o,className:a,component:s="div",slots:c={},slotProps:l={},imgProps:u,sizes:d,src:h,srcSet:p,variant:f="circular"}=n,m=(0,Me.A)(n,CS);let g=null;const v=function(e){let{crossOrigin:t,referrerPolicy:n,src:r,srcSet:o}=e;const[a,s]=i.useState(!1);return i.useEffect((()=>{if(!r&&!o)return;s(!1);let e=!0;const a=new Image;return a.onload=()=>{e&&s("loaded")},a.onerror=()=>{e&&s("error")},a.crossOrigin=t,a.referrerPolicy=n,a.src=r,o&&(a.srcset=o),()=>{e=!1}}),[t,n,r,o]),a}((0,Fe.A)({},u,{src:h,srcSet:p})),y=h||p,b=y&&"error"!==v,x=(0,Fe.A)({},n,{colorDefault:!b,component:s,variant:f}),w=(e=>{const{classes:t,variant:n,colorDefault:r}=e,o={root:["root",n,r&&"colorDefault"],img:["img"],fallback:["fallback"]};return(0,kw.A)(o,fS,t)})(x),[k,S]=IS("img",{className:w.img,elementType:ES,externalForwardedProps:{slots:c,slotProps:{img:(0,Fe.A)({},u,l.img)}},additionalProps:{alt:r,src:h,srcSet:p,sizes:d},ownerState:x});return g=b?(0,Be.jsx)(k,(0,Fe.A)({},S)):o||0===o?o:y&&r?r[0]:(0,Be.jsx)(TS,{ownerState:x,className:w.fallback}),(0,Be.jsx)(AS,(0,Fe.A)({as:s,ownerState:x,className:(0,cw.A)(w.root,a),ref:t},m,{children:g}))})),RS=NS,_S=e=>{let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,(t/100).toFixed(2)};function DS(e){return(0,Aw.Ay)("MuiPaper",e)}(0,vw.A)("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const OS=["className","component","elevation","square","variant"],FS=(0,Iw.Ay)("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],!n.square&&t.rounded,"elevation"===n.variant&&t["elevation".concat(n.elevation)]]}})((e=>{let{theme:t,ownerState:n}=e;var r;return(0,Fe.A)({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!n.square&&{borderRadius:t.shape.borderRadius},"outlined"===n.variant&&{border:"1px solid ".concat((t.vars||t).palette.divider)},"elevation"===n.variant&&(0,Fe.A)({boxShadow:(t.vars||t).shadows[n.elevation]},!t.vars&&"dark"===t.palette.mode&&{backgroundImage:"linear-gradient(".concat((0,Sw.X4)("#fff",_S(n.elevation)),", ").concat((0,Sw.X4)("#fff",_S(n.elevation)),")")},t.vars&&{backgroundImage:null==(r=t.vars.overlays)?void 0:r[n.elevation]}))})),MS=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiPaper"}),{className:r,component:o="div",elevation:a=1,square:i=!1,variant:s="elevation"}=n,c=(0,Me.A)(n,OS),l=(0,Fe.A)({},n,{component:o,elevation:a,square:i,variant:s}),u=(e=>{const{square:t,elevation:n,variant:r,classes:o}=e,a={root:["root",r,!t&&"rounded","elevation"===r&&"elevation".concat(n)]};return(0,kw.A)(a,DS,o)})(l);return(0,Be.jsx)(FS,(0,Fe.A)({as:o,ownerState:l,className:(0,cw.A)(u.root,r),ref:t},c))})),PS=MS;function LS(e){return(0,Aw.Ay)("MuiAppBar",e)}(0,vw.A)("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const zS=["className","color","enableColorOnDark","position"],BS=(e,t)=>e?"".concat(null==e?void 0:e.replace(")",""),", ").concat(t,")"):t,US=(0,Iw.Ay)(PS,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["position".concat((0,$k.A)(n.position))],t["color".concat((0,$k.A)(n.color))]]}})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[900];return(0,Fe.A)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===n.position&&{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===n.position&&{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},"sticky"===n.position&&{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},"static"===n.position&&{position:"static"},"relative"===n.position&&{position:"relative"},!t.vars&&(0,Fe.A)({},"default"===n.color&&{backgroundColor:r,color:t.palette.getContrastText(r)},n.color&&"default"!==n.color&&"inherit"!==n.color&&"transparent"!==n.color&&{backgroundColor:t.palette[n.color].main,color:t.palette[n.color].contrastText},"inherit"===n.color&&{color:"inherit"},"dark"===t.palette.mode&&!n.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===n.color&&(0,Fe.A)({backgroundColor:"transparent",color:"inherit"},"dark"===t.palette.mode&&{backgroundImage:"none"})),t.vars&&(0,Fe.A)({},"default"===n.color&&{"--AppBar-background":n.enableColorOnDark?t.vars.palette.AppBar.defaultBg:BS(t.vars.palette.AppBar.darkBg,t.vars.palette.AppBar.defaultBg),"--AppBar-color":n.enableColorOnDark?t.vars.palette.text.primary:BS(t.vars.palette.AppBar.darkColor,t.vars.palette.text.primary)},n.color&&!n.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":n.enableColorOnDark?t.vars.palette[n.color].main:BS(t.vars.palette.AppBar.darkBg,t.vars.palette[n.color].main),"--AppBar-color":n.enableColorOnDark?t.vars.palette[n.color].contrastText:BS(t.vars.palette.AppBar.darkColor,t.vars.palette[n.color].contrastText)},!["inherit","transparent"].includes(n.color)&&{backgroundColor:"var(--AppBar-background)"},{color:"inherit"===n.color?"inherit":"var(--AppBar-color)"},"transparent"===n.color&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))})),WS=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiAppBar"}),{className:r,color:o="primary",enableColorOnDark:a=!1,position:i="fixed"}=n,s=(0,Me.A)(n,zS),c=(0,Fe.A)({},n,{color:o,position:i,enableColorOnDark:a}),l=(e=>{const{color:t,position:n,classes:r}=e,o={root:["root","color".concat((0,$k.A)(t)),"position".concat((0,$k.A)(n))]};return(0,kw.A)(o,LS,r)})(c);return(0,Be.jsx)(US,(0,Fe.A)({square:!0,component:"header",ownerState:c,elevation:4,className:(0,cw.A)(l.root,r,"fixed"===i&&"mui-fixed"),ref:t},s))})),jS=WS;function VS(e){return(0,Aw.Ay)("MuiToolbar",e)}(0,vw.A)("MuiToolbar",["root","gutters","regular","dense"]);const GS=["className","component","disableGutters","variant"],HS=(0,Iw.Ay)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableGutters&&t.gutters,t[n.variant]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({position:"relative",display:"flex",alignItems:"center"},!n.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}},"dense"===n.variant&&{minHeight:48})}),(e=>{let{theme:t,ownerState:n}=e;return"regular"===n.variant&&t.mixins.toolbar})),qS=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiToolbar"}),{className:r,component:o="div",disableGutters:a=!1,variant:i="regular"}=n,s=(0,Me.A)(n,GS),c=(0,Fe.A)({},n,{component:o,disableGutters:a,variant:i}),l=(e=>{const{classes:t,disableGutters:n,variant:r}=e,o={root:["root",!n&&"gutters",r]};return(0,kw.A)(o,VS,t)})(c);return(0,Be.jsx)(HS,(0,Fe.A)({as:o,className:(0,cw.A)(l.root,r),ref:t,ownerState:c},s))})),KS=qS;var XS=n(3030);function YS(e){return(0,Aw.Ay)("MuiButton",e)}const QS=(0,vw.A)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);const JS=i.createContext({});const $S=i.createContext(void 0),ZS=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],eI=e=>(0,Fe.A)({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),tI=(0,Iw.Ay)(Ik,{shouldForwardProp:e=>(0,jk.A)(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t["".concat(n.variant).concat((0,$k.A)(n.color))],t["size".concat((0,$k.A)(n.size))],t["".concat(n.variant,"Size").concat((0,$k.A)(n.size))],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})((e=>{let{theme:t,ownerState:n}=e;var r,o;const a="light"===t.palette.mode?t.palette.grey[300]:t.palette.grey[800],i="light"===t.palette.mode?t.palette.grey.A100:t.palette.grey[700];return(0,Fe.A)({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":(0,Fe.A)({textDecoration:"none",backgroundColor:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,Sw.X4)(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===n.variant&&"inherit"!==n.color&&{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,Sw.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===n.variant&&"inherit"!==n.color&&{border:"1px solid ".concat((t.vars||t).palette[n.color].main),backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,Sw.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===n.variant&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:i,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},"contained"===n.variant&&"inherit"!==n.color&&{backgroundColor:(t.vars||t).palette[n.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[n.color].main}}),"&:active":(0,Fe.A)({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[8]}),["&.".concat(QS.focusVisible)]:(0,Fe.A)({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[6]}),["&.".concat(QS.disabled)]:(0,Fe.A)({color:(t.vars||t).palette.action.disabled},"outlined"===n.variant&&{border:"1px solid ".concat((t.vars||t).palette.action.disabledBackground)},"contained"===n.variant&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},"text"===n.variant&&{padding:"6px 8px"},"text"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main},"outlined"===n.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main,border:t.vars?"1px solid rgba(".concat(t.vars.palette[n.color].mainChannel," / 0.5)"):"1px solid ".concat((0,Sw.X4)(t.palette[n.color].main,.5))},"contained"===n.variant&&{color:t.vars?t.vars.palette.text.primary:null==(r=(o=t.palette).getContrastText)?void 0:r.call(o,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:a,boxShadow:(t.vars||t).shadows[2]},"contained"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].contrastText,backgroundColor:(t.vars||t).palette[n.color].main},"inherit"===n.color&&{color:"inherit",borderColor:"currentColor"},"small"===n.size&&"text"===n.variant&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"text"===n.variant&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"outlined"===n.variant&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"outlined"===n.variant&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"contained"===n.variant&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"contained"===n.variant&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},n.fullWidth&&{width:"100%"})}),(e=>{let{ownerState:t}=e;return t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},["&.".concat(QS.focusVisible)]:{boxShadow:"none"},"&:active":{boxShadow:"none"},["&.".concat(QS.disabled)]:{boxShadow:"none"}}})),nI=(0,Iw.Ay)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,t["iconSize".concat((0,$k.A)(n.size))]]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},eI(t))})),rI=(0,Iw.Ay)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,t["iconSize".concat((0,$k.A)(n.size))]]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},eI(t))})),oI=i.forwardRef((function(e,t){const n=i.useContext(JS),r=i.useContext($S),o=(0,XS.A)(n,e),a=(0,Cw.b)({props:o,name:"MuiButton"}),{children:s,color:c="primary",component:l="button",className:u,disabled:d=!1,disableElevation:h=!1,disableFocusRipple:p=!1,endIcon:f,focusVisibleClassName:m,fullWidth:g=!1,size:v="medium",startIcon:y,type:b,variant:x="text"}=a,w=(0,Me.A)(a,ZS),k=(0,Fe.A)({},a,{color:c,component:l,disabled:d,disableElevation:h,disableFocusRipple:p,fullWidth:g,size:v,type:b,variant:x}),S=(e=>{const{color:t,disableElevation:n,fullWidth:r,size:o,variant:a,classes:i}=e,s={root:["root",a,"".concat(a).concat((0,$k.A)(t)),"size".concat((0,$k.A)(o)),"".concat(a,"Size").concat((0,$k.A)(o)),"color".concat((0,$k.A)(t)),n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon","iconSize".concat((0,$k.A)(o))],endIcon:["icon","endIcon","iconSize".concat((0,$k.A)(o))]},c=(0,kw.A)(s,YS,i);return(0,Fe.A)({},i,c)})(k),I=y&&(0,Be.jsx)(nI,{className:S.startIcon,ownerState:k,children:y}),C=f&&(0,Be.jsx)(rI,{className:S.endIcon,ownerState:k,children:f}),A=r||"";return(0,Be.jsxs)(tI,(0,Fe.A)({ownerState:k,className:(0,cw.A)(n.className,S.root,u,A),component:l,disabled:d,focusRipple:!p,focusVisibleClassName:(0,cw.A)(S.focusVisible,m),ref:t,type:b},w,{classes:S,children:[I,s,C]}))})),aI=oI;function iI(e){return(0,Aw.Ay)("MuiIconButton",e)}const sI=(0,vw.A)("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),cI=["edge","children","className","color","disabled","disableFocusRipple","size"],lI=(0,Iw.Ay)(Ik,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"default"!==n.color&&t["color".concat((0,$k.A)(n.color))],n.edge&&t["edge".concat((0,$k.A)(n.edge))],t["size".concat((0,$k.A)(n.size))]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!n.disableRipple&&{"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,Sw.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===n.edge&&{marginLeft:"small"===n.size?-3:-12},"end"===n.edge&&{marginRight:"small"===n.size?-3:-12})}),(e=>{let{theme:t,ownerState:n}=e;var r;const o=null==(r=(t.vars||t).palette)?void 0:r[n.color];return(0,Fe.A)({},"inherit"===n.color&&{color:"inherit"},"inherit"!==n.color&&"default"!==n.color&&(0,Fe.A)({color:null==o?void 0:o.main},!n.disableRipple&&{"&:hover":(0,Fe.A)({},o&&{backgroundColor:t.vars?"rgba(".concat(o.mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,Sw.X4)(o.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),"small"===n.size&&{padding:5,fontSize:t.typography.pxToRem(18)},"large"===n.size&&{padding:12,fontSize:t.typography.pxToRem(28)},{["&.".concat(sI.disabled)]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})})),uI=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiIconButton"}),{edge:r=!1,children:o,className:a,color:i="default",disabled:s=!1,disableFocusRipple:c=!1,size:l="medium"}=n,u=(0,Me.A)(n,cI),d=(0,Fe.A)({},n,{edge:r,color:i,disabled:s,disableFocusRipple:c,size:l}),h=(e=>{const{classes:t,disabled:n,color:r,edge:o,size:a}=e,i={root:["root",n&&"disabled","default"!==r&&"color".concat((0,$k.A)(r)),o&&"edge".concat((0,$k.A)(o)),"size".concat((0,$k.A)(a))]};return(0,kw.A)(i,iI,t)})(d);return(0,Be.jsx)(lI,(0,Fe.A)({className:(0,cw.A)(h.root,a),centerRipple:!0,focusRipple:!c,disabled:s,ref:t},u,{ownerState:d,children:o}))})),dI=uI,hI=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];const pI=function(e){var t;const{elementType:n,externalSlotProps:r,ownerState:o,skipResolvingSlotProps:a=!1}=e,i=(0,Me.A)(e,hI),s=a?{}:vS(r,o),{props:c,internalRef:l}=xS((0,Fe.A)({},i,{externalSlotProps:s})),u=(0,mS.A)(l,null==s?void 0:s.ref,null==(t=e.additionalProps)?void 0:t.ref);return gS(n,(0,Fe.A)({},c,{ref:u}),o)};function fI(e){var t;return parseInt(i.version,10)>=19?(null==e||null==(t=e.props)?void 0:t.ref)||null:(null==e?void 0:e.ref)||null}var mI=n(1668);const gI=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function vI(e){const t=[],n=[];return Array.from(e.querySelectorAll(gI)).forEach(((e,r)=>{const o=function(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==o&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;const t=t=>e.ownerDocument.querySelector('input[type="radio"]'.concat(t));let n=t('[name="'.concat(e.name,'"]:checked'));return n||(n=t('[name="'.concat(e.name,'"]'))),n!==e}(e))}(e)&&(0===o?t.push(e):n.push({documentOrder:r,tabIndex:o,node:e}))})),n.sort(((e,t)=>e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex)).map((e=>e.node)).concat(t)}function yI(){return!0}const bI=function(e){const{children:t,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:o=!1,getTabbable:a=vI,isEnabled:s=yI,open:c}=e,l=i.useRef(!1),u=i.useRef(null),d=i.useRef(null),h=i.useRef(null),p=i.useRef(null),f=i.useRef(!1),m=i.useRef(null),g=(0,mS.A)(fI(t),m),v=i.useRef(null);i.useEffect((()=>{c&&m.current&&(f.current=!n)}),[n,c]),i.useEffect((()=>{if(!c||!m.current)return;const e=(0,mI.A)(m.current);return m.current.contains(e.activeElement)||(m.current.hasAttribute("tabIndex")||m.current.setAttribute("tabIndex","-1"),f.current&&m.current.focus()),()=>{o||(h.current&&h.current.focus&&(l.current=!0,h.current.focus()),h.current=null)}}),[c]),i.useEffect((()=>{if(!c||!m.current)return;const e=(0,mI.A)(m.current),t=t=>{v.current=t,!r&&s()&&"Tab"===t.key&&e.activeElement===m.current&&t.shiftKey&&(l.current=!0,d.current&&d.current.focus())},n=()=>{const t=m.current;if(null===t)return;if(!e.hasFocus()||!s()||l.current)return void(l.current=!1);if(t.contains(e.activeElement))return;if(r&&e.activeElement!==u.current&&e.activeElement!==d.current)return;if(e.activeElement!==p.current)p.current=null;else if(null!==p.current)return;if(!f.current)return;let n=[];if(e.activeElement!==u.current&&e.activeElement!==d.current||(n=a(m.current)),n.length>0){var o,i;const e=Boolean((null==(o=v.current)?void 0:o.shiftKey)&&"Tab"===(null==(i=v.current)?void 0:i.key)),t=n[0],r=n[n.length-1];"string"!==typeof t&&"string"!==typeof r&&(e?r.focus():t.focus())}else t.focus()};e.addEventListener("focusin",n),e.addEventListener("keydown",t,!0);const o=setInterval((()=>{e.activeElement&&"BODY"===e.activeElement.tagName&&n()}),50);return()=>{clearInterval(o),e.removeEventListener("focusin",n),e.removeEventListener("keydown",t,!0)}}),[n,r,o,s,c,a]);const y=e=>{null===h.current&&(h.current=e.relatedTarget),f.current=!0};return(0,Be.jsxs)(i.Fragment,{children:[(0,Be.jsx)("div",{tabIndex:c?0:-1,onFocus:y,ref:u,"data-testid":"sentinelStart"}),i.cloneElement(t,{ref:g,onFocus:e=>{null===h.current&&(h.current=e.relatedTarget),f.current=!0,p.current=e.target;const n=t.props.onFocus;n&&n(e)}}),(0,Be.jsx)("div",{tabIndex:c?0:-1,onFocus:y,ref:d,"data-testid":"sentinelEnd"})]})};var xI=n(4440),wI=n(6564);const kI=i.forwardRef((function(e,t){const{children:n,container:r,disablePortal:o=!1}=e,[a,s]=i.useState(null),c=(0,mS.A)(i.isValidElement(n)?fI(n):null,t);if((0,xI.A)((()=>{o||s(function(e){return"function"===typeof e?e():e}(r)||document.body)}),[r,o]),(0,xI.A)((()=>{if(a&&!o)return(0,wI.A)(t,a),()=>{(0,wI.A)(t,null)}}),[t,a,o]),o){if(i.isValidElement(n)){const e={ref:c};return i.cloneElement(n,e)}return(0,Be.jsx)(i.Fragment,{children:n})}return(0,Be.jsx)(i.Fragment,{children:a?ke.createPortal(n,a):a})})),SI=!1;var II="unmounted",CI="exited",AI="entering",EI="entered",TI="exiting",NI=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o,a=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?a?(o=CI,r.appearStatus=AI):o=EI:o=t.unmountOnExit||t.mountOnEnter?II:CI,r.state={status:o},r.nextCallback=null,r}Hw(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===II?{status:CI}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==AI&&n!==EI&&(t=AI):n!==AI&&n!==EI||(t=TI)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===AI){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:ke.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===CI&&this.setState({status:II})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,o=this.props.nodeRef?[r]:[ke.findDOMNode(this),r],a=o[0],i=o[1],s=this.getTimeouts(),c=r?s.appear:s.enter;!e&&!n||SI?this.safeSetState({status:EI},(function(){t.props.onEntered(a)})):(this.props.onEnter(a,i),this.safeSetState({status:AI},(function(){t.props.onEntering(a,i),t.onTransitionEnd(c,(function(){t.safeSetState({status:EI},(function(){t.props.onEntered(a,i)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:ke.findDOMNode(this);t&&!SI?(this.props.onExit(r),this.safeSetState({status:TI},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:CI},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:CI},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:ke.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var o=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],a=o[0],i=o[1];this.props.addEndListener(a,i)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===II)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,Me.A)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return i.createElement(qw.Provider,{value:null},"function"===typeof n?n(e,r):i.cloneElement(i.Children.only(n),r))},t}(i.Component);function RI(){}NI.contextType=qw,NI.propTypes={},NI.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:RI,onEntering:RI,onEntered:RI,onExit:RI,onExiting:RI,onExited:RI},NI.UNMOUNTED=II,NI.EXITED=CI,NI.ENTERING=AI,NI.ENTERED=EI,NI.EXITING=TI;const _I=NI;var DI=n(5170);function OI(){const e=fw(DI.A);return e[Je.A]||e}const FI=e=>e.scrollTop;function MI(e,t){var n,r;const{timeout:o,easing:a,style:i={}}=e;return{duration:null!=(n=i.transitionDuration)?n:"number"===typeof o?o:o[t.mode]||0,easing:null!=(r=i.transitionTimingFunction)?r:"object"===typeof a?a[t.mode]:a,delay:i.transitionDelay}}const PI=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],LI={entering:{opacity:1},entered:{opacity:1}},zI=i.forwardRef((function(e,t){const n=OI(),r={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:o,appear:a=!0,children:s,easing:c,in:l,onEnter:u,onEntered:d,onEntering:h,onExit:p,onExited:f,onExiting:m,style:g,timeout:v=r,TransitionComponent:y=_I}=e,b=(0,Me.A)(e,PI),x=i.useRef(null),w=(0,Uw.A)(x,fI(s),t),k=e=>t=>{if(e){const n=x.current;void 0===t?e(n):e(n,t)}},S=k(h),I=k(((e,t)=>{FI(e);const r=MI({style:g,timeout:v,easing:c},{mode:"enter"});e.style.webkitTransition=n.transitions.create("opacity",r),e.style.transition=n.transitions.create("opacity",r),u&&u(e,t)})),C=k(d),A=k(m),E=k((e=>{const t=MI({style:g,timeout:v,easing:c},{mode:"exit"});e.style.webkitTransition=n.transitions.create("opacity",t),e.style.transition=n.transitions.create("opacity",t),p&&p(e)})),T=k(f);return(0,Be.jsx)(y,(0,Fe.A)({appear:a,in:l,nodeRef:x,onEnter:I,onEntered:C,onEntering:S,onExit:E,onExited:T,onExiting:A,addEndListener:e=>{o&&o(x.current,e)},timeout:v},b,{children:(e,t)=>i.cloneElement(s,(0,Fe.A)({style:(0,Fe.A)({opacity:0,visibility:"exited"!==e||l?void 0:"hidden"},LI[e],g,s.props.style),ref:w},t))}))})),BI=zI;function UI(e){return(0,Aw.Ay)("MuiBackdrop",e)}(0,vw.A)("MuiBackdrop",["root","invisible"]);const WI=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],jI=(0,Iw.Ay)("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.invisible&&t.invisible]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})})),VI=i.forwardRef((function(e,t){var n,r,o;const a=(0,Cw.b)({props:e,name:"MuiBackdrop"}),{children:i,className:s,component:c="div",components:l={},componentsProps:u={},invisible:d=!1,open:h,slotProps:p={},slots:f={},TransitionComponent:m=BI,transitionDuration:g}=a,v=(0,Me.A)(a,WI),y=(0,Fe.A)({},a,{component:c,invisible:d}),b=(e=>{const{classes:t,invisible:n}=e,r={root:["root",n&&"invisible"]};return(0,kw.A)(r,UI,t)})(y),x=null!=(n=p.root)?n:u.root;return(0,Be.jsx)(m,(0,Fe.A)({in:h,timeout:g},v,{children:(0,Be.jsx)(jI,(0,Fe.A)({"aria-hidden":!0},x,{as:null!=(r=null!=(o=f.root)?o:l.Root)?r:c,className:(0,cw.A)(b.root,s,null==x?void 0:x.className),ownerState:(0,Fe.A)({},y,null==x?void 0:x.ownerState),classes:b,ref:t,children:i}))}))})),GI=VI;var HI=n(1782),qI=n(2456),KI=n(3940);function XI(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}function YI(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function QI(e){return parseInt((0,KI.A)(e).getComputedStyle(e).paddingRight,10)||0}function JI(e,t,n,r,o){const a=[t,n,...r];[].forEach.call(e.children,(e=>{const t=-1===a.indexOf(e),n=!function(e){const t=-1!==["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName),n="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||n}(e);t&&n&&YI(e,o)}))}function $I(e,t){let n=-1;return e.some(((e,r)=>!!t(e)&&(n=r,!0))),n}function ZI(e,t){const n=[],r=e.container;if(!t.disableScrollLock){if(function(e){const t=(0,mI.A)(e);return t.body===e?(0,KI.A)(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(r)){const e=XI((0,mI.A)(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight="".concat(QI(r)+e,"px");const t=(0,mI.A)(r).querySelectorAll(".mui-fixed");[].forEach.call(t,(t=>{n.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight="".concat(QI(t)+e,"px")}))}let e;if(r.parentNode instanceof DocumentFragment)e=(0,mI.A)(r).body;else{const t=r.parentElement,n=(0,KI.A)(r);e="HTML"===(null==t?void 0:t.nodeName)&&"scroll"===n.getComputedStyle(t).overflowY?t:r}n.push({value:e.style.overflow,property:"overflow",el:e},{value:e.style.overflowX,property:"overflow-x",el:e},{value:e.style.overflowY,property:"overflow-y",el:e}),e.style.overflow="hidden"}return()=>{n.forEach((e=>{let{value:t,el:n,property:r}=e;t?n.style.setProperty(r,t):n.style.removeProperty(r)}))}}const eC=new class{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,t){let n=this.modals.indexOf(e);if(-1!==n)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&YI(e.modalRef,!1);const r=function(e){const t=[];return[].forEach.call(e.children,(e=>{"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);JI(t,e.mount,e.modalRef,r,!0);const o=$I(this.containers,(e=>e.container===t));return-1!==o?(this.containers[o].modals.push(e),n):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:r}),n)}mount(e,t){const n=$I(this.containers,(t=>-1!==t.modals.indexOf(e))),r=this.containers[n];r.restore||(r.restore=ZI(r,t))}remove(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.modals.indexOf(e);if(-1===n)return n;const r=$I(this.containers,(t=>-1!==t.modals.indexOf(e))),o=this.containers[r];if(o.modals.splice(o.modals.indexOf(e),1),this.modals.splice(n,1),0===o.modals.length)o.restore&&o.restore(),e.modalRef&&YI(e.modalRef,t),JI(o.container,e.mount,e.modalRef,o.hiddenSiblings,!1),this.containers.splice(r,1);else{const e=o.modals[o.modals.length-1];e.modalRef&&YI(e.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}};const tC=function(e){const{container:t,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:o=eC,closeAfterTransition:a=!1,onTransitionEnter:s,onTransitionExited:c,children:l,onClose:u,open:d,rootRef:h}=e,p=i.useRef({}),f=i.useRef(null),m=i.useRef(null),g=(0,mS.A)(m,h),[v,y]=i.useState(!d),b=function(e){return!!e&&e.props.hasOwnProperty("in")}(l);let x=!0;"false"!==e["aria-hidden"]&&!1!==e["aria-hidden"]||(x=!1);const w=()=>(p.current.modalRef=m.current,p.current.mount=f.current,p.current),k=()=>{o.mount(w(),{disableScrollLock:r}),m.current&&(m.current.scrollTop=0)},S=(0,HI.A)((()=>{const e=function(e){return"function"===typeof e?e():e}(t)||(0,mI.A)(f.current).body;o.add(w(),e),m.current&&k()})),I=i.useCallback((()=>o.isTopModal(w())),[o]),C=(0,HI.A)((e=>{f.current=e,e&&(d&&I()?k():m.current&&YI(m.current,x))})),A=i.useCallback((()=>{o.remove(w(),x)}),[x,o]);i.useEffect((()=>()=>{A()}),[A]),i.useEffect((()=>{d?S():b&&a||A()}),[d,A,b,a,S]);const E=e=>t=>{var r;null==(r=e.onKeyDown)||r.call(e,t),"Escape"===t.key&&229!==t.which&&I()&&(n||(t.stopPropagation(),u&&u(t,"escapeKeyDown")))},T=e=>t=>{var n;null==(n=e.onClick)||n.call(e,t),t.target===t.currentTarget&&u&&u(t,"backdropClick")};return{getRootProps:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=yS(e);delete n.onTransitionEnter,delete n.onTransitionExited;const r=(0,Fe.A)({},n,t);return(0,Fe.A)({role:"presentation"},r,{onKeyDown:E(r),ref:g})},getBackdropProps:function(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,Fe.A)({"aria-hidden":!0},e,{onClick:T(e),open:d})},getTransitionProps:()=>({onEnter:(0,qI.A)((()=>{y(!1),s&&s()}),null==l?void 0:l.props.onEnter),onExited:(0,qI.A)((()=>{y(!0),c&&c(),a&&A()}),null==l?void 0:l.props.onExited)}),rootRef:g,portalRef:C,isTopModal:I,exited:v,hasTransition:b}};function nC(e){return(0,Aw.Ay)("MuiModal",e)}(0,vw.A)("MuiModal",["root","hidden","backdrop"]);const rC=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],oC=(0,Iw.Ay)("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.open&&n.exited&&t.hidden]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!n.open&&n.exited&&{visibility:"hidden"})})),aC=(0,Iw.Ay)(GI,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),iC=i.forwardRef((function(e,t){var n,r,o,a,s,c;const l=(0,Cw.b)({name:"MuiModal",props:e}),{BackdropComponent:u=aC,BackdropProps:d,className:h,closeAfterTransition:p=!1,children:f,container:m,component:g,components:v={},componentsProps:y={},disableAutoFocus:b=!1,disableEnforceFocus:x=!1,disableEscapeKeyDown:w=!1,disablePortal:k=!1,disableRestoreFocus:S=!1,disableScrollLock:I=!1,hideBackdrop:C=!1,keepMounted:A=!1,onBackdropClick:E,open:T,slotProps:N,slots:R}=l,_=(0,Me.A)(l,rC),D=(0,Fe.A)({},l,{closeAfterTransition:p,disableAutoFocus:b,disableEnforceFocus:x,disableEscapeKeyDown:w,disablePortal:k,disableRestoreFocus:S,disableScrollLock:I,hideBackdrop:C,keepMounted:A}),{getRootProps:O,getBackdropProps:F,getTransitionProps:M,portalRef:P,isTopModal:L,exited:z,hasTransition:B}=tC((0,Fe.A)({},D,{rootRef:t})),U=(0,Fe.A)({},D,{exited:z}),W=(e=>{const{open:t,exited:n,classes:r}=e,o={root:["root",!t&&n&&"hidden"],backdrop:["backdrop"]};return(0,kw.A)(o,nC,r)})(U),j={};if(void 0===f.props.tabIndex&&(j.tabIndex="-1"),B){const{onEnter:e,onExited:t}=M();j.onEnter=e,j.onExited=t}const V=null!=(n=null!=(r=null==R?void 0:R.root)?r:v.Root)?n:oC,G=null!=(o=null!=(a=null==R?void 0:R.backdrop)?a:v.Backdrop)?o:u,H=null!=(s=null==N?void 0:N.root)?s:y.root,q=null!=(c=null==N?void 0:N.backdrop)?c:y.backdrop,K=pI({elementType:V,externalSlotProps:H,externalForwardedProps:_,getSlotProps:O,additionalProps:{ref:t,as:g},ownerState:U,className:(0,cw.A)(h,null==H?void 0:H.className,null==W?void 0:W.root,!U.open&&U.exited&&(null==W?void 0:W.hidden))}),X=pI({elementType:G,externalSlotProps:q,additionalProps:d,getSlotProps:e=>F((0,Fe.A)({},e,{onClick:t=>{E&&E(t),null!=e&&e.onClick&&e.onClick(t)}})),className:(0,cw.A)(null==q?void 0:q.className,null==d?void 0:d.className,null==W?void 0:W.backdrop),ownerState:U});return A||T||B&&!z?(0,Be.jsx)(kI,{ref:P,container:m,disablePortal:k,children:(0,Be.jsxs)(V,(0,Fe.A)({},K,{children:[!C&&u?(0,Be.jsx)(G,(0,Fe.A)({},X)):null,(0,Be.jsx)(bI,{disableEnforceFocus:x,disableAutoFocus:b,disableRestoreFocus:S,isEnabled:L,open:T,children:i.cloneElement(f,j)})]}))}):null})),sC=iC;var cC=n(950),lC=n(6078);const uC=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function dC(e,t,n){var r;const o=function(e,t,n){const r=t.getBoundingClientRect(),o=n&&n.getBoundingClientRect(),a=(0,lC.A)(t);let i;if(t.fakeTransform)i=t.fakeTransform;else{const e=a.getComputedStyle(t);i=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("transform")}let s=0,c=0;if(i&&"none"!==i&&"string"===typeof i){const e=i.split("(")[1].split(")")[0].split(",");s=parseInt(e[4],10),c=parseInt(e[5],10)}return"left"===e?"translateX(".concat(o?o.right+s-r.left:a.innerWidth+s-r.left,"px)"):"right"===e?"translateX(-".concat(o?r.right-o.left-s:r.left+r.width-s,"px)"):"up"===e?"translateY(".concat(o?o.bottom+c-r.top:a.innerHeight+c-r.top,"px)"):"translateY(-".concat(o?r.top-o.top+r.height-c:r.top+r.height-c,"px)")}(e,t,"function"===typeof(r=n)?r():r);o&&(t.style.webkitTransform=o,t.style.transform=o)}const hC=i.forwardRef((function(e,t){const n=OI(),r={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},o={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:a,appear:s=!0,children:c,container:l,direction:u="down",easing:d=r,in:h,onEnter:p,onEntered:f,onEntering:m,onExit:g,onExited:v,onExiting:y,style:b,timeout:x=o,TransitionComponent:w=_I}=e,k=(0,Me.A)(e,uC),S=i.useRef(null),I=(0,Uw.A)(fI(c),S,t),C=e=>t=>{e&&(void 0===t?e(S.current):e(S.current,t))},A=C(((e,t)=>{dC(u,e,l),FI(e),p&&p(e,t)})),E=C(((e,t)=>{const r=MI({timeout:x,style:b,easing:d},{mode:"enter"});e.style.webkitTransition=n.transitions.create("-webkit-transform",(0,Fe.A)({},r)),e.style.transition=n.transitions.create("transform",(0,Fe.A)({},r)),e.style.webkitTransform="none",e.style.transform="none",m&&m(e,t)})),T=C(f),N=C(y),R=C((e=>{const t=MI({timeout:x,style:b,easing:d},{mode:"exit"});e.style.webkitTransition=n.transitions.create("-webkit-transform",t),e.style.transition=n.transitions.create("transform",t),dC(u,e,l),g&&g(e)})),_=C((e=>{e.style.webkitTransition="",e.style.transition="",v&&v(e)})),D=i.useCallback((()=>{S.current&&dC(u,S.current,l)}),[u,l]);return i.useEffect((()=>{if(h||"down"===u||"right"===u)return;const e=(0,cC.A)((()=>{S.current&&dC(u,S.current,l)})),t=(0,lC.A)(S.current);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}}),[u,h,l]),i.useEffect((()=>{h||D()}),[h,D]),(0,Be.jsx)(w,(0,Fe.A)({nodeRef:S,onEnter:A,onEntered:T,onEntering:E,onExit:R,onExited:_,onExiting:N,addEndListener:e=>{a&&a(S.current,e)},appear:s,in:h,timeout:x},k,{children:(e,t)=>i.cloneElement(c,(0,Fe.A)({ref:I,style:(0,Fe.A)({visibility:"exited"!==e||h?void 0:"hidden"},b,c.props.style)},t))}))})),pC=hC;function fC(e){return(0,Aw.Ay)("MuiDrawer",e)}(0,vw.A)("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const mC=["BackdropProps"],gC=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],vC=(e,t)=>{const{ownerState:n}=e;return[t.root,("permanent"===n.variant||"persistent"===n.variant)&&t.docked,t.modal]},yC=(0,Iw.Ay)(sC,{name:"MuiDrawer",slot:"Root",overridesResolver:vC})((e=>{let{theme:t}=e;return{zIndex:(t.vars||t).zIndex.drawer}})),bC=(0,Iw.Ay)("div",{shouldForwardProp:jk.A,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:vC})({flex:"0 0 auto"}),xC=(0,Iw.Ay)(PS,{name:"MuiDrawer",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.paper,t["paperAnchor".concat((0,$k.A)(n.anchor))],"temporary"!==n.variant&&t["paperAnchorDocked".concat((0,$k.A)(n.anchor))]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},"left"===n.anchor&&{left:0},"top"===n.anchor&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},"right"===n.anchor&&{right:0},"bottom"===n.anchor&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},"left"===n.anchor&&"temporary"!==n.variant&&{borderRight:"1px solid ".concat((t.vars||t).palette.divider)},"top"===n.anchor&&"temporary"!==n.variant&&{borderBottom:"1px solid ".concat((t.vars||t).palette.divider)},"right"===n.anchor&&"temporary"!==n.variant&&{borderLeft:"1px solid ".concat((t.vars||t).palette.divider)},"bottom"===n.anchor&&"temporary"!==n.variant&&{borderTop:"1px solid ".concat((t.vars||t).palette.divider)})})),wC={left:"right",right:"left",top:"down",bottom:"up"};const kC=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiDrawer"}),r=OI(),o=He(),a={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{anchor:s="left",BackdropProps:c,children:l,className:u,elevation:d=16,hideBackdrop:h=!1,ModalProps:{BackdropProps:p}={},onClose:f,open:m=!1,PaperProps:g={},SlideProps:v,TransitionComponent:y=pC,transitionDuration:b=a,variant:x="temporary"}=n,w=(0,Me.A)(n.ModalProps,mC),k=(0,Me.A)(n,gC),S=i.useRef(!1);i.useEffect((()=>{S.current=!0}),[]);const I=function(e,t){let{direction:n}=e;return"rtl"===n&&function(e){return-1!==["left","right"].indexOf(e)}(t)?wC[t]:t}({direction:o?"rtl":"ltr"},s),C=s,A=(0,Fe.A)({},n,{anchor:C,elevation:d,open:m,variant:x},k),E=(e=>{const{classes:t,anchor:n,variant:r}=e,o={root:["root"],docked:[("permanent"===r||"persistent"===r)&&"docked"],modal:["modal"],paper:["paper","paperAnchor".concat((0,$k.A)(n)),"temporary"!==r&&"paperAnchorDocked".concat((0,$k.A)(n))]};return(0,kw.A)(o,fC,t)})(A),T=(0,Be.jsx)(xC,(0,Fe.A)({elevation:"temporary"===x?d:0,square:!0},g,{className:(0,cw.A)(E.paper,g.className),ownerState:A,children:l}));if("permanent"===x)return(0,Be.jsx)(bC,(0,Fe.A)({className:(0,cw.A)(E.root,E.docked,u),ownerState:A,ref:t},k,{children:T}));const N=(0,Be.jsx)(y,(0,Fe.A)({in:m,direction:wC[I],timeout:b,appear:S.current},v,{children:T}));return"persistent"===x?(0,Be.jsx)(bC,(0,Fe.A)({className:(0,cw.A)(E.root,E.docked,u),ownerState:A,ref:t},k,{children:N})):(0,Be.jsx)(yC,(0,Fe.A)({BackdropProps:(0,Fe.A)({},c,p,{transitionDuration:b}),className:(0,cw.A)(E.root,E.modal,u),open:m,ownerState:A,onClose:f,hideBackdrop:h,ref:t},k,w,{children:N}))})),SC=kC;var IC=n(9611),CC=n(3639),AC=n(6940),EC=n(1958),TC=n(6300),NC=n(2807),RC=n(7566),_C=n(6893);const DC=[{label:"Home",to:"/",icon:(0,Be.jsx)(CC.A,{})},{label:"Scan",to:"/scan",icon:(0,Be.jsx)(AC.A,{})},{label:"History",to:"/history",icon:(0,Be.jsx)(EC.A,{})},{label:"Edukasi",to:"/education",icon:(0,Be.jsx)(TC.A,{})},{label:"Komunitas",to:"/community",icon:(0,Be.jsx)(_C.A,{})}],OC=()=>{var e,t,n,r;const{currentUser:o}=aw(),a=ee(),[s,c]=(0,i.useState)(!1),[l,u]=(0,i.useState)(null),d=()=>{c((e=>!e))};(0,i.useEffect)((()=>{let e;if(o){const t=Of(nw,"users",o.uid);e=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o,a,i;e=Ot(e);let s={includeMetadataChanges:!1},c=0;"object"!=typeof n[c]||Mf(n[c])||(s=n[c],c++);const l={includeMetadataChanges:s.includeMetadataChanges};if(Mf(n[c])){const e=n[c];n[c]=null===(o=e.next)||void 0===o?void 0:o.bind(e),n[c+1]=null===(a=e.error)||void 0===a?void 0:a.bind(e),n[c+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let u,d,h;if(e instanceof Nf)d=Af(e.firestore,Pf),h=zl(e._key.path),u={next:t=>{n[c]&&n[c](Bm(d,e,t))},error:n[c+1],complete:n[c+2]};else{const t=Af(e,Rf);d=Af(t.firestore,Pf),h=t._query;const r=new Fm(d);u={next:e=>{n[c]&&n[c](new _m(d,r,t,e))},error:n[c+1],complete:n[c+2]},fm(e._query)}return function(e,t,n,r){const o=new lf(r),a=new Op(t,o,n);return e.asyncQueue.enqueueAndForget((async()=>Tp(await vf(e),a))),()=>{o.Dc(),e.asyncQueue.enqueueAndForget((async()=>Np(await vf(e),a)))}}(Lf(d),h,l,u)}(t,(e=>{e.exists()?u(e.data().profileImage):u(null)}),(e=>{console.error("Error fetching user profile image:",e),u(null)}))}else u(null);return()=>{e&&e()}}),[o]);const h=(0,Be.jsxs)(ww,{sx:{width:250},role:"presentation",onClick:d,children:[(0,Be.jsx)(ww,{sx:{p:2,textAlign:"center"},children:(0,Be.jsx)(ww,{component:_e,to:"/",sx:{display:"inline-block",textDecoration:"none"},children:(0,Be.jsx)(ww,{component:"img",src:"/Agroscan/assets/logo.png",alt:"AgroScan Logo",sx:{height:40,verticalAlign:"middle"}})})}),(0,Be.jsx)(Dw,{}),(0,Be.jsx)(zw,{children:DC.map((e=>(0,Be.jsx)(Wk,{disablePadding:!0,children:(0,Be.jsxs)(qk,{component:_e,to:e.to,selected:a.pathname===e.to,children:[(0,Be.jsx)(Jk,{sx:{color:"#219653"},children:e.icon}),(0,Be.jsx)(dS,{primary:e.label,sx:{fontWeight:700}})]})},e.to)))}),(0,Be.jsx)(Dw,{}),(0,Be.jsx)(zw,{children:o?(0,Be.jsx)(Wk,{disablePadding:!0,children:(0,Be.jsxs)(qk,{component:_e,to:"/profile",children:[(0,Be.jsx)(Jk,{sx:{color:"#219653"},children:(0,Be.jsx)(RS,{src:l,sx:{width:24,height:24,bgcolor:"#219653"},children:(null===(e=o.email)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())||"U"})}),(0,Be.jsx)(dS,{primary:"Profile"})]})}):(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsx)(Wk,{disablePadding:!0,children:(0,Be.jsxs)(qk,{component:_e,to:"/login",children:[(0,Be.jsx)(Jk,{sx:{color:"#219653"},children:(0,Be.jsx)(NC.A,{})}),(0,Be.jsx)(dS,{primary:"Login"})]})}),(0,Be.jsx)(Wk,{disablePadding:!0,children:(0,Be.jsxs)(qk,{component:_e,to:"/register",children:[(0,Be.jsx)(Jk,{sx:{color:"#219653"},children:(0,Be.jsx)(RC.A,{})}),(0,Be.jsx)(dS,{primary:"Register"})]})})]})})]});return(0,Be.jsx)(jS,{position:"sticky",elevation:0,sx:{bgcolor:"white",color:"#219653",boxShadow:"0 2px 8px 0 rgba(33,150,83,0.04)"},children:(0,Be.jsxs)(KS,{sx:{maxWidth:1200,mx:"auto",width:"100%",minHeight:64},children:[(0,Be.jsx)(ww,{sx:{display:"flex",alignItems:"center",flexGrow:1},children:(0,Be.jsxs)(ww,{component:_e,to:"/",sx:{display:"flex",alignItems:"center",textDecoration:"none",mr:4},children:[(0,Be.jsx)(ww,{component:"img",src:"/Agroscan/assets/logo.png",alt:"AgroScan Logo",sx:{height:40,mr:1}}),(0,Be.jsx)(aS,{variant:"h6",sx:{fontWeight:800,color:"#219653",letterSpacing:1},children:"AgroScan"})]})}),(0,Be.jsxs)(ww,{sx:{display:{xs:"none",md:"flex"},gap:2,alignItems:"center"},children:[DC.map((e=>(0,Be.jsx)(aI,{component:_e,to:e.to,startIcon:e.icon,sx:{color:a.pathname===e.to?"#fff":"#219653",bgcolor:a.pathname===e.to?"#219653":"transparent",fontWeight:700,borderRadius:2,px:2.5,py:1,transition:"all 0.2s","&:hover":{bgcolor:a.pathname===e.to?"#17643b":"#F7F9FA",color:"#219653"}},children:e.label},e.to))),o?(0,Be.jsx)(aI,{component:_e,to:"/profile",sx:{color:"#219653",fontWeight:700,ml:2,minWidth:"auto",p:1,"&:hover":{bgcolor:"#F7F9FA"}},children:(0,Be.jsx)(RS,{src:l,sx:{width:32,height:32,bgcolor:"#219653",fontSize:"1rem"},children:(null===(n=o.email)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.toUpperCase())||"U"})}):(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsx)(aI,{component:_e,to:"/login",sx:{color:"#219653",fontWeight:700,ml:2},children:"Login"}),(0,Be.jsx)(aI,{component:_e,to:"/register",variant:"contained",sx:{bgcolor:"#219653",color:"#fff",fontWeight:700,ml:1,boxShadow:"none","&:hover":{bgcolor:"#17643b"}},children:"Register"})]})]}),(0,Be.jsx)(ww,{sx:{display:{xs:"flex",md:"none"}},children:(0,Be.jsx)(dI,{edge:"end",color:"inherit",onClick:d,children:(0,Be.jsx)(IC.A,{})})}),(0,Be.jsx)(SC,{anchor:"right",open:s,onClose:d,children:h})]})})};var FC=n(7598);function MC(e){let{props:t,name:n,defaultTheme:r,themeId:o}=e,a=fw(r);o&&(a=a[o]||a);const i=function(e){const{theme:t,name:n,props:r}=e;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?(0,XS.A)(t.components[n].defaultProps,r):r}({theme:a,name:n,props:t});return i}var PC=n(9172);const LC=["ownerState"],zC=["variants"],BC=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function UC(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}const WC=(0,hw.A)(),jC=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function VC(e){let{defaultTheme:t,theme:n,themeId:r}=e;return o=n,0===Object.keys(o).length?t:n[r]||n;var o}function GC(e){return e?(t,n)=>n[e]:null}function HC(e,t){let{ownerState:n}=t,r=(0,Me.A)(t,LC);const o="function"===typeof e?e((0,Fe.A)({ownerState:n},r)):e;if(Array.isArray(o))return o.flatMap((e=>HC(e,(0,Fe.A)({ownerState:n},r))));if(o&&"object"===typeof o&&Array.isArray(o.variants)){const{variants:e=[]}=o;let t=(0,Me.A)(o,zC);return e.forEach((e=>{let o=!0;"function"===typeof e.props?o=e.props((0,Fe.A)({ownerState:n},r,n)):Object.keys(e.props).forEach((t=>{(null==n?void 0:n[t])!==e.props[t]&&r[t]!==e.props[t]&&(o=!1)})),o&&(Array.isArray(t)||(t=[t]),t.push("function"===typeof e.style?e.style((0,Fe.A)({ownerState:n},r,n)):e.style))})),t}return o}const qC=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=WC,rootShouldForwardProp:r=UC,slotShouldForwardProp:o=UC}=e,a=e=>(0,uw.A)((0,Fe.A)({},e,{theme:VC((0,Fe.A)({},e,{defaultTheme:n,themeId:t}))}));return a.__mui_systemSx=!0,function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,lw.internal_processStyles)(e,(e=>e.filter((e=>!(null!=e&&e.__mui_systemSx)))));const{name:s,slot:c,skipVariantsResolver:l,skipSx:u,overridesResolver:d=GC(jC(c))}=i,h=(0,Me.A)(i,BC),p=void 0!==l?l:c&&"Root"!==c&&"root"!==c||!1,f=u||!1;let m=UC;"Root"===c||"root"===c?m=r:c?m=o:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(m=void 0);const g=(0,lw.default)(e,(0,Fe.A)({shouldForwardProp:m,label:undefined},h)),v=e=>"function"===typeof e&&e.__emotion_real!==e||(0,PC.Q)(e)?r=>HC(e,(0,Fe.A)({},r,{theme:VC({theme:r.theme,defaultTheme:n,themeId:t})})):e,y=function(r){let o=v(r);for(var i=arguments.length,c=new Array(i>1?i-1:0),l=1;l<i;l++)c[l-1]=arguments[l];const u=c?c.map(v):[];s&&d&&u.push((e=>{const r=VC((0,Fe.A)({},e,{defaultTheme:n,themeId:t}));if(!r.components||!r.components[s]||!r.components[s].styleOverrides)return null;const o=r.components[s].styleOverrides,a={};return Object.entries(o).forEach((t=>{let[n,o]=t;a[n]=HC(o,(0,Fe.A)({},e,{theme:r}))})),d(e,a)})),s&&!p&&u.push((e=>{var r;const o=VC((0,Fe.A)({},e,{defaultTheme:n,themeId:t}));return HC({variants:null==o||null==(r=o.components)||null==(r=r[s])?void 0:r.variants},(0,Fe.A)({},e,{theme:o}))})),f||u.push(a);const h=u.length-c.length;if(Array.isArray(r)&&h>0){const e=new Array(h).fill("");o=[...r,...e],o.raw=[...r.raw,...e]}const m=g(o,...u);return e.muiName&&(m.muiName=e.muiName),m};return g.withConfig&&(y.withConfig=g.withConfig),y}}(),KC=qC,XC=["className","component","disableGutters","fixed","maxWidth","classes"],YC=(0,hw.A)(),QC=KC("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["maxWidth".concat((0,FC.A)(String(n.maxWidth)))],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),JC=e=>MC({props:e,name:"MuiContainer",defaultTheme:YC});const $C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=QC,useThemeProps:n=JC,componentName:r="MuiContainer"}=e,o=t((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!n.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}})}),(e=>{let{theme:t,ownerState:n}=e;return n.fixed&&Object.keys(t.breakpoints.values).reduce(((e,n)=>{const r=n,o=t.breakpoints.values[r];return 0!==o&&(e[t.breakpoints.up(r)]={maxWidth:"".concat(o).concat(t.breakpoints.unit)}),e}),{})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({},"xs"===n.maxWidth&&{[t.breakpoints.up("xs")]:{maxWidth:Math.max(t.breakpoints.values.xs,444)}},n.maxWidth&&"xs"!==n.maxWidth&&{[t.breakpoints.up(n.maxWidth)]:{maxWidth:"".concat(t.breakpoints.values[n.maxWidth]).concat(t.breakpoints.unit)}})})),a=i.forwardRef((function(e,t){const a=n(e),{className:i,component:s="div",disableGutters:c=!1,fixed:l=!1,maxWidth:u="lg"}=a,d=(0,Me.A)(a,XC),h=(0,Fe.A)({},a,{component:s,disableGutters:c,fixed:l,maxWidth:u}),p=((e,t)=>{const{classes:n,fixed:r,disableGutters:o,maxWidth:a}=e,i={root:["root",a&&"maxWidth".concat((0,FC.A)(String(a))),r&&"fixed",o&&"disableGutters"]};return(0,kw.A)(i,(e=>(0,Aw.Ay)(t,e)),n)})(h,r);return(0,Be.jsx)(o,(0,Fe.A)({as:s,ownerState:h,className:(0,cw.A)(p.root,i),ref:t},d))}));return a}({createStyledComponent:(0,Iw.Ay)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["maxWidth".concat((0,$k.A)(String(n.maxWidth)))],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),useThemeProps:e=>(0,Cw.b)({props:e,name:"MuiContainer"})}),ZC=$C;function eA(e){return(0,Aw.Ay)("MuiLink",e)}const tA=(0,vw.A)("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]);var nA=n(7162);const rA={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},oA=e=>{let{theme:t,ownerState:n}=e;const r=(e=>rA[e]||e)(n.color),o=(0,nA.Yn)(t,"palette.".concat(r),!1)||n.color,a=(0,nA.Yn)(t,"palette.".concat(r,"Channel"));return"vars"in t&&a?"rgba(".concat(a," / 0.4)"):(0,Sw.X4)(o,.4)},aA=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],iA=(0,Iw.Ay)(aS,{name:"MuiLink",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["underline".concat((0,$k.A)(n.underline))],"button"===n.component&&t.button]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({},"none"===n.underline&&{textDecoration:"none"},"hover"===n.underline&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},"always"===n.underline&&(0,Fe.A)({textDecoration:"underline"},"inherit"!==n.color&&{textDecorationColor:oA({theme:t,ownerState:n})},{"&:hover":{textDecorationColor:"inherit"}}),"button"===n.component&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},["&.".concat(tA.focusVisible)]:{outline:"auto"}})})),sA=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiLink"}),{className:r,color:o="primary",component:a="a",onBlur:s,onFocus:c,TypographyClasses:l,underline:u="always",variant:d="inherit",sx:h}=n,p=(0,Me.A)(n,aA),{isFocusVisibleRef:f,onBlur:m,onFocus:g,ref:v}=(0,jw.A)(),[y,b]=i.useState(!1),x=(0,Uw.A)(t,v),w=(0,Fe.A)({},n,{color:o,component:a,focusVisible:y,underline:u,variant:d}),k=(e=>{const{classes:t,component:n,focusVisible:r,underline:o}=e,a={root:["root","underline".concat((0,$k.A)(o)),"button"===n&&"button",r&&"focusVisible"]};return(0,kw.A)(a,eA,t)})(w);return(0,Be.jsx)(iA,(0,Fe.A)({color:o,className:(0,cw.A)(k.root,r),classes:l,component:a,onBlur:e=>{m(e),!1===f.current&&b(!1),s&&s(e)},onFocus:e=>{g(e),!0===f.current&&b(!0),c&&c(e)},ref:x,ownerState:w,variant:d,sx:[...Object.keys(rA).includes(o)?[]:[{color:o}],...Array.isArray(h)?h:[h]]},p))})),cA=sA,lA=()=>(0,Be.jsx)(ww,{sx:{bgcolor:"white",borderTop:"1px solid #E0E0E0",py:4,mt:8},children:(0,Be.jsxs)(ZC,{maxWidth:"md",sx:{display:"flex",flexDirection:{xs:"column",md:"row"},alignItems:"center",justifyContent:"space-between",gap:2},children:[(0,Be.jsxs)(ww,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,Be.jsx)(ww,{component:"img",src:"/Agroscan/assets/logo.png",alt:"AgroScan Logo",sx:{height:30,width:"auto",verticalAlign:"middle"}}),(0,Be.jsx)(aS,{sx:{color:"#219653",fontWeight:500,fontSize:15,textAlign:{xs:"center",md:"left"}},children:"\xa9 2025 AgroScan"})]}),(0,Be.jsxs)(ww,{sx:{display:"flex",gap:2,justifyContent:{xs:"center",md:"flex-end"},width:{xs:"100%",md:"auto"}},children:[(0,Be.jsx)(cA,{href:"#",underline:"hover",sx:{color:"#888",fontSize:14,fontWeight:500,transition:"color 0.2s","&:hover":{color:"#219653"}},children:"Kebijakan Privasi"}),(0,Be.jsx)("span",{style:{color:"#BDBDBD",fontSize:14},children:"|"}),(0,Be.jsx)(cA,{href:"#",underline:"hover",sx:{color:"#888",fontSize:14,fontWeight:500,transition:"color 0.2s","&:hover":{color:"#219653"}},children:"Syarat & Ketentuan"})]})]})});var uA=n(9751);const dA=i.createContext();function hA(e){return(0,Aw.Ay)("MuiGrid",e)}const pA=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],fA=(0,vw.A)("MuiGrid",["root","container","item","zeroMinWidth",...[0,1,2,3,4,5,6,7,8,9,10].map((e=>"spacing-xs-".concat(e))),...["column-reverse","column","row-reverse","row"].map((e=>"direction-xs-".concat(e))),...["nowrap","wrap-reverse","wrap"].map((e=>"wrap-xs-".concat(e))),...pA.map((e=>"grid-xs-".concat(e))),...pA.map((e=>"grid-sm-".concat(e))),...pA.map((e=>"grid-md-".concat(e))),...pA.map((e=>"grid-lg-".concat(e))),...pA.map((e=>"grid-xl-".concat(e)))]),mA=fA,gA=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function vA(e){const t=parseFloat(e);return"".concat(t).concat(String(e).replace(String(t),"")||"px")}function yA(e){let{breakpoints:t,values:n}=e,r="";Object.keys(n).forEach((e=>{""===r&&0!==n[e]&&(r=e)}));const o=Object.keys(t).sort(((e,n)=>t[e]-t[n]));return o.slice(0,o.indexOf(r))}const bA=(0,Iw.Ay)("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{container:r,direction:o,item:a,spacing:i,wrap:s,zeroMinWidth:c,breakpoints:l}=n;let u=[];r&&(u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return[n["spacing-xs-".concat(String(e))]];const r=[];return t.forEach((t=>{const o=e[t];Number(o)>0&&r.push(n["spacing-".concat(t,"-").concat(String(o))])})),r}(i,l,t));const d=[];return l.forEach((e=>{const r=n[e];r&&d.push(t["grid-".concat(e,"-").concat(String(r))])})),[t.root,r&&t.container,a&&t.item,c&&t.zeroMinWidth,...u,"row"!==o&&t["direction-xs-".concat(String(o))],"wrap"!==s&&t["wrap-xs-".concat(String(s))],...d]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({boxSizing:"border-box"},t.container&&{display:"flex",flexWrap:"wrap",width:"100%"},t.item&&{margin:0},t.zeroMinWidth&&{minWidth:0},"wrap"!==t.wrap&&{flexWrap:t.wrap})}),(function(e){let{theme:t,ownerState:n}=e;const r=(0,uA.kW)({values:n.direction,breakpoints:t.breakpoints.values});return(0,uA.NI)({theme:t},r,(e=>{const t={flexDirection:e};return 0===e.indexOf("column")&&(t["& > .".concat(mA.item)]={maxWidth:"none"}),t}))}),(function(e){let{theme:t,ownerState:n}=e;const{container:r,rowSpacing:o}=n;let a={};if(r&&0!==o){const e=(0,uA.kW)({values:o,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=yA({breakpoints:t.breakpoints.values,values:e})),a=(0,uA.NI)({theme:t},e,((e,r)=>{var o;const a=t.spacing(e);return"0px"!==a?{marginTop:"-".concat(vA(a)),["& > .".concat(mA.item)]:{paddingTop:vA(a)}}:null!=(o=n)&&o.includes(r)?{}:{marginTop:0,["& > .".concat(mA.item)]:{paddingTop:0}}}))}return a}),(function(e){let{theme:t,ownerState:n}=e;const{container:r,columnSpacing:o}=n;let a={};if(r&&0!==o){const e=(0,uA.kW)({values:o,breakpoints:t.breakpoints.values});let n;"object"===typeof e&&(n=yA({breakpoints:t.breakpoints.values,values:e})),a=(0,uA.NI)({theme:t},e,((e,r)=>{var o;const a=t.spacing(e);return"0px"!==a?{width:"calc(100% + ".concat(vA(a),")"),marginLeft:"-".concat(vA(a)),["& > .".concat(mA.item)]:{paddingLeft:vA(a)}}:null!=(o=n)&&o.includes(r)?{}:{width:"100%",marginLeft:0,["& > .".concat(mA.item)]:{paddingLeft:0}}}))}return a}),(function(e){let t,{theme:n,ownerState:r}=e;return n.breakpoints.keys.reduce(((e,o)=>{let a={};if(r[o]&&(t=r[o]),!t)return e;if(!0===t)a={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===t)a={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const i=(0,uA.kW)({values:r.columns,breakpoints:n.breakpoints.values}),s="object"===typeof i?i[o]:i;if(void 0===s||null===s)return e;const c="".concat(Math.round(t/s*1e8)/1e6,"%");let l={};if(r.container&&r.item&&0!==r.columnSpacing){const e=n.spacing(r.columnSpacing);if("0px"!==e){const t="calc(".concat(c," + ").concat(vA(e),")");l={flexBasis:t,maxWidth:t}}}a=(0,Fe.A)({flexBasis:c,flexGrow:0,maxWidth:c},l)}return 0===n.breakpoints.values[o]?Object.assign(e,a):e[n.breakpoints.up(o)]=a,e}),{})}));const xA=e=>{const{classes:t,container:n,direction:r,item:o,spacing:a,wrap:i,zeroMinWidth:s,breakpoints:c}=e;let l=[];n&&(l=function(e,t){if(!e||e<=0)return[];if("string"===typeof e&&!Number.isNaN(Number(e))||"number"===typeof e)return["spacing-xs-".concat(String(e))];const n=[];return t.forEach((t=>{const r=e[t];if(Number(r)>0){const e="spacing-".concat(t,"-").concat(String(r));n.push(e)}})),n}(a,c));const u=[];c.forEach((t=>{const n=e[t];n&&u.push("grid-".concat(t,"-").concat(String(n)))}));const d={root:["root",n&&"container",o&&"item",s&&"zeroMinWidth",...l,"row"!==r&&"direction-xs-".concat(String(r)),"wrap"!==i&&"wrap-xs-".concat(String(i)),...u]};return(0,kw.A)(d,hA,t)},wA=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiGrid"}),{breakpoints:r}=OI(),o=(0,dw.A)(n),{className:a,columns:s,columnSpacing:c,component:l="div",container:u=!1,direction:d="row",item:h=!1,rowSpacing:p,spacing:f=0,wrap:m="wrap",zeroMinWidth:g=!1}=o,v=(0,Me.A)(o,gA),y=p||f,b=c||f,x=i.useContext(dA),w=u?s||12:x,k={},S=(0,Fe.A)({},v);r.keys.forEach((e=>{null!=v[e]&&(k[e]=v[e],delete S[e])}));const I=(0,Fe.A)({},o,{columns:w,container:u,direction:d,item:h,rowSpacing:y,columnSpacing:b,wrap:m,zeroMinWidth:g,spacing:f},k,{breakpoints:r.keys}),C=xA(I);return(0,Be.jsx)(dA.Provider,{value:w,children:(0,Be.jsx)(bA,(0,Fe.A)({ownerState:I,className:(0,cw.A)(C.root,a),as:l,ref:t},S))})}));const kA=wA;function SA(e){return(0,Aw.Ay)("MuiCardActionArea",e)}const IA=(0,vw.A)("MuiCardActionArea",["root","focusVisible","focusHighlight"]),CA=["children","className","focusVisibleClassName"],AA=(0,Iw.Ay)(Ik,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",["&:hover .".concat(IA.focusHighlight)]:{opacity:(t.vars||t).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},["&.".concat(IA.focusVisible," .").concat(IA.focusHighlight)]:{opacity:(t.vars||t).palette.action.focusOpacity}}})),EA=(0,Iw.Ay)("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(e,t)=>t.focusHighlight})((e=>{let{theme:t}=e;return{overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:t.transitions.create("opacity",{duration:t.transitions.duration.short})}})),TA=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiCardActionArea"}),{children:r,className:o,focusVisibleClassName:a}=n,i=(0,Me.A)(n,CA),s=n,c=(e=>{const{classes:t}=e;return(0,kw.A)({root:["root"],focusHighlight:["focusHighlight"]},SA,t)})(s);return(0,Be.jsxs)(AA,(0,Fe.A)({className:(0,cw.A)(c.root,o),focusVisibleClassName:(0,cw.A)(a,c.focusVisible),ref:t,ownerState:s},i,{children:[r,(0,Be.jsx)(EA,{className:c.focusHighlight,ownerState:s})]}))})),NA=TA;function RA(e){return(0,Aw.Ay)("MuiCard",e)}(0,vw.A)("MuiCard",["root"]);const _A=["className","raised"],DA=(0,Iw.Ay)(PS,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),OA=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiCard"}),{className:r,raised:o=!1}=n,a=(0,Me.A)(n,_A),i=(0,Fe.A)({},n,{raised:o}),s=(e=>{const{classes:t}=e;return(0,kw.A)({root:["root"]},RA,t)})(i);return(0,Be.jsx)(DA,(0,Fe.A)({className:(0,cw.A)(s.root,r),elevation:o?8:void 0,ref:t,ownerState:i},a))})),FA=OA,MA=[{title:"Scan Tanaman",description:"Identifikasi penyakit tanaman dan kekurangan nutrisi dengan AI.",icon:(0,Be.jsx)(AC.A,{sx:{fontSize:38}}),color:"#219653",path:"/scan"},{title:"Riwayat",description:"Lihat riwayat scan dan analisis Anda secara terorganisir.",icon:(0,Be.jsx)(EC.A,{sx:{fontSize:38}}),color:"#56CCF2",path:"/history"},{title:"Edukasi",description:"Pelajari penyakit tanaman dan solusi terbaik.",icon:(0,Be.jsx)(TC.A,{sx:{fontSize:38}}),color:"#F2C94C",path:"/education"},{title:"Komunitas",description:"Berbagi pengetahuan dan berdiskusi dengan petani lainnya.",icon:(0,Be.jsx)(_C.A,{sx:{fontSize:38}}),color:"#FF9800",path:"/community"}],PA=()=>{const e=ne(),{currentUser:t}=aw();return(0,Be.jsxs)(ww,{sx:{bgcolor:"background.default",minHeight:"100vh"},children:[(0,Be.jsx)(ww,{sx:{background:"url(".concat("/Agroscan","/assets/konten.webp) no-repeat center center"),backgroundSize:"cover",borderRadius:4,mx:{xs:1,md:4},mt:5,mb:6,p:{xs:4,md:8},boxShadow:2,textAlign:"center",color:"white",position:"relative",overflow:"hidden"},children:(0,Be.jsxs)(ww,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[(0,Be.jsx)(ww,{sx:{bgcolor:"white",color:"#219653",borderRadius:"50%",width:80,height:80,display:"flex",alignItems:"center",justifyContent:"center",mb:2,boxShadow:1},children:(0,Be.jsx)(AC.A,{sx:{fontSize:48}})}),(0,Be.jsx)(aS,{variant:"h2",sx:{fontWeight:800,mb:1,color:"white",letterSpacing:1,textShadow:"2px 2px 4px rgba(0, 0, 0, 0.5)"},children:"AgroScan"}),(0,Be.jsx)(aS,{variant:"h5",sx:{mb:3,color:"white",opacity:.95,textShadow:"2px 2px 4px rgba(0, 0, 0, 0.5)"},children:"Masa Depan Pertanian di Genggaman Anda"}),(0,Be.jsx)(aS,{sx:{mb:4,color:"white",maxWidth:500,mx:"auto",fontSize:18,textShadow:"2px 2px 4px rgba(0, 0, 0, 0.5)"},children:"AgroScan membantu Anda memahami kesehatan tanaman dan tanah dengan analisis cerdas dan rekomendasi akurat."}),(0,Be.jsx)(aI,{variant:"contained",size:"large",sx:{bgcolor:"white",color:"#219653",fontWeight:800,px:5,py:1.7,borderRadius:3,fontSize:18,boxShadow:1,"&:hover":{bgcolor:"#F7F9FA"}},onClick:()=>e("/scan"),children:"Mulai Sekarang"})]})}),(0,Be.jsx)(ZC,{maxWidth:"lg",sx:{mb:8},children:(0,Be.jsx)(kA,{container:!0,spacing:4,justifyContent:"center",children:MA.map(((t,n)=>(0,Be.jsx)(kA,{item:!0,xs:12,md:4,children:(0,Be.jsx)(NA,{onClick:()=>e(t.path),children:(0,Be.jsxs)(FA,{sx:{borderRadius:4,boxShadow:1,textAlign:"center",py:5,px:2,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:2,transition:"transform 0.2s","&:hover":{transform:"translateY(-6px)",boxShadow:3}},children:[(0,Be.jsx)(ww,{sx:{bgcolor:t.color,color:"white",borderRadius:"50%",width:56,height:56,display:"flex",alignItems:"center",justifyContent:"center",mb:2},children:t.icon}),(0,Be.jsx)(aS,{variant:"h6",sx:{fontWeight:700,mb:1,color:"#222"},children:t.title}),(0,Be.jsx)(aS,{sx:{color:"#555",fontSize:15},children:t.description})]})})},n)))})}),(0,Be.jsxs)(ww,{sx:{background:"linear-gradient(90deg, #219653 0%, #6FCF97 100%)",borderRadius:4,mx:{xs:1,md:4},mb:8,p:{xs:4,md:6},textAlign:"center",color:"white",boxShadow:2},children:[" ",(0,Be.jsxs)(aS,{variant:"h4",sx:{fontWeight:800,mb:2},children:[" ","Siap Tingkatkan Hasil Panen Anda?"]}),(0,Be.jsxs)(aS,{sx:{mb:3,fontSize:18},children:[" ","Bergabunglah dengan ribuan petani yang telah memanfaatkan AgroScan untuk pertanian yang lebih cerdas dan efisien."]}),(0,Be.jsx)(aI,{variant:"contained",size:"large",sx:{bgcolor:"white",color:"#219653",fontWeight:800,px:5,py:1.7,borderRadius:3,fontSize:18,boxShadow:1,"&:hover":{bgcolor:"#17643b"}},onClick:()=>e("/education"),children:"Pelajari Lebih Lanjut"})]})]})};var LA=n(8604);const zA=["component","direction","spacing","divider","children","className","useFlexGap"],BA=(0,hw.A)(),UA=KC("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function WA(e){return MC({props:e,name:"MuiStack",defaultTheme:BA})}function jA(e,t){const n=i.Children.toArray(e).filter(Boolean);return n.reduce(((e,r,o)=>(e.push(r),o<n.length-1&&e.push(i.cloneElement(t,{key:"separator-".concat(o)})),e)),[])}const VA=e=>{let{ownerState:t,theme:n}=e,r=(0,Fe.A)({display:"flex",flexDirection:"column"},(0,uA.NI)({theme:n},(0,uA.kW)({values:t.direction,breakpoints:n.breakpoints.values}),(e=>({flexDirection:e}))));if(t.spacing){const e=(0,LA.LX)(n),o=Object.keys(n.breakpoints.values).reduce(((e,n)=>(("object"===typeof t.spacing&&null!=t.spacing[n]||"object"===typeof t.direction&&null!=t.direction[n])&&(e[n]=!0),e)),{}),a=(0,uA.kW)({values:t.direction,base:o}),i=(0,uA.kW)({values:t.spacing,base:o});"object"===typeof a&&Object.keys(a).forEach(((e,t,n)=>{if(!a[e]){const r=t>0?a[n[t-1]]:"column";a[e]=r}}));const s=(n,r)=>{return t.useFlexGap?{gap:(0,LA._W)(e,n)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{["margin".concat((o=r?a[r]:t.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[o]))]:(0,LA._W)(e,n)}};var o};r=(0,PC.A)(r,(0,uA.NI)({theme:n},i,s))}return r=(0,uA.iZ)(n.breakpoints,r),r};const GA=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=UA,useThemeProps:n=WA,componentName:r="MuiStack"}=e,o=t(VA),a=i.forwardRef((function(e,t){const a=n(e),i=(0,dw.A)(a),{component:s="div",direction:c="column",spacing:l=0,divider:u,children:d,className:h,useFlexGap:p=!1}=i,f=(0,Me.A)(i,zA),m={direction:c,spacing:l,useFlexGap:p},g=(0,kw.A)({root:["root"]},(e=>(0,Aw.Ay)(r,e)),{});return(0,Be.jsx)(o,(0,Fe.A)({as:s,ownerState:m,ref:t,className:(0,cw.A)(g.root,h)},f,{children:u?jA(d,u):d}))}));return a}({createStyledComponent:(0,Iw.Ay)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>(0,Cw.b)({props:e,name:"MuiStack"})}),HA=GA;function qA(e){return(0,Aw.Ay)("MuiAlert",e)}const KA=(0,vw.A)("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),XA=(0,hS.A)((0,Be.jsx)("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),YA=(0,hS.A)((0,Be.jsx)("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),QA=(0,hS.A)((0,Be.jsx)("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),JA=(0,hS.A)((0,Be.jsx)("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),$A=(0,hS.A)((0,Be.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),ZA=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],eE=(0,Iw.Ay)(PS,{name:"MuiAlert",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t["".concat(n.variant).concat((0,$k.A)(n.color||n.severity))]]}})((e=>{let{theme:t}=e;const n="light"===t.palette.mode?Sw.e$:Sw.a,r="light"===t.palette.mode?Sw.a:Sw.e$;return(0,Fe.A)({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[o]=e;return{props:{colorSeverity:o,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert["".concat(o,"Color")]:n(t.palette[o].light,.6),backgroundColor:t.vars?t.vars.palette.Alert["".concat(o,"StandardBg")]:r(t.palette[o].light,.9),["& .".concat(KA.icon)]:t.vars?{color:t.vars.palette.Alert["".concat(o,"IconColor")]}:{color:t.palette[o].main}}}})),...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[r]=e;return{props:{colorSeverity:r,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert["".concat(r,"Color")]:n(t.palette[r].light,.6),border:"1px solid ".concat((t.vars||t).palette[r].light),["& .".concat(KA.icon)]:t.vars?{color:t.vars.palette.Alert["".concat(r,"IconColor")]}:{color:t.palette[r].main}}}})),...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.dark})).map((e=>{let[n]=e;return{props:{colorSeverity:n,variant:"filled"},style:(0,Fe.A)({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert["".concat(n,"FilledColor")],backgroundColor:t.vars.palette.Alert["".concat(n,"FilledBg")]}:{backgroundColor:"dark"===t.palette.mode?t.palette[n].dark:t.palette[n].main,color:t.palette.getContrastText(t.palette[n].main)})}}))]})})),tE=(0,Iw.Ay)("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,t)=>t.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),nE=(0,Iw.Ay)("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),rE=(0,Iw.Ay)("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),oE={success:(0,Be.jsx)(XA,{fontSize:"inherit"}),warning:(0,Be.jsx)(YA,{fontSize:"inherit"}),error:(0,Be.jsx)(QA,{fontSize:"inherit"}),info:(0,Be.jsx)(JA,{fontSize:"inherit"})},aE=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiAlert"}),{action:r,children:o,className:a,closeText:i="Close",color:s,components:c={},componentsProps:l={},icon:u,iconMapping:d=oE,onClose:h,role:p="alert",severity:f="success",slotProps:m={},slots:g={},variant:v="standard"}=n,y=(0,Me.A)(n,ZA),b=(0,Fe.A)({},n,{color:s,severity:f,variant:v,colorSeverity:s||f}),x=(e=>{const{variant:t,color:n,severity:r,classes:o}=e,a={root:["root","color".concat((0,$k.A)(n||r)),"".concat(t).concat((0,$k.A)(n||r)),"".concat(t)],icon:["icon"],message:["message"],action:["action"]};return(0,kw.A)(a,qA,o)})(b),w={slots:(0,Fe.A)({closeButton:c.CloseButton,closeIcon:c.CloseIcon},g),slotProps:(0,Fe.A)({},l,m)},[k,S]=IS("closeButton",{elementType:dI,externalForwardedProps:w,ownerState:b}),[I,C]=IS("closeIcon",{elementType:$A,externalForwardedProps:w,ownerState:b});return(0,Be.jsxs)(eE,(0,Fe.A)({role:p,elevation:0,ownerState:b,className:(0,cw.A)(x.root,a),ref:t},y,{children:[!1!==u?(0,Be.jsx)(tE,{ownerState:b,className:x.icon,children:u||d[f]||oE[f]}):null,(0,Be.jsx)(nE,{ownerState:b,className:x.message,children:o}),null!=r?(0,Be.jsx)(rE,{ownerState:b,className:x.action,children:r}):null,null==r&&h?(0,Be.jsx)(rE,{ownerState:b,className:x.action,children:(0,Be.jsx)(k,(0,Fe.A)({size:"small","aria-label":i,title:i,color:"inherit",onClick:h},S,{children:(0,Be.jsx)(I,(0,Fe.A)({fontSize:"small"},C))}))}):null]}))})),iE=aE;function sE(e){return(0,Aw.Ay)("MuiCircularProgress",e)}(0,vw.A)("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);var cE,lE,uE,dE;const hE=["className","color","disableShrink","size","style","thickness","value","variant"];let pE,fE,mE,gE;const vE=44,yE=(0,Zw.i7)(pE||(pE=cE||(cE=Vw(["\n  0% {\n    transform: rotate(0deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n"])))),bE=(0,Zw.i7)(fE||(fE=lE||(lE=Vw(["\n  0% {\n    stroke-dasharray: 1px, 200px;\n    stroke-dashoffset: 0;\n  }\n\n  50% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -15px;\n  }\n\n  100% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -125px;\n  }\n"])))),xE=(0,Iw.Ay)("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t["color".concat((0,$k.A)(n.color))]]}})((e=>{let{ownerState:t,theme:n}=e;return(0,Fe.A)({display:"inline-block"},"determinate"===t.variant&&{transition:n.transitions.create("transform")},"inherit"!==t.color&&{color:(n.vars||n).palette[t.color].main})}),(e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&(0,Zw.AH)(mE||(mE=uE||(uE=Vw(["\n      animation: "," 1.4s linear infinite;\n    "]))),yE)})),wE=(0,Iw.Ay)("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),kE=(0,Iw.Ay)("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t["circle".concat((0,$k.A)(n.variant))],n.disableShrink&&t.circleDisableShrink]}})((e=>{let{ownerState:t,theme:n}=e;return(0,Fe.A)({stroke:"currentColor"},"determinate"===t.variant&&{transition:n.transitions.create("stroke-dashoffset")},"indeterminate"===t.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})}),(e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&!t.disableShrink&&(0,Zw.AH)(gE||(gE=dE||(dE=Vw(["\n      animation: "," 1.4s ease-in-out infinite;\n    "]))),bE)})),SE=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiCircularProgress"}),{className:r,color:o="primary",disableShrink:a=!1,size:i=40,style:s,thickness:c=3.6,value:l=0,variant:u="indeterminate"}=n,d=(0,Me.A)(n,hE),h=(0,Fe.A)({},n,{color:o,disableShrink:a,size:i,thickness:c,value:l,variant:u}),p=(e=>{const{classes:t,variant:n,color:r,disableShrink:o}=e,a={root:["root",n,"color".concat((0,$k.A)(r))],svg:["svg"],circle:["circle","circle".concat((0,$k.A)(n)),o&&"circleDisableShrink"]};return(0,kw.A)(a,sE,t)})(h),f={},m={},g={};if("determinate"===u){const e=2*Math.PI*((vE-c)/2);f.strokeDasharray=e.toFixed(3),g["aria-valuenow"]=Math.round(l),f.strokeDashoffset="".concat(((100-l)/100*e).toFixed(3),"px"),m.transform="rotate(-90deg)"}return(0,Be.jsx)(xE,(0,Fe.A)({className:(0,cw.A)(p.root,r),style:(0,Fe.A)({width:i,height:i},m,s),ownerState:h,ref:t,role:"progressbar"},g,d,{children:(0,Be.jsx)(wE,{className:p.svg,ownerState:h,viewBox:"".concat(22," ").concat(22," ").concat(vE," ").concat(vE),children:(0,Be.jsx)(kE,{className:p.circle,style:f,ownerState:h,cx:vE,cy:vE,r:(vE-c)/2,fill:"none",strokeWidth:c})})}))})),IE=SE;var CE=n(2954),AE=n(7029),EE=n.n(AE);class TE{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class NE{refCount(e){return RE("refCount")}incRef(e){return RE("incRef")}timerAvailable(){return!0}time(e){return RE("time")}read(e){return RE("read")}readSync(e){return RE("readSync")}readToGPU(e,t){return RE("readToGPU")}numDataIds(){return RE("numDataIds")}disposeData(e,t){return RE("disposeData")}write(e,t,n){return RE("write")}move(e,t,n,r,o){return RE("move")}createTensorFromGPUData(e,t,n){return RE("createTensorFromGPUData")}memory(){return RE("memory")}floatPrecision(){return RE("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return RE("dispose")}}function RE(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function _E(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,FE(e,t,n)}function DE(e,t,n){return Math.max(e,Math.min(t,n))}function OE(e){return e%2===0?e:e+1}function FE(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function ME(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function PE(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";ME(BE(e,t),(()=>n+" Shapes ".concat(e," and ").concat(t," must match")))}function LE(e){ME(null!=e,(()=>"The input to the tensor constructor must be a non-null value."))}function zE(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function BE(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function UE(e){return e%1===0}function WE(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function jE(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function VE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise(((o,a)=>{let i=0;const s=()=>{if(e())return void o();i++;const c=t(i);null!=n&&i>=n?a():null!=r?r(s,c):setTimeout(s,c)};s()}))}function GE(e,t){let n=1,r=-1;for(let a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));const o=e.slice();return o[r]=t/n,o}function HE(e,t){const n=t.length;return ME((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-n&&e<n)),(()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e))),ME(e.every((e=>UE(e))),(()=>"All values in axis param must be integers but "+"got axis ".concat(e))),e.map((e=>e<0?n+e:e))}function qE(e,t){const n=[],r=[],o=null!=t&&Array.isArray(t)&&0===t.length,a=null==t||o?null:HE(t,e).sort();let i=0;for(let s=0;s<e.length;++s){if(null!=a){if(a[i]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==a[i]||a[i]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),a[i]<=s&&i++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function KE(e,t){return XE(e,t)}function XE(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function YE(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function QE(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function JE(e){return"string"===typeof e||e instanceof String}function $E(e){return"number"===typeof e}function ZE(e){return Array.isArray(e)?ZE(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":$E(e)?"float32":JE(e)?"string":"boolean"===typeof e?"bool":"float32"}function eT(e){return!!(e&&e.constructor&&e.call&&e.apply)}function tT(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function nT(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function rT(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=new Array;if(1===t.length){const a=t[0]*(r?2:1);for(let t=0;t<a;t++)o[t]=n[e+t]}else{const a=t[0],i=t.slice(1),s=i.reduce(((e,t)=>e*t))*(r?2:1);for(let t=0;t<a;t++)o[t]=rT(e+t*s,i,n,r)}return o}function oT(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];const r=e.reduce(((e,t)=>e*t))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return rT(0,e,t,n)}function aT(e,t){const n=iT(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function iT(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function sT(e,t){const n=e.reduce(((e,t)=>e*t),1);if(null==t||"float32"===t)return oT(e,new Float32Array(n));if("int32"===t)return oT(e,new Int32Array(n));if("bool"===t)return oT(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function cT(e){e.forEach((t=>{ME(Number.isInteger(t)&&t>=0,(()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")))}))}function lT(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function uT(e,t,n){if(0===t)return[];if(1===t)return[e];const r=new Array(t);for(let o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}function dT(e){return e&&e.then&&"function"===typeof e.then}const hT="tfjsflags";class pT{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=fT,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(mT().getBool("IS_TEST")||mT().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];mT().getBool("IS_TEST")||mT().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(t,".")),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(dT(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);if(hT in e){e[hT].split(",").forEach((e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){const n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,n)}))}}}function fT(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")})),t}function mT(){return vT}let gT,vT=null;function yT(){if(null==gT){let e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}gT=e}return gT}function bT(e,t){const n=function(){const e=yT();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const xT="Abs",wT="Acos",kT="Acosh",ST="Add",IT="AddN",CT="All",AT="Any",ET="ArgMax",TT="ArgMin",NT="Asin",RT="Asinh",_T="Atan",DT="Atanh",OT="Atan2",FT="AvgPool",MT="AvgPoolGrad",PT="AvgPool3D",LT="AvgPool3DGrad",zT="BatchMatMul",BT="BatchToSpaceND",UT="Bincount",WT="BitwiseAnd",jT="BroadcastArgs",VT="Cast",GT="Ceil",HT="ClipByValue",qT="Complex",KT="ComplexAbs",XT="Concat",YT="Conv2D",QT="Conv2DBackpropFilter",JT="Conv2DBackpropInput",$T="Conv3D",ZT="Conv3DBackpropFilterV2",eN="Conv3DBackpropInputV2",tN="Cos",nN="Cosh",rN="Cumprod",oN="Cumsum",aN="CropAndResize",iN="DenseBincount",sN="DepthToSpace",cN="DepthwiseConv2dNative",lN="DepthwiseConv2dNativeBackpropFilter",uN="DepthwiseConv2dNativeBackpropInput",dN="Diag",hN="Dilation2D",pN="Dilation2DBackpropInput",fN="Dilation2DBackpropFilter",mN="Draw",gN="RealDiv",vN="Einsum",yN="Elu",bN="EluGrad",xN="Erf",wN="Equal",kN="Exp",SN="ExpandDims",IN="Expm1",CN="FFT",AN="Fill",EN="FlipLeftRight",TN="Floor",NN="FloorDiv",RN="FusedBatchNorm",_N="GatherV2",DN="GatherNd",ON="Greater",FN="GreaterEqual",MN="Identity",PN="IFFT",LN="Imag",zN="IsFinite",BN="IsInf",UN="IsNan",WN="LeakyRelu",jN="Less",VN="LessEqual",GN="LinSpace",HN="Log",qN="Log1p",KN="LogicalAnd",XN="LogicalNot",YN="LogicalOr",QN="LRN",JN="LRNGrad",$N="Max",ZN="Maximum",eR="MaxPool",tR="MaxPoolGrad",nR="MaxPool3D",rR="MaxPool3DGrad",oR="MaxPoolWithArgmax",aR="Mean",iR="Min",sR="Minimum",cR="MirrorPad",lR="Mod",uR="Multinomial",dR="Multiply",hR="Neg",pR="NotEqual",fR="NonMaxSuppressionV3",mR="NonMaxSuppressionV4",gR="NonMaxSuppressionV5",vR="OnesLike",yR="OneHot",bR="Pack",xR="PadV2",wR="Pow",kR="Prelu",SR="Prod",IR="RaggedGather",CR="RaggedRange",AR="RaggedTensorToTensor",ER="Range",TR="Real",NR="Reciprocal",RR="Relu",_R="Reshape",DR="ResizeNearestNeighbor",OR="ResizeNearestNeighborGrad",FR="ResizeBilinear",MR="ResizeBilinearGrad",PR="Relu6",LR="Reverse",zR="Round",BR="Rsqrt",UR="ScatterNd",WR="TensorScatterUpdate",jR="SearchSorted",VR="Select",GR="Selu",HR="Slice",qR="Sin",KR="Sinh",XR="Sign",YR="Sigmoid",QR="Softplus",JR="Sqrt",$R="Sum",ZR="SpaceToBatchND",e_="SplitV",t_="Softmax",n_="SparseFillEmptyRows",r_="SparseReshape",o_="SparseSegmentMean",a_="SparseSegmentSum",i_="SparseToDense",s_="SquaredDifference",c_="Square",l_="StaticRegexReplace",u_="StridedSlice",d_="StringNGrams",h_="StringSplit",p_="StringToHashBucketFast",f_="Sub",m_="Tan",g_="Tanh",v_="Tile",y_="TopK",b_="Transform",x_="Transpose",w_="Unique",k_="Unpack",S_="UnsortedSegmentSum",I_="ZerosLike",C_="Step",A_="FromPixels",E_="RotateWithOffset",T_="_FusedMatMul",N_="FusedConv2D",R_="FusedDepthwiseConv2D";function __(){mT().getBool("IS_TEST")||mT().getBool("PROD")||console.warn(...arguments)}function D_(){mT().getBool("IS_TEST")||mT().getBool("PROD")||console.log(...arguments)}const O_=bT("kernelRegistry",(()=>new Map)),F_=bT("gradRegistry",(()=>new Map));function M_(e,t){const n=U_(e,t);return O_.get(n)}function P_(e){return F_.get(e)}function L_(e){const t=O_.entries(),n=[];for(;;){const{done:r,value:o}=t.next();if(r)break;const[a,i]=o,[s]=a.split("_");s===e&&n.push(i)}return n}function z_(e){const{kernelName:t,backendName:n}=e,r=U_(t,n);O_.has(r)&&__("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),O_.set(r,e)}function B_(e){const{kernelName:t}=e;F_.has(t)&&mT().getBool("DEBUG")&&__("Overriding the gradient for '".concat(t,"'")),F_.set(t,e)}function U_(e,t){return"".concat(t,"_").concat(e)}function W_(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var j_=n(7353);const V_=n.n(j_)()||j_;function G_(e){return V_.fromString(e,!0,16)}const H_=G_("c3a5c85c97cb3127"),q_=G_("b492b66fbe98f273"),K_=G_("9ae16a3b2f90404f");function X_(e){return e.xor(e.shru(47))}function Y_(e,t,n){const r=e.slice(t,t+n);return V_.fromBytes(Array.from(r),!0,!0)}function Q_(e,t){return Y_(e,t,8)}function J_(e,t){return Y_(e,t,4)}function $_(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function Z_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:G_("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));let o=t.xor(r).mul(n);return o=o.xor(o.shru(47)),o=o.mul(n),o}function eD(e,t,n,r){return function(e,t,n,r,o,a){o=o.add(e),a=$_(a.add(o).add(r),21);const i=o;return o=(o=o.add(t)).add(n),a=a.add($_(o,44)),[o.add(r),a.add(i)]}(Q_(e,t),Q_(e,t+8),Q_(e,t+16),Q_(e,t+24),n,r)}function tD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=V_.fromNumber(81,!0);if(t<=32)return t<=16?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){const n=K_.add(2*t),r=Q_(e,0).add(K_),o=Q_(e,t-8);return Z_($_(o,37).mul(n).add(r),$_(r,25).add(o).mul(n),n)}if(t>=4){const n=K_.add(2*t);return Z_(J_(e,0).shl(3).add(t),J_(e,t-4),n)}if(t>0){const n=e[0]+(e[t>>1]<<8),r=t+(e[t-1]<<2);return X_(K_.mul(n).xor(H_.mul(r))).mul(K_)}return K_}(e,t):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=K_.add(2*t),r=Q_(e,0).mul(q_),o=Q_(e,8),a=Q_(e,t-8).mul(n),i=Q_(e,t-16).mul(K_);return Z_($_(r.add(o),43).add($_(a,30)).add(i),r.add($_(o.add(K_),18)).add(a),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=K_.add(2*t),r=Q_(e,0).mul(K_),o=Q_(e,8),a=Q_(e,t-8).mul(n),i=Q_(e,t-16).mul(K_),s=$_(r.add(o),43).add($_(a,30)).add(i),c=Z_(s,r.add($_(o.add(K_),18)).add(a),n),l=Q_(e,16).mul(n),u=Q_(e,24),d=s.add(Q_(e,t-32)).mul(n),h=c.add(Q_(e,t-24)).mul(n);return Z_($_(l.add(u),43).add($_(d,30)).add(h),l.add($_(u.add(r),18)).add(d),n)}(e,t);let r=n,o=n.mul(q_).add(113),a=X_(o.mul(K_).add(113)).mul(K_),i=[V_.UZERO,V_.UZERO],s=[V_.UZERO,V_.UZERO];r=r.mul(K_).add(Q_(e,0));let c=0;const l=64*(t-1>>6),u=l+(t-1&63)-63;do{r=$_(r.add(o).add(i[0]).add(Q_(e,c+8)),37).mul(q_),o=$_(o.add(i[1]).add(Q_(e,c+48)),42).mul(q_),r=r.xor(s[1]),o=o.add(i[0]).add(Q_(e,c+40)),a=$_(a.add(s[0]),33).mul(q_),i=eD(e,c,i[1].mul(q_),r.add(s[0])),s=eD(e,c+32,a.add(s[1]),o.add(Q_(e,c+16))),[a,r]=[r,a],c+=64}while(c!==l);const d=q_.add(a.and(255).shl(1));return c=u,s[0]=s[0].add(t-1&63),i[0]=i[0].add(s[0]),s[0]=s[0].add(i[0]),r=$_(r.add(o).add(i[0]).add(Q_(e,c+8)),37).mul(d),o=$_(o.add(i[1]).add(Q_(e,c+48)),42).mul(d),r=r.xor(s[1].mul(9)),o=o.add(i[0].mul(9).add(Q_(e,c+40))),a=$_(a.add(s[0]),33).mul(d),i=eD(e,c,i[1].mul(d),r.add(s[0])),s=eD(e,c+32,a.add(s[1]),o.add(Q_(e,c+16))),[a,r]=[r,a],Z_(Z_(i[0],s[0],d).add(X_(o).mul(H_)).add(a),Z_(i[1],s[1],d).add(r),d)}function nD(e,t){return"string"===t?aD(e):rD([e],t)}function rD(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=cD(e)),mT().getBool("DEBUG")&&function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error("Unknown data type ".concat(t))}function oD(){return mT().platform.now()}function aD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",mT().platform.encode(e,t)}function iD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",mT().platform.decode(e,t)}function sD(e){return null!=mT().platform.isTypedArray?mT().platform.isTypedArray(e):W_(e)}function cD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||dT(e)||null==e||sD(e)&&n)t.push(e);else if(Array.isArray(e)||sD(e))for(let r=0;r<e.length;++r)cD(e[r],t,n);else{let r=-1;for(const t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let o=0;o<=r;o++)cD(e[o],t,n)}return t}class lD{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new dD)}profileKernel(e,t,n){let r;const o=()=>{r=n()};let a;const i=oD();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(o);else{o();for(const e of r)e.dataSync();a=Promise.resolve({kernelMs:oD()-i})}if(mT().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let s=0;s<r.length;s++){const t=r[s];t.data().then((n=>{uD(n,t.dtype,e)}))}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((e=>e.kernelMs)),extraInfo:a.then((e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""))}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:r,inputs:o,extraInfo:a}=e;n.forEach((e=>{Promise.all([e.data(),r,a]).then((n=>{this.logger.logKernelProfile(t,e,n[0],n[1],o,n[2])}))}))}}function uD(e,t,n){if("float32"!==t)return!1;for(let r=0;r<e.length;r++){const t=e[r];if(isNaN(t)||!isFinite(t))return console.warn("Found ".concat(t," in the result of '").concat(n,"'")),!0}return!1}class dD{logKernelProfile(e,t,n,r,o,a){const i="number"===typeof r?jE("".concat(r,"ms"),9):r.error,s=jE(e,25),c=t.rank,l=t.size,u=jE(t.shape.toString(),14);let d="";for(const h in o){const e=o[h];if(null!=e){const n=e.shape||t.shape,r=n.length;d+="".concat(h,": ").concat(r,"D ").concat(r>0?n:""," ")}}console.log("%c".concat(s,"\t%c").concat(i,"\t%c").concat(c,"D ").concat(u,"\t%c").concat(l,"\t%c").concat(d,"\t%c").concat(a),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function hD(e,t,n,r){const o=nT(t),a=function(e,t,n,r){const o=zE(t),a=r[r.length-1],i=new Array(a).fill(0),s=t.length,c="complex64"===n?gD(e):e;if(s>1)for(let l=0;l<o/a;l++){const e=l*a;for(let t=0;t<a;t++)i[t]=Math.max(i[t],pD(c[e+t],0,n).length)}return i}(e,t,n,o),i=t.length,s=mD(e,t,n,o,a),c=["Tensor"];return r&&(c.push("  dtype: ".concat(n)),c.push("  rank: ".concat(i)),c.push("  shape: [".concat(t,"]")),c.push("  values:")),c.push(s.map((e=>"    "+e)).join("\n")),c.join("\n")}function pD(e,t,n){let r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):JE(e)?"'".concat(e,"'"):"bool"===n?fD(e):parseFloat(e.toFixed(7)).toString(),jE(r,t)}function fD(e){return 0===e?"false":"true"}function mD(e,t,n,r,o){let a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const i="complex64"===n?2:1,s=t[0],c=t.length;if(0===c){if("complex64"===n){return[pD(gD(e)[0],0,n)]}return"bool"===n?[fD(e[0])]:[e[0].toString()]}if(1===c){if(s>20){const t=3*i;let r=Array.from(e.slice(0,t)),a=Array.from(e.slice((s-3)*i,s*i));return"complex64"===n&&(r=gD(r),a=gD(a)),["["+r.map(((e,t)=>pD(e,o[t],n))).join(", ")+", ..., "+a.map(((e,t)=>pD(e,o[s-3+t],n))).join(", ")+"]"]}return["["+("complex64"===n?gD(e):Array.from(e)).map(((e,t)=>pD(e,o[t],n))).join(", ")+"]"]}const l=t.slice(1),u=r.slice(1),d=r[0]*i,h=[];if(s>20){for(let t=0;t<3;t++){const r=t*d,a=r+d;h.push(...mD(e.slice(r,a),l,n,u,o,!1))}h.push("...");for(let t=s-3;t<s;t++){const r=t*d,a=r+d;h.push(...mD(e.slice(r,a),l,n,u,o,t===s-1))}}else for(let m=0;m<s;m++){const t=m*d,r=t+d;h.push(...mD(e.slice(t,r),l,n,u,o,m===s-1))}const p=2===c?",":"";h[0]="["+(s>0?h[0]+p:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+p;let f=",\n";for(let m=2;m<c;m++)f+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(a?"":f),h}function gD(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class vD{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=zE(e),null!=n){const e=n.length;ME(e===this.size,(()=>"Length of values '".concat(e,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'.")))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||XE(t,this.size),this.strides=nT(e)}set(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),ME(n.length===this.rank,(()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")")));const o=this.locToIndex(n);this.values[o]=e}get(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let r=0;for(const a of t){if(a<0||a>=this.shape[r]){const e="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(e)}r++}let o=t[t.length-1];for(let a=0;a<t.length-1;++a)o+=this.strides[a]*t[a];return this.values[o]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return yD().makeTensor(this.values,this.shape,this.dtype)}}let yD=null,bD=null,xD=null;class wD{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=zE(e),this.strides=nT(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return bD.buffer(this.shape,this.dtype,e)}bufferSync(){return bD.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return oT(this.shape,e,"complex64"===this.dtype)}arraySync(){return oT(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=yD().read(this.dataId);if("string"===this.dtype){const n=await e;try{return n.map((e=>iD(e)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),yD().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=yD().readSync(this.dataId);if("string"===this.dtype)try{return e.map((e=>iD(e)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await yD().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),yD().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return bD.print(this,e)}clone(){return this.throwIfDisposed(),bD.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return hD(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),bD.cast(this,e)}variable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),yD().makeVariable(this,e,t,n)}}function kD(){return bT("Tensor",(()=>wD))}Object.defineProperty(wD,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),kD();class SD extends wD{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!BE(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));yD().disposeTensor(this),this.dataId=e.dataId,yD().incRef(this,null)}dispose(){yD().disposeVariable(this),this.isDisposedInternal=!0}}var ID,CD,AD,ED,TD;Object.defineProperty(SD,Symbol.hasInstance,{value:e=>e instanceof wD&&null!=e.assign&&e.assign instanceof Function}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(ID||(ID={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(CD||(CD={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(AD||(AD={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(ED||(ED={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(TD||(TD={}));const ND={float32:ED,int32:CD,bool:AD,complex64:TD};function RD(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return ND[e][t]}function _D(e){return RD(e,"int32")}function DD(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function OD(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function FD(e,t){if(e.dtype===t.dtype)return[e,t];const n=RD(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function MD(e,t){return t.some((t=>t.id===e.id))}function PD(e){const t=[];return LD(e,t,new Set),t}function LD(e,t,n){if(null==e)return;if(e instanceof wD)return void t.push(e);if(r=e,!Array.isArray(r)&&"object"!==typeof r)return;var r;const o=e;for(const a in o){const e=o[a];n.has(e)||(n.add(e),LD(e,t,n))}}function zD(e){return null!=e.kernelName}class BD{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((e=>e.name))))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class UD{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new BD}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(__("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new lD(this.backendInstance),!0}setupRegisteredKernels(){L_(this.backendName).forEach((e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(e){L_(e).forEach((t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])}))}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{const n=t.factory();if(!n||n instanceof NE||"function"!==typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,r=n.then((n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0))).catch((n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,__("Initialization of backend ".concat(e," failed")),__(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return __("Initialization of backend ".concat(e," failed")),__(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority))}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:r,asyncInit:o}=this.initializeBackend(n);if(o||r)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),r=n.backend,o=this.readSync(t),a=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,o,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(r){throw t(),r}}nextTensorId(){return UD.nextTensorId++}nextVariableId(){return UD.nextVariableId++}clone(e){const t=jD.runKernel(MN,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(e=>({x:()=>{const t={x:e},n={dtype:"float32"};return jD.runKernel(VT,t,n)}})),[],{}),t}runKernel(e,t,n){null==this.backendName&&this.backend;if(!(null!=M_(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const r=this.backend.numDataIds();let o=0;n.forEach((e=>{o+="complex64"===e.dtype?3:1}));const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=r-t-o-a;if(i>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(i," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n=[];const r=this.isTapeOn(),o=this.state.numBytes,a=this.state.numTensors;let i,s;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const c=zD(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(zD(e)){const{kernelName:t,inputs:o,attrs:a}=e;null==this.backendName&&this.backend;const c=M_(t,this.backendName);ME(null!=c,(()=>"Cannot find registered kernel '".concat(t,"' for backend '").concat(this.backendName,"'"))),i=()=>{const e=this.backend.numDataIds();s=c.kernelFunc({inputs:o,attrs:a,backend:this.backend});const i=Array.isArray(s)?s:[s];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,i);const l=i.map((e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e)));if(r){const e=this.getTensorsForGradient(t,o,l);n=this.saveTensorsForBackwardMode(e)}return l}}else{const{forwardFunc:t}=e,o=e=>{r&&(n=e.map((e=>this.keep(this.clone(e)))))};i=()=>{const e=this.backend.numDataIds();s=this.tidy((()=>t(this.backend,o)));const n=Array.isArray(s)?s:[s];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,e,n),n}}const{inputs:l,attrs:u}=e,d=zD(e)?null:e.backwardsFunc;let h;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(h=this.profiler.profileKernel(c,l,(()=>i())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),t=h.outputs):t=i()})),r&&this.addTapeNode(c,l,t,d,n,u),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(l).map((e=>null!=l[e]?l[e].shape:null)),outputShapes:t.map((e=>e.shape)),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(s)?t:t[0]}saveTensorsForBackwardMode(e){return e.map((e=>this.keep(this.clone(e))))}getTensorsForGradient(e,t,n){const r=P_(e);if(null!=r){const e=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(ME(Array.isArray(t),(()=>"saveAllInputs is true, expected inputs to be an array.")),a=Object.keys(t).map((e=>t[e]))):a=e.map((e=>t[e]));const i=n.filter(((e,t)=>o[t]));return a.concat(i)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let o=e;"string"===n&&JE(e[0])&&(o=e.map((e=>aD(e))));const a=r.write(o,t,n),i=new wD(t,n,a,this.nextTensorId());if(this.trackTensor(i,r),"string"===n){const e=this.state.tensorInfo.get(a),t=function(e){if(null==e)return 0;let t=0;return e.forEach((e=>t+=e.length)),t}(o);this.state.numBytes+=t-e.bytes,e.bytes=t}return i}makeTensorFromDataId(e,t,n,r){const o={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(o,r)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:r,dtype:o}=e,a=new wD(r,o,n,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const o=new SD(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[o.name])throw new Error("Variable with name ".concat(o.name," was already registered"));return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*QE(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof SD||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*QE(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((e=>e.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,o,a){const i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:o},s=P_(e);null!=s&&(r=s.gradFunc),null!=r&&(i.gradient=e=>(e=e.map(((e,t)=>{if(null==e){const e=n[t],r=iT(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e})),r(e.length>1?e:e[0],o,a))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=PD(e),n=new Set(t.map((e=>e.id)));for(let o=0;o<this.state.activeScope.track.length;o++){const e=this.state.activeScope.track[o];e.kept||n.has(e.id)||e.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach((e=>{e.kept||e.scopeId!==r.id||this.track(e)}))}gradients(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(ME(t.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const o=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",e)));ME(o instanceof wD,(()=>"The result y returned by f() must be a tensor."));const a=function(e,t,n){const r={},o={};for(let c=0;c<t.length;c++)r[t[c].id]=!0;for(let c=0;c<e.length;c++){const n=e[c],a=n.inputs;for(const e in a){const i=a[e];let s=!1;for(let e=0;e<t.length;e++)if(r[i.id]){n.outputs.forEach((e=>r[e.id]=!0)),s=!0,o[n.id]=!0;break}if(s)break}}const a={};a[n.id]=!0;const i={};for(let c=e.length-1;c>=0;c--){const t=e[c],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(a[t.outputs[e].id]){for(const e in n)a[n[e].id]=!0,i[t.id]=!0;break}}const s=[];for(let c=0;c<e.length;c++){const t=e[c];if(o[t.id]&&i[t.id]){const e={};for(const o in t.inputs){const n=t.inputs[o];r[n.id]&&(e[o]=n)}const n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,s.push(n)}}return s}(this.state.activeTape,t,o);if(!r&&0===a.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const e={};e[o.id]=null==n?function(e){const t=aT(zE(e),"float32");return jD.makeTensor(t,e,"float32")}(o.shape):n,function(e,t,n,r){for(let o=t.length-1;o>=0;o--){const a=t[o],i=[];if(a.outputs.forEach((t=>{const n=e[t.id];null!=n?i.push(n):i.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));const s=a.gradient(i);for(const t in a.inputs){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));const o=n((()=>s[t]()));if("float32"!==o.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(o.dtype,"'"));const i=a.inputs[t];if(!BE(o.shape,i.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(o.shape,"', which does not match ")+"the shape of the input '".concat(i.shape,"'"));if(null==e[i.id])e[i.id]=o;else{const t=e[i.id];e[i.id]=r(t,o),t.dispose()}}}}(e,a,(e=>this.tidy(e)),VD);const r=t.map((t=>e[t.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((e=>{for(const t of e.saved)t.dispose()})),this.state.activeTape=null),{value:o,grads:r}}))}customGrad(e){var t=this;return ME(eT(e),(()=>"The f passed in customGrad(f) must be a function.")),function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];let a;ME(r.every((e=>e instanceof wD)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const i={};r.forEach(((e,t)=>{i[t]=e}));return t.runKernelFunc({forwardFunc:(t,n)=>(a=e(...r,n),ME(a.value instanceof wD,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),ME(eT(a.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),a.value),backwardsFunc:(e,t)=>{const n=a.gradFunc(e,t),o=Array.isArray(n)?n:[n];ME(o.length===r.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),ME(o.every((e=>e instanceof wD)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const i={};return o.forEach(((e,t)=>{i[t]=()=>e})),i},inputs:i})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=oD(),n=await this.backend.time(e);return n.wallMs=oD()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new BD;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function WD(){const e=yT();if(null==e._tfengine){const t=new pT(e);e._tfengine=new UD(t)}var t;return t=e._tfengine.ENV,vT=t,function(e){yD=e}((()=>e._tfengine)),e._tfengine}UD.nextTensorId=0,UD.nextVariableId=0;const jD=WD();function VD(e,t){const n={a:e,b:t};return jD.runKernel(ST,n)}let GD;function HD(e){if(void 0!==GD)return GD;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function qD(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const KD=mT();function XD(e,t){let n=e;if(sD(e))return"string"===t?[]:[e.length];if(DD(e)){const t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(OD(e))return[e.buffer.size/(null==t?4:QE(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||sD(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&mT().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&YD(e,r,[]),r}function YD(e,t,n){if(n=n||[],!Array.isArray(e)&&!sD(e))return void ME(0===t.length,(()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")));ME(t.length>0,(()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements"))),ME(e.length===t[0],(()=>"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")));const r=t.slice(1);for(let o=0;o<e.length;++o)YD(e[o],r,n.concat(o))}function QD(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function JD(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof kD())return QD(r,e.dtype,t,n),e;let o=ZE(e);if("string"!==o&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),QD(r,o,t,n),null==e||!sD(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){const r=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(r,"'"))}const a=XD(e,o);sD(e)||Array.isArray(e)||(e=[e]);const i="string"!==o?rD(e,o):cD(e,[],!0);return jD.makeTensor(i,a,o)}function $D(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map(((e,o)=>JD(e,"".concat(t,"[").concat(o,"]"),n,r)))}KD.registerFlag("DEBUG",(()=>!1),(e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),KD.registerFlag("IS_BROWSER",(()=>qD())),KD.registerFlag("IS_NODE",(()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node)),KD.registerFlag("IS_CHROME",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),KD.registerFlag("IS_SAFARI",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),KD.registerFlag("PROD",(()=>!1)),KD.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>KD.getBool("DEBUG"))),KD.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),KD.registerFlag("IS_TEST",(()=>!1)),KD.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>KD.getBool("DEBUG"))),KD.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),KD.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),KD.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));function ZD(e){const t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";const o=function(){jD.startScope(n);try{const e=r(...arguments);return dT(e)&&console.error("Cannot return a Promise inside of tidy."),jD.endScope(e),e}catch(e){throw jD.endScope(null),e}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}const eO=ZD({complex_:function(e,t){const n=JD(e,"real","complex"),r=JD(t,"imag","complex");PE(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");const o={real:n,imag:r};return jD.runKernel(qT,o)}});function tO(e,t,n,r){if(null==r)r=ZE(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(OD(e)||DD(e)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return jD.backend.createTensorFromGPUData(e,t||n,r)}if(!sD(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){cT(t);const e=zE(t),r=zE(n);ME(e===r,(()=>"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(e," values but has ").concat(r)));for(let o=0;o<n.length;++o){const e=n[o],r=o!==n.length-1||e!==zE(t.slice(o));ME(n[o]===t[o]||!r,(()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")))}}return sD(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?rD(e,r):cD(e,[],!0),jD.makeTensor(e,t,r)}function nO(e,t,n){return tO(e,t,XD(e,n),n)}const rO={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class oO{static join(e){return new oO(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e)return;if(e instanceof Array||(e=[e]),0===(e=e.map((e=>sD(e)?e.buffer:e))).length)return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=t+r.byteLength;this.shards.push({buffer:r,start:t,end:o}),t=o}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));const r=new ArrayBuffer(t-e),o=new Uint8Array(r);let a=0;for(let i=n;i<this.shards.length;i++){const n=this.shards[i],r=e+a-n.start,s=a,c=Math.min(t,n.end)-n.start,l=new Uint8Array(n.buffer,r,c-r);if(o.set(l,s),a+=l.length,t<n.end)break}return r}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(e,t){let n=0,r=e.length;for(;n<=r;){const o=Math.floor((r-n)/2)+n,a=t(e[o]);if(0===a)return o;a<0?r=o:n=o+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function aO(){return jD}function iO(){return jD.memory()}function sO(e,t){return jD.tidy(e,t)}function cO(e){PD(e).forEach((e=>e.dispose()))}function lO(e){return jD.keep(e)}function uO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return jD.registerBackend(e,t,n)}function dO(){return jD.backend}!function(e){xD=e}((function(e){mT().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}));async function hO(e,t){const n=[],r=[],o=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);for(let a=0;a<o.length;++a){const i=o[a],s=Array.isArray(e)?e[a].tensor:e[i];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(i,"': ").concat(s.dtype));const c={name:i,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const e=new Promise((async e=>{const t=await s.bytes(),n=t.reduce(((e,t)=>e+t.length),0)+4*t.length,r=new Uint8Array(n);let o=0;for(let a=0;a<t.length;a++){const e=t[a],n=new Uint8Array(new Uint32Array([e.length]).buffer);r.set(n,o),o+=4,r.set(e,o),o+=e.length}e(r)}));r.push(e)}else r.push(s.data());null!=t&&(c.group=t),n.push(c)}return{data:gO(await Promise.all(r)),specs:n}}function pO(e,t){const n=new oO(e),r={};let o=0;for(const a of t){const e=fO(a,((e,t)=>n.slice(o+e,o+t)));r[a.name]=mO(a,n.slice(o,o+e)),o+=e}return r}function fO(e,t){const n=zE(e.shape);let r;if("quantization"in e){const t=e.quantization;r=rO[t.dtype]}else{if("string"===e.dtype){let e=0;for(let r=0;r<n;r++)e+=4+new Uint32Array(t(e,e+4))[0];return e}r=rO[e.dtype]}return n*r}function mO(e,t){const n=e.name,r=e.dtype,o=e.shape,a=zE(o);let i,s=0;if("quantization"in e){const o=e.quantization;if("uint8"===o.dtype||"uint16"===o.dtype){if(!("min"in o)||!("scale"in o))throw new Error("Weight ".concat(e.name," with quantization ").concat(o.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==o.dtype)throw new Error("Weight ".concat(e.name," has unknown ")+"quantization dtype ".concat(o.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==r)throw new Error("Weight ".concat(e.name," is quantized with ").concat(o.dtype," ")+"which only supports weights of type float32 not ".concat(r,"."))}const c=rO[o.dtype],l="uint8"===o.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===r)if("uint8"===o.dtype||"uint16"===o.dtype){i=new Float32Array(l.length);for(let e=0;e<l.length;e++){const t=l[e];i[e]=t*o.scale+o.min}}else{if("float16"!==o.dtype)throw new Error("Unsupported quantization type ".concat(o.dtype," ")+"for weight type float32.");{const e=function(){const e=function(){const e=e=>{let t=e<<13,n=0;for(;0===(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}(),t=function(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{const o=new ArrayBuffer(4*r.length),a=new Uint32Array(o);for(let i=0;i<r.length;i++){const o=r[i],s=e[n[o>>10]+(1023&o)]+t[o>>10];a[i]=s}return new Float32Array(o)}}();i=e(l)}}else{if("int32"!==r)throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(r));if("uint8"!==o.dtype&&"uint16"!==o.dtype)throw new Error("Unsupported quantization type ".concat(o.dtype," ")+"for weight type int32.");i=new Int32Array(l.length);for(let e=0;e<l.length;e++){const t=l[e];i[e]=Math.round(t*o.scale+o.min)}}s+=a*c}else if("string"===r){const n=zE(e.shape);i=[];for(let e=0;e<n;e++){const e=new Uint32Array(t.slice(s,s+4))[0];s+=4;const n=new Uint8Array(t.slice(s,s+e));i.push(n),s+=e}}else{const e=rO[r];if("float32"===r)i=new Float32Array(t);else if("int32"===r)i=new Int32Array(t);else{if("bool"!==r){if("complex64"===r){i=new Float32Array(t);const e=new Float32Array(i.length/2),n=new Float32Array(i.length/2);for(let t=0;t<e.length;t++)e[t]=i[2*t],n[t]=i[2*t+1];const r=nO(e,o,"float32"),a=nO(n,o,"float32"),s=eO(r,a);return r.dispose(),a.dispose(),s}throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(r))}i=new Uint8Array(t)}s+=a*e}return nO(i,o,r)}function gO(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));let t=0;const n=[];e.forEach((e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));const r=new Uint8Array(t);let o=0;return n.forEach((e=>{r.set(new Uint8Array(e.buffer),o),o+=e.byteLength})),r.buffer}const vO="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function yO(e){return vO?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function bO(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}async function xO(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),function(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}(e,n,r)}function wO(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:yO(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:yO(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new oO(e.weightData).byteLength}}function kO(e){const t=[];for(const n of e)t.push(...n.weights);return t}class SO{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==SO.instance&&(SO.instance=new SO),SO.instance}static registerSaveRouter(e){SO.getInstance().saveRouters.push(e)}static registerLoadRouter(e){SO.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return SO.getHandlers(e,"save")}static getLoadHandlers(e,t){return SO.getHandlers(e,"load",t)}static getHandlers(e,t,n){const r=[];return("load"===t?SO.getInstance().loadRouters:SO.getInstance().saveRouters).forEach((t=>{const o=t(e,n);null!==o&&r.push(o)})),r}}const IO="tensorflowjs",CO="models_store",AO="model_info_store";function EO(){if(!mT().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function TO(e){const t=e.result;t.createObjectStore(CO,{keyPath:"modelPath"}),t.createObjectStore(AO,{keyPath:"modelPath"})}class NO{constructor(e){if(this.indexedDB=EO(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise(((e,n)=>{const r=this.indexedDB.open(IO,1);r.onupgradeneeded=()=>TO(r),r.onsuccess=()=>{const o=r.result;if(null==t){const t=o.transaction(CO,"readonly"),r=t.objectStore(CO).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return o.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));e(r.result.modelArtifacts)},r.onerror=e=>(o.close(),n(r.error)),t.oncomplete=()=>o.close()}else{t.weightData=oO.join(t.weightData);const r=wO(t),i=o.transaction(AO,"readwrite");let s,c,l=i.objectStore(AO);try{s=l.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(a){return n(a)}s.onsuccess=()=>{c=o.transaction(CO,"readwrite");const s=c.objectStore(CO);let u;try{u=s.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r})}catch(a){return n(a)}u.onsuccess=()=>e({modelArtifactsInfo:r}),u.onerror=e=>{l=i.objectStore(AO);const t=l.delete(this.modelPath);t.onsuccess=()=>(o.close(),n(u.error)),t.onerror=e=>(o.close(),n(u.error))}},s.onerror=e=>(o.close(),n(s.error)),i.oncomplete=()=>{null==c?o.close():c.oncomplete=()=>o.close()}}},r.onerror=e=>n(r.error)}))}}NO.URL_SCHEME="indexeddb://";const RO=e=>{return mT().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(NO.URL_SCHEME)?(t=e.slice(NO.URL_SCHEME.length),new NO(t)):null;var t};SO.registerSaveRouter(RO),SO.registerLoadRouter(RO);class _O{constructor(){this.indexedDB=EO()}async listModels(){return new Promise(((e,t)=>{const n=this.indexedDB.open(IO,1);n.onupgradeneeded=()=>TO(n),n.onsuccess=()=>{const r=n.result,o=r.transaction(AO,"readonly"),a=o.objectStore(AO).getAll();a.onsuccess=()=>{const t={};for(const e of a.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},a.onerror=e=>(r.close(),t(a.error)),o.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)}))}async removeModel(e){var t;return e=(t=e).startsWith(NO.URL_SCHEME)?t.slice(NO.URL_SCHEME.length):t,new Promise(((t,n)=>{const r=this.indexedDB.open(IO,1);r.onupgradeneeded=()=>TO(r),r.onsuccess=()=>{const o=r.result,a=o.transaction(AO,"readwrite"),i=a.objectStore(AO),s=i.get(e);let c;s.onsuccess=()=>{if(null==s.result)return o.close(),n(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));{const r=i.delete(e),a=()=>{c=o.transaction(CO,"readwrite");const r=c.objectStore(CO).delete(e);r.onsuccess=()=>t(s.result.modelArtifactsInfo),r.onerror=e=>n(s.error)};r.onsuccess=a,r.onerror=e=>(a(),o.close(),n(s.error))}},s.onerror=e=>(o.close(),n(s.error)),a.oncomplete=()=>{null==c?o.close():c.oncomplete=()=>o.close()}},r.onerror=e=>n(r.error)}))}}const DO="/",OO="tensorflowjs_models",FO="info",MO="model_topology",PO="weight_specs",LO="weight_data",zO="model_metadata";function BO(e){return{info:[OO,e,FO].join(DO),topology:[OO,e,MO].join(DO),weightSpecs:[OO,e,PO].join(DO),weightData:[OO,e,LO].join(DO),modelMetadata:[OO,e,zO].join(DO)}}function UO(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function WO(e){const t=e.split(DO);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(DO)}class jO{constructor(e){if(!mT().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=BO(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),o=wO(e),a=oO.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(vO)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,o=t.length;r<o;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(a));const t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:o}}catch(t){throw UO(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(o.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(o.weightSpecsBytes,", ")+"weightDataBytes=".concat(o.weightDataBytes,"."))}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");t.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");t.weightSpecs=r;const o=this.LS.getItem(this.keys.modelMetadata);if(null!=o){const e=JSON.parse(o);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(null==a)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return t.weightData=function(e){if(vO){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}(a),t}}jO.URL_SCHEME="localstorage://";const VO=e=>{return mT().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(jO.URL_SCHEME)?(t=e.slice(jO.URL_SCHEME.length),new jO(t)):null;var t};SO.registerSaveRouter(VO),SO.registerLoadRouter(VO);class GO{constructor(){ME(mT().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),ME("undefined"===typeof window||"undefined"!==typeof window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const e={},t=OO+DO,n=DO+FO;for(let r=0;r<this.LS.length;++r){const o=this.LS.key(r);if(o.startsWith(t)&&o.endsWith(n)){e[WO(o)]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){var t;const n=BO(e=(t=e).startsWith(jO.URL_SCHEME)?t.slice(jO.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(e,"'"));const r=JSON.parse(this.LS.getItem(n.info));return UO(n),r}}const HO="://";class qO{constructor(){this.managers={}}static getInstance(){return null==qO.instance&&(qO.instance=new qO),qO.instance}static registerManager(e,t){ME(null!=e,(()=>"scheme must not be undefined or null.")),e.endsWith(HO)&&(e=e.slice(0,e.indexOf(HO))),ME(e.length>0,(()=>"scheme must not be an empty string."));const n=qO.getInstance();ME(null==n.managers[e],(()=>"A model store manager is already registered for scheme '".concat(e,"'."))),n.managers[e]=t}static getManager(e){const t=qO.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}static getSchemes(){return Object.keys(qO.getInstance().managers)}}class KO{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!==typeof window&&mT().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(e=>{if(e.source===window&&e.data.name===this.messageName){e.stopPropagation();(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}}),!0))):setTimeout(e,t)}isTypedArray(e){return W_(e)}}if(mT().get("IS_BROWSER")){mT().setPlatform("browser",new KO);try{qO.registerManager(jO.URL_SCHEME,new GO)}catch(Dse){}try{qO.registerManager(NO.URL_SCHEME,new _O)}catch(Dse){}}const XO=()=>n(5817);let YO;class QO{constructor(){this.util=n(8590),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=mT().global.fetch?mT().global.fetch(e,t):(null==YO&&(YO=XO()),YO(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}function JO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",cT(e),new vD(e,t,n)}mT().get("IS_NODE")&&!mT().get("IS_BROWSER")&&mT().setPlatform("node",new QO);const $O=ZD({cast_:function(e,t){const n=JD(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},o={dtype:t};return jD.runKernel(VT,r,o)}});const ZO=ZD({clone_:function(e){const t={x:JD(e,"x","clone","string_or_numeric")};return jD.runKernel(MN,t)}});WD();const eF={buffer:JO,cast:$O,clone:ZO,print:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}};bD=eF;const tF=ZD({add_:function(e,t){let n=JD(e,"a","add"),r=JD(t,"b","add");[n,r]=FD(n,r);const o={a:n,b:r};return jD.runKernel(ST,o)}});const nF=ZD({floorDiv_:function(e,t){let n=JD(e,"a","floorDiv"),r=JD(t,"b","floorDiv");[n,r]=FD(n,r);const o={a:n,b:r};return jD.runKernel(NN,o)}});const rF=ZD({div_:function(e,t){let n=JD(e,"a","div"),r=JD(t,"b","div");if([n,r]=FD(n,r),"int32"===n.dtype&&"int32"===r.dtype)return nF(n,r);const o={a:n,b:r};return jD.runKernel(gN,o,{})}});const oF=ZD({mul_:function(e,t){let n=JD(e,"a","mul"),r=JD(t,"b","mul");[n,r]=FD(n,r);const o={a:n,b:r};return jD.runKernel(dR,o)}});const aF=ZD({sqrt_:function(e){const t={x:JD(e,"x","sqrt","float32")};return jD.runKernel(JR,t)}});const iF=ZD({square_:function(e){const t=JD(e,"x","square");return jD.runKernel("Square",{x:t},{})}});const sF=ZD({zerosLike_:function(e){const t={x:JD(e,"x","zerosLike")};return jD.runKernel(I_,t)}});function cF(e){return jD.customGrad(e)}function lF(e,t){if((sD(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&sD(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return tO(e,[],[],t)}const uF=new Map,dF=new Map;class hF{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class pF{constructor(){this.classNameMap={}}static getMap(){return null==pF.instance&&(pF.instance=new pF),pF.instance}static register(e){pF.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function fF(e,t,n){ME(null!=e.className,(()=>"Class being registered does not have the static className property defined.")),ME("string"===typeof e.className,(()=>"className is required to be a string, but got type "+typeof e.className)),ME(e.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);const r=t+">"+n;return pF.register(e),uF.set(r,e),dF.set(e,r),e}class mF extends hF{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:r,grads:o}=this.computeGradients(e,n);if(null!=n){const e=n.map((e=>({name:e.name,tensor:o[e.name]})));this.applyGradients(e)}else this.applyGradients(o);return cO(o),t?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return function(e,t){ME(eT(e),(()=>"The f passed in variableGrads(f) must be a function")),ME(null==t||Array.isArray(t)&&t.every((e=>e instanceof SD)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=t;if(!n){t=[];for(const e in jD.registeredVariables)t.push(jD.registeredVariables[e])}const r=n?t.filter((e=>!e.trainable)):null,o=t.length;t=t.filter((e=>e.trainable)),ME(t.length>0,(()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(o," variables is ")+"trainable."));const{value:a,grads:i}=jD.gradients(e,t,null,!0);ME(i.some((e=>null!=e)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),ME(0===a.rank,(()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(a.rank," tensor")));const s={};return t.forEach(((e,t)=>{null!=i[t]&&(s[e.name]=i[t])})),null!=r&&r.forEach((e=>s[e.name]=null)),{value:a,grads:s}}(e,t)}dispose(){null!=this.iterations_&&cO(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:lF(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(mF,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});class gF extends mF{static get className(){return"Adadelta"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=jD.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=jD.registeredVariables[t],o=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accum_grad"),variable:sO((()=>sF(r).variable(o)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(t,"/accum_var"),variable:sO((()=>sF(r).variable(o)))});const a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;const i=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;sO((()=>{const e=tF(oF(i,this.rho),oF(iF(a),1-this.rho)),t=oF(rF(aF(tF(s,this.epsilon)),aF(tF(i,this.epsilon))),a),n=tF(oF(s,this.rho),oF(iF(t),1-this.rho));i.assign(e),s.assign(n);const o=tF(oF(t,-this.learningRate),r);r.assign(o)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(cO(this.accumulatedGrads.map((e=>e.variable))),cO(this.accumulatedUpdates.map((e=>e.variable))))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){const t=(e=await this.extractIterations(e)).length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedUpdates=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}function vF(e,t,n){cT(e);const r={shape:e,value:t,dtype:n=n||ZE(t)};return jD.runKernel(AN,{},r)}class yF extends mF{static get className(){return"Adagrad"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=jD.registeredVariables[t];if(null==this.accumulatedGrads[n]){const e=!1;this.accumulatedGrads[n]={originalName:"".concat(t,"/accumulator"),variable:sO((()=>vF(r.shape,this.initialAccumulatorValue).variable(e)))}}const o=Array.isArray(e)?e[n].tensor:e[t];if(null==o)return;const a=this.accumulatedGrads[n].variable;sO((()=>{const e=tF(a,iF(o));a.assign(e);const t=tF(oF(rF(o,aF(tF(e,jD.backend.epsilon()))),-this.learningRate),r);r.assign(t)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&cO(this.accumulatedGrads.map((e=>e.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);this.accumulatedGrads=e.map((e=>({originalName:e.name,variable:e.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}const bF=ZD({pow_:function(e,t){let n=JD(e,"base","pow"),r=JD(t,"exp","pow");[n,r]=FD(n,r);const o={a:n,b:r};return jD.runKernel(wR,o)}});const xF=ZD({sub_:function(e,t){let n=JD(e,"a","sub"),r=JD(t,"b","sub");[n,r]=FD(n,r);const o={a:n,b:r};return jD.runKernel(f_,o)}});class wF extends mF{static get className(){return"Adam"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],sO((()=>{this.accBeta1=lF(t).variable(),this.accBeta2=lF(n).variable()})),null==r&&(this.epsilon=jD.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);sO((()=>{const n=xF(1,this.accBeta1),r=xF(1,this.accBeta2);t.forEach(((t,o)=>{const a=jD.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[o]&&(this.accumulatedFirstMoment[o]={originalName:"".concat(t,"/m"),variable:sO((()=>sF(a).variable(i)))}),null==this.accumulatedSecondMoment[o]&&(this.accumulatedSecondMoment[o]={originalName:"".concat(t,"/v"),variable:sO((()=>sF(a).variable(i)))});const s=Array.isArray(e)?e[o].tensor:e[t];if(null==s)return;const c=this.accumulatedFirstMoment[o].variable,l=this.accumulatedSecondMoment[o].variable,u=tF(oF(c,this.beta1),oF(s,1-this.beta1)),d=tF(oF(l,this.beta2),oF(iF(s),1-this.beta2)),h=rF(u,n),p=rF(d,r);c.assign(u),l.assign(d);const f=tF(oF(rF(h,tF(aF(p),this.epsilon)),-this.learningRate),a);a.assign(f)})),this.accBeta1.assign(oF(this.accBeta1,this.beta1)),this.accBeta2.assign(oF(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&cO(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedSecondMoment&&cO(this.accumulatedSecondMoment.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),sO((()=>{this.accBeta1.assign(bF(this.beta1,this.iterations_+1)),this.accBeta2.assign(bF(this.beta2,this.iterations_+1))}));const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedSecondMoment=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}const kF=ZD({abs_:function(e){const t=JD(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return jD.runKernel(KT,e)}{const e={x:t};return jD.runKernel(xT,e)}}});function SF(e,t){const n=e.length,r=[];for(let o=0;o<n;o++){const a=n-1-o,i=e[a]||1;(t[t.length-1-o]||1)>1&&1===i&&r.unshift(a)}return r}function IF(e,t){const n=[];for(let r=0;r<t.length;r++){const o=e[e.length-r-1],a=t.length-r-1,i=t[a];(null==o||1===o&&i>1)&&n.unshift(a)}return n}function CF(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let o=0;o<n;o++){let a=e[e.length-o-1];null==a&&(a=1);let i=t[t.length-o-1];if(null==i&&(i=1),1===a)r[n-o-1]=i;else if(1===i)r[n-o-1]=a;else{if(a!==i){const n="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(n)}r[n-o-1]=a}}return r}const AF=ZD({maximum_:function(e,t){let n=JD(e,"a","maximum"),r=JD(t,"b","maximum");[n,r]=FD(n,r),"bool"===n.dtype&&(n=$O(n,"int32"),r=$O(r,"int32")),CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(ZN,o)}});class EF extends mF{static get className(){return"Adamax"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],sO((()=>{this.iteration=lF(0).variable(),this.accBeta1=lF(t).variable()})),null==r&&(this.epsilon=jD.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);sO((()=>{const n=xF(1,this.accBeta1),r=rF(-this.learningRate,tF(oF(this.iteration,this.decay),1));t.forEach(((t,o)=>{const a=jD.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[o]&&(this.accumulatedFirstMoment[o]={originalName:"".concat(t,"/m"),variable:sF(a).variable(i)}),null==this.accumulatedWeightedInfNorm[o]&&(this.accumulatedWeightedInfNorm[o]={originalName:"".concat(t,"/v"),variable:sF(a).variable(i)});const s=Array.isArray(e)?e[o].tensor:e[t];if(null==s)return;const c=this.accumulatedFirstMoment[o].variable,l=this.accumulatedWeightedInfNorm[o].variable,u=tF(oF(c,this.beta1),oF(s,1-this.beta1)),d=oF(l,this.beta2),h=kF(s),p=AF(d,h);c.assign(u),l.assign(p);const f=tF(oF(rF(r,n),rF(u,tF(p,this.epsilon))),a);a.assign(f)})),this.iteration.assign(tF(this.iteration,1)),this.accBeta1.assign(oF(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&cO(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedWeightedInfNorm&&cO(this.accumulatedWeightedInfNorm.map((e=>e.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}class TF extends mF{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);t.forEach(((t,n)=>{const r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;const o=jD.registeredVariables[t];sO((()=>{const e=tF(oF(this.c,r),o);o.assign(e)}))})),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=lO(lF(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}class NF extends TF{static get className(){return"Momentum"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=lF(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=jD.registeredVariables[t];if(null==this.accumulations[n]){const e=!1;this.accumulations[n]={originalName:"".concat(t,"/momentum"),variable:sO((()=>sF(r).variable(e)))}}const o=this.accumulations[n].variable,a=Array.isArray(e)?e[n].tensor:e[t];null!=a&&sO((()=>{let e;const t=tF(oF(this.m,o),a);e=this.useNesterov?tF(oF(this.c,tF(a,oF(t,this.m))),r):tF(oF(this.c,t),r),o.assign(t),r.assign(e)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&cO(this.accumulations.map((e=>e.variable)))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);this.accumulations=e.map((e=>({originalName:e.name,variable:e.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}class RF extends mF{static get className(){return"RMSProp"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,null==r&&(this.epsilon=jD.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=jD.registeredVariables[t],o=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(t,"/rms"),variable:sO((()=>sF(r).variable(o)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(t,"/momentum"),variable:sO((()=>sF(r).variable(o)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(t,"/mg"),variable:sO((()=>sF(r).variable(o)))});const a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;const i=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;sO((()=>{const e=tF(oF(i,this.decay),oF(iF(a),1-this.decay));if(this.centered){const t=this.accumulatedMeanGrads[n].variable,o=tF(oF(t,this.decay),oF(a,1-this.decay)),c=rF(oF(a,this.learningRate),aF(xF(e,tF(iF(o),this.epsilon)))),l=tF(oF(s,this.momentum),c);i.assign(e),t.assign(o),s.assign(l);const u=xF(r,l);r.assign(u)}else{const e=tF(oF(i,this.decay),oF(iF(a),1-this.decay)),t=tF(oF(s,this.momentum),rF(oF(a,this.learningRate),aF(tF(e,this.epsilon))));i.assign(e),s.assign(t);const n=xF(r,t);r.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&cO(this.accumulatedMeanSquares.map((e=>e.variable))),null!=this.accumulatedMeanGrads&&this.centered&&cO(this.accumulatedMeanGrads.map((e=>e.variable))),null!=this.accumulatedMoments&&cO(this.accumulatedMoments.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedMoments=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}const _F=[gF,yF,wF,EF,NF,RF,TF];function DF(e){return new Promise((e=>setTimeout(e))).then(e)}class OF{constructor(e){if(!mT().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(OF.URL_SCHEME)&&(e=e.slice(OF.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=oO.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const t=bO(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),o=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=r,await DF((()=>o.dispatchEvent(new MouseEvent("click")))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await DF((()=>e.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:wO(e)}}}}OF.URL_SCHEME="downloads://";function FF(e,t,n,r){!function(e){ME(null!=e&&Array.isArray(e)&&e.length>0,(()=>"promises must be a none empty array"))}(e),function(e,t){ME(e>=0&&e<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e))),ME(t>=0&&t<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t))),ME(t>=e,(()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)))}(n=null==n?0:n,r=null==r?1:r);let o=0;return Promise.all(e.map((a=>(a.then((a=>{const i=n+ ++o/e.length*(r-n);return t(i),a})),a))))}async function MF(e,t){null==t&&(t={});const n=null==t.fetchFunc?mT().platform.fetch:t.fetchFunc,r=e.map((e=>n(e,t.requestInit,{isBinary:!0}))),o=(null==t.onProgress?await Promise.all(r):await FF(r,t.onProgress,0,.5)).map((e=>e.arrayBuffer()));return null==t.onProgress?await Promise.all(o):await FF(o,t.onProgress,.5,1)}SO.registerSaveRouter((e=>mT().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(OF.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new OF(e)}(e.slice(OF.URL_SCHEME.length)):null));class PF{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(ME("function"===typeof t.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=t.fetchFunc):this.fetch=mT().platform.fetch,ME(null!=e&&e.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(e)&&ME(2===e.length,(()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,")."))),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=bO(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){const n=oO.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:wO(e),responses:[r]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."))}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let t;try{t=await e.json()}catch(_se){let t="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=t.modelTopology,r=t.weightsManifest;if(null==n&&null==r)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return xO(await this.loadModelJSON(),(e=>this.loadWeights(e)))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=kO(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>function(e,t){var n;const r=null==t.fetchFunc?mT().platform.fetch:t.fetchFunc;let o,a=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var i;a<e.length;){if(!o){const n=(await r(e[a],t.requestInit,{isBinary:!0})).body;o=n.getReader()}const{done:s,value:c}=await o.read();if(!s)return void n.enqueue(c);a++,o=void 0,null===(i=t.onProgress)||void 0===i||i.call(t,a/e.length)}n.close()}})}(t,this.loadOptions)})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),o=n>t?e.substring(n):"";return[r+"/",o]}(t),o=this.weightPathPrefix||n,a=[],i=[];for(const s of e)for(const e of s.paths)null!=this.weightUrlConverter?i.push(this.weightUrlConverter(e)):a.push(o+e+r);return this.weightUrlConverter&&a.push(...await Promise.all(i)),a}async loadWeights(e){const t=await this.getWeightUrls(e);return[kO(e),await MF(t,this.loadOptions)]}}function LF(e){return null!=e.match(PF.URL_SCHEME_REGEX)}PF.URL_SCHEME_REGEX=/^https?:\/\//;const zF=(e,t)=>{if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every((e=>LF(e))):LF(e),n)return BF(e,t)}return null};function BF(e,t){return new PF(e,t)}SO.registerSaveRouter(zF),SO.registerLoadRouter(zF);let UF;function WF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,o=!1,a=!1,i=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)o=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)a=!0;else if(null!=e.getContext)i=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));s=!0}if(null!=M_(A_,jD.backendName)){const n={pixels:e},r={numChannels:t};return jD.runKernel(A_,n,r)}const[c,l]=o?[e.videoWidth,e.videoHeight]:[e.width,e.height];let u,d;if(i)u=e.getContext("2d").getImageData(0,0,c,l).data;else if(r||n)u=e.data;else if(a||o||s){if(null==UF)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");UF=new OffscreenCanvas(1,1).getContext("2d")}else UF=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});UF.canvas.width=c,UF.canvas.height=l,UF.drawImage(e,0,0,c,l),u=UF.getImageData(0,0,c,l).data}if(4===t)d=new Int32Array(u);else{const e=c*l;d=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)d[n*t+e]=u[4*n+e]}return function(e,t,n){if(LE(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const r=XD(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return tO(e,t,r,n)}(d,[l,c,t],"int32")}const jF=ZD({fromPixels_:WF}),VF=-2,GF=-1;function HF(e,t,n){const r=e.shape.length;ME(r===t.length,(()=>"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,")."))),ME(r===n.length,(()=>"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")));for(let o=0;o<r;++o)ME(t[o]+n[o]<=e.shape[o],(()=>"Error in slice".concat(r,"D: begin[").concat(o,"] + size[").concat(o,"] ")+"(".concat(t[o]+n[o],") would overflow input.shape[").concat(o,"] (").concat(e.shape[o],")")))}function qF(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function KF(e,t,n){const r=[];for(let o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function XF(e,t,n,r){const o=[...e];for(let a=o.length;a<r.length;a++)o.push(1);for(let a=0;a<n;a++)0===a?o[t]=1:(o.splice(t,0,1),o.pop());return o}function YF(e,t,n){return n<=e?n:n-(t-1)}function QF(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function JF(e,t,n,r,o,a,i,s,c){const l=e.length;let u=new Array(l),d=new Array(l),h=new Array(l);if(t.length&&n>0){const c=t[0],l=n+1;u=$F(i,c,l,r,e),d=ZF(s,c,l,o,e),h=XF(a,c,l,e)}else for(let p=0;p<l;p++)u[p]=tM(i,r,a,e,p,c),d[p]=nM(s,o,a,e,p,c),h[p]=eM(a,p,c);return{begin:u,end:d,strides:h}}function $F(e,t,n,r,o){const a=[...o],i=QF(n,t);for(let s=0;s<a.length;s++)if(i.indexOf(s)>-1)a[s]=0;else{const o=YF(t,n,s);let i=r[o];e&1<<o&&(i=0),a[s]=i}return a}function ZF(e,t,n,r,o){const a=[...o],i=QF(n,t);for(let s=0;s<a.length;s++)if(i.indexOf(s)>-1)a[s]=Number.MAX_SAFE_INTEGER;else{const o=YF(t,n,s);let i=r[o];e&1<<o&&(i=Number.MAX_SAFE_INTEGER),a[s]=i}for(let s=0;s<a.length;s++){const e=o[s];a[s]<0&&(a[s]+=e),a[s]=DE(0,a[s],o[s])}return a}function eM(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function tM(e,t,n,r,o,a){let i=t[o];const s=n[o]||1;(e&1<<o||a&1<<o||null==i)&&(i=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const c=r[o];return i<0&&(i+=c),i=DE(0,i,c-1),i}function nM(e,t,n,r,o,a){let i=t[o];const s=n[o]||1;(e&1<<o||a&1<<o||null==i)&&(i=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const c=r[o];return i<0&&(i+=c),i=s>0?DE(0,i,c):DE(-1,i,c-1),i}function rM(e,t,n){let r=n.length;for(let o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(let o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function oM(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function aM(e,t,n){let r;const o=e.shape.length;let a;return r="number"===typeof t?[t,...new Array(o-1).fill(0)]:t.length<o?t.concat(new Array(o-t.length).fill(0)):t.slice(),r.forEach((e=>{ME(-1!==e,(()=>"slice() does not support negative begin indexing."))})),a=null==n?new Array(o).fill(-1):"number"===typeof n?[n,...new Array(o-1).fill(-1)]:n.length<o?n.concat(new Array(o-n.length).fill(-1)):n,a=a.map(((t,n)=>t>=0?t:(ME(-1===t,(()=>"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,"."))),e.shape[n]-r[n]))),[r,a]}function iM(e,t,n,r,o,a,i,s,c){let l;if(null==r?(l=new Array(t.length),l.fill(1)):l=r,null!=i&&0!==(i&i-1))throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:l.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:l.slice(),beginMask:o,endMask:a,ellipsisMask:i,newAxisMask:s,shrinkAxisMask:c};for(let y=0;y<d.dims;y++)u&&0!==(1<<y&s)&&d.numAddAxisAfterEllipsis++,1<<y&i&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const o=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<o;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(VF),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(GF),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(d,h);let p=!0,f=!0,m=!0;const g=[],v=[];for(let y=0;y<e.length;++y){if(0===h.strides[y])throw Error("strides[".concat(y,"] must be non-zero"));const t=!!(h.shrinkAxisMask&1<<y),n=e[y];if(-1===n){g.push(t?1:-1);continue}const r=[h.beginMask&1<<y,h.endMask&1<<y],o=[h.strides[y]>0?0:-1,h.strides[y]>0?n:n-1];if(t&&h.strides[y]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===h.strides[y];const a=!!(h.beginMask&1<<y&&h.endMask&1<<y);if(h.beginValid&&h.endValid){if(t){const e=h.begin[y]<0?n+h.begin[y]:h.begin[y];if(h.begin[y]=e,h.end[y]=h.begin[y]+1,e<0||e>=n)throw Error("slice index ".concat(h.begin[y]," of dimension ").concat(y," out of bounds."))}else h.begin[y]=sM(h.begin[y],0,h.strides[y],n,r,o),h.end[y]=sM(h.end[y],1,h.strides[y],n,r,o);const e=1===h.strides[y]&&0===h.begin[y]&&h.end[y]===n;p=p&&e,f=f&&(0===y&&1===h.strides[y]||e)}else p=p&&1===h.strides[y]&&a,f=f&&(0===y&&1===h.strides[y]||a);let i,s=!1;if(h.beginValid&&h.endValid?(i=h.end[y]-h.begin[y],s=!0):t?(i=1,s=!0):a&&n>=0&&(i=h.strides[y]<0?-n:n,s=!0),s){let e;e=0===i||i<0!==h.strides[y]<0?0:Math.trunc(i/h.strides[y])+(i%h.strides[y]!==0?1:0),g.push(e)}else g.push(-1)}for(let y=0;y<h.finalShapeGatherIndices.length;++y){const e=h.finalShapeGatherIndices[y];e>=0?v.push(g[e]):e===VF&&v.push(1)}return{finalShapeSparse:v.filter(((e,t)=>h.finalShapeGatherIndices[t]!==VF)),finalShape:v,isIdentity:p,sliceDim0:f,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function sM(e,t,n,r,o,a){if(o[t])return n>0?a[t]:a[t+1&1];{const t=e<0?r+e:e;return t<a[0]?a[0]:t>a[1]?a[1]:t}}const cM=ZD({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:JD(e,"x","all","bool")},o={axis:t,keepDims:n};return jD.runKernel(CT,r,o)}});const lM=ZD({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:JD(e,"x","any","bool")},o={axis:t,keepDims:n};return jD.runKernel(AT,r,o)}});const uM=ZD({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:JD(e,"x","argMax")},r={axis:t};return jD.runKernel(ET,n,r)}});function dM(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5?arguments[5]:void 0;return fM(e,[...t,e[3]],n,a,r,null,null,IM(o))}function hM(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[s,c]=vM(t);let l;if("channelsLast"===i)l=[s,c,e[3],e[3]];else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat ".concat(i));l=[s,c,e[1],e[1]]}return fM(e,l,n,r,o,a,!1,i)}function pM(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[s,c,l]=yM(t);let u,d;if("NDHWC"===i)d="channelsLast",u=[s,c,l,e[4],e[4]];else{if("NCDHW"!==i)throw new Error("Unknown dataFormat ".concat(i));d="channelsFirst",u=[s,c,l,e[1],e[1]]}return mM(e,u,n,r,o,!1,d,a)}function fM(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[c,l,u,d]=[-1,-1,-1,-1];if("channelsLast"===s)[c,l,u,d]=e;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));[c,d,l,u]=e}const[h,p,,f]=t,[m,g]=vM(n),[v,y]=vM(r),b=bM(h,v),x=bM(p,y),{padInfo:w,outHeight:k,outWidth:S}=function(e,t,n,r,o,a,i,s,c){let l,u,d;if("number"===typeof e){l={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const o=function(e,t,n,r,o){null==r&&(r=gM(e,t,n));const a=e[0],i=e[1],s=xM((a-t+2*r)/n+1,o),c=xM((i-t+2*r)/n+1,o);return[s,c]}([t,n],a,r,e,s);u=o[0],d=o[1]}else if("same"===e){u=Math.ceil(t/r),d=Math.ceil(n/o);const e=Math.max(0,(u-1)*r+a-t),s=Math.max(0,(d-1)*o+i-n),c=Math.floor(e/2),h=e-c,p=Math.floor(s/2);l={top:c,bottom:h,left:p,right:s-p,type:"SAME"}}else if("valid"===e)l={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-a+1)/r),d=Math.ceil((n-i+1)/o);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));{const h="channelsLast"===c?e[1][0]:e[2][0],p="channelsLast"===c?e[1][1]:e[2][1],f="channelsLast"===c?e[2][0]:e[3][0],m="channelsLast"===c?e[2][1]:e[3][1];l={top:h,bottom:p,left:f,right:m,type:0===h&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},u=xM((t-a+h+p)/r+1,s),d=xM((n-i+f+m)/o+1,s)}}return{padInfo:l,outHeight:u,outWidth:d}}(o,l,u,m,g,b,x,a,s),I=i?f*d:f;let C;return"channelsFirst"===s?C=[c,I,k,S]:"channelsLast"===s&&(C=[c,k,S,I]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:u,inChannels:d,outHeight:k,outWidth:S,outChannels:I,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:p,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:v,dilationWidth:y,inShape:e,outShape:C,filterShape:t}}function mM(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,[c,l,u,d,h]=[-1,-1,-1,-1,-1];if("channelsLast"===i)[c,l,u,d,h]=e;else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat ".concat(i));[c,h,l,u,d]=e}const[p,f,m,,g]=t,[v,y,b]=yM(n),[x,w,k]=yM(r),S=bM(p,x),I=bM(f,w),C=bM(m,k),{padInfo:A,outDepth:E,outHeight:T,outWidth:N}=function(e,t,n,r,o,a,i,s,c,l,u){let d,h,p,f;"valid"===e&&(e=0);if("number"===typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const m=function(e,t,n,r,o,a){null==o&&(o=gM(e,t[0],r[0]));const i=[0,0,0,n];for(let s=0;s<3;s++)e[s]+2*o>=t[s]&&(i[s]=xM((e[s]-t[s]+2*o)/r[s]+1,a));return i}([t,n,r,1],[s,c,l],1,[o,a,i],e,u);h=m[0],p=m[1],f=m[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));{h=Math.ceil(t/o),p=Math.ceil(n/a),f=Math.ceil(r/i);const e=(h-1)*o+s-t,u=(p-1)*a+c-n,m=(f-1)*i+l-r,g=Math.floor(e/2),v=e-g,y=Math.floor(u/2),b=u-y,x=Math.floor(m/2);d={top:y,bottom:b,left:x,right:m-x,front:g,back:v,type:"SAME"}}}return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}(o,l,u,d,v,y,b,S,I,C,s),R=a?g*h:g;let _;return"channelsFirst"===i?_=[c,R,E,T,N]:"channelsLast"===i&&(_=[c,E,T,N,R]),{batchSize:c,dataFormat:i,inDepth:l,inHeight:u,inWidth:d,inChannels:h,outDepth:E,outHeight:T,outWidth:N,outChannels:R,padInfo:A,strideDepth:v,strideHeight:y,strideWidth:b,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:I,effectiveFilterWidth:C,dilationDepth:x,dilationHeight:w,dilationWidth:k,inShape:e,outShape:_,filterShape:t}}function gM(e,t,n){const r=bM(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function vM(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function yM(e){return"number"===typeof e?[e,e,e]:e}function bM(e,t){return t<=1?e:e+(e-1)*(t-1)}function xM(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function wM(e){const[t,n,r]=vM(e);return 1===t&&1===n&&1===r}function kM(e,t){return wM(e)||wM(t)}function SM(e){return vM(e).every((e=>e>0))}function IM(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function CM(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)ME(UE(t),(()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach((t=>{t.forEach((t=>{ME(UE(t),(()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")))}))}))}}}const AM=ZD({reshape_:function(e,t){const n={x:JD(e,"x","reshape","string_or_numeric")},r={shape:t};return jD.runKernel(_R,n,r)}});const EM=ZD({avgPool_:function(e,t,n,r,o){const a=JD(e,"x","avgPool","float32");ME(kM(n,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")));let i=a,s=!1;3===a.rank&&(s=!0,i=AM(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ME(4===i.rank,(()=>"Error in avgPool: x must be rank 4 but got rank ".concat(i.rank,"."))),CM("avgPool",r,o);const c={x:i},l={filterSize:t,strides:n,pad:r,dimRoundingMode:o};let u=jD.runKernel(FT,c,l);return u=$O(u,a.dtype),s?AM(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const TM=ZD({avgPool3d_:function(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const i=JD(e,"x","avgPool3d","float32");let s=i,c=!1;4===i.rank&&(c=!0,s=AM(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),ME(5===s.rank,(()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),ME("NDHWC"===a,(()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a))),ME("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'"))),CM("avgPool3d",r,o);const l={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:o,dataFormat:a};let d=jD.runKernel(PT,l,u);return d=$O(d,s.dtype),c?AM(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const NM=ZD({batchNorm_:function(e,t,n,r,o,a){null==a&&(a=.001);const i=JD(e,"x","batchNorm"),s=JD(t,"mean","batchNorm"),c=JD(n,"variance","batchNorm");let l,u;null!=o&&(l=JD(o,"scale","batchNorm")),null!=r&&(u=JD(r,"offset","batchNorm")),ME(s.rank===c.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),ME(null==u||s.rank===u.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),ME(null==l||s.rank===l.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const d=function(e){let t;return t=0===e.rank||1===e.rank?AM(e,[1,1,1,e.size]):2===e.rank?AM(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?AM(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(i),h={x:d,scale:l,offset:u,mean:s,variance:c},p={varianceEpsilon:a},f=jD.runKernel(RN,h,p);return AM(f,i.shape)}});const RM=ZD({batchNorm2d_:function(e,t,n,r,o,a){const i=JD(e,"x","batchNorm"),s=JD(t,"mean","batchNorm"),c=JD(n,"variance","batchNorm");let l,u;return null!=o&&(l=JD(o,"scale","batchNorm")),null!=r&&(u=JD(r,"offset","batchNorm")),ME(2===i.rank,(()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(i.rank,"."))),ME(2===s.rank||1===s.rank,(()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,"."))),ME(2===c.rank||1===c.rank,(()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=l&&ME(2===l.rank||1===l.rank,(()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,"."))),null!=u&&ME(2===u.rank||1===u.rank,(()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,"."))),NM(i,s,c,u,l,a)}});const _M=ZD({batchNorm3d_:function(e,t,n,r,o,a){const i=JD(e,"x","batchNorm"),s=JD(t,"mean","batchNorm"),c=JD(n,"variance","batchNorm");let l,u;return null!=o&&(l=JD(o,"scale","batchNorm")),null!=r&&(u=JD(r,"offset","batchNorm")),ME(3===i.rank,(()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(i.rank,"."))),ME(3===s.rank||1===s.rank,(()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,"."))),ME(3===c.rank||1===c.rank,(()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=l&&ME(3===l.rank||1===l.rank,(()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,"."))),null!=u&&ME(3===u.rank||1===u.rank,(()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,"."))),NM(i,s,c,u,l,a)}});const DM=ZD({batchNorm4d_:function(e,t,n,r,o,a){const i=JD(e,"x","batchNorm"),s=JD(t,"mean","batchNorm"),c=JD(n,"variance","batchNorm");let l,u;return null!=o&&(l=JD(o,"scale","batchNorm")),null!=r&&(u=JD(r,"offset","batchNorm")),ME(4===i.rank,(()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(i.rank,"."))),ME(4===s.rank||1===s.rank,(()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,"."))),ME(4===c.rank||1===c.rank,(()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=l&&ME(4===l.rank||1===l.rank,(()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,"."))),null!=u&&ME(4===u.rank||1===u.rank,(()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,"."))),NM(i,s,c,u,l,a)}});const OM=ZD({broadcastTo_:function(e,t){let n=JD(e,"broadcastTo","x");const r=n.shape;if(cT(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=AM(n,e)}const o=n.shape,a=Array.from(t);for(let c=t.length-1;c>=0;c--)if(o[c]===t[c])a[c]=1;else if(1!==n.shape[c])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));if(0===a.map(((e,t)=>e>1?t:-1)).filter((e=>e>=0)).length)return ZO(n);const i={x:n},s={reps:a};return jD.runKernel(v_,i,s)}});const FM=ZD({clipByValue_:function(e,t,n){const r=JD(e,"x","clipByValue");if(ME(t<=n,(()=>"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,")."))),t===n)return vF(r.shape,t,r.dtype);const o={x:r},a={clipValueMin:t,clipValueMax:n};return jD.runKernel(HT,o,a)}});const MM=ZD({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ME(e.length>=1,(()=>"Pass at least one tensor to concat"));const n=$D(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((e=>{if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return ZO(n[0]);const r=n,o={axis:t};return jD.runKernel(XT,r,o)}});const PM=ZD({concat1d_:function(e){return MM(e,0)}});const LM=ZD({concat2d_:function(e,t){return MM(e,t)}});const zM=ZD({concat3d_:function(e,t){return MM(e,t)}});const BM=ZD({concat4d_:function(e,t){return MM(e,t)}});const UM=ZD({conv2d_:function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0;const s=JD(e,"x","conv2d","float32"),c=JD(t,"filter","conv2d","float32");let l=s,u=!1;3===s.rank&&(u=!0,l=AM(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ME(4===l.rank,(()=>"Error in conv2d: input must be rank 4, but got rank ".concat(l.rank,"."))),ME(4===c.rank,(()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(c.rank,"."))),CM("conv2d",r,i);const d="NHWC"===o?l.shape[3]:l.shape[1];ME(d===c.shape[2],(()=>"Error in conv2d: depth of input (".concat(d,") must match ")+"input depth for filter ".concat(c.shape[2],"."))),ME(kM(n,a),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'"))),ME(SM(a),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),ME(SM(n),(()=>"Error in conv2D: Strides should be larger than 0."));const h={x:l,filter:c},p={strides:n,pad:r,dataFormat:o,dilations:a,dimRoundingMode:i},f=jD.runKernel(YT,h,p);return u?AM(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const WM=ZD({conv1d_:function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6?arguments[6]:void 0;const s=JD(e,"x","conv1d"),c=JD(t,"filter","conv1d");let l=s,u=!1;2===s.rank&&(u=!0,l=AM(s,[1,s.shape[0],s.shape[1]])),ME(3===l.rank,(()=>"Error in conv1d: input must be rank 3, but got rank ".concat(l.rank,"."))),ME(3===c.rank,(()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(c.rank,"."))),CM("conv1d",r,i),ME(l.shape[2]===c.shape[1],(()=>"Error in conv1d: depth of input (".concat(l.shape[2],") must match ")+"input depth for filter ".concat(c.shape[1],"."))),ME(kM(n,a),(()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(a,"'"))),ME(SM(a),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),ME(SM(n),(()=>"Error in conv1D: Stride should be larger than 0.")),ME("NWC"===o,(()=>"Error in conv1d: got dataFormat of ".concat(o," but only NWC is currently supported.")));const d=AM(c,[1,c.shape[0],c.shape[1],c.shape[2]]),h=AM(l,[l.shape[0],1,l.shape[1],l.shape[2]]),p=UM(h,d,[1,n],r,"NHWC",[1,a],i);return AM(p,u?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});const jM=ZD({conv2DBackpropInput_:function(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0;ME(e.length===t.rank,(()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")));let s=e,c=t,l=!1;3===t.rank&&(l=!0,c=AM(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),ME(4===s.length,(()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,"."))),ME(4===c.rank,(()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(c.rank))),ME(4===n.rank,(()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)));const u="NHWC"===a?s[3]:s[1],d="NHWC"===a?c.shape[3]:c.shape[1];ME(u===n.shape[2],(()=>"Error in conv2dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[2],"."))),ME(d===n.shape[3],(()=>"Error in conv2dDerInput: depth of output (".concat(d,") must ")+"match output depth for filter ".concat(n.shape[3],"."))),CM("conv2dDerInput",o,i);const h={dy:c,filter:n},p={strides:r,pad:o,dataFormat:a,dimRoundingMode:i,inputShape:s},f=jD.runKernel(JT,h,p);return l?AM(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const VM=ZD({conv2dTranspose_:function(e,t,n,r,o,a){const i=JD(e,"x","conv2dTranspose"),s=JD(t,"filter","conv2dTranspose");return jM(n,i,s,r,o,"NHWC",a)}});const GM=ZD({conv3d_:function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const i=JD(e,"x","conv3d"),s=JD(t,"filter","conv3d");let c=i,l=!1;4===i.rank&&(l=!0,c=AM(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),ME(5===c.rank,(()=>"Error in conv3d: input must be rank 5, but got rank ".concat(c.rank,"."))),ME(5===s.rank,(()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,"."))),ME(c.shape[4]===s.shape[3],(()=>"Error in conv3d: depth of input (".concat(c.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],"."))),ME(kM(n,a),(()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'"))),ME("NDHWC"===o,(()=>"Error in conv3d: got dataFormat of ".concat(o," but only NDHWC is currently supported."))),ME(SM(a),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),ME(SM(n),(()=>"Error in conv3D: Strides should be larger than 0."));const u={x:c,filter:s},d={strides:n,pad:r,dataFormat:o,dilations:a},h=jD.runKernel($T,u,d);return l?AM(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const HM=ZD({conv3DBackpropInput_:function(e,t,n,r,o){ME(e.length===t.rank,(()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")));let a=e,i=t,s=!1;4===t.rank&&(s=!0,i=AM(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,e[0],e[1],e[2],e[3]]);const c=a[4],l=i.shape[4];ME(5===a.length,(()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(a.length,"."))),ME(5===i.rank,(()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(i.rank))),ME(5===n.rank,(()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank))),ME(c===n.shape[3],(()=>"Error in conv3dDerInput: depth of input (".concat(c,") must ")+"match input depth for filter ".concat(n.shape[3],"."))),ME(l===n.shape[4],(()=>"Error in conv3dDerInput: depth of output (".concat(l,") must ")+"match output depth for filter ".concat(n.shape[4],".")));const u={dy:i,filter:n},d={pad:o,strides:r,inputShape:a},h=jD.runKernel(eN,u,d);return s?AM(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const qM=ZD({conv3dTranspose_:function(e,t,n,r,o){const a=JD(e,"x","conv3dTranspose"),i=JD(t,"filter","conv3dTranspose");return HM(n,a,i,r,o)}});const KM=ZD({denseBincount_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=JD(e,"x","denseBincount"),a=JD(t,"weights","denseBincount");ME("int32"===o.dtype,(()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(o.dtype))),ME(o.rank<=2,(()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(o.rank,"."))),ME(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),ME(a.size===o.size||0===a.size,(()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(o.shape,", weights shape: ")+"".concat(a.shape,".")));const i={x:o,weights:a},s={size:n,binaryOutput:r};return jD.runKernel(iN,i,s)}});const XM=ZD({depthwiseConv2d_:function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0;const s=JD(e,"x","depthwiseConv2d","float32"),c=JD(t,"filter","depthwiseConv2d","float32");let l=s,u=!1;3===s.rank&&(u=!0,l=AM(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ME(4===l.rank,(()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,"."))),ME(4===c.rank,(()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(c.rank,".")));const d="NHWC"===o?l.shape[3]:l.shape[1];ME(d===c.shape[2],(()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(d,") must match the inChannels dimension in ")+"filter ".concat(c.shape[2],"."))),CM("depthwiseConv2d",r,i);const h={x:l,filter:c},p={strides:n,pad:r,dataFormat:o,dilations:a,dimRoundingMode:i},f=jD.runKernel(cN,h,p);return u?AM(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const YM=ZD({elu_:function(e){const t={x:JD(e,"x","elu","float32")};return jD.runKernel(yN,t)}});const QM=ZD({equal_:function(e,t){let n=JD(e,"a","equal","string_or_numeric"),r=JD(t,"b","equal","string_or_numeric");[n,r]=FD(n,r),CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(wN,o)}});const JM=ZD({erf_:function(e){let t=JD(e,"x","erf");ME("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=$O(t,"float32"));const n={x:t};return jD.runKernel(xN,n)}});const $M=ZD({exp_:function(e){const t={x:JD(e,"x","exp")};return jD.runKernel(kN,t)}});const ZM=ZD({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=JD(e,"x","expandDims","string_or_numeric");ME(t<=n.rank,(()=>"Axis must be <= rank of the tensor"));const r={input:n},o={dim:t};return jD.runKernel(SN,r,o)}});const eP=ZD({tile_:function(e,t){const n=JD(e,"x","tile","string_or_numeric");ME(n.rank===t.length,(()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")));const r={x:n},o={reps:t};return jD.runKernel(v_,r,o)}});const tP=ZD({eye_:function(e,t,n){null==t&&(t=e);const r=JO([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),o=e<=t?e:t;for(let i=0;i<o;++i)r.set(1,i,i);const a=AM(r.toTensor(),[e,t]);if(null==n)return a;if(1===n.length)return eP(ZM(a,0),[n[0],1,1]);if(2===n.length)return eP(ZM(ZM(a,0),0),[n[0],n[1],1,1]);if(3===n.length)return eP(ZM(ZM(ZM(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});const nP=ZD({floor_:function(e){const t={x:JD(e,"x","floor","float32")};return jD.runKernel(TN,t)}});const rP=ZD({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o={x:JD(e,"x","gather"),indices:JD(t,"indices","gather","int32")},a={axis:n,batchDims:r};return jD.runKernel(_N,o,a)}});const oP=ZD({greater_:function(e,t){let n=JD(e,"a","greater","string_or_numeric"),r=JD(t,"b","greater","string_or_numeric");[n,r]=FD(n,r),CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(ON,o)}});const aP=ZD({greaterEqual_:function(e,t){let n=JD(e,"a","greaterEqual","string_or_numeric"),r=JD(t,"b","greaterEqual","string_or_numeric");[n,r]=FD(n,r),CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(FN,o)}});const iP=ZD({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:JD(e,"x","leakyRelu")},r={alpha:t};return jD.runKernel(WN,n,r)}});const sP=ZD({log_:function(e){const t={x:JD(e,"x","log","float32")};return jD.runKernel(HN,t)}});const cP=ZD({log1p_:function(e){const t={x:JD(e,"x","log1p")};return jD.runKernel(qN,t)}});const lP=ZD({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:JD(e,"x","max")},o={reductionIndices:t,keepDims:n};return jD.runKernel($N,r,o)}});const uP=ZD({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=JD(e,"x","sum");"bool"===r.dtype&&(r=$O(r,"int32"));const o={x:r},a={axis:t,keepDims:n};return jD.runKernel($R,o,a)}});const dP=ZD({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=JD(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));const r=cF(((e,n)=>{const r=lP(e,t,!0),o=xF(e,r),a=xF($O(o,"float32"),sP(uP($M(o),t,!0)));n([a]);return{value:a,gradFunc:(e,n)=>{const[r]=n,o=$M(r);return xF(e,oF(uP(e,t,!0),o))}}}));return r(n)}});function hP(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function pP(e,t,n){const r=e.length+t.length,o=[];let a=0,i=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?o.push(e[a++]):o.push(t[i++]);return o}function fP(e,t){const n=[],r=e.length;for(let o=0;o<r;o++)-1===t.indexOf(o)&&n.push(e[o]);return[n,t.map((t=>e[t]))]}function mP(e,t){return pP(e,t.map((e=>1)),t)}function gP(e,t,n){ME(hP(t,n),(()=>"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")))}function vP(e,t){if(hP(e,t))return null;const n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((e=>n.push(e))),n}function yP(e){return e.map(((e,t)=>[t,e])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0]))}function bP(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}const xP=ZD({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=JD(e,"x","logSumExp"),o=HE(t,r.shape),a=lP(r,o,!0),i=xF(r,a),s=$M(i),c=uP(s,o),l=sP(c),u=tF(AM(a,l.shape),l);if(n){const e=mP(u.shape,o);return AM(u,e)}return u}});const wP=ZD({logicalAnd_:function(e,t){const n=JD(e,"a","logicalAnd","bool"),r=JD(t,"b","logicalAnd","bool");CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(KN,o)}});const kP=ZD({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=JD(e,"a","matMul"),a=JD(t,"b","matMul");[o,a]=FD(o,a);const i={a:o,b:a},s={transposeA:n,transposeB:r};return jD.runKernel(zT,i,s)}});const SP=ZD({maxPool_:function(e,t,n,r,o){const a=JD(e,"x","maxPool");let i=a,s=!1;3===a.rank&&(s=!0,i=AM(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ME(4===i.rank,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(i.rank,"."))),ME(kM(n,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"))),CM("maxPool",r,o);const c={x:i},l={filterSize:t,strides:n,pad:r,dimRoundingMode:o},u=jD.runKernel(eR,c,l);return s?AM(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const IP=ZD({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const i=JD(e,"x","maxPool3d");let s=i,c=!1;4===i.rank&&(c=!0,s=AM(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),ME(5===s.rank,(()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),ME("NDHWC"===a,(()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a))),CM("maxPool3d",r,o);const l={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:o,dataFormat:a},d=jD.runKernel(nR,l,u);return c?AM(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const CP=ZD({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:JD(e,"x","mean")},o={axis:t,keepDims:n};return jD.runKernel(aR,r,o)}});const AP=ZD({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:JD(e,"x","min")},o={axis:t,keepDims:n};return jD.runKernel(iR,r,o)}});const EP=ZD({minimum_:function(e,t){let n=JD(e,"a","minimum"),r=JD(t,"b","minimum");[n,r]=FD(n,r),"bool"===n.dtype&&(n=$O(n,"int32"),r=$O(r,"int32")),CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(sR,o)}});const TP=ZD({moments_:function(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=HE(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=JD(e,"x","moments")).shape),r=CP(e,n,t);let o=r.shape;t||(o=mP(r.shape,n));const a=iF(xF($O(e,"float32"),AM(r,o)));return{mean:r,variance:CP(a,n,t)}}});const NP=ZD({neg_:function(e){const t={x:JD(e,"x","neg")};return jD.runKernel(hR,t)}});const RP=ZD({notEqual_:function(e,t){let n=JD(e,"a","notEqual","string_or_numeric"),r=JD(t,"b","notEqual","string_or_numeric");[n,r]=FD(n,r),CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(pR,o)}});const _P=ZD({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));const a={indices:JD(e,"indices","oneHot","int32")},i={dtype:o,depth:t,onValue:n,offValue:r};return jD.runKernel(yR,a,i)}});function DP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(cT(e),"complex64"===t){const t=DP(e,"float32"),n=DP(e,"float32");return eO(t,n)}const n=iT(zE(e),t);return jD.makeTensor(n,e,t)}function OP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(cT(e),"complex64"===t){const t=OP(e,"float32"),n=DP(e,"float32");return eO(t,n)}const n=aT(zE(e),t);return jD.makeTensor(n,e,t)}const FP=ZD({onesLike_:function(e){const t={x:JD(e,"x","onesLike")};return jD.runKernel(vR,t)}});const MP=ZD({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=JD(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const o={paddings:t,constantValue:n},a={x:r};return jD.runKernel(xR,a,o)}});const PP=ZD({prelu_:function(e,t){const n={x:JD(e,"x","prelu"),alpha:JD(t,"alpha","prelu")};return jD.runKernel(kR,n)}});var LP=n(4334);class zP{constructor(e,t,n,r,o){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const a=o||Math.random();this.random=LP.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,o,a;do{r=2*this.random()-1,o=2*this.random()-1,a=r*r+o*o}while(a>=1||0===a);const i=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*r*i,t=this.mean+this.stdDev*o*i,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class BP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=LP.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const UP=ZD({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(cT(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));const a=new zP(t,n,r,!1,o),i=JO(e,r);for(let s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}});const WP=ZD({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",o=arguments.length>4?arguments[4]:void 0;cT(e);const a=JO(e,r),i=new BP(t,n,null,o);for(let s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}});function jP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const o={start:e,stop:t,step:n,dtype:r};return jD.runKernel(ER,{},o)}const VP=ZD({relu_:function(e){const t={x:JD(e,"x","relu")};return jD.runKernel(RR,t)}});const GP=ZD({reverse_:function(e,t){const n={x:JD(e,"x","reverse")},r={dims:t};return jD.runKernel(LR,n,r)}});const HP=ZD({selu_:function(e){const t={x:JD(e,"x","selu")};return jD.runKernel(GR,t)}});const qP=ZD({separableConv2d_:function(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const s=JD(e,"x","separableConv2d"),c=JD(t,"depthwiseFilter","separableConv2d"),l=JD(n,"pointwiseFilter","separableConv2d");let u=s,d=!1;if(3===s.rank&&(d=!0,u=AM(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===i)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ME(4===u.rank,(()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(u.rank,"."))),ME(4===c.rank,(()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(c.rank,"."))),ME(4===l.rank,(()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(c.rank,"."))),ME(1===l.shape[0],(()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(l.shape[0],"."))),ME(1===l.shape[1],(()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(l.shape[1],".")));const h=c.shape[2],p=c.shape[3];ME(l.shape[2]===h*p,(()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(h*p,", ")+"but got ".concat(l.shape[2],".")));const f=XM(u,c,r,o,i,a),m=UM(f,l,1,"valid",i);return d?AM(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const KP=ZD({sigmoid_:function(e){const t={x:JD(e,"x","sigmoid","float32")};return jD.runKernel(YR,t)}});const XP=ZD({slice_:function(e,t,n){const r=JD(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const o={x:r},a={begin:t,size:n};return jD.runKernel(HR,o,a)}});const YP=ZD({slice1d_:function(e,t,n){const r=JD(e,"x","slice1d");return ME(1===r.rank,(()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor"))),XP(r,[t],[n])}});const QP=ZD({slice2d_:function(e,t,n){const r=JD(e,"x","slice2d");return ME(2===r.rank,(()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor"))),XP(r,t,n)}});const JP=ZD({slice3d_:function(e,t,n){const r=JD(e,"x","slice3d");return ME(3===r.rank,(()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor"))),XP(r,t,n)}});const $P=ZD({slice4d_:function(e,t,n){const r=JD(e,"x","slice4d");return ME(4===r.rank,(()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor"))),XP(r,t,n)}});const ZP=ZD({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=JD(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));const r={logits:n},o={dim:t};return jD.runKernel(t_,r,o)}});const eL=ZD({softplus_:function(e){const t={x:JD(e,"x","softplus")};return jD.runKernel(QR,t)}});const tL=ZD({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={x:JD(e,"x","split")},o={numOrSizeSplits:t,axis:n};return jD.runKernel(e_,r,o)}});const nL=ZD({squeeze_:function(e,t){const n=JD(e,"x","squeeze","string_or_numeric");return AM(n,qE(n.shape,t).newShape)}});const rL=ZD({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=$D(e,"tensors","stack","string_or_numeric");ME(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&ME(t<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const r=n,o={axis:t};return jD.runKernel(bR,r,o)}});const oL=ZD({tanh_:function(e){const t={x:JD(e,"x","tanh","float32")};return jD.runKernel(g_,t)}});function aL(e,t){LE(e);const n=XD(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return tO(e,null,n,t)}function iL(e,t,n){if(LE(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=XD(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return tO(e,t,r,n)}const sL=ZD({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(cT(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const a=new zP(t,n,r,!0,o),i=JO(e,r);for(let s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}});const cL=ZD({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=JD(e,"x","unstack","string_or_numeric");ME(t>=-n.shape.length&&t<n.shape.length,(()=>"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")));const r={value:n},o={axis:t};return jD.runKernel(k_,r,o)}});const lL=ZD({where_:function(e,t,n){const r=JD(t,"a","where"),o=JD(n,"b","where"),a=JD(e,"condition","where","bool"),i=CF(CF(a.shape,r.shape),o.shape),s={condition:OM(a,i),t:OM(r,i),e:OM(o,i)};return jD.runKernel(VR,s)}});const uL=ZD({imag_:function(e){const t={input:JD(e,"input","imag")};return jD.runKernel(LN,t)}});const dL=ZD({real_:function(e){const t={input:JD(e,"input","real")};return jD.runKernel(TR,t)}});const hL=ZD({transpose_:function(e,t,n){const r=JD(e,"x","transpose");if(null==t&&(t=r.shape.map(((e,t)=>t)).reverse()),ME(r.rank===t.length,(()=>"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(t,"."))),t.forEach((e=>{ME(e>=0&&e<r.rank,(()=>"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(t)))})),r.rank<=1)return r.clone();const o={x:r},a={perm:t};return"complex64"===r.dtype?sO((()=>{let e=dL(r),t=uL(r);return e=jD.runKernel(x_,{x:e},a),t=jD.runKernel(x_,{x:t},a),n&&(t=NP(t)),eO(e,t)})):jD.runKernel(x_,o,a)}});const pL=ZD({dropout_:function(e,t,n,r){const o=JD(e,"x","dropout");if(ME("float32"===o.dtype,(()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(o.dtype," tensor instead."))),ME(t>=0&&t<1,(()=>"rate must be a float in the range [0, 1), but got ".concat(t,"."))),0===t)return e instanceof wD?o.clone():o;const a=function(e,t){if(null==t)return e.shape.slice();if(BE(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(o,n),i=1-t,s=rF(nP(tF(WP(a,0,1,"float32",r),i)),i);return oF(o,s)}});const fL=ZD({fft_:function(e){ME("complex64"===e.dtype,(()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")));const t={input:e};return jD.runKernel(CN,t)}});const mL=ZD({rfft_:function(e,t){ME("float32"===e.dtype,(()=>"The dtype for rfft() must be real value but got ".concat(e.dtype)));let n=e.shape[e.shape.length-1];const r=e.size/n;let o;if(null!=t&&t<n){const r=e.shape.map((e=>0)),a=e.shape.map((e=>e));a[e.shape.length-1]=t,o=XP(e,r,a),n=t}else if(null!=t&&t>n){const r=e.shape.map((e=>e));r[e.shape.length-1]=t-n,o=MM([e,DP(r)],e.shape.length-1),n=t}else o=e;const a=sF(o),i=AM(eO(o,a),[r,n]),s=fL(i),c=Math.floor(n/2)+1,l=dL(s),u=uL(s),d=tL(l,[c,n-c],l.shape.length-1),h=tL(u,[c,n-c],u.shape.length-1),p=o.shape.slice();return p[o.shape.length-1]=c,AM(eO(d[0],h[0]),p)}});const gL=ZD({ifft_:function(e){ME("complex64"===e.dtype,(()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")));const t={input:e};return jD.runKernel(PN,t)}});const vL=ZD({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const o=AM(e,[n,t]);r=gL(o)}else{const o=[n,2*(t-1)],a=AM(dL(e),[n,t]),i=AM(uL(e),[n,t]),s=GP(XP(a,[0,1],[n,t-2]),1),c=oF(GP(XP(i,[0,1],[n,t-2]),1),lF(-1)),l=MM([a,s],1),u=MM([i,c],1),d=AM(eO(l,u),[o[0],o[1]]);r=gL(d)}if(r=dL(r),3===e.rank&&0!==e.shape[0]){const t=r,n=e.shape[0];r=AM(r,[n,r.shape[0]/n,r.shape[1]]),t.dispose()}return r}});const yL=ZD({conv2DBackpropFilter_:function(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=AM(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let c=t;3===c.rank&&(c=AM(t,[1,t.shape[0],t.shape[1],t.shape[2]])),ME(4===s.rank,(()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,"."))),ME(4===c.rank,(()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(c.shape,"."))),ME(4===n.length,(()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")));const l="NHWC"===a?s.shape[3]:s.shape[1],u="NHWC"===a?c.shape[3]:c.shape[1];ME(l===n[2],(()=>"Error in conv2dDerFilter: depth of input ".concat(l,") must ")+"match input depth in filter (".concat(n[2],"."))),ME(u===n[3],(()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must ")+"match output depth for filter (".concat(n[3],")."))),CM("conv2dDerFilter",o,i);const d={x:s,dy:c},h={strides:r,pad:o,dataFormat:a,dimRoundingMode:i,filterShape:n};return jD.runKernel(QT,d,h)}});const bL=ZD({relu6_:function(e){const t={x:JD(e,"x","relu6")};return jD.runKernel(PR,t)}});const xL=ZD({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:JD(e,"x","step")},r={alpha:t};return jD.runKernel(C_,n,r)}});function wL(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return oF(e,xL(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function kL(e,t){let n=t;const r=IF(e.shape,t.shape);return r.length>0&&(n=uP(n,r)),AM(n,e.shape)}function SL(e,t,n,r){if("linear"===t)return e;if("relu"===t)return VP(e);if("elu"===t)return YM(e);if("relu6"===t)return bL(e);if("prelu"===t)return PP(e,n);if("leakyrelu"===t)return iP(e,r);if("sigmoid"===t)return KP(e);throw new Error("Unknown fused activation ".concat(t,"."))}const IL=(e,t)=>!(e>0)||"linear"===t;const CL=ZD({fusedConv2d_:function(e){let{x:t,filter:n,strides:r,pad:o,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:c,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}=e;if(l=l||"linear",!1===IL(jD.state.gradientDepth,l)){ME("NHWC"===a,(()=>"Error in fused conv2d: got dataFormat of ".concat(a," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."));let e=UM(t,n,r,o,a,i,s);return null!=c&&(e=tF(e,c)),SL(e,l,u,d)}const h=JD(t,"x","conv2d","float32"),p=JD(n,"filter","conv2d","float32");let f=h,m=!1;3===h.rank&&(m=!0,f=AM(h,[1,h.shape[0],h.shape[1],h.shape[2]])),ME(4===f.rank,(()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(f.rank,"."))),ME(4===p.rank,(()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,"."))),CM("fused conv2d",o,s);const g="NHWC"===a?f.shape[3]:f.shape[1];ME(p.shape[2]===g,(()=>"Error in conv2d: depth of input (".concat(g,") must match ")+"input depth for filter ".concat(p.shape[2],"."))),ME(kM(r,i),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(i,"'")));const v=fM(f.shape,p.shape,r,i,o,s);let y,b;if(null!=c&&(y=JD(c,"bias","fused conv2d"),[y]=FD(y,h),"NHWC"===a?CF(v.outShape,y.shape):(ME(y.shape.length<=1,(()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(y.shape.length,"."))),ME(0===y.shape.length||y.shape[0]===v.outChannels||1===y.shape[0],(()=>"Error in fused conv2d: bias shape (".concat(y.shape,") is not ")+"compatible with the number of output channels "+"(".concat(v.outChannels,")"))))),null!=u){const e=u.shape;if(ME(e.length<=1||3===e.length,(()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(e.length,"."))),1===e.length)ME(1===e[0]||e[0]===v.outChannels,(()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(e,") is not compatible with the number of output ")+"channels (".concat(v.outChannels,").")));else if(3===e.length)try{CF(e,v.outShape)}catch(_se){const n="Error in fused conv2d: PReLU activation weights (".concat(e,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(v.outShape,").");throw Error(n)}b=JD(u,"prelu weights","fused conv2d")}const x=(e,t)=>{ME("NHWC"===a,(()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(a," but only NHWC is currently supported.")));const[n,s,c,u]=t,d=wL(e,c,l);ME(wM(i),(()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(i,"'")));const h=[jM(s.shape,d,n,r,o),yL(s,d,n.shape,r,o)];if(null!=u){const e=kL(u,d);h.push(e)}return h},w={x:f,filter:p,bias:y,preluActivationWeights:b},k={strides:r,pad:o,dataFormat:a,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:d};if(null==c){const e=cF(((e,t,n)=>{let r=jD.runKernel(N_,w,k);return n([t,e,r]),m&&(r=AM(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}));return e(f,p)}{const e=cF(((e,t,n,r)=>{let o=jD.runKernel(N_,w,k);return r([t,e,o,n]),m&&(o=AM(o,[o.shape[1],o.shape[2],o.shape[3]])),{value:o,gradFunc:x}}));return e(f,p,y)}}});const AL=ZD({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=AM(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let c=t;3===c.rank&&(c=AM(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const l={x:s,dy:c},u={strides:r,pad:o,dimRoundingMode:i,dilations:a,filterShape:n};return jD.runKernel(lN,l,u)}});const EL=ZD({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,s=t,c=!1;3===t.rank&&(c=!0,s=AM(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const l={dy:s,filter:n},u={strides:r,pad:o,dimRoundingMode:i,dilations:a,inputShape:e},d=jD.runKernel(uN,l,u);return c?AM(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});const TL=ZD({fusedMatMul_:function(e){let{a:t,b:n,transposeA:r=!1,transposeB:o=!1,bias:a,activation:i="linear",preluActivationWeights:s,leakyreluAlpha:c=.2}=e;if(!1===IL(jD.state.gradientDepth,i)){let e=kP(t,n,r,o);return null!=a&&(e=tF(e,a)),SL(e,i,s,c)}let l=JD(t,"a","fused matMul"),u=JD(n,"b","fused matMul");[l,u]=FD(l,u);const d=r?l.shape[l.rank-2]:l.shape[l.rank-1],h=o?u.shape[u.rank-1]:u.shape[u.rank-2],p=r?l.shape[l.rank-1]:l.shape[l.rank-2],f=o?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),g=u.shape.slice(0,-2),v=zE(m),y=zE(g);ME(d===h,(()=>"Error in fused matMul: inner shapes (".concat(d,") and (")+"".concat(h,") of Tensors with shapes ").concat(l.shape," and ")+"".concat(u.shape," and transposeA=").concat(r)+" and transposeB=".concat(o," must match.")));const b=CF(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,f]),x=AM(l,r?[v,d,p]:[v,p,d]),w=AM(u,o?[y,f,h]:[y,h,f]);let k,S;null!=a&&(k=JD(a,"bias","fused matMul"),[k]=FD(k,l),CF(b,k.shape)),null!=s&&(S=JD(s,"prelu weights","fused matMul"));const I=(e,t)=>{const[n,s,c,l]=t,u=wL(AM(e,c.shape),c,i);let d,h;if(r||o?!r&&o?(d=kP(u,s,!1,!1),h=kP(u,n,!0,!1)):r&&!o?(d=kP(s,u,!1,!0),h=kP(n,u,!1,!1)):(d=kP(s,u,!0,!0),h=kP(u,n,!0,!0)):(d=kP(u,s,!1,!0),h=kP(n,u,!0,!1)),null!=a){return[d,h,kL(l,u)]}return[d,h]},C={a:x,b:w,bias:k,preluActivationWeights:S},A={transposeA:r,transposeB:o,activation:i,leakyreluAlpha:c};if(null==a){const e=cF(((e,t,n)=>{const r=jD.runKernel(T_,C,A);return n([e,t,r]),{value:AM(r,b),gradFunc:I}}));return e(x,w)}{const e=cF(((e,t,n,r)=>{const o=jD.runKernel(T_,C,A);return r([e,t,o,n]),{value:AM(o,b),gradFunc:I}}));return e(x,w,k)}}});const NL=ZD({cropAndResize_:function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=JD(e,"image","cropAndResize"),s=JD(t,"boxes","cropAndResize","float32"),c=JD(n,"boxInd","cropAndResize","int32"),l=s.shape[0];ME(4===i.rank,(()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(i.rank,"."))),ME(2===s.rank&&4===s.shape[1],(()=>"Error in cropAndResize: boxes must be have size [".concat(l,",4] ")+"but had shape ".concat(s.shape,"."))),ME(1===c.rank&&c.shape[0]===l,(()=>"Error in cropAndResize: boxInd must be have size [".concat(l,"] ")+"but had shape ".concat(s.shape,"."))),ME(2===r.length,(()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,"."))),ME(r[0]>=1&&r[1]>=1,(()=>"cropSize must be atleast [1,1], but was ".concat(r))),ME("bilinear"===o||"nearest"===o,(()=>"method must be bilinear or nearest, but was ".concat(o)));const u={image:i,boxes:s,boxInd:c},d={method:o,extrapolationValue:a,cropSize:r};return jD.runKernel(aN,u,d)}});const RL=ZD({flipLeftRight_:function(e){const t=JD(e,"image","flipLeftRight","float32");ME(4===t.rank,(()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")));const n={image:t};return jD.runKernel(EN,n,{})}});const _L=ZD({grayscaleToRGB_:function(e){const t=JD(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];ME(t.rank>=2,(()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,"."))),ME(1===r,(()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")));const o=new Array(t.rank);return o.fill(1,0,n),o[n]=3,eP(t,o)}});const DL=ZD({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const o=n.map(((e,t)=>JD(e,"tensors".concat(t),"einsum"))),a={equation:e};return jD.runKernel(vN,o,a)}});const OL=ZD({rgbToGrayscale_:function(e){const t=JD(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];ME(t.rank>=2,(()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(t.rank,"."))),ME(3===r,(()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,".")));const o=t.dtype,a=$O(t,"float32"),i=aL([.2989,.587,.114]);let s;switch(t.rank){case 2:s=DL("ij,j->i",a,i);break;case 3:s=DL("ijk,k->ij",a,i);break;case 4:s=DL("ijkl,l->ijk",a,i);break;case 5:s=DL("ijklm,m->ijkl",a,i);break;case 6:s=DL("ijklmn,n->ijklm",a,i);break;default:throw new Error("Not a valid tensor rank.")}return s=ZM(s,-1),$O(s,o)}});const FL=ZD({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const o=JD(e,"image","rotateWithOffset","float32");ME(4===o.rank,(()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(o.rank,".")));const a={image:o},i={radians:t,fillValue:n,center:r};return jD.runKernel(E_,a,i)}});function ML(e,t,n,r,o,a){null==r&&(r=.5),null==o&&(o=Number.NEGATIVE_INFINITY),null==a&&(a=0);const i=e.shape[0];return n=Math.min(n,i),ME(0<=r&&r<=1,(()=>"iouThreshold must be in [0, 1], but was '".concat(r,"'"))),ME(2===e.rank,(()=>"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'"))),ME(4===e.shape[1],(()=>"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1]))),ME(1===t.rank,(()=>"scores must be a 1D tensor")),ME(t.shape[0]===i,(()=>"scores has incompatible shape with boxes. Expected ".concat(i,", ")+"but was ".concat(t.shape[0]))),ME(0<=a&&a<=1,(()=>"softNmsSigma must be in [0, 1], but was '".concat(a,"'"))),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:a}}const PL=ZD({nonMaxSuppression_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const a=JD(e,"boxes","nonMaxSuppression","float32"),i=JD(t,"scores","nonMaxSuppression","float32"),s=ML(a,i,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;const c={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return jD.runKernel(fR,{boxes:a,scores:i},c)}});function LL(e,t,n){const r=function(e,t,n){return function(e,t,n){let r=0,o=e.length,a=0,i=!1;for(;r<o;){a=r+(o-r>>>1);const s=n(t,e[a]);s>0?r=a+1:(o=a,i=!s)}return i?r:-r-1}(e,t,n||zL)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function zL(e,t){return e>t?1:e<t?-1:0}function BL(e,t,n,r,o){return jL(e,t,n,r,o,0)}function UL(e,t,n,r,o,a){return jL(e,t,n,r,o,0,!1,a,!0)}function WL(e,t,n,r,o,a){return jL(e,t,n,r,o,a,!0)}function jL(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const l=[];for(let g=0;g<t.length;g++)t[g]>o&&l.push({score:t[g],boxIndex:g,suppressBeginIndex:0});l.sort(HL);const u=a>0?-.5/a:0,d=[],h=[];for(;d.length<n&&l.length>0;){const t=l.pop(),{score:n,boxIndex:a,suppressBeginIndex:i}=t;if(n<o)break;let s=!1;for(let c=d.length-1;c>=i;--c){const n=VL(e,a,d[c]);if(n>=r){s=!0;break}if(t.score=t.score*GL(r,u,n),t.score<=o)break}t.suppressBeginIndex=d.length,s||(t.score===n?(d.push(a),h.push(t.score)):t.score>o&&LL(l,t,HL))}const p=d.length,f=n-p;s&&f>0&&(d.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=h),c&&(m.validOutputs=p),m}function VL(e,t,n){const r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),u=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),h=Math.max(o[1],o[3]),p=(s-a)*(c-i),f=(d-l)*(h-u);if(p<=0||f<=0)return 0;const m=Math.max(a,l),g=Math.max(i,u),v=Math.min(s,d),y=Math.min(c,h),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(p+f-b)}function GL(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function HL(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const qL=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const a=JD(e,"boxes","nonMaxSuppressionAsync"),i=JD(t,"scores","nonMaxSuppressionAsync"),s=ML(a,i,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;const c=await Promise.all([a.data(),i.data()]),l=c[0],u=c[1],{selectedIndices:d}=BL(l,u,n,r,o);return a!==e&&a.dispose(),i!==t&&i.dispose(),aL(d,"int32")};const KL=ZD({nonMaxSuppressionWithScore_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=JD(e,"boxes","nonMaxSuppression"),s=JD(t,"scores","nonMaxSuppression"),c=ML(i,s,n,r,o,a);n=c.maxOutputSize,r=c.iouThreshold,o=c.scoreThreshold,a=c.softNmsSigma;const l={boxes:i,scores:s},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:a},d=jD.runKernel(gR,l,u);return{selectedIndices:d[0],selectedScores:d[1]}}});const XL=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=JD(e,"boxes","nonMaxSuppressionAsync"),s=JD(t,"scores","nonMaxSuppressionAsync"),c=ML(i,s,n,r,o,a);n=c.maxOutputSize,r=c.iouThreshold,o=c.scoreThreshold,a=c.softNmsSigma;const l=await Promise.all([i.data(),s.data()]),u=l[0],d=l[1],{selectedIndices:h,selectedScores:p}=WL(u,d,n,r,o,a);return i!==e&&i.dispose(),s!==t&&s.dispose(),{selectedIndices:aL(h,"int32"),selectedScores:aL(p)}};const YL=ZD({nonMaxSuppressionPadded_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=JD(e,"boxes","nonMaxSuppression"),s=JD(t,"scores","nonMaxSuppression"),c=ML(i,s,n,r,o,null),l={boxes:i,scores:s},u={maxOutputSize:c.maxOutputSize,iouThreshold:c.iouThreshold,scoreThreshold:c.scoreThreshold,padToMaxOutputSize:a},d=jD.runKernel(mR,l,u);return{selectedIndices:d[0],validOutputs:d[1]}}});const QL=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=JD(e,"boxes","nonMaxSuppressionAsync"),s=JD(t,"scores","nonMaxSuppressionAsync"),c=ML(i,s,n,r,o,null),l=c.maxOutputSize,u=c.iouThreshold,d=c.scoreThreshold,[h,p]=await Promise.all([i.data(),s.data()]),{selectedIndices:f,validOutputs:m}=UL(h,p,l,u,d,a);return i!==e&&i.dispose(),s!==t&&s.dispose(),{selectedIndices:aL(f,"int32"),validOutputs:lF(m,"int32")}};const JL=ZD({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=JD(e,"images","resizeBilinear");ME(3===o.rank||4===o.rank,(()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(o.rank,"."))),ME(2===t.length,(()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,"."))),ME(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let a=o,i=!1;3===o.rank&&(i=!0,a=AM(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const[]=t,s={images:a},c={alignCorners:n,halfPixelCenters:r,size:t},l=jD.runKernel(FR,s,c);return i?AM(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const $L=ZD({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=JD(e,"images","resizeNearestNeighbor");ME(3===o.rank||4===o.rank,(()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(o.rank,"."))),ME(2===t.length,(()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,"."))),ME("float32"===o.dtype||"int32"===o.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),ME(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let a=o,i=!1;3===o.rank&&(i=!0,a=AM(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const[]=t,s={images:a},c={alignCorners:n,halfPixelCenters:r,size:t},l=jD.runKernel(DR,s,c);return i?AM(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const ZL=ZD({bincount_:function(e,t,n){const r=JD(e,"x","bincount"),o=JD(t,"weights","bincount");ME("int32"===r.dtype,(()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype))),ME(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),ME(o.size===r.size||0===o.size,(()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(o.shape,".")));const a={x:r,weights:o},i={size:n};return jD.runKernel(UT,a,i)}});const ez=ZD({lessEqual_:function(e,t){let n=JD(e,"a","lessEqual","string_or_numeric"),r=JD(t,"b","lessEqual","string_or_numeric");[n,r]=FD(n,r),CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(VN,o)}});const tz=ZD({round_:function(e){const t={x:JD(e,"x","round")};return jD.runKernel(zR,t)}});const nz=ZD({threshold_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const o=JD(e,"image","threshold"),a=o.shape[0]*o.shape[1];let i,s,c,l,u=oF(aL([r]),255);if(ME(3===o.rank,(()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(o.rank,"."))),ME(3===o.shape[2]||1===o.shape[2],(()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(o.shape[2],"."))),ME("int32"===o.dtype||"float32"===o.dtype,(()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(o.dtype,"."))),ME("otsu"===t||"binary"===t,(()=>"Method must be binary or otsu, but was ".concat(t))),3===o.shape[2]){[i,s,c]=tL(o,[1,1,1],-1);const e=oF(i,.2989),t=oF(s,.587),n=oF(c,.114);l=tF(tF(e,t),n)}else l=e;if("otsu"===t){u=function(e,t){let n,r,o,a,i,s,c=aL([-1]),l=aL([0]),u=aL([0]);for(let d=0;d<e.size-1;d++){n=XP(e,0,d+1),r=XP(e,d+1),i=rF(uP(n),t),s=rF(uP(r),t);const h=uP(oF(n,jP(0,n.size)));o=rF(h,uP(n));const p=vF(r.shape,n.size),f=tF(jP(0,r.size),p),m=oF(r,f);a=rF(uP(m),uP(r));const g=xF(o,a),v=xF(o,a),y=oF(i,s);u=oF(oF(y,g),v);const b=oP(u,l);l=lL(b,u,l),c=lL(b,aL([d]),c)}return c}(ZL($O(tz(l),"int32"),nO([]),256),a)}const d=n?ez(l,u):oP(l,u);return $O(oF(d,255),"int32")}});const rz=ZD({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0;const i=JD(e,"image","transform","float32"),s=JD(t,"transforms","transform","float32");ME(4===i.rank,(()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(i.rank,"."))),ME(2===s.rank&&(s.shape[0]===i.shape[0]||1===s.shape[0])&&8===s.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),ME(null==a||2===a.length,(()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(a,".")));const c={image:i,transforms:s},l={interpolation:n,fillMode:r,fillValue:o,outputShape:a};return jD.runKernel(b_,c,l)}});const oz=ZD({less_:function(e,t){let n=JD(e,"a","less","string_or_numeric"),r=JD(t,"b","less","string_or_numeric");[n,r]=FD(n,r),CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(jN,o)}});const az=ZD({bandPart_:function(e,t,n){const r=JD(e,"a","bandPart");ME(r.rank>=2,(()=>"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")));const o=r.shape,[a,i]=r.shape.slice(-2);let s,c;"number"===typeof t?(ME(t%1===0,(()=>"bandPart(): numLower must be an integer, got ".concat(t,"."))),ME(t<=a,(()=>"bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(a,")."))),s=JD(t<0?a:t,"numLower","bandPart")):(ME("int32"===t.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),s=lL(oz(t,0),a,EP(t,a))),"number"===typeof n?(ME(n%1===0,(()=>"bandPart(): numUpper must be an integer, got ".concat(n,"."))),ME(n<=i,(()=>"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(i,")."))),c=JD(n<0?i:n,"numUpper","bandPart")):(ME("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),c=lL(oz(n,0),i,EP(n,i)));const l=AM(jP(0,a,1,"int32"),[-1,1]),u=jP(0,i,1,"int32"),d=xF(l,u),h=wP(ez(d,s),aP(d,NP(c))),p=DP([a,i],r.dtype);return AM(rL(cL(AM(r,[-1,a,i])).map((e=>lL(h,e,p)))),o)}});function iz(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return kF(e);if(1!==e.rank&&null===n)return iz(AM(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return uP(kF(e),n);if(t===1/0)return lP(kF(e),n);if(t===-1/0)return AP(kF(e),n);if("euclidean"===t||2===t)return aF(uP(bF(kF(e),lF(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return lP(uP(kF(e),n[0]),n[1]-1);if(t===1/0)return lP(uP(kF(e),n[1]),n[0]);if(t===-1/0)return AP(uP(kF(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return aF(uP(iF(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}const sz=ZD({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=iz(e=JD(e,"x","norm"),t,n);let a=o.shape;if(r){const t=HE(n,e.shape);a=mP(o.shape,t)}return AM(o,a)}});const cz=ZD({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,ME(null!=e&&e.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=e[0].shape[0];for(let t=1;t<e.length;++t)ME(e[t].shape[0]===n,(()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")))}else t=!0,e=tL(e,e.shape[0],0).map((e=>nL(e,[0])));ME(e.length<=e[0].shape[0],(()=>"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")));const n=[],r=e;for(let o=0;o<e.length;++o)n.push(jD.tidy((()=>{let e=r[o];if(o>0)for(let t=0;t<o;++t){const r=oF(uP(oF(n[t],e)),n[t]);e=xF(e,r)}return rF(e,sz(e,"euclidean"))})));return t?rL(n,0):n}});function lz(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return jD.tidy((()=>{ME(2===e.shape.length,(()=>"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")));const n=e.shape[0],r=e.shape[1];let o=tP(n),a=ZO(e);const i=iL([[1]],[1,1]);let s=ZO(i);const c=n>=r?r:n;for(let e=0;e<c;++e){const t=a,c=s,l=o;[s,a,o]=jD.tidy((()=>{const t=XP(a,[e,e],[n-e,1]),c=sz(t),l=XP(a,[e,e],[1,1]),u=lL(oP(l,0),iL([[-1]]),iL([[1]])),d=xF(l,oF(u,c)),h=rF(t,d);s=1===h.shape[0]?ZO(i):MM([i,XP(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);const p=NP(rF(kP(u,d),c)),f=XP(a,[e,0],[n-e,r]),m=oF(p,s),g=hL(s);if(0===e)a=xF(f,kP(m,kP(g,f)));else{const t=xF(f,kP(m,kP(g,f)));a=MM([XP(a,[0,0],[e,r]),t],0)}const v=hL(m),y=XP(o,[0,e],[n,o.shape[1]-e]);if(0===e)o=xF(y,kP(kP(y,s),v));else{const t=xF(y,kP(kP(y,s),v));o=MM([XP(o,[0,0],[n,e]),t],1)}return[s,a,o]})),cO([t,c,l])}return!t&&n>r&&(o=XP(o,[0,0],[n,r]),a=XP(a,[0,0],[r,r])),[o,a]}))}const uz=ZD({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(ME(e.rank>=2,(()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank))),2===e.rank)return lz(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce(((e,t)=>e*t)),r=cL(AM(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],a=[];r.forEach((e=>{const[n,r]=lz(e,t);o.push(n),a.push(r)}));return[AM(rL(o,0),e.shape),AM(rL(a,0),e.shape)]}}});var dz;!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(dz||(dz={}));const hz=ZD({squaredDifference_:function(e,t){let n=JD(e,"a","squaredDifference"),r=JD(t,"b","squaredDifference");[n,r]=FD(n,r),CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(s_,o,{})}});const pz={flipLeftRight:RL,grayscaleToRGB:_L,resizeNearestNeighbor:$L,resizeBilinear:JL,rgbToGrayscale:OL,rotateWithOffset:FL,cropAndResize:NL,nonMaxSuppression:PL,nonMaxSuppressionAsync:qL,nonMaxSuppressionWithScore:KL,nonMaxSuppressionWithScoreAsync:XL,nonMaxSuppressionPadded:YL,nonMaxSuppressionPaddedAsync:QL,threshold:nz,transform:rz},fz={bandPart:az,gramSchmidt:cz,qr:uz};const mz=class{static sgd(e){return new TF(e)}static momentum(e,t){return new NF(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(e){return new RF(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new wF(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new gF(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new EF(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(e){return new yF(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}},gz="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:e=>e();function vz(){return new Promise((e=>gz((()=>e()))))}function yz(e,t){const n=e[0].length;e.forEach(((e,t)=>{ME(e.length===n,(()=>"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")))})),ME(t>=0&&t<n,(()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")));const r=e[0];e.forEach(((e,o)=>{for(let a=0;a<n;a++)ME(a===t||e[a]===r[a],(()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(o,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(o,".")))}))}function bz(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var xz;function wz(e,t,n){let r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(let o=1;o<n.length;++o){const a=n[o],i=r[r.length-n.length+o],s=r[i];if(a>=0)if(s>=0){if(s!==a)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(o+e,"] = ").concat(a," but shape[").concat(o+e,"] = ").concat(s))}else r[i]=a}return r}function kz(e){const t={FIRST_DIM_SIZE:xz.FIRST_DIM_SIZE,VALUE_ROWIDS:xz.VALUE_ROWIDS,ROW_LENGTHS:xz.ROW_LENGTHS,ROW_SPLITS:xz.ROW_SPLITS,ROW_LIMITS:xz.ROW_LIMITS,ROW_STARTS:xz.ROW_STARTS},n=[];for(const r of e){if(!(r in t))break;n.push(t[r])}return n}function Sz(e){return 0===e.length?0:e[0]===xz.FIRST_DIM_SIZE?e.length-1:e.length}function Iz(e,t){if(null==e||null==t)return;const n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(let o=0;o<Math.min(n,r-1);++o){const n=e[o],r=t[o+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(o-e.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(o-e.length,"] = ").concat(r))}}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(xz||(xz={}));const Cz=30;function Az(e){return e<=Cz?e:tT(e,Math.floor(Math.sqrt(e)))}function Ez(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function Tz(e,t,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const n=t.length;for(let o=0;o<n;++o)r=r.concat([e[o+1]/t[o],t[o]]);r=r.concat(e.slice(n+1))}return r}function Nz(e,t){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(let r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{const r=[],o=[];for(let n=1;n<e;++n)n>=2*t+1||n%2===1?o.push(n):r.push(n);n.push(...r),n.push(0),n.push(...o)}return n}function Rz(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(let a=1;a<e.length;++a)a<=t.length?r?o.push(t[a-1]*e[a]):o.push(e[a]/t[a-1]):o.push(e[a]);return o}function _z(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function Dz(e,t,n){const r=e.slice(0,1);for(let o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function Oz(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===zE(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));const o=t.shape,a=o[o.length-1];let i=1;for(let d=0;d<o.length-1;++d)i*=o[d];const s=e.shape,c=o.slice();c.pop();let l=1;for(let d=a;d<n;++d)l*=s[d],c.push(s[d]);const u=[...nT(e.shape).map((e=>e/l)),1].slice(0,a);return[c,i,l,u]}function Fz(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(o,".");if(n.rank<o)throw new Error(a+" update.rank < ".concat(o,". "));if(e.length<r+(n.rank-o))throw new Error(a+" Output shape length < ".concat(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(a+" update.rank != ".concat(o+e.length-r));for(let i=0;i<o;++i)if(n.shape[i]!==t.shape[i])throw new Error(a+" updates.shape[".concat(i,"] (").concat(n.shape[i],") != indices.shape[").concat(i,"] (").concat(t.shape[i],")."));for(let i=0;i<n.rank-o;++i)if(n.shape[i+o]!==e[i+r])throw new Error(a+" updates.shape[".concat(i+o,"] (").concat(n.shape[i+o],") != shape[").concat(i+o,"] (").concat(e[i+o],")"))}function Mz(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}Fz(n,t,e)}function Pz(e,t,n){const r=t.shape.length,o=r>1?t.shape[r-1]:1,a=n.length;let i=1;for(let c=o;c<a;++c)i*=n[c];const s=o<1?1:o;return{sliceRank:o,numUpdates:zE(t.shape)/s,sliceSize:i,strides:[...nT(n.slice(0,o)),1],outputSize:zE(n)}}const Lz=1.7580993408473768,zz=1.0507009873554805,Bz=.3275911,Uz=.254829592,Wz=-.284496736,jz=1.421413741,Vz=-1.453152027,Gz=1.061405429;function Hz(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));const n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function qz(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function Kz(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let o=0;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}function Xz(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let o=2;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}function Yz(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Qz(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function Jz(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let o=0;o<Math.ceil(e/2);o++){const a=(t?2:-2)*Math.PI*(o/e);n[o]=Math.cos(a),r[o]=Math.sin(a)}return{real:n,imag:r}}function $z(e,t,n){const r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}const Zz="->",eB=/->/g,tB=",",nB="...";function rB(e,t){const n=((e=e.replace(/\s/g,"")).length-e.replace(eB,"").length)/Zz.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(Zz,'").'));const[r,o]=e.split(Zz);ME(-1===r.indexOf(nB),(()=>'The ellipsis notation ("'.concat(nB,'") is not supported yet.')));const a=r.split(tB),i=a.length;if(t!==i)throw new Error("Expected ".concat(i," input tensors, received ").concat(t));if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let d=0;d<o.length;++d){const e=o[d];if(!a.some((t=>-1!==t.indexOf(e))))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===s.indexOf(e)&&s.push(e)}for(let d=0;d<r.length;++d){const e=r[d];-1===s.indexOf(e)&&e!==tB&&s.push(e)}const c=new Array(a.length);for(let d=0;d<i;++d){if(new Set(a[d].split("")).size!==a[d].length)throw new Error("Found duplicate axes in input component ".concat(a[d],". ")+"Support for duplicate axes in input is not implemented yet.");c[d]=[];for(let e=0;e<a[d].length;++e)c[d].push(s.indexOf(a[d][e]))}const l=s.length,u=[];for(let d=o.length;d<l;++d)u.push(d);return{allDims:s,summedDims:u,idDims:c}}function oB(e,t){let n=new Array(e);n.fill(-1);for(let o=0;o<t.length;++o)n[t[o]]=o;const r=[];for(let o=0;o<e;++o)-1===n[o]&&r.push(o);return n=n.filter((e=>-1!==e)),{permutationIndices:n,expandDims:r}}function aB(e,t,n){const r=new Array(e);for(let o=0;o<n.length;++o){const e=n[o].shape;for(let n=0;n<t[o].length;++n)void 0===r[t[o][n]]?r[t[o][n]]=e[n]:ME(r[t[o][n]]===e[n],(()=>"Expected dimension ".concat(r[t[o][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(e),", ")+"but got dimension ".concat(e[n])))}}function iB(e,t){const n=e,r=[];let o=0;0===e.length&&n.push(-1),o=e.length+1;for(let i=0;i<o;++i)r.push([]);const a=[];for(let i=0;i<n.length;++i){const e=cB(t,n[i]);for(const t of e)-1===a.indexOf(t)&&(r[i].push(t),a.push(t))}return{path:n,steps:r}}function sB(e){return e.every(((e,t)=>e===t))}function cB(e,t){const n=[];for(let r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function lB(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)ME(e.shape[n]%t===0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(t).fill(e.shape[n]/t);else{const o=t.reduce(((e,t)=>(-1===t&&(e+=1),e)),0);ME(o<=1,(()=>"There should be only one negative value in split array."));const a=t.indexOf(-1);if(-1!==a){const r=t.reduce(((e,t)=>t>0?e+t:e));t[a]=e.shape[n]-r}ME(e.shape[n]===t.reduce(((e,t)=>e+t)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=t}return r}function uB(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function dB(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function hB(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function pB(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function fB(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function mB(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function gB(e,t){const n=zE(e),r=zE(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}function vB(e,t){const n=zE(e),r=zE(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}function yB(){return"segment ids must be >= 0"}function bB(){return"segment ids are not increasing"}function xB(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function wB(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function kB(e,t){let n,r=!1;for(e<=Cz?(n=e,r=!0):n=tT(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=tT(e,n+1);return n}function SB(e,t,n){const r=[],o=e.length;for(let a=0;a<o;a++)a!==t?r.push(e[a]):r.push(n);return r}function IB(e,t,n,r){const o=t.shape.length,a=e.shape.length;if(0!==r&&(r<-o||r>o))throw new Error("Expect batchDims in the range of [-".concat(o,", ").concat(o,"], but got ").concat(r));if(r<0&&(r+=o),r>a)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(a,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(let d=0;d<r;++d)if(e.shape[d]!==t.shape[d])throw new Error("x.shape[".concat(d,"]: ").concat(e.shape[d]," should be equal to indices.shape[").concat(d,"]: ").concat(t.shape[d],"."));const i=e.shape[n],s=[];let c=1,l=1,u=1;for(let d=0;d<r;++d)s.push(e.shape[d]),c*=e.shape[d];for(let d=r;d<n;d++)s.push(e.shape[d]),l*=e.shape[d];for(let d=r;d<o;d++)s.push(t.shape[d]);for(let d=n+1;d<a;d++)s.push(e.shape[d]),u*=e.shape[d];return{batchSize:c,sliceSize:u,outerSize:l,dimSize:i,outputShape:s}}function CB(e){try{return e.map((e=>iD(e)))}catch(Dse){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(Dse))}}function AB(e){return e.map((e=>aD(e)))}function EB(e,t){const n=[];for(let a=0;a<t.length;a++)t[a]&&n.push(a);const r=JO(e,"int32"),o=JO([n.length,e.length],"int32");for(let a=0;a<n.length;a++){const t=r.indexToLoc(n[a]),i=a*e.length;o.values.set(t,i)}return o.toTensor()}!function(){for(const e of _F)fF(e)}();const TB={kernelName:xT,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(e,xL($O(n,"float32"),-1))}}},NB={kernelName:wT,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=iF($O(n,"float32")),r=aF(xF(lF(1),t));return NP(rF(e,r))}}}},RB={kernelName:kT,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=aF(xF(iF($O(n,"float32")),1));return rF(e,t)}}}},_B={kernelName:ST,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,o=CF(n.shape,r.shape);return{a:()=>{let t=e;const r=IF(n.shape,o);return r.length>0&&(t=uP(t,r)),AM(t,n.shape)},b:()=>{let t=e;const n=IF(r.shape,o);return n.length>0&&(t=uP(t,n)),AM(t,r.shape)}}}},DB={kernelName:IT,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach(((t,r)=>{n[r]=()=>e.clone()})),n}},OB={kernelName:ET,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sF(n)}}},FB={kernelName:TT,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>sF(n)}}},MB={kernelName:NT,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rF(e,aF(xF(lF(1),iF($O(n,"float32")))))}}},PB={kernelName:RT,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=aF(tF(lF(1),iF($O(n,"float32"))));return rF(e,t)}}}},LB={kernelName:OT,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,o=CF(n.shape,r.shape);return{a:()=>{const t=tF(iF(n),iF(r));let a=oF(e,rF(r,t));const i=IF(n.shape,o);return i.length>0&&(a=uP(a,i)),AM(a,n.shape)},b:()=>{const t=tF(iF(n),iF(r));let a=NP(oF(e,rF(n,t)));const i=IF(r.shape,o);return i.length>0&&(a=uP(a,i)),AM(a,r.shape)}}}},zB={kernelName:_T,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rF(e,tF(iF($O(n,"float32")),1))}}},BB={kernelName:DT,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rF(e,xF(lF(1),iF($O(n,"float32"))))}}};const UB=ZD({avgPool3dGrad_:function(e,t,n,r,o,a){const i=JD(e,"dy","avgPool3dGrad"),s=JD(t,"input","avgPool3dGrad");let c=i,l=s,u=!1;4===s.rank&&(u=!0,c=AM(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),l=AM(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),ME(5===c.rank,(()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(c.rank,"."))),ME(5===l.rank,(()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(l.rank,"."))),CM("avgPool3dGrad",o,a);const d={dy:c,input:l},h={filterSize:n,strides:r,pad:o,dimRoundingMode:a},p=jD.runKernel(LT,d,h);return u?AM(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),WB={kernelName:PT,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:o,strides:a,pad:i,dimRoundingMode:s}=n;return{x:()=>UB(e,r,o,a,i,s)}}};const jB=ZD({avgPoolGrad_:function(e,t,n,r,o){const a=JD(e,"dy","avgPoolGrad"),i=JD(t,"input","avgPoolGrad");ME(i.rank===a.rank,(()=>"Rank of input (".concat(i.rank,") does not match rank of dy (").concat(a.rank,")")));let s=i,c=a,l=!1;3===i.rank&&(l=!0,s=AM(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=AM(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ME(4===c.rank,(()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(c.rank,"."))),ME(4===s.rank,(()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")));const u={dy:c,input:s},d={filterSize:n,strides:r,pad:o},h=jD.runKernel(MT,u,d);return l?AM(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),VB={kernelName:FT,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:o,strides:a,pad:i}=n;return{x:()=>jB(e,r,o,a,i)}}},GB={kernelName:zT,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,o]=t,{transposeA:a,transposeB:i}=n;return a||i?!a&&i?{a:()=>kP(e,o,!1,!1),b:()=>kP(e,r,!0,!1)}:a&&!i?{a:()=>kP(o,e,!1,!0),b:()=>kP(r,e,!1,!1)}:{a:()=>kP(o,e,!0,!0),b:()=>kP(e,r,!0,!0)}:{a:()=>kP(e,o,!1,!0),b:()=>kP(r,e,!0,!1)}}};const HB=ZD({spaceToBatchND_:function(e,t,n){const r=JD(e,"x","spaceToBatchND");ME(r.rank>=1+t.length,(()=>"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length))),ME(n.length===t.length,(()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length))),ME(r.shape.reduce(((e,r,o)=>o>0&&o<=t.length?e&&(r+n[o-1][0]+n[o-1][1])%t[o-1]===0:e),!0),(()=>"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())));const o={x:r},a={blockShape:t,paddings:n};return jD.runKernel(ZR,o,a)}}),qB={kernelName:BT,gradFunc:(e,t,n)=>{const{blockShape:r,crops:o}=n;return{x:()=>HB(e,r,o)}}},KB={kernelName:"BroadcastTo",gradFunc:(e,t,n)=>{const r=n,o=r.inputShape,a=r.shape,i=Array.from(a);for(let c=o.length-1;c>=0;c--)if(o[c]===a[c])i[c]=1;else if(1!==o[c])throw new Error("broadcastTo(): [".concat(o,"] cannot be broadcast to [").concat(a,"]."));const s=[];for(let c=0;c<i.length;c++)i[c]>1&&s.push(c);return{x:()=>uP(e,s,!0)}}},XB={kernelName:VT,gradFunc:e=>({x:()=>e.clone()})},YB={kernelName:GT,gradFunc:e=>({x:()=>sF(e)})},QB={kernelName:HT,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:o,clipValueMax:a}=n;return{x:()=>lL(wP(aP(r,o),ez(r,a)),e,sF(e))}}},JB={kernelName:KT,inputsToSave:["x"],gradFunc:TB.gradFunc},$B={kernelName:XT,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map((e=>e.shape)),{axis:o}=n,a=HE(o,t[0].shape)[0],i=r.map((e=>e[a]));return tL(e,i,a).map((e=>()=>e))}},ZB={kernelName:YT,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,o]=t,{dilations:a,strides:i,pad:s,dataFormat:c}=n;return ME(wM(a),(()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(a,"'"))),{x:()=>jM(r.shape,e,o,i,s,c),filter:()=>yL(r,e,o.shape,i,s,c)}}},eU={kernelName:JT,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,o]=t,{strides:a,pad:i,dataFormat:s,dimRoundingMode:c}=n;return{dy:()=>UM(e,o,a,i,s,1,c),filter:()=>yL(e,r,o.shape,a,i,s,c)}}};const tU=ZD({conv3DBackpropFilter_:function(e,t,n,r,o){let a=e;4===e.rank&&(a=AM(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let i=t;4===i.rank&&(i=AM(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),ME(5===a.rank,(()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(a.shape,"."))),ME(5===i.rank,(()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(i.shape,"."))),ME(5===n.length,(()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,"."))),ME(a.shape[4]===n[3],(()=>"Error in conv3dDerFilter: depth of input ".concat(a.shape[4],") must ")+"match input depth in filter (".concat(n[3],"."))),ME(i.shape[4]===n[4],(()=>"Error in conv3dDerFilter: depth of dy (".concat(i.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")));const s={x:a,dy:i},c={strides:r,pad:o,filterShape:n};return jD.runKernel(ZT,s,c)}}),nU={kernelName:$T,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:o,pad:a}=n;ME(wM(r),(()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")));const[i,s]=t;return{x:()=>HM(i.shape,e,s,o,a),filter:()=>tU(i,e,s.shape,o,a)}}};const rU=ZD({sin_:function(e){const t={x:JD(e,"x","sin","float32")};return jD.runKernel(qR,t)}}),oU={kernelName:tN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(NP(rU($O(n,"float32"))),e)}}};const aU=ZD({sinh_:function(e){const t={x:JD(e,"x","sinh")};return jD.runKernel(KR,t)}}),iU={kernelName:nN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(aU($O(n,"float32")),e)}}};const sU=ZD({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o={x:JD(e,"x","cumsum")},a={axis:t,exclusive:n,reverse:r};return jD.runKernel(oN,o,a)}}),cU={kernelName:oN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:o,exclusive:a,reverse:i}=n;return{x:()=>{const t=vP([o],r.rank);let n=sU(e,o,a,!i);return null!=t&&(n=hL(n,t)),n}}}},lU={kernelName:cN,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:o,pad:a,dimRoundingMode:i}=n,s=null==r?[1,1]:r;ME(wM(s),(()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")));const[c,l]=t;return ME(4===c.rank,(()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,"."))),ME(4===l.rank,(()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,"."))),ME(c.shape[3]===l.shape[2],(()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],"."))),ME(kM(o,s),(()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(o," and dilations ")+"'".concat(s,"'."))),CM("depthwiseConv2d",a,i),{x:()=>EL(c.shape,e,l,o,a,s,i),filter:()=>AL(c,e,l.shape,o,a,s,i)}}},uU={kernelName:hN,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,o]=t,a={x:r,filter:o,dy:e},i={x:r,filter:o,dy:e};return{x:()=>jD.runKernel(pN,a,n),filter:()=>jD.runKernel(fN,i,n)}}},dU={kernelName:yN,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>jD.runKernel(bN,r)}}},hU={kernelName:xN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=oF($M(NP(iF(n))),2/Math.sqrt(Math.PI));return{x:()=>oF(e,r)}}},pU={kernelName:kN,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(e,n)}}},fU={kernelName:SN,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>AM(e,n.shape)}}},mU={kernelName:IN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(e,$M(n))}}},gU={kernelName:TN,gradFunc:e=>({x:()=>sF(e)})},vU={kernelName:NN,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,o=CF(n.shape,r.shape);return{a:()=>{const t=rF(e,$O(r,"float32")),a=IF(n.shape,o);return a.length>0?AM(uP(t,a),n.shape):t},b:()=>{let t=oF(e,$O(n,"float32"));const a=IF(r.shape,o);a.length>0&&(t=AM(uP(t,a),r.shape));const i=iF(r);return NP(rF(t,$O(i,"float32")))}}}};const yU=ZD({rsqrt_:function(e){const t={x:JD(e,"x","rsqrt","float32")};return jD.runKernel(BR,t)}}),bU={kernelName:RN,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[o,a,i,s]=t,c=null==s?lF(1):s,l=IF(a.shape,o.shape),u=[];if(1===a.rank){for(let e=0;e<o.shape.length-1;++e)u.push(o.shape[e]);u.push(1)}const d=xF(o,a),h=oF(e,c),p=yU(tF(i,lF(r))),f=oF(oF(oF(p,p),p),lF(-.5));return{x:()=>1===a.rank?AM(oF(oF(e,eP(AM(p,[1,1,1,a.shape[0]]),u)),c),o.shape):AM(oF(oF(e,p),c),o.shape),mean:()=>{let e=oF(oF(p,lF(-1)),h);return 1===a.rank&&(e=uP(e,l)),AM(e,a.shape)},variance:()=>{let e=oF(oF(f,d),h);return 1===a.rank&&(e=uP(e,l)),AM(e,a.shape)},scale:()=>{const t=oF(d,p);let n=oF(e,t);return 1===a.rank&&(n=uP(n,l)),AM(n,a.shape)},offset:()=>{let t=e;return 1===a.rank&&(t=uP(t,l)),AM(t,a.shape)}}}};const xU=ZD({unsortedSegmentSum_:function(e,t,n){const r=JD(e,"x","unsortedSegmentSum"),o=JD(t,"segmentIds","unsortedSegmentSum","int32");ME(UE(n),(()=>"numSegments must be of dtype int"));const a={x:r,segmentIds:o},i={numSegments:n};return jD.runKernel(S_,a,i)}}),wU={kernelName:_N,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,o]=t,{axis:a,batchDims:i}=n,s=HE(a,r.shape)[0],c=(e,t,n)=>()=>{const r=e.shape,o=t.size,i=r.slice(0,s),c=i.length,l=r.slice(a,r.length).slice(1),u=l.length,d=kU(0,c),h=kU(c+1,c+1+u),p=SU([i,[o],l]),f=AM(n,p),m=AM(t,[o]),g=SU([[c],d,h]),v=hL(f,g);let y=xU(v,m,e.shape[s]);const b=yP(g);return y=hL(y,b),y};if(1===i){const t=r.shape[0],n=r.split(t,0);return{x:()=>{const t=rL(n.map(((t,n)=>c(t,o.slice(n,1),e.slice(n,1))())));return t.reshape(r.shape)},indices:()=>o}}return{x:c(r,o,e),indices:()=>o}}};function kU(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function SU(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}const IU={kernelName:FN,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>sF(n),b:()=>sF(r)}}},CU={kernelName:MN,gradFunc:e=>({x:()=>$O(e,"float32")})},AU={kernelName:zN,gradFunc:e=>({x:()=>sF(e)})},EU={kernelName:BN,gradFunc:e=>({x:()=>sF(e)})},TU={kernelName:UN,gradFunc:e=>({x:()=>sF(e)})},NU={kernelName:WN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:o}=n,a=oP(r,0);return{x:()=>lL(a,e,oF(e,o))}}},RU={kernelName:qN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rF(e,tF(n,1))}}},_U={kernelName:HN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rF(e,$O(n,"float32"))}}},DU={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:o}=n;return{logits:()=>{const t=$M(r);return xF(e,oF(uP(e,o,!0),t))}}}};const OU=ZD({localResponseNormalizationBackprop_:function(e,t,n){const r={x:e,y:t,dy:n},o={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return jD.runKernel(JN,r,o)}}),FU={kernelName:QN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,o]=t,{depthRadius:a,bias:i,alpha:s,beta:c}=n;return{x:()=>OU(r,o,e,a,i,s,c)}}};function MU(e,t,n,r){return t.rank<n.rank&&(t=AM(t,mP(t.shape,r))),e.rank<n.rank&&(e=AM(e,mP(e.shape,r))),{x:()=>oF(e,$O(QM(n,t),e.dtype))}}const PU={kernelName:$N,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:o}=r,a=t[0],i=MU(e,t[1],a,HE(o,a.shape));return{x:()=>i.x()}}},LU={kernelName:ZN,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>oF(e,$O(aP(n,r),"float32")),b:()=>oF(e,$O(oz(n,r),"float32"))}}};const zU=ZD({maxPool3dGrad_:function(e,t,n,r,o,a,i){const s=JD(e,"dy","maxPool3dGrad"),c=JD(t,"input","maxPool3dGrad"),l=JD(n,"output","maxPool3dGrad");let u=s,d=c,h=l,p=!1;4===c.rank&&(p=!0,u=AM(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),d=AM(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),h=AM(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),ME(5===u.rank,(()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,"."))),ME(5===d.rank,(()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(d.rank,"."))),ME(5===h.rank,(()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(h.rank,"."))),CM("maxPool3dGrad",a,i);const f={dy:u,input:d,output:h},m={filterSize:r,strides:o,pad:a,dimRoundingMode:i},g=jD.runKernel(rR,f,m);return p?AM(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),BU={kernelName:nR,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,o]=t,{filterSize:a,strides:i,pad:s,dimRoundingMode:c}=n;return{x:()=>zU(e,r,o,a,i,s,c)}}};const UU=ZD({maxPoolGrad_:function(e,t,n,r,o,a,i){const s=JD(e,"dy","maxPoolGrad"),c=JD(t,"input","maxPoolGrad"),l=JD(n,"output","maxPoolGrad");ME(c.rank===s.rank,(()=>"Rank of input (".concat(c.rank,") does not match rank of dy ")+"(".concat(s.rank,")"))),ME(4===s.rank,(()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,"."))),ME(4===c.rank,(()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(c.rank,"."))),CM("maxPoolGrad",a,i);const u={dy:s,input:c,output:l},d={filterSize:r,strides:o,pad:a,dimRoundingMode:i};return jD.runKernel(tR,u,d)}}),WU={kernelName:eR,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,o]=t,{filterSize:a,strides:i,pad:s}=n;return{x:()=>UU(e,r,o,a,i,s)}}},jU={kernelName:aR,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:o}=n,a=HE(o,r.shape),i=zE(fP(r.shape,a)[1]);return{x:()=>{const t=r.shape.slice();a.forEach((e=>{t[e]=1}));const n=AM(e,t);return rF(oF(n,OP(r.shape,"float32")),i)}}}},VU={kernelName:iR,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:o}=r,[a,i]=t,s=MU(e,i,a,HE(o,a.shape));return{x:()=>s.x()}}},GU={kernelName:sR,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>oF(e,$O(ez(n,r),"float32")),b:()=>oF(e,$O(oP(n,r),"float32"))}}},HU={kernelName:cR,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:o}=n,a=o.map((e=>e[0]));return{x:()=>XP(e,a,r.shape)}}},qU={kernelName:lR,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,o=CF(n.shape,r.shape);return{a:()=>{const t=IF(n.shape,o);return t.length>0?AM(uP(e,t),n.shape):e},b:()=>{const t=oF(e,NP(nP(rF(n,r)))),a=IF(r.shape,o);return a.length>0?AM(uP(t,a),r.shape):t}}}},KU={kernelName:dR,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,o=CF(n.shape,r.shape);return{a:()=>{const t=oF(e,$O(r,"float32")),a=IF(n.shape,o);return a.length>0?AM(uP(t,a),n.shape):t},b:()=>{const t=oF(e,$O(n,"float32")),a=IF(r.shape,o);return a.length>0?AM(uP(t,a),r.shape):t}}}},XU={kernelName:hR,gradFunc:e=>({x:()=>NP(e)})},YU={kernelName:yR,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>DP(n.shape,"float32")}}},QU={kernelName:vR,gradFunc:e=>({x:()=>sF(e)})},JU={kernelName:bR,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return cL(e,r).map((e=>()=>e))}},$U={kernelName:xR,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:o}=n,a=o.map((e=>e[0]));return{x:()=>XP(e,a,r.shape)}}},ZU={kernelName:wR,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,o]=t,a=n,i=r,s=CF(a.shape,i.shape);return{a:()=>{const t=$O(i,"float32");let n=oF(e,oF(t,bF(a,xF(t,lF(1)))));const r=IF(a.shape,s);return r.length>0&&(n=uP(n,r)),AM(n,a.shape)},b:()=>{const t=oP(a,0),n=lL(t,sP(a),sF(a));let r=oF(e,oF(o,n));const c=IF(i.shape,s);return c.length>0&&(r=uP(r,c)),AM(r,i.shape)}}}},eW={kernelName:kR,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,o=oP(n,0);return{x:()=>lL(o,e,oF(e,r)),alpha:()=>{let t=lL(o,sF(e),oF(e,n));const a=IF(r.shape,e.shape);return a.length>0&&(t=uP(t,a)),AM(t,r.shape)}}}};const tW=ZD({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o={x:JD(e,"x","cumprod")},a={axis:t,exclusive:n,reverse:r};return jD.runKernel(rN,o,a)}});function nW(e,t,n){const r=e.shape.length,o=r-n.length,a=vP(n,r);let i=e;null!=a&&(i=hL(e,a));const s=i.shape.slice(),c=s.splice(r-n.length,n.length).reduce(((e,t)=>e*t),1);s.push(c);let l=function(e,t,n){const r=e.shape.slice();r[n]=1;const o=AM(t,r),a=tW(e,n,!0,!1),i=tW(e,n,!0,!0),s=oF(a,i);return oF(o,s)}(i.reshape(s),t,o);if(l=l.reshape(i.shape),null!=a){const e=yP(a);l=hL(l,e)}return l}const rW={kernelName:SR,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:o}=n;let a=[];return a=void 0===o||null===o?r.shape.map(((e,t)=>t)):"number"===typeof o?[o]:o,{x:()=>nW(r,e,a)}}},oW={kernelName:gN,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,o=CF(n.shape,r.shape);return{a:()=>{const t=rF(e,$O(r,"float32")),a=IF(n.shape,o);return a.length>0?AM(uP(t,a),n.shape):t},b:()=>{let t=oF(e,$O(n,"float32"));const a=IF(r.shape,o);a.length>0&&(t=AM(uP(t,a),r.shape));const i=iF(r);return NP(rF(t,$O(i,"float32")))}}}},aW={kernelName:NR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rF(e,NP(iF(n)))}}},iW={kernelName:PR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=oF(ez(n,6),xL(n));return{x:()=>oF(e,$O(r,"float32"))}}},sW={kernelName:RR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(e,$O(xL(n),"float32"))}}},cW={kernelName:_R,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>AM(e,n.shape)}}},lW={kernelName:FR,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,o={dy:e,images:r};return{images:()=>jD.runKernel(MR,o,n)}}},uW={kernelName:DR,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,o={dy:e,images:r};return{images:()=>jD.runKernel(OR,o,n)}}},dW={kernelName:LR,gradFunc:(e,t,n)=>{const{dims:r}=n,o=HE(r,e.shape);return{x:()=>GP(e,o)}}},hW={kernelName:zR,gradFunc:e=>({x:()=>sF(e)})},pW={kernelName:BR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>NP(rF(e,oF(bF(n,1.5),2)))}}};const fW=ZD({logicalNot_:function(e){const t={x:JD(e,"x","logicalNot","bool")};return jD.runKernel(XN,t)}}),mW={kernelName:VR,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>$O(sF(n),"float32"),t:()=>oF(e,$O(n,e.dtype)),e:()=>oF(e,$O(fW(n),e.dtype))}}},gW={kernelName:GR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=oP(n,lF(0)),r=lF(Lz),o=lF(zz),a=oF(e,o),i=oF(oF(e,r),$M($O(n,"float32")));return lL(t,a,i)}}}},vW={kernelName:YR,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(e,oF(n,xF(lF(1),n)))}}},yW={kernelName:XR,gradFunc:e=>({x:()=>sF(e)})};const bW=ZD({cos_:function(e){const t={x:JD(e,"x","cos","float32")};return jD.runKernel(tN,t)}}),xW={kernelName:qR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(bW($O(n,"float32")),e)}}};const wW=ZD({cosh_:function(e){const t={x:JD(e,"x","cosh","float32")};return jD.runKernel(nN,t)}}),kW={kernelName:KR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(wW($O(n,"float32")),e)}}},SW={kernelName:HR,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:o,size:a}=n,i=r.shape,[s,c]=aM(r,o,a),l=[];for(let u=0;u<e.rank;u++)l.push([s[u],i[u]-s[u]-c[u]]);return{x:()=>MP(e,l)}}},IW={kernelName:t_,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:o}=n,a=oF(e,r);return{logits:()=>xF(a,oF(uP(a,[o],true),r))}}},CW={kernelName:QR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(e,KP(n))}}};const AW=ZD({batchToSpaceND_:function(e,t,n){const r=JD(e,"x","batchToSpaceND"),o=t.reduce(((e,t)=>e*t));ME(r.rank>=1+t.length,(()=>"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length))),ME(n.length===t.length,(()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length))),ME(r.shape[0]%o===0,(()=>"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(o)));const a={x:r},i={blockShape:t,crops:n};return jD.runKernel(BT,a,i)}}),EW={kernelName:ZR,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:o}=n;return{x:()=>AW(e,r,o)}}},TW={kernelName:e_,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>MM(e,r)}}},NW={kernelName:JR,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rF(e,oF(aF($O(n,"float32")),2))}}},RW={kernelName:c_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(e,oF($O(n,"float32"),2))}}},_W={kernelName:s_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,o=lF(2);return{a:()=>oF(e,oF(o,xF(n,r))),b:()=>oF(e,oF(o,xF(r,n)))}}},DW={kernelName:f_,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,o=CF(n.shape,r.shape);return{a:()=>{let t=e;const r=IF(n.shape,o);return r.length>0&&(t=uP(t,r)),AM(t,n.shape)},b:()=>{let t=e;const n=IF(r.shape,o);return n.length>0&&(t=uP(t,n)),AM(NP(t),r.shape)}}}},OW={kernelName:$R,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,o=r.shape.slice(),{axis:a}=n;HE(a,r.shape).forEach((e=>{o[e]=1}));const i=AM(e,o),s=oF(i,OP(r.shape,"float32"));return{x:()=>s}}},FW={kernelName:m_,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>rF(e,iF(bW(n)))}}},MW={kernelName:g_,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>oF(xF(lF(1),iF(n)),e)}}},PW={kernelName:v_,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:o}=n;return{x:()=>{let t=sF(r);if(1===r.rank)for(let n=0;n<o[0];++n)t=tF(t,XP(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<o[0];++n)for(let a=0;a<o[1];++a)t=tF(t,XP(e,[n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<o[0];++n)for(let a=0;a<o[1];++a)for(let i=0;i<o[2];++i)t=tF(t,XP(e,[n*r.shape[0],a*r.shape[1],i*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(let n=0;n<o[0];++n)for(let a=0;a<o[1];++a)for(let i=0;i<o[2];++i)for(let s=0;s<o[3];++s)t=tF(t,XP(e,[n*r.shape[0],a*r.shape[1],i*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},LW={kernelName:S_,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>function(e,t){const n=AF(t,sF(t)),r=rP(e,n);let o=aP(t,lF(0,"int32"));const a=r.rank-o.rank;for(let s=0;s<a;++s)o=ZM(o,s+1);o=wP(o,OP(r.shape,"bool"));const i=sF(r);return lL(o,r,i)}(e,n)}}};const zW=[TB,NB,RB,_B,DB,OB,FB,MB,PB,LB,zB,BB,WB,VB,GB,qB,KB,XB,YB,QB,JB,$B,eU,ZB,nU,oU,iU,cU,lU,uU,oW,dU,hU,pU,fU,mU,vU,gU,bU,wU,IU,CU,AU,EU,TU,NU,RU,_U,DU,FU,PU,PU,LU,BU,WU,jU,VU,GU,HU,qU,KU,XU,YU,QU,JU,$U,$U,ZU,eW,rW,aW,iW,sW,cW,lW,uW,dW,hW,pW,mW,gW,vW,yW,xW,kW,SW,IW,CW,EW,EW,TW,TW,NW,_W,RW,{kernelName:C_,gradFunc:e=>({x:()=>sF(e)})},DW,OW,FW,MW,PW,{kernelName:x_,gradFunc:(e,t,n)=>{const r=n,{perm:o}=r,a=yP(o);return{x:()=>hL(e,a)}}},{kernelName:k_,gradFunc:(e,t,n)=>{const r=n,{axis:o}=r;return{value:()=>rL(e,o)}}},LW,{kernelName:I_,gradFunc:e=>({x:()=>sF(e)})}];for(const n of zW)B_(n);kD().prototype.abs=function(){return this.throwIfDisposed(),kF(this)};const BW=ZD({acos_:function(e){const t={x:JD(e,"x","acos")};return jD.runKernel(wT,t)}});kD().prototype.acos=function(){return this.throwIfDisposed(),BW(this)};const UW=ZD({acosh_:function(e){const t={x:JD(e,"x","acosh")};return jD.runKernel(kT,t)}});kD().prototype.acosh=function(){return this.throwIfDisposed(),UW(this)},kD().prototype.add=function(e){return this.throwIfDisposed(),tF(this,e)},kD().prototype.all=function(e,t){return this.throwIfDisposed(),cM(this,e,t)},kD().prototype.any=function(e,t){return this.throwIfDisposed(),lM(this,e,t)},kD().prototype.argMax=function(e){return this.throwIfDisposed(),uM(this,e)};const WW=ZD({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:JD(e,"x","argMin")},r={axis:t};return jD.runKernel(TT,n,r)}});kD().prototype.argMin=function(e){return this.throwIfDisposed(),WW(this,e)},kD().prototype.asScalar=function(){return this.throwIfDisposed(),ME(1===this.size,(()=>"The array must have only 1 element.")),AM(this,[])},kD().prototype.asType=function(e){return this.throwIfDisposed(),$O(this,e)},kD().prototype.as1D=function(){return this.throwIfDisposed(),AM(this,[this.size])},kD().prototype.as2D=function(e,t){return this.throwIfDisposed(),AM(this,[e,t])},kD().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),AM(this,[e,t,n])},kD().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),AM(this,[e,t,n,r])},kD().prototype.as5D=function(e,t,n,r,o){return this.throwIfDisposed(),AM(this,[e,t,n,r,o])};const jW=ZD({asin_:function(e){const t={x:JD(e,"x","asin")};return jD.runKernel(NT,t)}});kD().prototype.asin=function(){return this.throwIfDisposed(),jW(this)};const VW=ZD({asinh_:function(e){const t={x:JD(e,"x","asinh")};return jD.runKernel(RT,t)}});kD().prototype.asinh=function(){return this.throwIfDisposed(),VW(this)};const GW=ZD({atan_:function(e){const t={x:JD(e,"x","atan")};return jD.runKernel(_T,t)}});kD().prototype.atan=function(){return this.throwIfDisposed(),GW(this)};const HW=ZD({atan2_:function(e,t){let n=JD(e,"a","atan2"),r=JD(t,"b","atan2");[n,r]=FD(n,r);const o={a:n,b:r};return jD.runKernel(OT,o)}});kD().prototype.atan2=function(e){return this.throwIfDisposed(),HW(this,e)};const qW=ZD({atanh_:function(e){const t={x:JD(e,"x","atanh")};return jD.runKernel(DT,t)}});kD().prototype.atanh=function(){return this.throwIfDisposed(),qW(this)},kD().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),EM(this,e,t,n,r)},kD().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),AW(this,e,t)},kD().prototype.batchNorm=function(e,t,n,r,o){return this.throwIfDisposed(),NM(this,e,t,n,r,o)},kD().prototype.broadcastTo=function(e){return this.throwIfDisposed(),OM(this,e)},kD().prototype.cast=function(e){return this.throwIfDisposed(),$O(this,e)};const KW=ZD({ceil_:function(e){const t={x:JD(e,"x","ceil","float32")};return jD.runKernel(GT,t)}});kD().prototype.ceil=function(){return this.throwIfDisposed(),KW(this)},kD().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),FM(this,e,t)},kD().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof wD&&(e=[e]),MM([this,...e],t)},kD().prototype.conv1d=function(e,t,n,r,o,a){return this.throwIfDisposed(),WM(this,e,t,n,r,o,a)},kD().prototype.conv2dTranspose=function(e,t,n,r,o){return this.throwIfDisposed(),VM(this,e,t,n,r,o)},kD().prototype.conv2d=function(e,t,n,r,o,a){return this.throwIfDisposed(),UM(this,e,t,n,r,o,a)},kD().prototype.cos=function(){return this.throwIfDisposed(),bW(this)},kD().prototype.cosh=function(){return this.throwIfDisposed(),wW(this)},kD().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),tW(this,e,t,n)},kD().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),sU(this,e,t,n)};const XW=ZD({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const r=JD(e,"x","depthToSpace","float32"),o="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],i="NHWC"===n?r.shape[3]:r.shape[1];ME(t>1,(()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(t))),ME(o*t>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(o," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape))),ME(a*t>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape))),ME(i%(t*t)===0,(()=>"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(i," for depthToSpace with input shape ").concat(r.shape)));const s={x:r},c={blockSize:t,dataFormat:n};return jD.runKernel(sN,s,c)}});kD().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),XW(this,e,t)},kD().prototype.depthwiseConv2d=function(e,t,n,r,o,a){return this.throwIfDisposed(),XM(this,e,t,n,r,o,a)};const YW=ZD({dilation2d_:function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const i=JD(e,"x","dilation2d"),s=JD(t,"filter","dilation2d");ME(3===i.rank||4===i.rank,(()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(i.rank,"."))),ME(3===s.rank,(()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,"."))),ME("NHWC"===a,(()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(a)));let c=i,l=!1;3===i.rank&&(c=AM(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=!0),ME(c.shape[3]===s.shape[2],(()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(c.shape[3]," vs ").concat(s.shape[2])));const u={x:c,filter:s},d={strides:n,pad:r,dilations:o},h=jD.runKernel(hN,u,d);return l?AM(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});kD().prototype.dilation2d=function(e,t,n,r,o){return this.throwIfDisposed(),YW(this,e,t,n,r,o)};const QW=ZD({divNoNan_:function(e,t){let n=JD(e,"a","div"),r=JD(t,"b","div");[n,r]=FD(n,r);const o=rF(n,r),a=sF(o),i=QM(r,a);return lL(i,a,o)}});kD().prototype.divNoNan=function(e){return this.throwIfDisposed(),QW(this,e)},kD().prototype.div=function(e){return this.throwIfDisposed(),rF(this,e)};const JW=ZD({dot_:function(e,t){const n=JD(e,"t1","dot"),r=JD(t,"t2","dot");ME((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")));const o=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];if(ME(o===a,(()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(o," and ").concat(a,"."))),1===n.rank&&1===r.rank){const e=AM(n,[1,-1]),t=AM(r,[-1,1]),o=kP(e,t);return AM(o,[])}if(1===n.rank&&2===r.rank){const e=AM(n,[1,-1]),t=AM(r,[r.shape[0],r.shape[1]]),o=kP(e,t);return AM(o,[o.size])}if(2===n.rank&&1===r.rank){const e=AM(r,[-1,1]),t=kP(n,e);return AM(t,[t.size])}{const e=AM(r,[r.shape[0],r.shape[1]]);return kP(n,e)}}});kD().prototype.dot=function(e){return this.throwIfDisposed(),JW(this,e)},kD().prototype.elu=function(){return this.throwIfDisposed(),YM(this)},kD().prototype.equal=function(e){return this.throwIfDisposed(),QM(this,e)},kD().prototype.erf=function(){return this.throwIfDisposed(),JM(this)};const $W=ZD({euclideanNorm_:function(e){return sz(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});kD().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),$W(this,e,t)},kD().prototype.exp=function(){return this.throwIfDisposed(),$M(this)},kD().prototype.expandDims=function(e){return this.throwIfDisposed(),ZM(this,e)};const ZW=ZD({expm1_:function(e){const t={x:JD(e,"x","expm1")};return jD.runKernel(IN,t)}});kD().prototype.expm1=function(){return this.throwIfDisposed(),ZW(this)},kD().prototype.fft=function(){return this.throwIfDisposed(),fL(this)},kD().prototype.flatten=function(){return this.throwIfDisposed(),AM(this,[this.size])},kD().prototype.floor=function(){return this.throwIfDisposed(),nP(this)},kD().prototype.floorDiv=function(e){return this.throwIfDisposed(),nF(this,e)},kD().prototype.gather=function(e,t,n){return this.throwIfDisposed(),rP(this,e,t,n)},kD().prototype.greaterEqual=function(e){return this.throwIfDisposed(),aP(this,e)},kD().prototype.greater=function(e){return this.throwIfDisposed(),oP(this,e)},kD().prototype.ifft=function(){return this.throwIfDisposed(),gL(this)},kD().prototype.irfft=function(){return this.throwIfDisposed(),vL(this)};const ej=ZD({isFinite_:function(e){const t={x:JD(e,"x","isFinite")};return jD.runKernel(zN,t)}});kD().prototype.isFinite=function(){return this.throwIfDisposed(),ej(this)};const tj=ZD({isInf_:function(e){const t={x:JD(e,"x","isInf")};return jD.runKernel(BN,t)}});kD().prototype.isInf=function(){return this.throwIfDisposed(),tj(this)};const nj=ZD({isNaN_:function(e){const t={x:JD(e,"x","isNaN")};return jD.runKernel(UN,t)}});kD().prototype.isNaN=function(){return this.throwIfDisposed(),nj(this)},kD().prototype.leakyRelu=function(e){return this.throwIfDisposed(),iP(this,e)},kD().prototype.lessEqual=function(e){return this.throwIfDisposed(),ez(this,e)},kD().prototype.less=function(e){return this.throwIfDisposed(),oz(this,e)};const rj=ZD({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const a=JD(e,"x","localResponseNormalization");ME(4===a.rank||3===a.rank,(()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(a.rank,"."))),ME(UE(t),(()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")));let i=a,s=!1;3===a.rank&&(s=!0,i=AM(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const c={x:i},l={depthRadius:t,bias:n,alpha:r,beta:o},u=jD.runKernel(QN,c,l);return s?AM(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});kD().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),rj(this,e,t,n,r)};const oj=ZD({logSigmoid_:function(e){const t=JD(e,"x","logSigmoid"),n=cF((e=>({value:NP(eL(NP(e))),gradFunc:t=>oF(t,KP(NP(e)))})));return n(t)}});kD().prototype.logSigmoid=function(){return this.throwIfDisposed(),oj(this)},kD().prototype.logSoftmax=function(e){return this.throwIfDisposed(),dP(this,e)},kD().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),xP(this,e,t)},kD().prototype.log=function(){return this.throwIfDisposed(),sP(this)},kD().prototype.log1p=function(){return this.throwIfDisposed(),cP(this)},kD().prototype.logicalAnd=function(e){return this.throwIfDisposed(),wP(this,e)},kD().prototype.logicalNot=function(){return this.throwIfDisposed(),fW(this)};const aj=ZD({logicalOr_:function(e,t){const n=JD(e,"a","logicalOr","bool"),r=JD(t,"b","logicalOr","bool");CF(n.shape,r.shape);const o={a:n,b:r};return jD.runKernel(YN,o)}});kD().prototype.logicalOr=function(e){return this.throwIfDisposed(),aj(this,e)};const ij=ZD({logicalXor_:function(e,t){const n=JD(e,"a","logicalXor","bool"),r=JD(t,"b","logicalXor","bool");return CF(n.shape,r.shape),wP(aj(e,t),fW(wP(e,t)))}});kD().prototype.logicalXor=function(e){return this.throwIfDisposed(),ij(this,e)},kD().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),kP(this,e,t,n)},kD().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),SP(this,e,t,n,r)},kD().prototype.max=function(e,t){return this.throwIfDisposed(),lP(this,e,t)},kD().prototype.maximum=function(e){return this.throwIfDisposed(),AF(this,e)},kD().prototype.mean=function(e,t){return this.throwIfDisposed(),CP(this,e,t)},kD().prototype.min=function(e,t){return this.throwIfDisposed(),AP(this,e,t)},kD().prototype.minimum=function(e){return this.throwIfDisposed(),EP(this,e)};const sj=ZD({mirrorPad_:function(e,t,n){ME("reflect"===n||"symmetric"===n,(()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")));const r=JD(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");ME(t.length===r.rank,(()=>"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,".")));const o="reflect"===n?1:0;for(let s=0;s<r.rank;s++)ME(2===t[s].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),ME(t[s][0]>=0&&t[s][0]<=r.shape[s]-o&&t[s][1]>=0&&t[s][1]<=r.shape[s]-o,(()=>"Padding in dimension ".concat(s," cannot be greater than or equal ")+"to ".concat(r.shape[s]-o," or less than 0 for input of ")+"shape ".concat(r.shape)));const a={paddings:t,mode:n},i={x:r};return jD.runKernel(cR,i,a)}});kD().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),sj(this,e,t)};const cj=ZD({mod_:function(e,t){let n=JD(e,"a","mod"),r=JD(t,"b","mod");[n,r]=FD(n,r);const o={a:n,b:r};return jD.runKernel(lR,o)}});kD().prototype.mod=function(e){return this.throwIfDisposed(),cj(this,e)},kD().prototype.mul=function(e){return this.throwIfDisposed(),oF(this,e)},kD().prototype.neg=function(){return this.throwIfDisposed(),NP(this)},kD().prototype.norm=function(e,t,n){return this.throwIfDisposed(),sz(this,e,t,n)},kD().prototype.notEqual=function(e){return this.throwIfDisposed(),RP(this,e)},kD().prototype.oneHot=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),_P(this,e,t,n)},kD().prototype.onesLike=function(){return this.throwIfDisposed(),FP(this)},kD().prototype.pad=function(e,t){return this.throwIfDisposed(),MP(this,e,t)};const lj=ZD({pool_:function(e,t,n,r,o,a,i){null==o&&(o=[1,1]),null==a&&(a=1),0===r&&(r="valid");const s=JD(e,"x","maxPool");let c=s,l=!1;3===s.rank&&(l=!0,c=AM(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ME(kM(a,o),(()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(a," and dilations '").concat(o,"'")));const u=hM(c.shape,t,a,o,r),d=[u.dilationHeight,u.dilationWidth];let h;h="same"===r?function(e,t){const n=e.map(((e,n)=>e+(e-1)*(t[n]-1))),r=n.map((e=>e-1)),o=r.map((e=>Math.floor(e/2))),a=r.map(((e,t)=>e-o[t]));return r.map(((e,t)=>[o[t],a[t]]))}([u.filterHeight,u.filterWidth],d):[[0,0],[0,0]];const p=1===d[0]&&1===d[1],[f,m]=function(e,t,n){const r=n.map((e=>e[0])),o=n.map((e=>e[1])),a=e.concat(r,o),i=t.map(((e,t)=>(e-a[t]%e)%e)),s=o.map(((e,t)=>e+i[t])),c=t.map(((e,t)=>[r[t],s[t]])),l=t.map(((e,t)=>[0,i[t]]));return[c,l]}([u.inHeight,u.inWidth],d,h),g=p?r:"valid",v=p?c:HB(c,d,f),y=("avg"===n?()=>EM(v,t,a,g,i):()=>SP(v,t,a,g,i))(),b=p?y:AW(y,d,m);return l?AM(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});kD().prototype.pool=function(e,t,n,r,o,a){return this.throwIfDisposed(),lj(this,e,t,n,r,o,a)},kD().prototype.pow=function(e){return this.throwIfDisposed(),bF(this,e)},kD().prototype.prelu=function(e){return this.throwIfDisposed(),PP(this,e)};const uj=ZD({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=JD(e,"x","prod");"bool"===r.dtype&&(r=$O(r,"int32"));const o={x:r},a={axis:t,keepDims:n};return jD.runKernel(SR,o,a)}});kD().prototype.prod=function(e,t){return this.throwIfDisposed(),uj(this,e,t)};const dj=ZD({reciprocal_:function(e){const t={x:JD(e,"x","reciprocal")};return jD.runKernel(NR,t)}});kD().prototype.reciprocal=function(){return this.throwIfDisposed(),dj(this)},kD().prototype.relu=function(){return this.throwIfDisposed(),VP(this)},kD().prototype.relu6=function(){return this.throwIfDisposed(),bL(this)},kD().prototype.reshapeAs=function(e){return this.throwIfDisposed(),AM(this,e.shape)},kD().prototype.reshape=function(e){return this.throwIfDisposed(),AM(this,e)},kD().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),JL(this,e,t,n)},kD().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),$L(this,e,t,n)},kD().prototype.reverse=function(e){return this.throwIfDisposed(),GP(this,e)},kD().prototype.rfft=function(){return this.throwIfDisposed(),mL(this)},kD().prototype.round=function(){return this.throwIfDisposed(),tz(this)},kD().prototype.rsqrt=function(){return this.throwIfDisposed(),yU(this)},kD().prototype.selu=function(){return this.throwIfDisposed(),HP(this)},kD().prototype.separableConv2d=function(e,t,n,r,o,a){return this.throwIfDisposed(),qP(this,e,t,n,r,o,a)},kD().prototype.sigmoid=function(){return this.throwIfDisposed(),KP(this)};const hj=ZD({sign_:function(e){const t={x:JD(e,"x","sign")};return jD.runKernel(XR,t)}});kD().prototype.sign=function(){return this.throwIfDisposed(),hj(this)},kD().prototype.sin=function(){return this.throwIfDisposed(),rU(this)},kD().prototype.sinh=function(){return this.throwIfDisposed(),aU(this)},kD().prototype.slice=function(e,t){return this.throwIfDisposed(),XP(this,e,t)},kD().prototype.softmax=function(e){return this.throwIfDisposed(),ZP(this,e)},kD().prototype.softplus=function(){return this.throwIfDisposed(),eL(this)},kD().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),HB(this,e,t)},kD().prototype.split=function(e,t){return this.throwIfDisposed(),tL(this,e,t)},kD().prototype.sqrt=function(){return this.throwIfDisposed(),aF(this)},kD().prototype.square=function(){return this.throwIfDisposed(),iF(this)},kD().prototype.squaredDifference=function(e){return this.throwIfDisposed(),hz(this,e)},kD().prototype.squeeze=function(e){return this.throwIfDisposed(),nL(this,e)},kD().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof wD?[this,e]:[this,...e];return rL(n,t)},kD().prototype.step=function(e){return this.throwIfDisposed(),xL(this,e)};const pj=ZD({stridedSlice_:function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const l={x:JD(e,"x","stridedSlice","string_or_numeric")},u={begin:t,end:n,strides:r,beginMask:o,endMask:a,ellipsisMask:i,newAxisMask:s,shrinkAxisMask:c};return jD.runKernel(u_,l,u)}});kD().prototype.stridedSlice=function(e,t,n,r,o,a,i,s){return this.throwIfDisposed(),pj(this,e,t,n,r,o,a,i,s)},kD().prototype.sub=function(e){return this.throwIfDisposed(),xF(this,e)},kD().prototype.sum=function(e,t){return this.throwIfDisposed(),uP(this,e,t)};const fj=ZD({tan_:function(e){const t={x:JD(e,"x","tan","float32")};return jD.runKernel(m_,t)}});kD().prototype.tan=function(){return this.throwIfDisposed(),fj(this)},kD().prototype.tanh=function(){return this.throwIfDisposed(),oL(this)},kD().prototype.tile=function(e){return this.throwIfDisposed(),eP(this,e)},kD().prototype.toBool=function(){return this.throwIfDisposed(),$O(this,"bool")},kD().prototype.toFloat=function(){return this.throwIfDisposed(),$O(this,"float32")},kD().prototype.toInt=function(){return this.throwIfDisposed(),$O(this,"int32")};const mj=ZD({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=JD(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const o=r.shape[r.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(o,") ")+"but got ".concat(t));const a={x:r},i={k:t,sorted:n},[s,c]=jD.runKernel(y_,a,i);return{values:s,indices:c}}});kD().prototype.topk=function(e,t){return this.throwIfDisposed(),mj(this,e,t)},kD().prototype.transpose=function(e){return this.throwIfDisposed(),hL(this,e)};const gj=ZD({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=JD(e,"x","unique","string_or_numeric");ME(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},o={axis:t},[a,i]=jD.runKernel(w_,r,o);return{values:a,indices:i}}});kD().prototype.unique=function(e){return this.throwIfDisposed(),gj(this,e)},kD().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),xU(this,e,t)},kD().prototype.unstack=function(e){return this.throwIfDisposed(),cL(this,e)},kD().prototype.where=function(e,t){return this.throwIfDisposed(),lL(e,this,t)},kD().prototype.zerosLike=function(){return this.throwIfDisposed(),sF(this)};class vj extends Error{constructor(e){super(e),Object.setPrototypeOf(this,vj.prototype)}}class yj extends Error{constructor(e){super(e),Object.setPrototypeOf(this,yj.prototype)}}class bj extends Error{constructor(e){super(e),Object.setPrototypeOf(this,bj.prototype)}}class xj extends Error{constructor(e){super(e),Object.setPrototypeOf(this,xj.prototype)}}class wj extends Error{constructor(e){super(e),Object.setPrototypeOf(this,wj.prototype)}}Error;class kj{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}}function Sj(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}{const n=new Array(t);return n.fill(e),n}}function Ij(e,t){if(!e)throw new wj(t)}function Cj(e,t){let n=0;for(const r of e)r===t&&n++;return n}function Aj(e){return 1===e.length?e[0]:e}function Ej(e){return Array.isArray(e)?e:[e]}function Tj(e){const t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function Nj(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,((e,t)=>t.toUpperCase()))}let Rj={};function _j(e){if(null===e||void 0===e)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function Dj(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((e=>Dj(e)));else{const t=Object.keys(e);for(const n of t){const t=e[n];null!=t&&"object"===typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!==typeof t.value?Dj(t):e[n]=t.value)}}}function Oj(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){const o=e;let a;if(o in n)a=n[o];else if(o in Rj)a=Rj[o];else if(a=t[o],null==a)throw new bj("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return a}{const a=e;if(null==a.className||null==a.config)throw new bj("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(a),".\n")+"'className' and 'config' must set.");const i=a.className;let s,c;if(i in n?[s,c]=n[i]:i in Rj?[s,c]=Rj.className:i in t&&([s,c]=t[i]),null==s)throw new bj("Unknown ".concat(r,": ").concat(i,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){const e={};for(const n of Object.keys(Rj))e[n]=Rj[n];for(const o of Object.keys(n))e[o]=n[o];a.config.customObjects=e;const t=Object.assign({},Rj);for(const o of Object.keys(n))Rj[o]=n[o];Dj(a.config);const r=c(s,a.config,n,o);return Rj=Object.assign({},t),r}{const e=Object.assign({},Rj);for(const r of Object.keys(n))Rj[r]=n[r];const t=new s(a.config);return Rj=Object.assign({},e),t}}}function Fj(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function Mj(e){if(null==e)return e;const t=[];for(const n of e)-1===t.indexOf(n)&&t.push(n);return t}function Pj(e){if(null==e)throw new bj("Invalid value in obj: ".concat(JSON.stringify(e)));for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function Lj(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new bj("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function zj(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return Ij(n>=0),Ij(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((e=>typeof e===t))}function Bj(e,t){Array.isArray(e)?(ME(e.length>0,(()=>"".concat(t," is unexpectedly an empty array."))),e.forEach(((e,n)=>Bj(e,"element ".concat(n+1," of ").concat(t))))):ME(Number.isInteger(e)&&e>0,(()=>"Expected ".concat(t," to be a positive integer, but got ")+"".concat(Uj(e),".")))}function Uj(e){return null===e?"null":Array.isArray(e)?"["+e.map((e=>Uj(e))).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function Wj(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}let jj=0;function Vj(){return jj++}const Gj={};function Hj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in Gj||(Gj[e]=0),Gj[e]+=1,e+Gj[e].toString()}const qj=["channelsFirst","channelsLast"],Kj=["nearest","bilinear"],Xj=["valid","same","causal"],Yj=["max","avg"],Qj=["sum","mul","concat","ave"],Jj=new Map;function $j(e){Lj(qj,"DataFormat",e)}function Zj(e){Lj(Xj,"PaddingMode",e)}function eV(e){Lj(Yj,"PoolMode",e)}const tV=[];function nV(e,t){tV.push(e);try{const e=t();return tV.pop(),e}catch(_se){throw tV.pop(),_se}}function rV(e){if(!iV(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===tV.length?"":tV.join("/")+"/")+e}function oV(e){if(!iV(e))throw new Error("Not a valid tensor name: '"+e+"'");Jj.has(e)||Jj.set(e,0);const t=Jj.get(e);if(Jj.set(e,Jj.get(e)+1),t>0){const n="".concat(e,"_").concat(t);return Jj.set(n,1),n}return e}const aV=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function iV(e){return!!e.match(aV)}function sV(e){return e===parseInt(e.toString(),10)}function cV(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let r=1;for(let o=t;o<n;++o)r*=e[o];return r}function lV(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function uV(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function dV(e,t){if(t<e)throw new bj("end (".concat(t,") < begin (").concat(e,") is forbidden."));const n=[];for(let r=e;r<t;++r)n.push(r);return n}let hV;function pV(){return null==hV&&(hV=dO().epsilon()),hV}function fV(e,t){return $O(e,t)}function mV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),AM(e,n)}function gV(e,t,n){return sO((()=>{switch(e.rank){case 1:return YP(e,t,n);case 2:return QP(e,[t,0],[n,e.shape[1]]);case 3:return JP(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return $P(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return XP(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return XP(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new bj("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function vV(e,t,n){return sO((()=>{switch(e.rank){case 1:return YP(e,t,n);case 2:return QP(e,[0,t],[e.shape[0],n]);case 3:return JP(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return $P(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new bj("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function yV(e,t,n,r){return sO((()=>{switch(e.rank){case 1:return YP(e,t,n);case 2:switch(r){case 1:return gV(e,t,n);case 2:return vV(e,t,n);default:throw new bj("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return gV(e,t,n);case 2:return JP(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return vV(e,t,n);default:throw new bj("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return gV(e,t,n);case 2:return $P(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return $P(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return vV(e,t,n);default:throw new bj("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new bj("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function bV(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(t=e[0].rank,n=0!==t?t:0),n===e[0].rank&&(n=-1),MM(e,n)}function xV(e,t){switch(e.rank){case 1:return PM([e,t]);case 2:return LM([e,t],0);case 3:return zM([e,t],0);case 4:return BM([e,t],0);default:throw new bj("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function wV(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new bj("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return eP(e,t)}function kV(e){return UP(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function SV(e,t,n,r){if(e.rank<2||t.rank<2)throw new xj("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3){if(e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new xj("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape))}if(2===e.rank&&2===t.rank){return TL({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?AV(e.rank,r,"channelsLast"):null,activation:n})}{const o=e.shape.slice(),a=o.pop();e=AM(e,[-1,a]);const i=t.shape.slice(),s=i.pop(),c=i.pop(),l=[...i,s],u=Array.from({length:t.rank},((e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n));t=AM(hL(t,u),[c,-1]);const d=[...o,...l];return AM(TL({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?AV(e.rank,r,"channelsLast"):null,activation:n}),d)}}function IV(e,t,n){return sO((()=>(t=Array.isArray(t)?aL(t,"int32"):$O(t,"int32"),rP(e,t,n))))}function CV(e){return oF(e,e)}function AV(e,t,n){const r=t.shape;if(1!==t.rank&&t.rank!==e)throw new bj("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?AM(t,[1,r[0],1,1,1]):AM(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?AM(t,[1,1,1,1,r[0]]):AM(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?AM(t,[1,r[0],1,1]):AM(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?AM(t,[1,1,1,r[0]]):AM(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?AM(t,[1,r[0],1]):AM(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?AM(t,[1,1,r[0]]):AM(t,[1].concat(r))}else if(e<3)return t;throw new bj("Unsupported input rank by biasAdd: ".concat(t.rank))}function EV(e,t,n){return sO((()=>(null==n&&(n="channelsLast"),$j(n),tF(e,AV(e.rank,t,n)))))}function TV(e,t,n,r){return sO((()=>pL(e,t,n,r)))}function NV(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}const RV=["fanIn","fanOut","fanAvg"],_V=["normal","uniform","truncatedNormal"];class DV extends hF{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class OV extends DV{apply(e,t){return DP(e,t)}}OV.className="Zeros",fF(OV);class FV extends DV{apply(e,t){return OP(e,t)}}FV.className="Ones",fF(FV);class MV extends DV{constructor(e){if(super(),"object"!==typeof e)throw new bj("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new bj("config must have value set but got ".concat(e));this.value=e.value}apply(e,t){return sO((()=>oF(lF(this.value),OP(e,t))))}getConfig(){return{value:this.value}}}MV.className="Constant",fF(MV);class PV extends DV{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return WP(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}PV.className="RandomUniform",fF(PV);class LV extends DV{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new xj("randomNormal does not support dType ".concat(t,"."));return kV(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}LV.className="RandomNormal",fF(LV);class zV extends DV{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new xj("truncatedNormal does not support dType ".concat(t,"."));return sL(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}zV.className="TruncatedNormal",fF(zV);class BV extends DV{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return sO((()=>{if(2!==e.length||e[0]!==e[1])throw new bj("Identity matrix initializer can only be used for 2D square matrices.");return oF(this.gain,tP(e[0]))}))}getConfig(){return{gain:this.gain}}}BV.className="Identity",fF(BV);class UV extends DV{constructor(e){if(super(),e.scale<0)throw new bj("scale must be a positive float. Got: ".concat(e.scale));var t;this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,t=this.mode,Lj(RV,"FanMode",t),this.distribution=null==e.distribution?"normal":e.distribution,function(e){Lj(_V,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){const n=function(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if($j(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){const r=cV(e,2);t=e[1]*r,n=e[0]*r}else if("channelsLast"===r){const r=cV(e,0,e.length-2);t=e[e.length-2]*r,n=e[e.length-1]*r}}else{const r=cV(e);t=Math.sqrt(r),n=Math.sqrt(r)}return[t,n]}(e),r=n[0],o=n[1];let a=this.scale;if("fanIn"===this.mode?a/=Math.max(1,r):"fanOut"===this.mode?a/=Math.max(1,o):a/=Math.max(1,(r+o)/2),"normal"===this.distribution){const n=Math.sqrt(a);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new xj("".concat(this.getClassName()," does not support dType ").concat(t,"."));return sL(e,0,n,t,this.seed)}{const n=Math.sqrt(3*a);return WP(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}UV.className="VarianceScaling",fF(UV);class WV extends UV{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return UV.className}}WV.className="GlorotUniform",fF(WV);class jV extends UV{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return UV.className}}jV.className="GlorotNormal",fF(jV);class VV extends UV{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return UV.className}}VV.className="HeNormal",fF(VV);class GV extends UV{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return UV.className}}GV.className="HeUniform",fF(GV);class HV extends UV{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return UV.className}}HV.className="LeCunNormal",fF(HV);class qV extends UV{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return UV.className}}qV.className="LeCunUniform",fF(qV);class KV extends DV{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return sO((()=>{if(e.length<2)throw new xj("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError("Unsupported data type ".concat(t,"."));const n=zE(e.slice(0,-1)),r=e[e.length-1],o=n*r;o>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(o,") elements: ")+"Slowness may result.");const a=kV([Math.max(r,n),Math.min(r,n)],0,1,t,this.seed),i=fz.qr(a,!1);let s=i[0];const c=i[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return s=oF(s,c.sign()),n<r&&(s=s.transpose()),oF(lF(this.gain),s.reshape(e))}))}getConfig(){return{gain:this.gain,seed:this.seed}}}KV.className="Orthogonal",fF(KV);const XV={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function YV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Oj(e,pF.getMap().classNameMap,t,"initializer")}function QV(e){return _j(e)}function JV(e){if("string"===typeof e){const t=e in XV?XV[e]:e;if("GlorotNormal"===t)return new jV;if("GlorotUniform"===t)return new WV;if("HeNormal"===t)return new VV;if("HeUniform"===t)return new GV;if("LeCunNormal"===t)return new HV;if("LeCunUniform"===t)return new qV;{const e={};return e.className=t,e.config={},YV(e)}}return e instanceof DV?e:YV(e)}function $V(e){return Array.isArray(e)&&Array.isArray(e[0])}function ZV(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function eG(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new bj("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function tG(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new bj("Expected exactly 1 Shape; got ".concat(e.length))}return e}function nG(e){let t=0;for(const n of e)0===n.shape.length?t+=1:t+=n.shape.reduce(((e,t)=>e*t));return t}const rG="Variable";class oG{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rG,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=Vj(),n=null==n?rG:n,this.originalName=rV(n),this.name=oV(this.originalName),this.trainable_=r,this.constraint=o,this.val=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return jD.makeVariable(e,t,n,r)}(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function aG(e){return e.map((e=>e.read()))}function iG(e){e.forEach((e=>{e[0].write(e[1])}))}class sG{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class cG{constructor(e,t,n,r,o,a,i){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=o,this.outputTensorIndex=i,this.id=Vj(),null!=a&&(this.originalName=rV(a),this.name=oV(this.originalName)),this.rank=t.length}}let lG=0;class uG{constructor(e,t){this.callArgs=t,this.id=lG++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const n of e.inboundLayers)null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let dG=0;class hG extends hF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=dG++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const e=this.getClassName();t=Tj(e)+"_"+Hj(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new yj("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new bj("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return Aj(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Aj(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new vj("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new vj("Layer ".concat(this.name)+" is not connected, no input to return.");return Aj(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new vj("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new vj("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Aj(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((e=>e()))}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach((t=>t.trainable=e)),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((e=>e.trainable)):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((e=>!e.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=Ej(e);if(null==this.inputSpec||0===this.inputSpec.length)return;const n=Ej(this.inputSpec);if(t.length!==n.length)throw new bj("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(e));for(let r=0;r<t.length;r++){const e=t[r],o=n[r];if(null==o)continue;const a=e.rank;if(null!=o.ndim&&a!==o.ndim)throw new bj("Input ".concat(r," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(o.ndim,", found ndim=").concat(a));if(null!=o.maxNDim&&a>o.maxNDim)throw new bj("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(o.maxNDim,", found ndim=").concat(a));if(null!=o.minNDim&&a<o.minNDim)throw new bj("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(o.minNDim,", found ndim=").concat(a,"."));if(null!=o.dtype&&e.dtype!==o.dtype)throw new bj("Input ".concat(r," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(o.dtype,", found dtype=").concat(e.dtype,"."));if(o.axes){const t=e.shape;for(const e in o.axes){const n=Number(e),a=o.axes[e],i=n>=0?t[n]:t[t.length+n];if(null!=a&&-1===[a,null].indexOf(i))throw new bj("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(n," of input shape to ")+"have value ".concat(a," but got shape ").concat(t,"."))}}if(null!=o.shape)for(let t=0;t<o.shape.length;++t){const n=o.shape[t],a=e.shape[t];if(null!=n&&null!=a&&n!==a)throw new bj("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(o.shape,", ")+"found shape=".concat(e.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=Ej(e),r=function(e){let t=!0;for(const n of Ej(e))if(!(n instanceof cG)){t=!1;break}return t}(e),o=function(e){let t=!0;for(const n of Ej(e))if(n instanceof cG){t=!1;break}return t}(e);if(r===o)throw new bj("Arguments to apply() must be all SymbolicTensors or all Tensors");return nV(this.name,(()=>{if(!this.built){this.assertInputCompatibility(e);const t=[];for(const n of Ej(e))t.push(n.shape);this.build(Aj(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let r=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,r);const o=Ej(r),a=[];for(let e of o)-1!==n.indexOf(e)&&(e=e.clone()),a.push(e);if(r=Aj(a),null!=this.activityRegularizer)throw new xj("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(e){e=Ej(e);const t=[];for(const n of e)t.push(n.shape);return Aj(t)}(e),r=this.computeOutputShape(n);let o;const a="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?n[0]:n),o=null!=r&&r.length>0&&Array.isArray(r[0])?r.map(((n,r)=>new cG(a,n,this,Ej(e),t,this.name,r))):new cG(a,r,this,Ej(e),t,this.name),this.addInboundNode(e,o,null,null,n,r,t),this._refCount++,null!=this.activityRegularizer)throw new xj("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}}))}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let t=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new vj("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new vj("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new yj("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return nG(this.weights)}build(e){this.built=!0}getWeights(){return aG(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(e){sO((()=>{const t=this.weights;if(t.length!==e.length)throw new bj('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(t.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0===t.length)return;const n=[],r=aG(t);for(let o=0;o<r.length;++o){const a=r[o],i=t[o],s=e[o];if(!BE(a.shape,s.shape))throw new bj("Layer weight shape ".concat(a.shape," ")+"not compatible with provided weight shape ".concat(s.shape));n.push([i,s])}iG(n)}))}addWeight(e,t,n,r,o,a,i,s){if(-1!==this._addedWeightNames.indexOf(e))throw new bj("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():JV("zeros"));const c=r.apply(t,n),l=new oG(c,n,e,a,i);return c.dispose(),null!=o&&this.addLoss((()=>o.apply(l.read()))),null==a&&(a=!0),a?this._trainableWeights.push(l):this._nonTrainableWeights.push(l),l}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=Ej(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((e=>{if(null!=e)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;const r=this.computeMask(e,n),o=Ej(t),a=Ej(r);if(o.length!==a.length)throw new Error("".concat(this.name," outputs ").concat(o.length," tensors ")+"but ".concat(o.length," masks for those tensors"));for(let i=0;i<o.length;i++)o[i].kerasMask=a[i]}addInboundNode(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const s=Ej(e);t=Ej(t),n=Ej(n),r=Ej(r),o=ZV(o),a=ZV(a);const c=[],l=[],u=[];for(const d of s)c.push(d.sourceLayer),l.push(d.nodeIndex),u.push(d.tensorIndex);new uG({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:u,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:o,outputShapes:a},i);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach((e=>e.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function pG(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{const e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{const t=[];for(let n=0;n<e.inboundLayers.length;n++){const r=pG(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(const e of r)-1===t.indexOf(e)&&t.push(e)}return t}}}class fG extends hG{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:Hj("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new bj("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new bj("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new bj("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const r=new cG(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new uG({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new bj("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}fG.className="InputLayer",fF(fG);class mG{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof mG)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new bj("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return $O(t,e.dtype)}catch(Dse){throw new bj("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof cG){if(null==this.id2Value[e.id])throw new bj("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}{const t=this.name2Id[e];if(null==t)throw new bj("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof cG){if(null==this.id2Value[e.id])throw new bj("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}{const t=this.name2Id[e];if(null==t)throw new bj("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&cO(this.id2Mask)}}const gG=new kj,vG=new kj;function yG(e,t,n,r){const o=null!=n&&n.training,a=Array.isArray(e),i=a?e:[e],s=i.map((e=>e.name)),c=[],l=t.names();for(const f of s)-1!==l.indexOf(f)?c.push(t.getValue(f)):c.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const u=s.join(",")+"|"+t.names().sort().join(",");let d,h=gG.get(u);if(null==h){const e=function(e,t){ME(null!=e&&e.length>0,(()=>"Expected at least one fetch, got none"));let n=[],r={};if(1===e.length){const o=xG(e[0],t);n=o.sorted,r=o.recipientMap}else{const o=new Set;for(const a of e){const{sorted:e,recipientMap:i}=xG(a,t);for(const t of e)o.has(t.name)||(n.push(t),o.add(t.name));for(const t in i)null==r[t]&&(r[t]=new Set),i[t].forEach((e=>r[t].add(e)))}}return{sorted:n,recipientCounts:bG(r)}}(i,t);h=e.sorted,d=e.recipientCounts,gG.put(u,h),vG.put(u,d)}d={},o||Object.assign(d,vG.get(u));const p=new mG(t);for(let f=0;f<h.length;++f){if(null!=r){const e=iO().numTensors;e>r.maxNumTensors&&(r.maxNumTensors=e),e<r.minNumTensors&&(r.minNumTensors=e)}const e=h[f],a=e.sourceLayer;if(a instanceof fG)continue;const i=[],l=[],u=[];let m=!1;for(const n of e.inputs){const e=p.getValue(n),r=p.getMask(n);i.push(e),l.push(r),null!=r&&(m=!0),o||(d[n.name]--,0!==d[n.name]||t.hasKey(n)||-1!==s.indexOf(n.name)||e.isDisposed||!0===n.sourceLayer.stateful||u.push(e))}m&&((n=n||{}).mask=l[0]);const g=Ej(a.apply(i,n));let v=null;a.supportsMasking&&(v=a.computeMask(i,l));const y=wG(e),b=Array.isArray(y)?y:[y];for(let t=0;t<b.length;++t){p.hasKey(b[t])||p.add(b[t],g[t],Array.isArray(v)?v[0]:v);const e=s.indexOf(b[t].name);-1!==e&&(c[e]=g[t])}o||cO(u)}return p.disposeMasks(),a?c:c[0]}function bG(e){const t={};for(const n in e)t[n]=e[n].size;return t}function xG(e,t){const n=new Set,r=[],o={};for(const s of t.names())n.add(s);const a=[],i=[];for(a.push(e);a.length>0;){const e=a[a.length-1];if(n.has(e.name)){a.pop();continue}const t=i[i.length-1]===a.length-1;if(0===e.inputs.length||t)a.pop(),r.push(e),n.add(e.name),t&&i.pop();else{i.push(a.length-1);for(const t of e.inputs)null==o[t.name]&&(o[t.name]=new Set),o[t.name].add(e.name),n.has(t.name)||a.push(t)}}return{sorted:r,recipientMap:o}}function wG(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(const r of e.sourceLayer.inboundNodes[t].outputTensors)if(r.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}function kG(e,t){return sO((()=>aF(uP(oF(e,e),t,!0))))}mT().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(()=>100),(function(e){null!=gG&&gG.setMaxEntries(e),null!=vG&&vG.setMaxEntries(e)}));class SG extends hF{getConfig(){return{}}}class IG extends SG{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return sO((()=>{const t=kG(e,this.axis),n=FM(t,0,this.maxValue);return oF(e,rF(n,tF(pV(),t)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}IG.className="MaxNorm",fF(IG);class CG extends SG{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return sO((()=>rF(e,tF(pV(),kG(e,this.axis)))))}getConfig(){return{axis:this.axis}}}CG.className="UnitNorm",fF(CG);class AG extends SG{apply(e){return VP(e)}}AG.className="NonNeg",fF(AG);class EG extends SG{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return sO((()=>{const t=kG(e,this.axis),n=tF(oF(this.rate,FM(t,this.minValue,this.maxValue)),oF(1-this.rate,t));return oF(e,rF(n,tF(pV(),t)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}EG.className="MinMaxNorm",fF(EG);const TG={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function NG(e){return _j(e)}function RG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Oj(e,pF.getMap().classNameMap,t,"constraint")}function _G(e){if(null==e)return null;if("string"===typeof e){return RG({className:e in TG?TG[e]:e,config:{}})}return e instanceof SG?e:RG(e)}async function DG(e){if(null==e)return;const t=[],n=[],r=[];for(const o in e){const a=e[o];if("number"!==typeof a){const e=a;t.push(e.data()),n.push(o),r.push(e)}}if(t.length>0){const o=await Promise.all(t);for(let t=0;t<o.length;++t)e[n[t]]=o[t][0];cO(r)}}function OG(e){if(null!=e)for(const t in e){const n=e[t];"number"!==typeof n&&n.dispose()}}var FG;!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(FG||(FG={}));class MG{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class PG{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class LG extends MG{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});const n=null==t.size?0:t.size;this.seen+=n;for(const r in t){const e=t[r];if("number"===typeof e)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+e*n;else{let t;r in this.totals?t=this.totals[r]:this.totals[r]=0;const o=sO((()=>tF(this.totals[r],oF(e,n))));this.totals[r]=o,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?t[n]=this.totals[n]/this.seen:sO((()=>{const e=oF(rF(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),lO(t[n])})))}}class zG extends MG{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(const n in t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){const e=[],t=[],n=[];for(const o in this.history){const r=this.history[o];for(let a=0;a<r.length;++a)if("number"!==typeof r[a]){const i=r[a];e.push(i.data()),t.push(o),n.push(a)}}const r=await Promise.all(e);for(let o=0;o<r.length;++o){this.history[t[o]][n[o]].dispose(),this.history[t[o]][n[o]]=r[o][0]}}}class BG extends MG{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||vz,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");$E(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let r,o=null!=n?n():oD();return function(){const a=null!=n?n():oD();return a-o<t||(o=a,r=e(...arguments)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const r=[];null!=this.yield&&(await DG(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await DG(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];null!=this.epochEnd&&(await DG(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await DG(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];null!=this.batchEnd&&(await DG(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):$E(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await DG(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await DG(e),await this.trainEnd(e))}}function UG(e,t){if(null==e&&(e={}),e instanceof MG)return[e];if(Array.isArray(e)&&e[0]instanceof MG)return e;return Ej(e).map((e=>new BG(e,t)))}class WG{constructor(){}static registerCallbackConstructor(e,t){ME(e>=0&&Number.isInteger(e),(()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(e))),WG.checkForDuplicate(t),null==WG.constructors[e]&&(WG.constructors[e]=[]),WG.constructors[e].push(t)}static checkForDuplicate(e){for(const t in WG.constructors){WG.constructors[+t].forEach((t=>{if(t===e)throw new bj("Duplicate callback constructor.")}))}}static clear(){WG.constructors={}}static createCallbacks(e){const t=[];for(const n in WG.constructors){const r=+n;e>=r&&t.push(...WG.constructors[r])}return t.map((e=>new e))}}function jG(e,t,n,r,o,a,i,s,c){const l=new zG,u=[new LG,...WG.createCallbacks(t)];null!=e&&u.push(...e),u.push(l);const d=new PG(u);return d.setParams({epochs:n,initialEpoch:r,samples:o,steps:a,batchSize:i,verbose:t,doValidation:s,metrics:c}),{callbackList:d,history:l}}function VG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Oj(e,pF.getMap().classNameMap,t,"layer",n)}function GG(e,t){return sO((()=>{"float32"!==e.dtype&&(e=$O(e,"float32"));const n=uP(CV(e),t,!0),r=vF(n.shape,pV()),o=aF(AF(n,r));return rF(e,o)}))}function HG(e,t){return sO((()=>CP(CV(xF(t,e)),-1)))}function qG(e,t){return sO((()=>CP(kF(xF(t,e)),-1)))}function KG(e,t){return sO((()=>{const n=xF(e,t),r=FM(kF(e),pV(),Number.MAX_VALUE),o=kF(rF(n,r));return oF(100,CP(o,-1))}))}function XG(e,t){return sO((()=>{const n=FM(t,pV(),Number.MAX_VALUE),r=sP(tF(1,n)),o=FM(e,pV(),Number.MAX_VALUE),a=sP(tF(1,o));return CP(CV(xF(r,a)),-1)}))}function YG(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return sO((()=>{if(n)t=ZP(t);else{const e=uP(t,t.shape.length-1,!0);t=rF(t,e)}return t=FM(t,pV(),1-pV()),NP(uP(oF($O(e,"float32"),sP(t)),t.shape.length-1))}))}function QG(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return sO((()=>{const r=$O(nP(function(e){const t=[cV(e.shape)];return AM(e,t)}(e)),"int32"),o=(t=FM(t,pV(),1-pV())).shape;return YG(AM(_P(r,o[o.length-1]),o),t,n)}))}function JG(e,t){return sO((()=>{let n;return n=FM(t,pV(),1-pV()),n=sP(rF(n,xF(1,n))),CP(function(e,t){if(!BE(e.shape,t.shape))throw new bj("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return sO((()=>{const n=VP(t),r=NP(kF(t));return tF(xF(n,oF(t,e)),cP($M(r)))}))}(e,n),-1)}))}function $G(e,t){return sO((()=>{const n=FM(e,pV(),1),r=FM(t,pV(),1);return uP(oF(e,sP(rF(n,r))),-1)}))}function ZG(e,t){return sO((()=>{const n=GG(e,-1),r=GG(t,-1),o=oF(n,r);return NP(uP(o,-1))}))}WG.constructors={};const eH={meanSquaredError:HG,meanAbsoluteError:qG,meanAbsolutePercentageError:KG,meanSquaredLogarithmicError:XG,squaredHinge:function(e,t){return sO((()=>{const n=AF(0,xF(1,oF(e,t)));return CP(CV(n),-1)}))},hinge:function(e,t){return sO((()=>{const n=AF(0,xF(1,oF(e,t)));return CP(n,-1)}))},categoricalHinge:function(e,t){return sO((()=>{const n=uP(oF(e,t),-1),r=lP(oF(xF(1,e),t),-1);return AF(0,tF(1,xF(r,n)))}))},logcosh:function(e,t){return sO((()=>{const n=Math.log(2),r=xF(t,e),o=xF(tF(r,eL(oF(-2,r))),n);return CP(o,-1)}))},categoricalCrossentropy:YG,sparseCategoricalCrossentropy:QG,binaryCrossentropy:JG,kullbackLeiblerDivergence:$G,poisson:function(e,t){return sO((()=>{const n=sP(tF(pV(),t));return CP(xF(t,oF(e,n)),-1)}))},cosineProximity:ZG};function tH(e){if("string"===typeof e){if(e in eH)return eH[e];let t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new bj(t)}return e}function nH(e,t){return sO((()=>{const n=oF(.5,FP(t)),r=fV(oP(t,n),e.dtype);return CP(QM(e,r),-1)}))}function rH(e,t){return sO((()=>fV(QM(uM(e,-1),uM(t,-1)),"float32")))}function oH(e,t){return sO((()=>$O(uP(wP(QM(e,1),QM(t,1))),"float32")))}function aH(e,t){return JG(e,t)}function iH(e,t){return e.rank===t.rank&&(e=nL(e,[e.rank-1])),(t=uM(t,-1)).dtype!==e.dtype&&(t=$O(t,e.dtype)),$O(QM(e,t),"float32")}const sH=YG,cH=QG,lH={binaryAccuracy:nH,categoricalAccuracy:rH,precision:function(e,t){return sO((()=>{const n=oH(e,t),r=function(e,t){return sO((()=>$O(uP(wP(QM(e,0),QM(t,1))),"float32")))}(e,t),o=tF(n,r);return $O(lL(oP(o,0),rF(n,o),0),"float32")}))},categoricalCrossentropy:sH,sparseCategoricalCrossentropy:cH,mse:HG,MSE:HG,mae:qG,MAE:qG,mape:KG,MAPE:KG,cosine:ZG};function uH(e){if("string"===typeof e&&e in lH)return lH[e];if("string"!==typeof e&&null!=e)return e;throw new bj("Unknown metric ".concat(e))}function dH(e){if(Ij(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;{let t;for(const n of Object.keys(eH))if(eH[n]===e){t=n;break}if(void 0!==t)return t;for(const n of Object.keys(lH))if(lH[n]===e){t=n;break}return void 0!==t?t:e.name}}const hH=1048576;function pH(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!fH(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(e);n.length>hH&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(hH,"."))}}function fH(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t){if("string"!==typeof n)return!1;if(!fH(e[n]))return!1}return!0}if(Array.isArray(e)){for(const t of e)if(!fH(t))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function mH(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const o=function(e){let t=!0;const n=[],r=[];for(const o in e.nodesByDepth)n.push(e.nodesByDepth[o]);for(const o of n){if(o.length>1||1===o.length&&o[0].inboundLayers.length>1){t=!1;break}r.push(...o)}if(t)for(const o of e.layers){let e=!1;for(const n of o.inboundNodes)if(-1!==r.indexOf(n)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),a=["Layer (type)","Input Shape","Output shape","Param #"];let i;if(o?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((e=>Math.floor(t*e)))),!o){a.push("Receives inputs"),i=[];for(const t in e.nodesByDepth)i.push(...e.nodesByDepth[t])}r("_".repeat(t)),gH(a,n,r),r("=".repeat(t));const s=e.layers;for(let u=0;u<s.length;++u)o?vH(s[u],n,r):yH(s[u],n,i,r),r((u===s.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const c=function(e){let t;t=null!=e.collectedTrainableWeights?nG(e.collectedTrainableWeights):nG(e.trainableWeights);return t}(e),l=nG(e.nonTrainableWeights);r("Total params: ".concat(c+l)),r("Trainable params: ".concat(c)),r("Non-trainable params: ".concat(l)),r("_".repeat(t))}function gH(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="";for(let o=0;o<e.length;++o)o>0&&(r=r.slice(0,r.length-1)+" "),r+=e[o],r=r.slice(0,t[o]),r+=" ".repeat(t[o]-r.length);n(r)}function vH(e,t,n){let r,o;try{o=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(Dse){o="multiple"}try{r=JSON.stringify(e.outputShape)}catch(Dse){r="multiple"}const a=e.name,i=e.getClassName();gH(["".concat(a," (").concat(i,")"),o,r,e.countParams().toString()],t,n)}function yH(e,t,n,r){let o,a;try{a=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(Dse){a="multiple"}try{o=JSON.stringify(e.outputShape)}catch(Dse){o="multiple"}const i=[];for(const u of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(let e=0;e<u.inboundLayers.length;++e){const t=u.inboundLayers[e].name,n=u.nodeIndices[e],r=u.tensorIndices[e];i.push("".concat(t,"[").concat(n,"][").concat(r,"]"))}const s=e.name,c=e.getClassName(),l=0===i.length?"":i[0];gH(["".concat(s," (").concat(c,")"),a,o,e.countParams().toString(),l],t,r);for(let u=1;u<i.length;++u)gH(["","","","",i[u]],t,r)}function bH(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function xH(e,t){if(null===e)return null;if("string"===typeof e)return Nj(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let o=0;o<r;++o){const r=e[o];bH(t,o,r)?n.push(r):n.push(xH(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n];if("name"===n&&"string"===typeof r)t[n]=r;else{const e=Nj(n);t[e]=xH(r,e)}}return t}}function wH(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return Tj(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let o=0;o<r;++o){const r=e[o];bH(t,o,r)?n.push(r):n.push(wH(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n],o=Tj(n);t[o]="name"!==n&&"className"!==n||"string"!==typeof r?wH(r,n):r}return t}}const kH="4.22.0";class SH extends hG{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,null==this.name){const e=this.getClassName().toLowerCase();this.name=Hj(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Mj(this.inputs).length!==this.inputs.length)throw new bj("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map((e=>e.name))));Mj(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map((e=>e.name)))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const e=v.sourceLayer,t=v.nodeIndex,n=v.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(n)}for(const v of this.inputs){const e=v.sourceLayer,t=v.nodeIndex,n=v.tensorIndex;Ij(0===t,"input layer has >1 nodes"),Ij(0===n,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(t),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const t=this.inputLayers[v];if(!(t instanceof fG))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(v," (0-based) originates ")+"from layer type ".concat(t.getClassName(),"."));this.inputNames.push(t.name),this.feedInputShapes.push(t.batchInputShape),this.feedInputNames.push(t.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map((e=>e.shape)),this.internalOutputShapes=this.outputs.map((e=>e.shape));const t={},n={},r={},o={},a={},i=[],s=(e,t,n,r,o,c)=>{null!=r&&null!=o&&null!=c||(r=e.sourceLayer,o=e.nodeIndex,c=e.tensorIndex);const l=r.inboundNodes[o];if(-1!==n.indexOf(l))throw new yj("The tensor ".concat(e.name,' at layer "').concat(r.name,'" ')+"is part of a cycle.");if(-1!==t.indexOf(l))return;this.containerNodes.add(SH.nodeKey(r,o)),r.id in a||(a[r.id]=Object.keys(a).length),-1===n.indexOf(l)&&n.push(l);const u=l.inboundLayers.length;for(let a=0;a<u;a++){const e=l.inputTensors[a],r=l.inboundLayers[a],o=l.nodeIndices[a],i=l.tensorIndices[a];s(e,t,n,r,o,i)}for(t.push(l);n.indexOf(l)>=0;)n.splice(n.indexOf(l),1);i.push(l)},c=[],l=[];for(const v of this.outputs)s(v,c,l);const u=i.slice().reverse();for(const v of u){n[v.id]=v,v.id in t||(t[v.id]=0);let e=t[v.id];const a=null==r[v.outboundLayer.id]?0:r[v.outboundLayer.id];e=Math.max(e,a),r[v.outboundLayer.id]=e,o[v.outboundLayer.id]=v.outboundLayer,t[v.id]=e;for(let r=0;r<v.inboundLayers.length;r++){const o=v.inboundLayers[r],a=v.nodeIndices[r],i=o.inboundNodes[a],s=null==t[i.id]?0:t[i.id];t[i.id]=Math.max(e+1,s),n[i.id]=i}}const d={};for(const v in t){const e=t[v];e in d||(d[e]=[]),d[e].push(n[v])}const h={};for(const v in r){const e=r[v];e in h||(h[e]=[]),h[e].push(o[v])}let p=Object.keys(h).map((e=>parseInt(e,10))).sort(Fj);this.layers=[];for(const v of p){const e=h[v];e.sort(((e,t)=>{const n=a[e.id],r=a[t.id];return n<r?-1:n>r?1:0}));for(const t of e)t instanceof SH&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=h,p=Object.keys(d).map((e=>parseInt(e,10))).sort(Fj);const f=this.inputs.slice(),m=[];for(const v of p)for(const e of d[v]){const t=e.outboundLayer;if(null!=t){for(const n of e.inputTensors)if(-1===f.indexOf(n))throw new yj("Graph disconnected: cannot obtain value for tensor ".concat(n)+' at layer "'.concat(t.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(m));for(const t of e.outputTensors)f.push(t);m.push(t.name)}}this.nodesByDepth=d;const g=this.layers.map((e=>e.name));for(const v of g){const e=g.filter((e=>e===v)).length;if(1!==e)throw new yj('The name "'.concat(v,'" is used ').concat(e," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new uG({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((e=>null)),outputMasks:this.outputs.map((e=>null)),inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs.map((e=>e.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach((t=>{t._trainableWeights.forEach((t=>t.trainable=e))})),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new bj("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let r=0;const o=(e=>{const t=Object.keys(e);if(0===t.length)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(e);o&&this.parseWeights(e);for(const i of this.layers)for(const[e,t]of i.weights.entries()){const a=o?"".concat(t.name.split("/").slice(0,-1).join("/")+"/").concat(e):t.originalName;if(null!=n[a])throw new bj("Duplicate weight name: ".concat(a));n[a]=t,r++}const a=[];for(const i in e){let r=i;if(null==n[i]){const e=i.split("/");r=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[r])a.push([n[r],e[i]]);else if(t)throw new bj("Provided weight data has no target variable: ".concat(i));delete n[r]}if(t){const e=[];for(const t in n)e.push(t);if(e.length>0)throw new bj("".concat(e.length," of ").concat(r," weights are not set: ")+"".concat(e))}iG(a)}parseWeights(e){for(const t in Object.keys(e)){const n=t.split("/"),r=["vars","layer_checkpoint_dependencies"],o=n.map((e=>e.startsWith("_")?e.slice(1):e)).filter((e=>!r.includes(e))).join("/");o!==t&&(e[o]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(kH),t.backend="TensorFlow.js",t}toJSON(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=wH(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return sO((()=>{e=Ej(e);const n=new mG;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return yG(this.outputs,n,t)}))}computeMask(e,t){return sO((()=>{let n;return e=Ej(e),n=null==t?Sj(null,e.length):Ej(t),this.runInternalGraph(e,n)[1]}))}computeOutputShape(e){const t=ZV(e);if(t.length!==this.inputLayers.length)throw new bj("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let i=0;i<t.length;i++){const e=this.inputLayers[i],r=t[i];n[e.name+"_0_0"]=r}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(Fj);if(r.length>1)for(const i of r){const e=this.nodesByDepth[i];for(const t of e){const e=t.outboundLayer;if(-1!==this.inputLayers.map((e=>e.id)).indexOf(e.id))continue;const r=[];for(let i=0;i<t.inboundLayers.length;i++){const e=t.inboundLayers[i],o=t.nodeIndices[i],a=t.tensorIndices[i],s=n["".concat(e.name,"_").concat(o,"_").concat(a)];r.push(s)}const o=ZV(e.computeOutputShape(Aj(r))),a=e.inboundNodes.indexOf(t);for(let t=0;t<o.length;t++){n["".concat(e.name,"_").concat(a,"_").concat(t)]=o[t]}}}const o=[],a=[];for(let i=0;i<this.outputLayers.length;i++){const e=this.outputLayers[i],t=this.outputLayersNodeIndices[i],n=this.outputLayersTensorIndices[i],r="".concat(e.name,"_").concat(t,"_").concat(n);a.push(r)}for(let i=0;i<a.length;i++){const e=a[i];Ij(e in n),o.push(n[e])}return Aj(o)}runInternalGraph(e,t){null==t&&(t=Sj(null,e.length));const n={};for(let s=0;s<this.inputs.length;++s){const r=this.inputs[s],o=e[s],a=t[s];n[r.id]=[o,a]}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(Fj);for(const s of r){const e=this.nodesByDepth[s];for(const t of e){const e=t.outboundLayer,r=t.inputTensors,o=t.outputTensors,a=new Array;for(const t of r)t.id in n&&a.push(n[t.id]);if(a.length===r.length){let r,i,s,c,l={};if(null!=t.callArgs&&(l=t.callArgs),1===a.length){const[t,n]=a[0];null==l.mask&&(l.mask=n),s=Ej(e.call(t,l)),c=Ej(e.computeMask(t,n)),r=[t],i=[n]}else r=a.map((e=>e[0])),i=a.map((e=>e[1])),null==l.mask&&(l.mask=i),s=Ej(e.call(r,l)),c=Ej(e.computeMask(r,i));if(e.activityRegularizer)throw new xj("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<o.length;++e){const t=o[e],r=s[e],a=c[e];n[t.id]=[r,a]}}}}const o=[],a=[],i=[];for(const s of this.outputs){Ij(s.id in n,"Could not compute output ".concat(s.name," : ").concat(s.id));const[e,t]=n[s.id];i.push(e.shape),o.push(e),a.push(t)}return[o,a,i]}buildNodeConversionMap(e){const t={};let n;for(const r of this.layers){n=r instanceof SH?1:0;for(let e=0;e<r.inboundNodes.length;e++){const o=SH.nodeKey(r,e);this.containerNodes.has(o)&&(t[o]=n,n+=1)}}return t}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new bj("Provide either a layer name or layer index");if("number"===typeof e)return this.findLayer(e);for(const n of this.layers)if(n.name===e)return n;throw new bj("No such layer: ".concat(e))}findLayer(e){if(this.layers.length<=e)throw new bj("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}calculateLosses(){return sO((()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const r=SH.nodeKey(t,n);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e}))}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const a of this.layers){const e=a.getClassName(),r=a.getConfig(),o=[];for(let n=0;n<a.inboundNodes.length;n++){const e=a.inboundNodes[n],r=SH.nodeKey(a,n);let i={};if(this.containerNodes.has(r)){if(e.callArgs)try{JSON.stringify(e.callArgs),i=e.callArgs}catch(Dse){console.warn("Layer ".concat(a.name," was passed ")+"non-serializable keyword arguments: "+"".concat(e.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),i={}}if(e.inboundLayers.length>0){const n=[];for(let r=0;r<e.inboundLayers.length;r++){const o=e.inboundLayers[r],a=e.nodeIndices[r],s=e.tensorIndices[r];let c=t[SH.nodeKey(o,a)];null==c&&(c=0),n.push([o.name,c,s,i])}o.push(n)}}}const i={};i.name=a.name,i.className=e,i.config=r,i.inboundNodes=o,n.push(i)}e.layers=n;const r=[];for(let a=0;a<this.inputLayers.length;a++){const e=this.inputLayers[a],n=this.inputLayersNodeIndices[a],o=SH.nodeKey(e,n);if(!this.containerNodes.has(o))continue;let i=t[o];null!==i&&void 0!==i||(i=0);const s=this.inputLayersTensorIndices[a];r.push([e.name,i,s])}e.inputLayers=r;const o=[];for(let a=0;a<this.outputLayers.length;a++){const e=this.outputLayers[a],n=this.outputLayersNodeIndices[a],r=SH.nodeKey(e,n);if(!this.containerNodes.has(r))continue;let i=t[r];null!==i&&void 0!==i||(i=0);const s=this.outputLayersTensorIndices[a];o.push([e.name,i,s])}return e.outputLayers=o,e}static fromConfig(e,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={},o={};function a(e,t){e.name in o?o[e.name].push(t):o[e.name]=[t]}function i(e,t){const n=[];let o;for(const i of t){const s=i[0],c=i[1],l=i[2];if(o=null==i[3]?{}:i[3],!(s in r))return void a(e,t);const u=r[s];if(u.inboundNodes.length<=c)return void a(e,t);const d=u.inboundNodes[c];n.push(d.outputTensors[l])}n.length>0&&e.apply(Aj(n),o)}function s(e){const o=e.name,i=VG(e,null!=t.customObjects?t.customObjects:{});i.setFastWeightInitDuringBuild(n),r[o]=i;e.inboundNodes.forEach((e=>{if(!(e instanceof Array))throw new bj("Corrupted configuration, expected array for nodeData: ".concat(e));a(i,e)}))}const c=t.name,l=t.layers;for(const f of l)s(f);for(;!Pj(o);)for(const e of l){const t=r[e.name];if(t.name in o){const e=o[t.name];delete o[t.name];for(const n of e)i(t,n)}}const u=[],d=[],h=t.inputLayers;for(const f of h){const e=f[0],t=f[1],n=f[2];Ij(e in r);const o=r[e].inboundNodes[t].outputTensors;u.push(o[n])}const p=t.outputLayers;for(const f of p){const e=f[0],t=f[1],n=f[2];Ij(e in r);const o=r[e].inboundNodes[t].outputTensors;d.push(o[n])}return new e({inputs:u,outputs:d,name:c})}get stateful(){if(this._stateful)throw new bj("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){sO((()=>{this.layers.forEach((e=>{e.stateful&&e.resetStates()}))}))}}function IH(e,t,n){const r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>null));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){const n=[];return t.forEach((t=>{t in e?n.push(e[t]):n.push(null)})),n}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function CH(e,t){return IH(e,t,"classWeight")}async function AH(e,t,n,r){if(null!=t||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const t=sO((()=>{if(1===e.shape.length)return ZO(e);if(2===e.shape.length){if(e.shape[1]>1){return uM(e,1)}if(1===e.shape[1])return AM(e,[e.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(e.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(e.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),r=Array.from(await t.data());cO(t);const o=[];return r.forEach((e=>{if(null==n[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");o.push(n[e])})),aL(o,"float32")}return null}function EH(e,t){return oF(e,t)}function TH(e,t){let n,r;const o=t;n=o.xs,r=o.ys,ME(null!=n&&null!=r,(()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)));const a=NH("input",e.inputNames,n),i=NH("output",e.outputNames,r),s=a[0].shape[0];ME(a.length===e.inputs.length,(()=>"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(a.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")"))),ME(i.length===e.outputs.length,(()=>"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(i.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")));for(let c=0;c<a.length;c++)ME(a[c].shape[0]===s,(()=>"Batch size mismatch: input "+"".concat(e.inputNames[c]," has ").concat(a[c].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")));for(let c=0;c<i.length;c++)ME(i[c].shape[0]===s,(()=>"Batch size mismatch: output "+"".concat(e.outputNames[c]," has ").concat(i[c].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")));return{xs:a,ys:i}}function NH(e,t,n){if(n instanceof wD)return[n];if(Array.isArray(n))return ME(n.length===t.length,(()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,"."))),n;{const r=[];for(const o of t){if(null==n[o])throw new bj("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(o,"'."));r.push(n[o])}return r}}async function RH(e,t,n){const r=null!=n.batchesPerEpoch;if(ME(null!=e.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),ME(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),ME(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs))),ME(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch))),ME(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const o=null!=n.validationData;let a,i;if(o)if(_H(n.validationData))ME(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches)));else{const e=function(e){if(3===e.length)throw new xj("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);a=e.xs,i=e.ys}const s=e.makeTrainFunction(),c=e.getDedupedMetricsNames();let l;l=o?c.slice().concat(c.map((e=>"val_"+e))):c.slice();const u=UG(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:h,history:p}=jG(u,d,n.epochs,null,null,function(e,t){let n=null;null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size);return n}(t,n),null,o,l);h.setModel(e),e.history=p,await h.onTrainBegin(),e.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,m=await t.iterator();for(;f<n.epochs;){const l={};await h.onEpochBegin(f);let u=0,d=0;for(r||(m=await t.iterator());!r||u<n.batchesPerEpoch;){const t=await m.next();if(r&&t.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(u," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(null!=t.value){const{xs:r,ys:o}=TH(e,t.value),a={};a.batch=d,a.size=r[0].shape[0],await h.onBatchBegin(d,a);const i=[];if(null!=n.classWeight){const t=CH(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)i.push(await AH(o[e],null,t[e]))}const l=r.concat(o).concat(i),p=s(l);cO(l);for(let e=0;e<c.length;++e){const t=c[e],n=p[e];a[t]=n,lO(n)}await h.onBatchEnd(d,a),OG(a),d++,u++}if(r?u>=n.batchesPerEpoch:t.done){if(o){let t;t=_H(n.validationData)?Ej(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):Ej(e.evaluate(a,i,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)l["val_".concat(e.metricsNames[n])]=t[n]}break}if(e.stopTraining_)break}if(await h.onEpochEnd(f,l),f++,e.stopTraining_)break}return await h.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function _H(e){return"function"===typeof e.iterator}function DH(e){ME(e>0&&Number.isInteger(e),(()=>"batchSize is required to be a positive integer, but got ".concat(e)))}function OH(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((e=>gV(e,t,n-t))):gV(e,t,n-t)}function FH(e,t){return sO((()=>null==e?null:Array.isArray(e)?e.map((e=>FH(e,t))):IV(e,"int32"===t.dtype?t:$O(t,"int32"))))}function MH(e,t){const n=[];let r=0,o=null;for(;r<e;)o=r+t,o>=e&&(o=e),n.push([r,o]),r=o;return n}function PH(e){const t=[];e instanceof wD&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(1===r.rank)t.push(mV(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function LH(e,t){if(null==e)return;const n=[];if(t instanceof wD)n.push(t.id);else if(Array.isArray(t))t.forEach((e=>n.push(e.id)));else if(null!=t)for(const o in t){const e=t[o];n.push(e.id)}const r=[];if(e instanceof wD)-1===n.indexOf(e.id)&&r.push(e);else if(Array.isArray(e))e.forEach((e=>{-1===n.indexOf(e.id)&&r.push(e)}));else if(null!=e)for(const o in e){const t=e[o];-1===n.indexOf(t.id)&&r.push(t)}r.forEach((e=>{e.isDisposed||e.dispose()}))}function zH(e){return Array.isArray(e)}function BH(e){return!function(e){return e instanceof wD}(e)&&!zH(e)}function UH(e,t,n){let r,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){let t=!1;if(zH(e)&&e.length>0)t=!0;else if(BH(e)){for(const n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new bj("Error when checking model ".concat(a," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((e=>null));if(BH(e)){r=[];for(const n of t){if(null==e[n])throw new bj('No data provided for "'.concat(n,'". Need data for each key in: ')+"".concat(t));r.push(e[n])}}else if(zH(e)){if(e.length!==t.length)throw new bj("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new bj("The model ".concat(a," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=PH(r),null!=n)for(let i=0;i<t.length;++i){if(null==n[i])continue;const e=r[i];if(e.shape.length!==n[i].length)throw new bj("Error when checking ".concat(a,": expected ").concat(t[i]," ")+"to have ".concat(n[i].length," dimension(s). but got array with ")+"shape ".concat(e.shape));for(let t=0;t<n[i].length;++t){if(0===t&&!o)continue;const r=e.shape[t],s=n[i][t];if(null!=s&&s>=0&&r!==s)throw new bj("".concat(a," expected a batch of elements where each ")+"example has shape [".concat(n[i].slice(1,n[i].length),"] ")+"(i.e.,tensor shape [*,".concat(n[i].slice(1,n[i].length),"])")+" but the ".concat(a," received an input with ").concat(e.shape[0])+" examples, each with shape [".concat(e.shape.slice(1,e.shape.length),"]")+" (tensor shape [".concat(e.shape,"])"))}}return r}function WH(e,t,n){let r,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new bj("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new bj("The model expects ".concat(t.length," ").concat(a," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(let i=0;i<t.length;++i){if(null==n[i])continue;const e=r[i];if(e.shape.length!==n[i].length)throw new bj("Error when checking ".concat(a,": expected ").concat(t[i]," ")+"to have ".concat(n[i].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(e.shape)));for(let r=0;r<n[i].length;++r){if(0===r&&!o)continue;const s=e.shape[r],c=n[i][r];if(null!=c&&c!==s)throw new bj("Error when checking ".concat(a,": expected ")+"".concat(t[i]," to have shape ").concat(JSON.stringify(n[i])," but ")+"got array with shape ".concat(JSON.stringify(e.shape),"."))}}}class jH extends SH{constructor(e){super(e),this.isTraining=!1}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new bj("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");mH(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){const t={Adagrad:()=>mz.adagrad(.01),Adadelta:()=>mz.adadelta(1,.95,pV()),Adam:()=>mz.adam(.001,.9,.999,pV()),Adamax:()=>mz.adamax(.002,.9,.999,pV(),0),RMSProp:()=>mz.rmsprop(.001,.9,0,pV()),SGD:()=>mz.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new bj("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof mF))throw new bj("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new bj("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));const n=e.loss;t=n.map((e=>tH(e)))}else{const n=tH(e.loss);this.outputs.forEach((e=>{t.push(n)}))}else{e.loss=e.loss;for(const t in e.loss)if(-1===this.outputNames.indexOf(t))throw new bj('Unknown entry in loss dictionary: "'.concat(t,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const n of this.outputNames)null==e.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(n," during training")),t.push(tH(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const e=this.internalOutputShapes[a],t=this.outputNames[a];this.feedOutputNames.push(t),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[a])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],nV("loss",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;const t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}}));const r=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>[]));let n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((e=>n));{const e=[];for(const r of t){let t=n.hasOwnProperty(r)?n[r]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),o=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};nV("metric",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;(t=>{let n,r,a;for(const i of t){if("string"===typeof i&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(i)){const t=this.internalOutputShapes[e];let o;1===t[t.length-1]||this.lossFunctions[e]===JG?-1!==["accuracy","acc"].indexOf(i)?r=nH:-1!==["crossentropy","ce"].indexOf(i)&&(r=aH):this.lossFunctions[e]===QG?-1!==["accuracy","acc"].indexOf(i)?r=iH:-1!==["crossentropy","ce"].indexOf(i)&&(r=cH):-1!==["accuracy","acc"].indexOf(i)?r=rH:-1!==["crossentropy","ce"].indexOf(i)&&(r=sH),-1!==["accuracy","acc"].indexOf(i)?o="acc":-1!==["crossentropy","ce"].indexOf(i)&&(o="ce"),a=r,n=""+o}else{const e=uH(i);a=e,n=""+dH(i)}let t;nV(n,(()=>{t=a})),o(e,n,t)}})(r[e])}})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=null==n.batchSize?32:n.batchSize;DH(r);const o=this.standardizeUserDataXY(e,t,!0,r);try{const e=o[0].concat(o[1]);this.makeTestFunction();const t=this.testFunction;return Aj(this.testLoop(t,e,r,n.verbose,n.steps))}finally{LH(o[0],e),LH(o[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){const r=null!=(n=n||{}).batches,o=e.testFunction;let a=[];if(n.verbose>0)throw new xj("Verbose mode is not implemented yet.");ME(!r||n.batches>0&&Number.isInteger(n.batches),(()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches))));const i="function"===typeof t.next?t:await t.iterator();let s=0,c=0;for(;!r||c<n.batches;){const t=await i.next();if(a=sO((()=>{if(t.value){const{xs:n,ys:r}=TH(e,t.value),i=n.concat(r),l=sO((()=>o(i)));if(cO(i),0===c)for(let e=0;e<l.length;++e)a.push(lF(0));const u=i[0].shape[0];for(let e=0;e<l.length;++e){const t=l[e],n=a[e];a[e]=sO((()=>tF(a[e],oF(u,t)))),c>0&&cO(n)}cO(l),s+=u,++c}return a})),t.done){r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let l=0;l<a.length;++l){const e=a[l];a[l]=rF(a[l],s),cO(e)}return Aj(a)}(this,e,t)}checkNumSamples(e,t,n){let r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new bj("If ".concat(o," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new bj("Either the input data should have a defined shape, or "+"".concat(o," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new bj("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),r=n?t:[t],o=this.retrieveSymbolicTensors(r),a=new mG;if(e instanceof wD&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new bj("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let t=0;t<this.inputs.length;++t)a.add(this.inputs[t],e[t])}else for(const s of this.inputs){const t=e[s.name];if(null==t)throw new bj("No value is provided for the model's input ".concat(s.name));a.add(s,t)}const i=yG(o,a);return n?i:i[0]}retrieveSymbolicTensors(e){const t=Sj(null,e.length);let n=e.length;for(const r of this.layers){const o=Array.isArray(r.output)?r.output:[r.output],a=o.map((e=>e.name));for(let r=0;r<e.length;++r){const i=a.indexOf(e[r]);if(-1!==i&&(t[r]=o[i],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw t.forEach(((t,r)=>{null==t&&n.push(e[r])})),new bj("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(n)))}return t}predictLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return sO((()=>{const r=this.checkNumSamples(e);if(n)throw new xj("Verbose predictLoop() is not implemented yet.");const o=MH(r,t),a=this.outputs.map((e=>[]));for(let t=0;t<o.length;++t){sO((()=>{const n=o[t][0],r=o[t][1],a=OH(e,n,r),i=[];if(Array.isArray(a))for(let e=0;e<a.length;++e)i.push({key:this.inputs[e],value:a[e]});else i.push({key:this.inputs[0],value:a});const s=new mG(i);return yG(this.outputs,s)})).forEach(((e,t)=>a[t].push(e)))}return Aj(a.map((e=>MM(e,0))))}))}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=PH(e);WH(n,this.inputNames,this.feedInputShapes,!1);try{const e=null==t.batchSize?32:t.batchSize;return DH(e),this.predictLoop(n,e)}finally{LH(n,e)}}predictOnBatch(e){WH(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new yj("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let o=0;o<this.feedOutputShapes.length;++o){const e=this.feedOutputShapes[o];this.feedLossFns[o]===QG?r.push(e.slice(0,e.length-1).concat([1])):r.push(e)}if(function(e,t){const n=Mj(e.map((e=>e.shape[0])));n.sort();const r=Mj(t.map((e=>e.shape[0])));if(r.sort(),n.length>1)throw new bj("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((e=>e.shape)))));if(r.length>1)throw new bj("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((e=>e.shape)))));if(n.length>0&&r.length>0&&!BE(n,r))throw new bj("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(n[0]," input sample(s) and ").concat(r[0]," target ")+"sample(s).")}(e=UH(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=UH(t,this.feedOutputNames,r,!1,"target")),function(e,t,n){const r=[HG,JG,YG];for(let o=0;o<e.length;++o){const a=e[o],i=t[o],s=n[o];if(null!=i){if(i===YG&&1===a.shape[a.shape.length-1])throw new bj("You are passing a target array of shape ".concat(a.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(i)){const e=a.shape.slice(1),t=s.slice(1);for(let n=0;n<e.length;++n){const r=e[n],o=t[n];if(null!=o&&r!==o)throw new bj("A target Tensor with shape ".concat(a.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new bj("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,r){let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5?arguments[5]:void 0;const[i,s]=this.standardizeUserDataXY(e,t,o,a);if(null!=n)throw new Error("sample weight is not supported yet.");let c=null;if(null!=r){const e=CH(r,this.outputNames);c=[];for(let t=0;t<e.length;++t)c.push(await AH(s[t],null,e[t]))}return[i,s,c]}testLoop(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4?arguments[4]:void 0;return sO((()=>{const a=this.checkNumSamples(t,n,o,"steps"),i=[];if(r>0)throw new xj("Verbose mode is not implemented yet.");if(null!=o)throw new xj("steps mode in testLoop() is not implemented yet");{const r=MH(a,n),o=aL(dV(0,a));for(let n=0;n<r.length;++n){const a=r[n][0],s=r[n][1],c=gV(o,a,s-a),l=FH(t,c),u=e(l);if(0===n)for(let e=0;e<u.length;++e)i.push(lF(0));for(let e=0;e<u.length;++e){const t=u[e];i[e]=tF(i[e],oF(s-a,t))}}for(let e=0;e<i.length;++e)i[e]=rF(i[e],a)}return i}))}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const r=e[n];let o=r;if(Cj(e,r)>1){const t=Cj(e.slice(0,n),r);o+="_".concat(t)}t.push(o)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),a=[],i=this.collectedTrainableWeights.map((e=>e.read()));return[this.optimizer_.minimize((()=>{const e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});const i=new mG(e),s=yG(this.outputs,i,{training:!0});let c;for(let n=0;n<this.lossFunctions.length;++n){let e=(0,this.lossFunctions[n])(r[n],s[n]);null!=o[n]&&(e=EH(e,o[n]));const a=CP(e);t.push(a),c=0===n?e:tF(c,e)}for(let n=0;n<this.metricsTensors.length;++n){let e;if(this.outputs.length>1&&n<this.outputs.length)e=t[n];else{const t=this.metricsTensors[n][0],o=this.metricsTensors[n][1];e=CP(t(r[o],s[o]))}lO(e),a.push(e)}return c=CP(c),this.calculateLosses().forEach((e=>{c=tF(c,e)})),c}),!0,i)].concat(a)}}makeTestFunction(){this.testFunction=e=>sO((()=>{const t=[];let n;const r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let e=0;e<this.inputs.length;++e)a.push({key:this.inputs[e],value:r[e]});const i=new mG(a),s=yG(this.outputs,i);for(let e=0;e<this.lossFunctions.length;++e){const r=this.lossFunctions[e],a=CP(r(o[e],s[e]));n=0===e?a:tF(n,a),t.push(n)}for(let e=0;e<this.metricsTensors.length;++e){const n=this.metricsTensors[e][0],r=this.metricsTensors[e][1],a=CP(n(o[r],s[r]));t.push(a)}return t}))}async fit(e,t){let n,r,o,a,i,s,c,l,u,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{const h=null==d.batchSize?32:d.batchSize;DH(h);const p=!1,f=await this.standardizeUserData(e,t,d.sampleWeight,d.classWeight,p,h);n=f[0],r=f[1],u=f[2];let m,g=!1;if(null!=d.validationData&&d.validationData.length>0){if(g=!0,2!==d.validationData.length)throw 3===d.validationData.length?new xj("validationData including sample weights is not supported yet."):new bj("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(d.validationData," is invalid."));i=d.validationData[0],s=d.validationData[1];const e=!0,t=await this.standardizeUserData(i,s,null,null,e,h);c=t[0],l=t[1],m=c.concat(l)}else if(null!=d.validationSplit&&d.validationSplit>0&&d.validationSplit<1){g=!0;const e=Math.floor(n[0].shape[0]*(1-d.validationSplit)),t=n[0].shape[0];c=OH(n,e,t),o=n,n=OH(n,0,e),l=OH(r,e,t),a=r,r=OH(r,0,e),m=c.concat(l)}else null!=d.validationSteps&&(g=!0);const v=n.concat(r).concat(u);this.checkTrainableWeightsConsistency();const y=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let x,w;g?(this.makeTestFunction(),x=this.testFunction,w=b.slice().concat(b.map((e=>"val_"+e)))):(x=null,m=[],w=b.slice());const k=UG(d.callbacks,d.yieldEvery);return await this.fitLoop(y,v,b,h,d.epochs,d.verbose,k,x,m,d.shuffle,w,d.initialEpoch,null,null)}finally{this.isTraining=!1,LH(n,e),LH(r,t),LH(o,e),LH(a,t),LH(c,i),LH(l,s),null!=u&&cO(u)}}async fitLoop(e,t,n,r,o,a,i,s,c,l,u,d,h,p){null==r&&(r=32),null==o&&(o=1),null==l&&(l=!0),null==d&&(d=0);let f=!1;if(null!=s&&null!=c&&(f=!0),null!=p&&(f=!0,null==h))throw new bj("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(t,r,h,"steps_per_epoch");let g;null!=m&&(g=dV(0,m)),null==a&&(a=1);const{callbackList:v,history:y}=jG(i,a,o,d,m,h,r,f,u);v.setModel(this),this.history=y,await v.onTrainBegin(),this.stopTraining_=!1;for(let b=d;b<o;++b){await v.onEpochBegin(b);const o={};if(null!=h)throw new xj("stepsPerEpoch mode is not implemented yet.");{if("batch"===l)throw new xj("batch shuffling is not implemneted yet");l&&_E(g);const a=aL(g),i=MH(m,r);for(let l=0;l<i.length;++l){const u={};if(await v.onBatchBegin(l,u),sO((()=>{const d=i[l][0],h=i[l][1],p=gV(a,d,h-d);u.batch=l,u.size=h-d;const m=FH(t,p),g=e(m);for(let e=0;e<n.length;++e){const t=n[e],r=g[e];u[t]=r,lO(r)}if(l===i.length-1&&f){const e=this.testLoop(s,c,r);for(let t=0;t<n.length;++t){const r=n[t],a=e[t];lO(a),o["val_"+r]=a}}})),await v.onBatchEnd(l,u),OG(u),this.stopTraining_)break}a.dispose()}if(await v.onEpochEnd(b,o),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return RH(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),r=n[0],o=n[1],a=this.makeTrainFunction()(r.concat(o)),i=[];for(const s of a){const e=await s.data();i.push(e[0])}return cO(a),LH(n[0],e),LH(n[1],t),Aj(i)}getNamedWeights(e){const t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,o=this.getWeights(n);for(let a=0;a<r.length;++a)n&&!r[a].trainable||t.push({name:r[a].originalName,tensor:o[a]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const t=iO().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-iO().numTensors}return e}getLossIdentifiers(){let e;if("string"===typeof this.loss)e=Tj(this.loss);else if(Array.isArray(this.loss)){for(const e of this.loss)if("string"!==typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map((e=>Tj(e)))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const r of t){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");e[r]=Tj(n[r])}}return e}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[Tj(dH(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((e=>Tj(dH(e))));{const e={};for(const t in this.metrics)e[t]=Tj(dH(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const t=VG(xH(e.optimizer_config));let n,r;if("string"===typeof e.loss)n=Nj(e.loss);else if(Array.isArray(e.loss))n=e.loss.map((e=>Nj(e)));else if(null!=e.loss){n={};for(const t in e.loss)n[t]=Nj(e.loss[t])}if(Array.isArray(e.metrics))r=e.metrics.map((e=>Nj(e)));else if(null!=e.metrics){r={};for(const t in e.metrics)r[t]=Nj(e.metrics[t])}this.compile({loss:n,metrics:r,optimizer:t})}async save(e,t){if("string"===typeof e){const t=(n=e,SO.getSaveHandlers(n));if(0===t.length)throw new bj("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new bj("Found more than one (".concat(t.length,") save handlers for ")+"URL '".concat(e,"'"));e=t[0]}var n;if(null==e.save)throw new bj("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await hO(this.getNamedWeights(t)),o={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(kH),convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){o.trainingConfig=this.getTrainingConfig();const e="optimizer",{data:t,specs:n}=await hO(await this.optimizer.getWeights(),e);r.specs.push(...n),r.data=(a=[r.data,t],oO.join(a))}var a;if(null!=this.userDefinedMetadata){const e=!0;pH(this.userDefinedMetadata,this.name,e),o.userDefinedMetadata=this.userDefinedMetadata}return o.weightData=r.data,o.weightSpecs=r.specs,e.save(o)}setUserDefinedMetadata(e){pH(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}jH.className="Model",fF(jH);class VH extends jH{}async function GH(e,t){if(null==t&&(t={}),"string"===typeof e){const o=(n=e,r=t,SO.getLoadHandlers(n,r));if(0===o.length)o.push(function(e,t){return BF(e,t)}(e,t));else if(o.length>1)throw new bj("Found more than one (".concat(o.length,") load handlers for ")+"URL '".concat(e,"'"));e=o[0]}var n,r;return async function(e,t,n){null==n&&(n={});if(null==e.load)throw new bj("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await e.load();let o=r.modelTopology;null!=o.model_config&&(o=o.model_config);const a=null==n.strict||n.strict,i=null!=r.weightData&&null!=r.weightSpecs&&a,s=VG(xH(o),t,i),c=r.trainingConfig;null!=c&&s.loadTrainingConfig(c);null!=r.userDefinedMetadata&&s.setUserDefinedMetadata(r.userDefinedMetadata);if(null!=r.weightData){if(null==r.weightSpecs)throw new bj("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:e,optimizerWeights:t}=function(e,t){const n=pO(e,t),r={},o=[];return t.forEach((e=>{"optimizer"===e.group?o.push({name:e.name,tensor:n[e.name]}):r[e.name]=n[e.name]})),{modelWeights:r,optimizerWeights:o}}(r.weightData,r.weightSpecs);s.loadWeights(e,a),null!=s.optimizer&&t.length>0&&await s.optimizer.setWeights(t),cO(e),cO(t.map((e=>e.tensor)))}return s}(e,void 0,t)}VH.className="Functional",fF(VH);class HH extends jH{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:Hj("sequential_"),null!=e.layers)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some((e=>e<0)))throw new bj("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(e){const t=e instanceof HH||e instanceof jH;let n;if(t){if(n=e,1!==n.outputs.length)throw new bj("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new bj("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new bj("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const t=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new bj("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new fG({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==e.inboundNodes.length)throw new bj("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new bj("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=pG(this.outputs[0])}this.inboundNodes=[],new uG({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Sj(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs[0].shape})}else{const t=e.apply(this.outputs[0]);if(Array.isArray(t))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(tG(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new jH({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new yj("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new yj("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new yj("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new yj("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t){let n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new bj("Legacy serialization format not supported yet.");n=t}else ME(null!=t.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),n=t.layers,delete t.layers,o=t;const a=new e(o);if(!(a instanceof HH))throw new xj("Sequential.fromConfig called on non-Sequential input: ".concat(a));for(const i of n){const e=VG(i,void 0,r);r&&e.setFastWeightInitDuringBuild(!0),a.add(e)}return a}set stopTraining(e){if(null==this.model)throw new bj("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new bj("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}HH.className="Sequential",fF(HH);class qH extends hF{getConfig(){return{}}}class KH extends qH{apply(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new xj("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return YM(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}KH.className="elu",fF(KH);class XH extends qH{apply(e){return HP(e)}}XH.className="selu",fF(XH);class YH extends qH{apply(e){return VP(e)}}YH.className="relu",fF(YH);class QH extends qH{apply(e){return sO((()=>EP(6,VP(e))))}}QH.className="relu6",fF(QH);class JH extends qH{apply(e){return e}}JH.className="linear",fF(JH);class $H extends qH{apply(e){return KP(e)}}$H.className="sigmoid",fF($H);class ZH extends qH{apply(e){return function(e){return sO((()=>{const t=tF(.5,oF(.2,e));return FM(t,0,1)}))}(e)}}ZH.className="hardSigmoid",fF(ZH);class eq extends qH{apply(e){return eL(e)}}eq.className="softplus",fF(eq);class tq extends qH{apply(e){return function(e){return sO((()=>rF(e,tF(kF(e),1))))}(e)}}tq.className="softsign",fF(tq);class nq extends qH{apply(e){return oL(e)}}nq.className="tanh",fF(nq);class rq extends qH{apply(e){return ZP(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}rq.className="softmax",fF(rq);class oq extends qH{apply(e){return dP(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}oq.className="logSoftmax",fF(oq);class aq extends qH{apply(e){return sO((()=>sO((()=>{const t=Math.sqrt(2),n=oF(.5,tF(1,JM(rF(e,t))));return oF(e,n)}))))}}aq.className="gelu",fF(aq);class iq extends qH{apply(e){return sO((()=>oF(.5,oF(e,tF(1,oL(oF(aF(rF(2,Math.PI)),tF(e,oF(.044715,bF(e,3))))))))))}}iq.className="gelu_new",fF(iq);class sq extends qH{apply(e){return sO((()=>oF(e,oL(eL(e)))))}}sq.className="mish",fF(sq);class cq extends qH{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return sO((()=>oF(KP(oF(e,t)),e)))}}function lq(e){return e.getClassName()}function uq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Oj(e,pF.getMap().classNameMap,t,"activation")}function dq(e){if(null==e){const e={className:"linear",config:{}};return uq(e)}if("string"===typeof e){const t={};return t.className=e,t.config={},uq(t)}return e instanceof qH?e:uq(e)}function hq(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}cq.className="swish",fF(cq);class pq extends hF{}class fq extends pq{constructor(e){super(),hq(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return sO((()=>{let t=DP([1]);return this.hasL1&&(t=tF(t,uP(oF(this.l1,kF(e))))),this.hasL2&&(t=tF(t,uP(oF(this.l2,CV(e))))),AM(t,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}fq.className="L1L2",fF(fq);const mq={l1l2:"L1L2"};function gq(e){return _j(e)}function vq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Oj(e,pF.getMap().classNameMap,t,"regularizer")}function yq(e){if(null==e)return null;if("string"===typeof e){return vq({className:e in mq?mq[e]:e,config:{}})}return e instanceof pq?e:vq(e)}class bq extends hG{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=eG(e);let n=VP(e);return null!=this.maxValue&&(n=FM(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}bq.className="ReLU",fF(bq);class xq extends hG{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=eG(e);return iP(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}xq.className="LeakyReLU",fF(xq);class wq extends hG{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=JV(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=yq(e.alphaRegularizer),this.alphaConstraint=_G(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new bj("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));this.sharedAxes=[e.sharedAxes]}}build(e){const t=(e=tG(e)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new sG({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=eG(e),PP(e,this.alpha.read())}getConfig(){const e={alphaInitializer:QV(this.alphaInitializer),alphaRegularizer:gq(this.alphaRegularizer),alphaConstraint:NG(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}wq.className="PReLU",fF(wq);class kq extends hG{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new xj("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=eG(e);return YM(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}kq.className="ELU",fF(kq);class Sq extends hG{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){const n=eG(e);return oF(n,$O(oP(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}Sq.className="ThresholdedReLU",fF(Sq);class Iq extends hG{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new rq).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){return sO((()=>{let n=eG(e);const r=t.mask;if(null!=r){const e=oF(xF(OP(n.shape),$O(r,n.dtype)),lF(-1e9));n=tF(n,e)}return this.axis instanceof Array?this.axis.length>1?$M(xF(n,xP(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)}))}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function Cq(e,t,n){if("number"===typeof e)return Sj(e,t);if(e.length!==t)throw new bj("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(let r=0;r<t;++r){const o=e[r];if(!sV(o))throw new bj("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(o))}return e}function Aq(e,t,n,r){if(null==e)return e;let o;return o="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((o+r-1)/r)}function Eq(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+uV([n-t,0]);else{if("same"!==r)throw new bj("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function Tq(e,t){return sO((()=>($j(t),"channelsFirst"===t?hL(e,[0,2,3,1]):e)))}function Nq(e,t){return sO((()=>($j(t),"channelsFirst"===t?hL(e,[0,2,3,4,1]):e)))}function Rq(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return sO((()=>{if(null==a&&(a="channelsLast"),$j(a),3!==e.shape.length)throw new bj("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new bj("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new bj("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(n.shape.length," instead"));if("channelsFirst"===a&&(e=hL(e,[0,2,1])),"causal"===o)throw new xj("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let s=WM(e,t,r,"same"===o?"same":"valid","NWC",i);return null!=n&&(s=EV(s,n)),s}))}function _q(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return sO((()=>{if(null==a&&(a="channelsLast"),$j(a),3!==e.rank&&4!==e.rank)throw new bj("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new bj("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));let c=Tq(e,a);if("causal"===o)throw new xj("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=CL({x:c,filter:t,strides:r,pad:"same"===o?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===a&&(c=hL(c,[0,3,1,2])),c}))}function Dq(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;return sO((()=>{if(null==a&&(a="channelsLast"),$j(a),4!==e.rank&&5!==e.rank)throw new bj("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new bj("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));let s=Nq(e,a);if("causal"===o)throw new xj("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=GM(s,t,r,"same"===o?"same":"valid","NDHWC",i),null!=n&&(s=EV(s,n)),"channelsFirst"===a&&(s=hL(s,[0,4,1,2,3])),s}))}Iq.className="Softmax",fF(Iq);class Oq extends hG{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Oq.verifyArgs(t),this.rank=e,Bj(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new xj("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=Cq(t.kernelSize,e,"kernelSize"),this.strides=Cq(null==t.strides?1:t.strides,e,"strides"),this.padding=null==t.padding?"valid":t.padding,Zj(this.padding),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,$j(this.dataFormat),this.activation=dq(t.activation),this.useBias=null==t.useBias||t.useBias,this.biasInitializer=JV(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=_G(t.biasConstraint),this.biasRegularizer=yq(t.biasRegularizer),this.activityRegularizer=yq(t.activityRegularizer),this.dilationRate=Cq(null==t.dilationRate?1:t.dilationRate,e,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new bj("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new bj("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new bj("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(e){if(Ij("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!zj(e.kernelSize,"number",1,3))throw new bj("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:lq(this.activation),useBias:this.useBias,biasInitializer:QV(this.biasInitializer),biasRegularizer:gq(this.biasRegularizer),activityRegularizer:gq(this.activityRegularizer),biasConstraint:NG(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class Fq extends Oq{constructor(e,t){super(e,t),this.kernel=null,Fq.verifyArgs(t),this.filters=t.filters,Bj(this.filters,"filters"),this.kernelInitializer=JV(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=_G(t.kernelConstraint),this.kernelRegularizer=yq(t.kernelRegularizer)}build(e){e=tG(e);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new bj("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));const n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return sO((()=>{let t;e=eG(e);const n=null==this.bias?null:this.bias.read(),r=Wj(this.activation.getClassName());if(null!=r&&2===this.rank)t=_q(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)t=Rq(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=_q(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new xj("convolutions greater than 3D are not implemented yet.");t=Dq(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t}))}computeOutputShape(e){e=tG(e);const t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<n.length;++o){const e=Aq(n[o],this.kernelSize[o],this.padding,this.strides[o],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[o]);t.push(e)}let r=[e[0]];return"channelsLast"===this.dataFormat?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:QV(this.kernelInitializer),kernelRegularizer:gq(this.kernelRegularizer),kernelConstraint:NG(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new bj("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}class Mq extends Fq{constructor(e){super(2,e),Mq.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!zj(e.kernelSize,"number",1,2))throw new bj("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}Mq.className="Conv2D",fF(Mq);class Pq extends Fq{constructor(e){super(3,e),Pq.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new bj("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}Pq.className="Conv3D",fF(Pq);class Lq extends Mq{constructor(e){if(super(e),this.inputSpec=[new sG({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new bj("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(4!==(e=tG(e)).length)throw new bj("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new bj("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new sG({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return sO((()=>{let t=eG(e);if(4!==t.shape.length)throw new bj("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));const n=t.shape,r=n[0];let o,a;"channelsFirst"===this.dataFormat?(o=2,a=3):(o=1,a=2);const i=n[o],s=n[a],c=this.kernelSize[0],l=this.kernelSize[1],u=this.strides[0],d=this.strides[1],h=[r,Eq(i,u,c,this.padding),Eq(s,d,l,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=hL(t,[0,2,3,1]));let p=VM(t,this.kernel.read(),h,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=hL(p,[0,3,1,2])),null!=this.bias&&(p=EV(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p}))}computeOutputShape(e){const t=(e=tG(e)).slice();let n,r,o;"channelsFirst"===this.dataFormat?(n=1,r=2,o=3):(n=3,r=1,o=2);const a=this.kernelSize[0],i=this.kernelSize[1],s=this.strides[0],c=this.strides[1];return t[n]=this.filters,t[r]=Eq(t[r],s,a,this.padding),t[o]=Eq(t[o],c,i,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}Lq.className="Conv2DTranspose",fF(Lq);class zq extends Pq{constructor(e){if(super(e),this.inputSpec=[new sG({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new bj("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(5!==(e=tG(e)).length)throw new bj("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new bj("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new sG({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return sO((()=>{let t=eG(e);if(5!==t.shape.length)throw new bj("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));const n=t.shape,r=n[0];let o,a,i;"channelsFirst"===this.dataFormat?(i=2,o=3,a=4):(i=1,o=2,a=3);const s=n[i],c=n[o],l=n[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.kernelSize[2],p=this.strides[0],f=this.strides[1],m=this.strides[2],g=[r,Eq(s,p,u,this.padding),Eq(c,f,d,this.padding),Eq(l,m,h,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=hL(t,[0,2,3,4,1]));let v=qM(t,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(v=hL(v,[0,4,1,2,3])),null!==this.bias&&(v=EV(v,this.bias.read(),this.dataFormat)),null!==this.activation&&(v=this.activation.apply(v)),v}))}computeOutputShape(e){const t=(e=tG(e)).slice();let n,r,o,a;"channelsFirst"===this.dataFormat?(n=1,r=2,o=3,a=4):(n=4,r=1,o=2,a=3);const i=this.kernelSize[0],s=this.kernelSize[1],c=this.kernelSize[2],l=this.strides[0],u=this.strides[1],d=this.strides[2];return t[n]=this.filters,t[r]=Eq(t[r],l,i,this.padding),t[o]=Eq(t[o],u,s,this.padding),t[a]=Eq(t[a],d,c,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}zq.className="Conv3DTranspose",fF(zq);class Bq extends Fq{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new bj("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new bj("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new bj("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(t.padding)));this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=JV(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=yq(t.depthwiseRegularizer),this.depthwiseConstraint=_G(t.depthwiseConstraint),this.pointwiseInitializer=JV(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=yq(t.pointwiseRegularizer),this.pointwiseConstraint=_G(t.pointwiseConstraint)}build(e){if((e=tG(e)).length<this.rank+2)throw new bj("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new bj("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));const n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),o=[];for(let i=0;i<this.rank;++i)o.push(1);o.push(n*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new sG({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return sO((()=>{let t;if(e=eG(e),1===this.rank)throw new xj("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=hL(e,[0,2,3,1])),t=qP(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=EV(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=hL(t,[0,3,1,2])),t}))}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=QV(this.depthwiseInitializer),e.pointwiseInitializer=QV(this.pointwiseInitializer),e.depthwiseRegularizer=gq(this.depthwiseRegularizer),e.pointwiseRegularizer=gq(this.pointwiseRegularizer),e.depthwiseConstraint=NG(this.depthwiseConstraint),e.pointwiseConstraint=NG(this.pointwiseConstraint),e}}Bq.className="SeparableConv";class Uq extends Bq{constructor(e){super(2,e)}}Uq.className="SeparableConv2D",fF(Uq);class Wq extends Fq{constructor(e){super(1,e),Wq.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!zj(e.kernelSize,"number",1,1))throw new bj("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}Wq.className="Conv1D",fF(Wq);class jq extends hG{constructor(e){super(e),"number"===typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return sO((()=>{if(e=eG(e),"channelsLast"===this.dataFormat){const t=yV(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return yV(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const t=yV(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return yV(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}jq.className="Cropping2D",fF(jq);class Vq extends hG{constructor(e){var t;super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,$j(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,t=this.interpolation,Lj(Kj,"InterpolationFormat",t)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){const t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{const t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return sO((()=>{let t=eG(e);const n=t.shape;if("channelsFirst"===this.dataFormat){t=hL(t,[0,2,3,1]);const e=this.size[0]*n[2],r=this.size[1]*n[3],o="nearest"===this.interpolation?pz.resizeNearestNeighbor(t,[e,r]):pz.resizeBilinear(t,[e,r]);return hL(o,[0,3,1,2])}{const e=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?pz.resizeNearestNeighbor(t,[e,r]):pz.resizeBilinear(t,[e,r])}}))}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}Vq.className="UpSampling2D",fF(Vq);class Gq extends Oq{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=JV(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=_G(e.depthwiseConstraint),this.depthwiseRegularizer=yq(e.depthwiseRegularizer)}build(e){if((e=tG(e)).length<4)throw new bj("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));const t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new bj("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));const n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return sO((()=>{let t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return sO((()=>{null==o&&(o="channelsLast"),$j(o);let i=Tq(e,o);if(4!==e.rank)throw new bj("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new bj("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return i=XM(i,t,n,"same"===r?"same":"valid","NHWC",a),"channelsFirst"===o&&(i=hL(i,[0,3,1,2])),i}))}(e=eG(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=EV(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t}))}computeOutputShape(e){e=tG(e);const t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=Aq(t,this.kernelSize[0],this.padding,this.strides[0]),a=Aq(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,o,a]:[e[0],o,a,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=QV(this.depthwiseInitializer),e.depthwiseRegularizer=gq(this.depthwiseRegularizer),e.depthwiseConstraint=NG(this.depthwiseRegularizer),e}}function Hq(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new bj("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function o(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=o(t),constants:n=o(n)}}function qq(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return sO((()=>{const c=t.shape.length;if(c<3)throw new bj("Input should be at least 3D, but is ".concat(c,"D."));const l=[1,0].concat(dV(2,c));if(t=hL(t,l),null!=a)throw new xj("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=o&&(o=$O($O(o,"bool"),"float32"),o.rank===c-1&&(o=ZM(o,-1)),o=hL(o,l)),r&&(t=GP(t,0),null!=o&&(o=GP(o,0)));const u=[];let d,h=n;const p=t.shape[0],f=cL(t);let m,g;null!=o&&(m=cL(o));for(let t=0;t<p;++t){const n=f[t],r=sO((()=>e(n,h)));if(null==o)d=r[0],h=r[1];else{const e=sO((()=>{const e=m[t],n=xF(FP(e),e);return{output:tF(oF(r[0],e),oF(h[0],n)),newStates:h.map(((t,o)=>tF(oF(r[1][o],e),oF(t,n))))}}));d=e.output,h=e.newStates}s&&u.push(d)}if(s){g=rL(u,1)}return[d,g,h]}))}Gq.className="DepthwiseConv2D",fF(Gq);class Kq extends hG{constructor(e){let t;if(super(e),null==e.cell)throw new bj("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new tK({cells:e.cell}):e.cell,null==t.stateSize)throw new bj("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new sG({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return dV(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((e=>null))}return this.states_}setStates(e){this.states_=e}computeOutputShape(e){$V(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let r;if(r=this.returnSequences?[e[0],e[1],n]:[e[0],n],this.returnState){const n=[];for(const r of t)n.push([e[0],r]);return[r].concat(n)}return r}computeMask(e,t){return sO((()=>{Array.isArray(t)&&(t=t[0]);const e=this.returnSequences?t:null;if(this.returnState){const t=this.states.map((e=>null));return[e].concat(t)}return e}))}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new xj("Constants support is not implemented in RNN yet.");$V(e)&&(e=e[0]);const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new sG({shape:[t,null,...n]});const r=[e[0]].concat(e.slice(2));let o;if(this.cell.build(r),o=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!BE(this.stateSpec.map((e=>e.shape[e.shape.length-1])),o))throw new bj("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=o.map((e=>new sG({shape:[null,e]})));this.stateful&&this.resetStates()}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];sO((()=>{if(!this.stateful)throw new vj("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new bj("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>DP([n,e]))):this.states_=[DP([n,this.cell.stateSize])];else if(null==e)cO(this.states_),null!=this.keptStates&&(cO(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>DP([n,e]))):this.states_[0]=DP([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new bj("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===t?this.keptStates.push(this.states_.slice()):cO(this.states_);for(let t=0;t<this.states_.length;++t){const r=e[t],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,a=[n,o];if(!BE(r.shape,a))throw new bj("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(a,", received shape=").concat(r.shape));this.states_[t]=r}}this.states_=this.states_.map((e=>lO(e.clone())))}))}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const o=Hq(e,n,r,this.numConstants);e=o.inputs,n=o.initialState,r=o.constants;let a=[],i=[];if(null!=n){t.initialState=n,a=a.concat(n),this.stateSpec=[];for(const e of n)this.stateSpec.push(new sG({shape:e.shape}));i=i.concat(this.stateSpec)}null!=r&&(t.constants=r,a=a.concat(r),this.numConstants=r.length);if(a[0]instanceof cG){const n=[e].concat(a),r=this.inputSpec.concat(i),o=this.inputSpec;this.inputSpec=r;const s=super.apply(n,t);return this.inputSpec=o,s}return super.apply(e,t)}call(e,t){return sO((()=>{const n=null==t?null:t.mask,r=null==t?null:t.training;let o=null==t?null:t.initialState;e=eG(e),null==o&&(o=this.stateful?this.states_:this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==a)throw new bj("RNN Layer has ".concat(a," state(s) but was passed ")+"".concat(o.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const i={training:r},s=qq(((e,t)=>{const n=this.cell.call([e].concat(t),i);return[n[0],n.slice(1)]}),e,o,this.goBackwards,n,null,this.unroll,this.returnSequences),c=s[0],l=s[1],u=s[2];this.stateful&&this.resetStates(u,r);const d=this.returnSequences?l:c;return this.returnState?[d].concat(u):d}))}getInitialState(e){return sO((()=>{let t=DP(e.shape);return t=uP(t,[1,2]),t=mV(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((e=>e>1?wV(t,[1,e]):t)):this.cell.stateSize>1?[wV(t,[1,this.cell.stateSize])]:[t]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===Kq.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=VG(t.cell,n);return new e(Object.assign(t,{cell:r}))}}Kq.className="RNN",fF(Kq);class Xq extends hG{}class Yq extends Xq{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Bj(this.units,"units"),this.activation=dq(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=JV(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=JV(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=JV(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=yq(e.kernelRegularizer),this.recurrentRegularizer=yq(e.recurrentRegularizer),this.biasRegularizer=yq(e.biasRegularizer),this.kernelConstraint=_G(e.kernelConstraint),this.recurrentConstraint=_G(e.recurrentConstraint),this.biasConstraint=_G(e.biasConstraint),this.dropout=lV([1,uV([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=lV([1,uV([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=tG(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return sO((()=>{if(2!==e.length)throw new bj("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let n=e[1];e=e[0];const r=null!=t.training&&t.training;let o;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=nK({ones:()=>FP(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=nK({ones:()=>FP(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;o=SV(null!=a?oF(e,a):e,this.kernel.read()),null!=this.bias&&(o=EV(o,this.bias.read())),null!=i&&(n=oF(n,i));let s=tF(o,SV(n,this.recurrentKernel.read()));return null!=this.activation&&(s=this.activation.apply(s)),[s,s]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:lq(this.activation),useBias:this.useBias,kernelInitializer:QV(this.kernelInitializer),recurrentInitializer:QV(this.recurrentInitializer),biasInitializer:QV(this.biasInitializer),kernelRegularizer:gq(this.kernelRegularizer),recurrentRegularizer:gq(this.recurrentRegularizer),biasRegularizer:gq(this.biasRegularizer),activityRegularizer:gq(this.activityRegularizer),kernelConstraint:NG(this.kernelConstraint),recurrentConstraint:NG(this.recurrentConstraint),biasConstraint:NG(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}Yq.className="SimpleRNNCell",fF(Yq);class Qq extends Kq{constructor(e){e.cell=new Yq(e),super(e)}call(e,t){return sO((()=>{null!=this.cell.dropoutMask&&(cO(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(cO(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,o=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:o})}))}static fromConfig(e,t){return new e(t)}}Qq.className="SimpleRNN",fF(Qq);class Jq extends Xq{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new bj("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Bj(this.units,"units"),this.activation=dq(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=dq(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=JV(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=JV(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=JV(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=yq(e.kernelRegularizer),this.recurrentRegularizer=yq(e.recurrentRegularizer),this.biasRegularizer=yq(e.biasRegularizer),this.kernelConstraint=_G(e.kernelConstraint),this.recurrentConstraint=_G(e.recurrentConstraint),this.biasConstraint=_G(e.biasConstraint),this.dropout=lV([1,uV([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=lV([1,uV([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){const t=(e=tG(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return sO((()=>{if(2!==e.length)throw new bj("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=null!=t.training&&t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=nK({ones:()=>FP(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=nK({ones:()=>FP(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let i,s,c;0<this.dropout&&this.dropout<1&&(e=oF(e,o[0]));let l=SV(e,this.kernel.read());this.useBias&&(l=EV(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=oF(r,a[0]));const u=this.recurrentKernel.read(),[d,h]=tL(u,[2*this.units,this.units],u.rank-1),p=SV(r,d),[f,m,g]=tL(l,3,l.rank-1),[v,y]=tL(p,2,p.rank-1);i=this.recurrentActivation.apply(tF(f,v)),s=this.recurrentActivation.apply(tF(m,y));const b=SV(oF(s,r),h);c=this.activation.apply(tF(g,b));const x=tF(oF(i,r),oF(tF(1,NP(i)),c));return[x,x]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:lq(this.activation),recurrentActivation:lq(this.recurrentActivation),useBias:this.useBias,kernelInitializer:QV(this.kernelInitializer),recurrentInitializer:QV(this.recurrentInitializer),biasInitializer:QV(this.biasInitializer),kernelRegularizer:gq(this.kernelRegularizer),recurrentRegularizer:gq(this.recurrentRegularizer),biasRegularizer:gq(this.biasRegularizer),activityRegularizer:gq(this.activityRegularizer),kernelConstraint:NG(this.kernelConstraint),recurrentConstraint:NG(this.recurrentConstraint),biasConstraint:NG(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}Jq.className="GRUCell",fF(Jq);class $q extends Kq{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Jq(e),super(e)}call(e,t){return sO((()=>{null!=this.cell.dropoutMask&&(cO(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(cO(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,o=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:o})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}$q.className="GRU",fF($q);class Zq extends Xq{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Bj(this.units,"units"),this.activation=dq(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=dq(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=JV(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=JV(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=JV(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=yq(e.kernelRegularizer),this.recurrentRegularizer=yq(e.recurrentRegularizer),this.biasRegularizer=yq(e.biasRegularizer),this.kernelConstraint=_G(e.kernelConstraint),this.recurrentConstraint=_G(e.recurrentConstraint),this.biasConstraint=_G(e.biasConstraint),this.dropout=lV([1,uV([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=lV([1,uV([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;const n=(e=tG(e))[e.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const e=this.biasInitializer,n=this.units;r=new((t=class extends DV{apply(t,r){const o=e.apply([n]),a=(new FV).apply([n]),i=e.apply([2*n]);return xV(xV(o,a),i)}}).className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return sO((()=>{const n=null!=t.training&&t.training;if(3!==e.length)throw new bj("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));let r=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=nK({ones:()=>FP(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=nK({ones:()=>FP(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let s,c,l,u;0<this.dropout&&this.dropout<1&&(e=oF(e,a[0]));let d=SV(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=oF(r,i[0])),d=tF(d,SV(r,this.recurrentKernel.read())),this.useBias&&(d=EV(d,this.bias.read()));const[h,p,f,m]=tL(d,4,d.rank-1);s=this.recurrentActivation.apply(h),c=this.recurrentActivation.apply(p),l=tF(oF(c,o),oF(s,this.activation.apply(f))),u=this.recurrentActivation.apply(m);const g=oF(u,this.activation.apply(l));return[g,g,l]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:lq(this.activation),recurrentActivation:lq(this.recurrentActivation),useBias:this.useBias,kernelInitializer:QV(this.kernelInitializer),recurrentInitializer:QV(this.recurrentInitializer),biasInitializer:QV(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:gq(this.kernelRegularizer),recurrentRegularizer:gq(this.recurrentRegularizer),biasRegularizer:gq(this.biasRegularizer),activityRegularizer:gq(this.activityRegularizer),kernelConstraint:NG(this.kernelConstraint),recurrentConstraint:NG(this.recurrentConstraint),biasConstraint:NG(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}Zq.className="LSTMCell",fF(Zq);class eK extends Kq{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Zq(e),super(e)}call(e,t){return sO((()=>{null!=this.cell.dropoutMask&&(cO(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(cO(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,o=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:o})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}eK.className="LSTM",fF(eK);class tK extends Xq{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return sO((()=>{let n=e.slice(1);const r=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?r.push(n.splice(0,e.stateSize.length)):r.push(n.splice(0,1));r.reverse();const o=[];let a;for(let i=0;i<this.cells.length;++i){const s=this.cells[i];n=r[i],a=0===i?[e[0]].concat(n):[a[0]].concat(n),a=s.call(a,t),o.push(a.slice(1))}n=[];for(const e of o.slice().reverse())n.push(...e);return[a[0]].concat(n)}))}build(e){let t;$V(e)&&(e=e[0]),this.cells.forEach(((n,r)=>{nV("RNNCell_".concat(r),(()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}getConfig(){const e=super.getConfig(),t={cells:this.cells.map((e=>({className:e.getClassName(),config:e.getConfig()})))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];for(const o of t.cells)r.push(VG(o,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return aG(e)}setWeights(e){const t=[];for(const n of this.cells){const r=n.weights.length,o=e.splice(r);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],o[e]])}iG(t)}}function nK(e){const{ones:t,rate:n,training:r=!1,count:o=1,dropoutFunc:a}=e,i=()=>null!=a?a(t(),n):TV(t(),n),s=()=>NV(i,t,r);if(!o||o<=1)return lO(s().clone());return Array(o).fill(void 0).map(s).map((e=>lO(e.clone())))}tK.className="StackedRNNCells",fF(tK);var rK=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};class oK extends Kq{constructor(e){if(e.unroll)throw new xj("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new xj("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new sG({ndim:5})]}call(e,t){return sO((()=>{if(null!=this.cell.dropoutMask&&(cO(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(cO(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new bj("ConvRNN2D cell does not support constants");const n=null==t?null:t.mask,r=null==t?null:t.training,o=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:o})}))}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return sO((()=>{const{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),o=DP([r[0],...r.slice(2)]);return Array.isArray(t)?Array(t.length).fill(o):[o]}))}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];sO((()=>{if(!this.stateful)throw new vj("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),o=[r[0],...r.slice(2)];if(null==n[0])throw new bj("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>DP(o))):this.states_=[DP(o)];else if(null==e)cO(this.states_),null!=this.keptStates&&(cO(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>DP(o))):this.states_[0]=DP(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new bj("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t?this.keptStates.push(this.states_.slice()):cO(this.states_);for(let t=0;t<this.states_.length;++t){const n=e[t],r=o;if(!BE(n.shape,r))throw new bj("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(r,", received shape=").concat(n.shape));this.states_[t]=n}}this.states_=this.states_.map((e=>lO(e.clone())))}))}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:r,padding:o,strides:a,dilationRate:i}=this.cell,s="channelsFirst"===t,c=e[s?3:2],l=e[s?4:3],u=Aq(c,r[0],o,a[0],i[0]),d=Aq(l,r[1],o,a[1],i[1]);return[...e.slice(0,2),...s?[n,u,d]:[u,d,n]]}}oK.className="ConvRNN2D";class aK extends Zq{constructor(e){const{filters:t,kernelSize:n,strides:r,padding:o,dataFormat:a,dilationRate:i}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,Bj(this.filters,"filters"),this.kernelSize=Cq(n,2,"kernelSize"),this.kernelSize.forEach((e=>Bj(e,"kernelSize"))),this.strides=Cq(r||1,2,"strides"),this.strides.forEach((e=>Bj(e,"strides"))),this.padding=o||"valid",Zj(this.padding),this.dataFormat=a||"channelsLast",$j(this.dataFormat),this.dilationRate=Cq(i||1,2,"dilationRate"),this.dilationRate.forEach((e=>Bj(e,"dilationRate")))}build(e){var t;e=tG(e);const n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new bj("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));const r=e[n],o=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;e=new((t=class extends DV{apply(e,t){return bV([n.apply([r]),OP([r]),n.apply([2*r])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return sO((()=>{if(3!==e.length)throw new bj("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=t.training||!1,r=e[0],o=e[1],a=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=nK({ones:()=>FP(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,s=(e,t,n)=>t&&t[n]?oF(t[n],e):e;let c=s(r,i,0),l=s(r,i,1),u=s(r,i,2),d=s(r,i,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=nK({ones:()=>FP(o),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const h=this.recurrentDropoutMask;let p=s(o,h,0),f=s(o,h,1),m=s(o,h,2),g=s(o,h,3);const[v,y,b,x]=tL(this.kernel.read(),4,3),[w,k,S,I]=this.useBias?tL(this.bias.read(),4):[null,null,null,null];c=this.inputConv(c,v,w,this.padding),l=this.inputConv(l,y,k,this.padding),u=this.inputConv(u,b,S,this.padding),d=this.inputConv(d,x,I,this.padding);const[C,A,E,T]=tL(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,C),f=this.recurrentConv(f,A),m=this.recurrentConv(m,E),g=this.recurrentConv(g,T);const N=this.recurrentActivation.apply(tF(c,p)),R=this.recurrentActivation.apply(tF(l,f)),_=tF(oF(R,a),oF(N,this.activation.apply(tF(u,m)))),D=oF(this.recurrentActivation.apply(tF(d,g)),this.activation.apply(_));return[D,D,_]}))}getConfig(){const e=super.getConfig(),{units:t}=e,n=rK(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,t,n,r){const o=UM(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?EV(o,n,this.dataFormat):o}recurrentConv(e,t){return UM(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}aK.className="ConvLSTM2DCell",fF(aK);class iK extends oK{constructor(e){const t=new aK(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}iK.className="ConvLSTM2D",fF(iK);class sK extends hG{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}call(e,t){return sO((()=>{this.invokeCallHook(e,t);const n=eG(e);if(0<this.rate&&this.rate<1){const e=null!=t.training&&t.training,r=this.getNoiseShape(n);return NV((()=>TV(n,this.rate,r,this.seed)),(()=>n),e)}return e}))}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}sK.className="Dropout",fF(sK);class cK extends sK{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}cK.className="SpatialDropout1D",fF(cK);class lK extends hG{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Bj(this.units,"units"),this.activation=dq(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=JV(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=JV(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=_G(e.kernelConstraint),this.biasConstraint=_G(e.biasConstraint),this.kernelRegularizer=yq(e.kernelRegularizer),this.biasRegularizer=yq(e.biasRegularizer),this.activityRegularizer=yq(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const t=(e=tG(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){const t=(e=tG(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return sO((()=>{this.invokeCallHook(e,t);const n=eG(e),r=Wj(this.activation.getClassName());let o;return null!=r?o=SV(n,this.kernel.read(),r,this.bias?this.bias.read():null):(o=SV(n,this.kernel.read()),null!=this.bias&&(o=EV(o,this.bias.read())),null!=this.activation&&(o=this.activation.apply(o))),o}))}getConfig(){const e={units:this.units,activation:lq(this.activation),useBias:this.useBias,kernelInitializer:QV(this.kernelInitializer),biasInitializer:QV(this.biasInitializer),kernelRegularizer:gq(this.kernelRegularizer),biasRegularizer:gq(this.biasRegularizer),activityRegularizer:gq(this.activityRegularizer),kernelConstraint:NG(this.kernelConstraint),biasConstraint:NG(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}lK.className="Dense",fF(lK);class uK extends hG{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=tG(e);for(const t of e.slice(1))if(null==t)throw new bj('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],cV(e,1)]}call(e,t){return sO((()=>{this.invokeCallHook(e,t);let n=eG(e);if("channelsFirst"===this.dataFormat&&n.rank>1){const e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=hL(n,e)}return function(e){if(e.rank<=1)throw new bj("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));const t=[e.shape[0],cV(e.shape,1)];return AM(e,t)}(n)}))}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}uK.className="Flatten",fF(uK);class dK extends hG{constructor(e){super(e),this.supportsMasking=!0,this.activation=dq(e.activation)}call(e,t){return sO((()=>{this.invokeCallHook(e,t);const n=eG(e);return this.activation.apply(n)}))}getConfig(){const e={activation:lq(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}dK.className="Activation",fF(dK);class hK extends hG{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return sO((()=>function(e,t){return sO((()=>{if(2!==e.shape.length)throw new bj("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(e.shape.length," tensor."));return wV(mV(e,1),[1,t,1])}))}(e=eG(e),this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}hK.className="RepeatVector",fF(hK);class pK extends hG{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",r=t.slice();let o=1,a=null;for(let s=0;s<r.length;++s){const e=r[s];if(this.isUnknown(e)){if(null!==a)throw new bj("Can only specifiy one unknown dimension.");a=s}else o*=e}const i=cV(e);if(null!==a){if(0===o||i%o!==0)throw new bj(n);r[a]=i/o}else if(i!==o)throw new bj(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return sO((()=>{this.invokeCallHook(e,t);const n=eG(e),r=n.shape,o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return AM(n,o)}))}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}pK.className="Reshape",fF(pK);class fK extends hG{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));const t=dV(1,e.dims.length+1);if(!BE(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new sG({ndim:this.dims.length+1})]}computeOutputShape(e){const t=(e=tG(e)).slice();return this.dims.forEach(((n,r)=>{t[r+1]=e[n]})),t}call(e,t){return hL(eG(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}fK.className="Permute",fF(fK);class mK extends hG{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=eG(e);return lM(RP(n,this.maskValue),-1)}call(e,t){return sO((()=>{this.invokeCallHook(e,t);const n=eG(e),r=lM(RP(n,this.maskValue),-1,!0);return oF(n,$O(r,n.dtype))}))}}mK.className="Masking",fF(mK);class gK extends hG{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Ej(e.inputLength))}this.inputDim=e.inputDim,Bj(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Bj(this.outputDim,"outputDim"),this.embeddingsInitializer=JV(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=yq(e.embeddingsRegularizer),this.activityRegularizer=yq(e.activityRegularizer),this.embeddingsConstraint=_G(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return sO((()=>this.maskZero?(e=eG(e),RP(e,sF(e))):null))}computeOutputShape(e){if(e=tG(e),null==this.inputLength)return[...e,this.outputDim];const t=Ej(this.inputLength);if(t.length!==e.length-1)throw new bj('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));{let n=0;for(let r=0;r<t.length;++r){const o=t[r],a=e[r+1];if(null!=o&&null!=a&&o!==a)throw new bj('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==o&&(t[n]=a),n++}}return[e[0],...t,this.outputDim]}call(e,t){return sO((()=>{this.invokeCallHook(e,t);let n=eG(e);"int32"!==n.dtype&&(n=fV(n,"int32"));const r=IV(this.embeddings.read(),AM(n,[n.size]));return AM(r,tG(this.computeOutputShape(n.shape)))}))}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:QV(this.embeddingsInitializer),embeddingsRegularizer:gq(this.embeddingsRegularizer),activityRegularizer:gq(this.activityRegularizer),embeddingsConstraint:NG(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}gK.className="Embedding",fF(gK);class vK extends hG{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new xj}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;const n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const o=e[e.length-t.length+r],a=t[r];if(null==o||null==a||o<0||a<0)n.push(null);else if(1===o)n.push(a);else if(1===a)n.push(o);else{if(o!==a)throw new bj("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(o)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[tG(e)]),e.length<2)throw new bj("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));let t=[];for(const o of e)null!=o&&null!==o[0]&&t.push(o[0]);if(t=Mj(t),t.length>1)throw new bj("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=null==e[0]?null:e[0].slice(1);for(let o=1;o<e.length;++o){const t=null==e[o]?null:e[o].slice(1);n=this.computeElementwiseOpOutputShape(n,t)}const r=e.map((e=>e.length));-1===e.indexOf(null)&&1===Mj(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return sO((()=>{if(this.reshapeRequired){const t=[],n=e.map((e=>e.rank));if(-1===n.indexOf(null)){const r=uV(n);for(let n of e){const e=n.rank;for(let t=0;t<r-e;++t)n=mV(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(const a of e){const e=a.rank;if(null==e){const e=a.shape,r=e[0],o=e.slice(1).concat([r]);let i=AM(a,[r].concat(cV(e.slice(1))));i=hL(i,[1,0]),i=AM(i,o),t.push(i),n=!0}else if(e>1){const r=dV(1,e).concat([0]);t.push(hL(a,r)),n=!0}else t.push(a)}let r=this.mergeFunction(t);const o=r.rank;if(n)if(null==o){const e=r.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));r=AM(hL(AM(r,[-1,t]),[1,0]),n)}else if(o>1){const e=[o-1].concat(dV(0,o-1));r=hL(r,e)}return r}}return this.mergeFunction(e)}))}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let r=1;r<e.length;++r){const n=null==e[r]?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}let n=[];for(const r of e)null!=r&&null!==r[0]&&n.push(r[0]);return n=Mj(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return sO((()=>{if(null==t)return null;if(!Array.isArray(t))throw new bj("`mask` should be an Array");if(!Array.isArray(e))throw new bj("`inputs` should be an Array");if(t.length!==e.length)throw new bj("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((e=>null==e)))return null;let n=(t=t.map((e=>null==e?e:ZM(e,0))))[0];for(let e=1;e<t.length-1;++e)n=wP(n,t[e]);return n}))}}class yK extends vK{constructor(e){super(e)}mergeFunction(e){return sO((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=tF(t,e[n]);return t}))}}yK.className="Add",fF(yK);class bK extends vK{constructor(e){super(e)}mergeFunction(e){return sO((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=oF(t,e[n]);return t}))}}bK.className="Multiply",fF(bK);class xK extends vK{constructor(e){super(e)}mergeFunction(e){return sO((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=tF(t,e[n]);return oF(1/e.length,t)}))}}xK.className="Average",fF(xK);class wK extends vK{constructor(e){super(e)}mergeFunction(e){return sO((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=AF(t,e[n]);return t}))}}wK.className="Maximum",fF(wK);class kK extends vK{constructor(e){super(e)}mergeFunction(e){return sO((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=EP(t,e[n]);return t}))}}kK.className="Minimum",fF(kK);class SK extends vK{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new bj("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(const r of e)if(null!=r){t=!1;break}if(t)return;const n=[];for(let r=0;r<e.length;++r){const t=e[r].slice();t.splice(this.axis,1);let o=!1;for(const e of n)if(BE(e,t)){o=!0;break}o||n.push(t)}if(n.length>1)throw new bj("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return sO((()=>bV(e,this.axis)))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new bj("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const o of t.slice(1)){if(null==n[r]||null==o[r]){n[r]=null;break}n[r]+=o[r]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new bj("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new bj("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new bj("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return sO((()=>{let n=!0;if(t.forEach((e=>{null==e||(n=!1)})),n)return null;const r=[];for(let a=0;a<e.length;++a)null==t[a]?r.push($O(FP(e[a]),"bool")):t[a].rank<e[a].rank?r.push(ZM(t[a],-1)):r.push(t[a]);const o=MM(r,this.axis);return cM(o,-1,!1)}))}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function IK(e,t){for(;e<0;)e+=t;return e}SK.className="Concatenate",fF(SK);class CK extends vK{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){ME(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new xj("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new bj("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}mergeFunction(e){if(2!==e.length)throw new bj("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));let t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map(((t,n)=>IK(t,e[n].shape.length))):[IK(this.axes,n.shape.length),IK(this.axes,r.shape.length)],this.normalize&&(n=GG(n,t[0]),r=GG(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new xj("batchDot is not implemented for tensors of 4D or higher rank yet");if(ME(e.shape.length>=2,(()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length))),ME(e.shape.length>=2,(()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length))),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new xj("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,o=t.shape.length;null==n&&(n=[r-1,o-2]);const a=n;return sO((()=>{let n,i;if(r>o){n=r-o;const e=[];for(let t=0;t<n;++t)e.push(1);t=AM(t,t.shape.concat(e))}else if(o>r){n=o-r;const t=[];for(let e=0;e<n;++e)t.push(1);e=AM(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)i=a[0]===a[1]?uP(oF(e,t),a[0]):uP(oF(hL(e,[1,0]),t),a[1]);else{const n=a[0]!==e.shape.length-1,r=a[1]===t.shape.length-1;i=kP(e,t,n,r)}if(n>0){let e;e=r>o?r+o-3:r-1;const t=[];for(let r=e;r<e+n;++r)t.push(r);i=nL(i,t)}return 1===i.shape.length&&(i=ZM(i,1)),i}))}(n,r,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[IK(this.axes,e.length),IK(this.axes,t.length)],n}computeOutputShape(e){ME(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new xj("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const o=t.concat(n);return 1===o.length&&o.push(1),o}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}CK.className="Dot",fF(CK);class AK extends hG{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return sO((()=>{this.invokeCallHook(e,t);const n=eG(e);return NV((()=>tF(kV(n.shape,0,this.stddev),n)),(()=>n),t.training||!1)}))}}AK.className="GaussianNoise",fF(AK);class EK extends hG{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return sO((()=>{this.invokeCallHook(e,t);const n=eG(e);if(this.rate>0&&this.rate<1){return NV((()=>{const e=Math.sqrt(this.rate/(1-this.rate));return oF(n,kV(n.shape,1,e))}),(()=>n),t.training||!1)}return n}))}}EK.className="GaussianDropout",fF(EK);class TK extends hG{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||eG(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return sO((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e),r=()=>{const t=eG(e),r=-1.7580993408473766;let o=aP(WP(n),this.rate);o=fV(o,"float32");const a=((1-this.rate)*(1+this.rate*r**2))**-.5,i=-a*r*this.rate,s=tF(oF(t,o),oF(tF(o,-1),r));return tF(oF(s,a),i)};return NV(r,(()=>eG(e)),t.training||!1)}return e}))}}function NK(e,t,n,r,o){let a,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)a=RM(e,t,n,r,o,i);else if(3===e.rank)a=_M(e,t,n,r,o,i);else{if(4!==e.rank)throw new xj("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");a=DM(e,t,n,r,o,i)}return a}function RK(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return BE(r.slice().sort(),dV(0,e.rank-1))?function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return sO((()=>{const a=TP(e,r),i=a.mean,s=a.variance;return[NK(e,i,s,n,t,o),i,s]}))}(e,t,n,r,o):function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return sO((()=>{const a=TP(e,r),i=a.mean,s=a.variance,c=[];for(const t of dV(0,e.rank))-1!==r.indexOf(t)?c.push(1):c.push(e.shape[t]);const l=AM(i,c),u=AM(s,c),d=null==t?null:AM(t,c),h=null==n?null:AM(n,c);return[NK(e,l,u,h,d,o),i,s]}))}(e,t,n,r,o)}TK.className="AlphaDropout",fF(TK);class _K extends hG{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=JV(e.betaInitializer||"zeros"),this.gammaInitializer=JV(e.gammaInitializer||"ones"),this.movingMeanInitializer=JV(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=JV(e.movingVarianceInitializer||"ones"),this.betaConstraint=_G(e.betaConstraint),this.gammaConstraint=_G(e.gammaConstraint),this.betaRegularizer=yq(e.betaRegularizer),this.gammaRegularizer=yq(e.gammaRegularizer)}build(e){e=tG(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new bj("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new sG({ndim:e.length,axes:{[t]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return sO((()=>{const n=null!=t.training&&t.training,r=eG(e),o=r.shape,a=o.length,i=dV(0,a),s=this.axis>=0?this.axis:this.axis+a;i.splice(s,1);const c=Sj(1,a);c[s]=o[s];const l=i.slice();l.sort();const u=!BE(l,dV(0,a).slice(0,a-1));if(!n)return(()=>{if(u){const e=AM(this.movingMean.read(),c),t=AM(this.movingVariance.read(),c),n=this.center?AM(this.beta.read(),c):null,o=this.scale?AM(this.gamma.read(),c):null;return NK(r,e,t,n,o,this.epsilon)}return NK(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[d,h,p]=RK(r,this.gamma.read(),this.beta.read(),i,this.epsilon),f=(e,t,n)=>{sO((()=>{const r=1-n,o=e.read(),a=oF(xF(o,t),r);e.write(xF(o,a))}))};return(()=>{f(this.movingMean,h,this.momentum),f(this.movingVariance,p,this.momentum)})(),d}))}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:QV(this.betaInitializer),gammaInitializer:QV(this.gammaInitializer),movingMeanInitializer:QV(this.movingMeanInitializer),movingVarianceInitializer:QV(this.movingVarianceInitializer),betaRegularizer:gq(this.betaRegularizer),gammaRegularizer:gq(this.gammaRegularizer),betaConstraint:NG(this.betaConstraint),gammaConstraint:NG(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}_K.className="BatchNormalization",fF(_K);class DK extends hG{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));for(const e of this.axis)if(!Number.isInteger(e))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=JV(e.betaInitializer||"zeros"),this.gammaInitializer=JV(e.gammaInitializer||"ones"),this.betaRegularizer=yq(e.betaRegularizer),this.gammaRegularizer=yq(e.gammaRegularizer),this.supportsMasking=!0}build(e){const t=(e=tG(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=t);for(const o of this.axis)if(o<0||o>=t)throw new Error("Invalid axis: ".concat(o));if(this.axis.length!==Mj(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map((t=>e[t])),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const n=eG(e),r=n.shape,o=r.length;return sO((()=>{let{mean:e,variance:t}=TP(n,this.axis,!0);const a=Sj(1,o);for(const n of this.axis)a[n]=r[n];const i=e=>null!=e&&e.shape.length!==o?AM(e,a):e;let s=this.scale?i(this.gamma.read()):null,c=this.center?i(this.beta.read()):null;const l=[],u=[];for(let n=0;n<o;++n)-1!==this.axis.indexOf(n)?(l.push(r[n]),u.push(1)):(l.push(1),u.push(r[n]));return e=eP(e,l),t=eP(t,l),null!=s&&(s=eP(s,u)),null!=c&&(c=eP(c,u)),NK(n,e,t,c,s,this.epsilon)}))}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:QV(this.betaInitializer),gammaInitializer:QV(this.gammaInitializer),betaRegularizer:gq(this.betaRegularizer),gammaRegularizer:gq(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}DK.className="LayerNormalization",fF(DK);class OK extends hG{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new bj("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));let t,n;if("number"===typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new bj("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],2!==e.padding[1].length)throw new bj("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new sG({ndim:4})]}computeOutputShape(e){let t,n;return e=tG(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return sO((()=>function(e,t,n){return sO((()=>{if(4!==e.rank)throw new bj("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new bj("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new bj("Unknown data format: ".concat(n,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let r;return r="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],MP(e,r)}))}(eG(e),this.padding,this.dataFormat)))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}function FK(e,t,n,r,o,a){return sO((()=>{let i;$j(o),eV(a),Zj(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==o&&(o="channelsLast"),null==a&&(a="max"),e=Tq(e,o);const s="same"===r?"same":"valid";return i="max"===a?SP(e,t,n,s):EM(e,t,n,s),"channelsFirst"===o&&(i=hL(i,[0,3,1,2])),i}))}function MK(e,t,n,r,o,a){return sO((()=>{let i;$j(o),eV(a),Zj(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==o&&(o="channelsLast"),null==a&&(a="max"),e=Nq(e,o);const s="same"===r?"same":"valid";return i="max"===a?IP(e,t,n,s):TM(e,t,n,s),"channelsFirst"===o&&(i=hL(i,[0,4,1,2,3])),i}))}OK.className="ZeroPadding2D",fF(OK);class PK extends hG{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"===typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new bj("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));this.poolSize=e.poolSize}if(Bj(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"===typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new bj("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));this.strides=e.strides}Bj(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,Zj(this.padding),this.inputSpec=[new sG({ndim:3})]}computeOutputShape(e){const t=Aq((e=tG(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return sO((()=>{this.invokeCallHook(e,t),e=mV(eG(e),2);const n=this.poolingFunction(eG(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return nL(n,[2])}))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class LK extends PK{constructor(e){super(e)}poolingFunction(e,t,n,r,o){return $j(o),Zj(r),FK(e,t,n,r,o,"max")}}LK.className="MaxPooling1D",fF(LK);class zK extends PK{constructor(e){super(e)}poolingFunction(e,t,n,r,o){return $j(o),Zj(r),FK(e,t,n,r,o,"avg")}}zK.className="AveragePooling1D",fF(zK);class BK extends hG{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new bj("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];Bj(this.poolSize,"poolSize"),Bj(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,$j(this.dataFormat),Zj(this.padding),this.inputSpec=[new sG({ndim:4})]}computeOutputShape(e){e=tG(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=Aq(t,this.poolSize[0],this.padding,this.strides[0]),n=Aq(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return sO((()=>(this.invokeCallHook(e,t),this.poolingFunction(eG(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class UK extends BK{constructor(e){super(e)}poolingFunction(e,t,n,r,o){return $j(o),Zj(r),FK(e,t,n,r,o,"max")}}UK.className="MaxPooling2D",fF(UK);class WK extends BK{constructor(e){super(e)}poolingFunction(e,t,n,r,o){return $j(o),Zj(r),FK(e,t,n,r,o,"avg")}}WK.className="AveragePooling2D",fF(WK);class jK extends hG{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new bj("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Bj(this.poolSize,"poolSize"),Bj(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,$j(this.dataFormat),Zj(this.padding),this.inputSpec=[new sG({ndim:5})]}computeOutputShape(e){e=tG(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=Aq(t,this.poolSize[0],this.padding,this.strides[0]),n=Aq(n,this.poolSize[1],this.padding,this.strides[1]),r=Aq(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return sO((()=>(this.invokeCallHook(e,t),this.poolingFunction(eG(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class VK extends jK{constructor(e){super(e)}poolingFunction(e,t,n,r,o){return $j(o),Zj(r),MK(e,t,n,r,o,"max")}}VK.className="MaxPooling3D",fF(VK);class GK extends jK{constructor(e){super(e)}poolingFunction(e,t,n,r,o){return $j(o),Zj(r),MK(e,t,n,r,o,"avg")}}GK.className="AveragePooling3D",fF(GK);class HK extends hG{constructor(e){super(e),this.inputSpec=[new sG({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new xj}}class qK extends HK{constructor(e){super(e||{})}call(e,t){return sO((()=>{const t=eG(e);return CP(t,1)}))}}qK.className="GlobalAveragePooling1D",fF(qK);class KK extends HK{constructor(e){super(e||{})}call(e,t){return sO((()=>{const t=eG(e);return lP(t,1)}))}}KK.className="GlobalMaxPooling1D",fF(KK);class XK extends hG{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,$j(this.dataFormat),this.inputSpec=[new sG({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new xj}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class YK extends XK{call(e,t){return sO((()=>{const t=eG(e);return"channelsLast"===this.dataFormat?CP(t,[1,2]):CP(t,[2,3])}))}}YK.className="GlobalAveragePooling2D",fF(YK);class QK extends XK{call(e,t){return sO((()=>{const t=eG(e);return"channelsLast"===this.dataFormat?lP(t,[1,2]):lP(t,[2,3])}))}}QK.className="GlobalMaxPooling2D",fF(QK);class JK extends hG{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=VG(t.layer,n);delete t.layer;const o={layer:r};return Object.assign(o,t),new e(o)}}class $K extends JK{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=tG(e)).length<3)throw new bj("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){const t=[(e=tG(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return sO((()=>qq(((e,n)=>[eG(this.layer.call(e,t)),[]]),e=eG(e),[],!1,null,null,!1,!0)[1]))}}$K.className="TimeDistributed",fF($K);class ZK extends JK{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=VG(n),t.goBackwards=!0!==t.goBackwards;const r={};var o;if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=VG(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,o=this.mergeMode,Lj(Qj,"BidirectionalMergeMode",o),e.weights)throw new xj("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,r,o=this.forwardLayer.computeOutputShape(e);return Array.isArray(o)&&Array.isArray(o[0])||(o=[o]),this.returnState?(r=o.slice(1),t=o[0]):t=o[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):Aj(n)}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const o=Hq(e,n,r,this.numConstants);if(e=o.inputs,n=o.initialState,r=o.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==r)return super.apply(e,t);const a=[],i=[];if(null!=n){const e=n.length;if(e%2>0)throw new bj("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,a.push(...n);const r=n.map((e=>new sG({shape:e.shape})));this.forwardLayer.stateSpec=r.slice(0,e/2),this.backwardLayer.stateSpec=r.slice(e/2),i.push(...r)}if(null!=r)throw new xj("Support for constants in Bidirectional layers is not implemented yet.");const s=a[0]instanceof cG;for(const c of a)if(c instanceof cG!==s)throw new bj("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(s){const n=[e].concat(a),r=this.inputSpec.concat(i),o=this.inputSpec;this.inputSpec=r;const s=super.apply(n,t);return this.inputSpec=o,s}return super.apply(e,t)}call(e,t){return sO((()=>{const n=t.initialState;let r,o,a,i;if(null==n)r=this.forwardLayer.call(e,t),o=this.backwardLayer.call(e,t);else{const a=n.slice(0,n.length/2),i=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:a})),o=this.backwardLayer.call(e,Object.assign(t,{initialState:i}))}return this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),this.returnSequences&&(o=GP(o,1)),"concat"===this.mergeMode?i=bV([r,o]):"sum"===this.mergeMode?i=tF(r,o):"ave"===this.mergeMode?i=oF(.5,tF(r,o)):"mul"===this.mergeMode?i=oF(r,o):null==this.mergeMode&&(i=[r,o]),this.returnState?null==this.mergeMode?i.concat(a):[i].concat(a):i}))}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){nV(this.forwardLayer.name,(()=>{this.forwardLayer.build(e)})),nV(this.backwardLayer.name,(()=>{this.backwardLayer.build(e)})),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){const e=this.forwardLayer.states.map((e=>null));return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=VG(t.layer);if(delete t.layer,null!=t.numConstants)throw new xj("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=n,new e(r)}}ZK.className="Bidirectional",fF(ZK);class eX extends hG{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return sO((()=>("float32"!==(e=eG(e)).dtype&&(e=fV(e,"float32")),tF(oF(e,this.scale),this.offset))))}}eX.className="Rescaling",fF(eX);const{resizeBilinear:tX,cropAndResize:nX}=pz;class rX extends hG{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,o,a,i,s){return sO((()=>{let c,l=!1;const u=[t/a,n/i,(r+t)/a,(o+n)/i],d=[];3===e.rank?(l=!0,c=rL([e])):c=e;for(let e=0;e<c.shape[0];e++)d.push(u);const h=nO(d,[d.length,4]),p=jP(0,d.length,1,"int32"),f=nX(c,h,p,[r,o],"nearest");return fV(l?eG(cL(f)):f,s)}))}upsize(e,t,n,r){return sO((()=>fV(tX(e,[t,n]),r)))}call(e,t){return sO((()=>{const t=eG(e),n=t.dtype,r=t.shape,o=r[r.length-3],a=r[r.length-2];let i=0;o!==this.height&&(i=Math.floor((o-this.height)/2));let s=0;return a!==this.width&&(s=Math.floor((a-this.width)/2),0===s&&(s=1)),i>=0&&s>=0?this.centerCrop(t,i,s,this.height,this.width,o,a,n):this.upsize(e,this.height,this.width,n)}))}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=tG(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}rX.className="CenterCrop",fF(rX);class oX extends hG{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=tG(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return sO((()=>{let n;if("int32"!==(e=eG(e)).dtype&&(e=fV(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==this.outputMode)throw new bj("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=eG(t.countWeights)}const r=lP(e),o=AP(e),a=oP(this.numTokens,r).bufferSync().get(0),i=aP(o,0).bufferSync().get(0);if(!a||!i)throw new bj("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(this.numTokens));return function(e,t,n,r){let o=eG(e);if("int32"!==o.dtype&&(o=fV(o,"int32")),"int"===t)return o;const a=o.shape;if(0===o.rank&&(o=ZM(o,-1)),"oneHot"===t&&1!==o.shape[o.shape.length-1]&&(o=ZM(o,-1)),o.rank>2)throw new bj("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(a)+" which would result in output rank ".concat(o.rank,"."));const i=["multiHot","oneHot"].includes(t),s=o;let c;if(c=KM(s,"undefined"!==typeof r&&"count"===t?r:[],n,i),"tfIdf"!==t)return c;if(r)return oF(c,r);throw new bj("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)}))}}oX.className="CategoryEncoding",fF(oX);const aX=new Set(["bilinear","nearest"]);class iX extends hG{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!aX.has(e.interpolation))throw new bj("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){const t=(e=tG(e))[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return sO((()=>{const t=[this.height,this.width];if("bilinear"===this.interpolation)return pz.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return pz.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...aX]," are supported"))}))}}iX.className="Resizing",fF(iX);class sX{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}sX.className="RandomSeed";class cX extends hG{constructor(e){super(e),this.randomGenerator=new sX(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}cX.className="BaseRandomLayer";const lX=new Set(["bilinear","nearest"]);class uX extends cX{constructor(e){super(e);const{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new bj("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new bj("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new bj("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n){if(!lX.has(n))throw new bj("Invalid interpolation parameter: ".concat(n," is not implemented"));this.interpolation=n}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=tG(e))[2];return[this.imgHeight,-1,t]}call(e,t){return sO((()=>{const t=eG(e);this.imgHeight=t.shape[t.shape.length-3];const n=t.shape[t.shape.length-2];this.widthFactor=WP([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);const o=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return pz.resizeBilinear(e,o);case"nearest":return pz.resizeNearestNeighbor(e,o);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...lX]," are supported"))}}))}}uX.className="RandomWidth",fF(uX);var dX,hX;mT().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(dX||(dX={})),function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(hX||(hX={}));Error;new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function pX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const o=t(e);if(o.recurse&&null!==o.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(o.recurse){if(vX(e)){const o=Array.isArray(e)?[]:{};r.add(e);for(const a in e){const i=pX(e[a],t,n,r);o[a]=i}return r.delete(e),e.__proto__&&(o.__proto__=e.__proto__),o}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,o.value),o.value}function fX(e){return mX(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:gX)}function mX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");const o=t(e);if(o.recurse&&null!==o.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(o.recurse){if(vX(r)){const o=Array.isArray(r)?[]:{};n.add(r);for(const a in r){const r=e.map((e=>e[a])),i=mX(r,t,n);o[a]=i}return n.delete(r),o}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return o.value}function gX(e){return null===e?null:vX(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function vX(e){let t=!1;if(mT().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:r}=n(551);t=e instanceof r}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof wD)&&!(e instanceof Promise)&&!t)}function yX(e){return function(e,t){return pX(e,t)}(e,bX)}function bX(e){return e instanceof wD?{value:e.clone(),recurse:!1}:vX(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}class xX{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}class wX extends xX{constructor(){super(wX.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=2*this.capacity,t=new Array(e),n=this.length();for(let r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function kX(e){return new AX(e)}function SX(e,t){return new LX(e,t)}wX.INITIAL_CAPACITY=32;class IX{async toArray(){const e=[];let t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),t=[];let n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new OX(this,e)}filter(e){return new _X(this,e)}map(e){return new DX(this,e)}mapAsync(e){return new FX(this,e)}serialMapAsync(e){return new FX(this,e).serial()}flatmap(e){return new PX(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile((e=>!0===e))}rowMajorBatch(e){return new RX(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gX;return this.rowMajorBatch(e,t).map((e=>fX(e,n)))}concatenate(e,t){return new LX(new CX([this,e]),t)}take(e){return e<0||null==e?this:new NX(this,e)}skip(e){return e<0||null==e?this:new TX(this,e)}prefetch(e){return new BX(this,e)}shuffle(e,t){return new UX(this,e,t)}serial(){return new EX(this)}}class CX extends IX{constructor(e){super(),this.items=e,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:yX(e),done:!1}}}class AX extends IX{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(_se){throw _se.message="Error thrown while iterating through a dataset: ".concat(_se.message),_se}}}class EX extends IX{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}}class TX extends IX{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;cO(e.value)}return this.upstream.next()}}class NX extends IX{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class RX extends IX{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}}class _X extends IX{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;cO(e.value)}}}class DX extends IX{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=PD(e.value),n=this.transform(e.value),r=PD(n);for(const o of t)MD(o,r)||o.dispose();return{value:n,done:!1}}}class OX extends IX{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(_se){if(!this.handler(_se))return{value:null,done:!0}}}}class FX extends IX{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=PD(e.value),n=await this.transform(e.value),r=PD(n);for(const o of t)MD(o,r)||o.dispose();return{value:n,done:!1}}}class MX extends IX{constructor(){super(),this.outputQueue=new wX,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class PX extends MX{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){const e=await this.upstream.next();if(e.done)return!1;const t=PD(e.value),n=this.transform(e.value),r=PD(n);this.outputQueue.pushAll(n);for(const o of t)MD(o,r)||o.dispose();return!0}}class LX extends IX{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){const e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}}var zX;!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(zX||(zX={}));class BX extends IX{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new xX(t)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class UX extends BX{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=LP.alea(n||oD().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}}class WX{constructor(){this.size=null}batch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let r;return ME(e>0,(()=>"batchSize needs to be positive, but it is\n      ".concat(e))),r=this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e),jX((async()=>(await n.iterator()).columnMajorBatch(e,t,VX)),r)}concatenate(e){const t=this;let n;return n=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,jX((async()=>(await t.iterator()).concatenate(await e.iterator())),n)}filter(e){const t=this;let n;return n=this.size===1/0?1/0:null,jX((async()=>(await t.iterator()).filter((t=>sO((()=>e(t)))))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const t=this;return jX((async()=>(await t.iterator()).map((t=>sO((()=>e(t)))))),this.size)}mapAsync(e){const t=this;return jX((async()=>(await t.iterator()).mapAsync(e)),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const t=this;return jX((async()=>(await t.iterator()).prefetch(e)),this.size)}repeat(e){const t=this;let n;return n=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,jX((async()=>SX(kX((async()=>({value:await t.iterator(),done:!1}))).take(e))),n)}skip(e){const t=this;let n;return n=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,jX((async()=>(await t.iterator()).skip(e)),n)}shuffle(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));const r=this,o=LP.alea(t||oD().toString());return jX((async()=>{let t=o.int32();return n&&(t+=o.int32()),(await r.iterator()).shuffle(e,t.toString())}),this.size)}take(e){const t=this;let n;return n=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,jX((async()=>(await t.iterator()).take(e)),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function jX(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends WX{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function VX(e){if(null===e)return null;if(function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof wD||sD(e);var t}(e[0])){return{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof wD?rL(e):nO(e)}(e),recurse:!1}}return{value:null,recurse:!0}}WX.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function GX(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&ME("complex64"!==e.dtype,(()=>"".concat(t," does not support complex64 tensors in the CPU backend.")))}))}const HX=EB;class qX extends NE{nextDataId(){return qX.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new TE(this,aO())}write(e,t,n){this.firstUse&&(this.firstUse=!1,mT().get("IS_NODE")&&__("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&JE(n[0])){const o=n.map((e=>aD(e)));r=this.write(o,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){if(this.data.has(e)){return this.data.get(e).refCount}return 0}incRef(e){this.data.get(e).refCount++}decRef(e){if(this.data.has(e)){this.data.get(e).refCount--}}move(e,t,n,r,o){this.data.set(e,{values:t,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){return Hz(this.readSync(n.real.dataId),this.readSync(n.imag.dataId))}return function(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>iD(e)));return JO(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return JO(e.shape,e.dtype,t)}makeOutput(e,t,n){return aO().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=oD();e();return{kernelMs:oD()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){GX([e],"where");const t=this.readSync(e.dataId);return HX(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}qX.nextDataId=0;function KX(e){return(t,n,r)=>{const o=XE(n,t.length);for(let a=0;a<t.length;++a)o[a]=e(t[a],r);return o}}function XX(e,t,n){return YX(e,KX(t),n)}function YX(e,t,n){return r=>{let{inputs:o,attrs:a,backend:i}=r;const{x:s}=o;GX(s,e);const c=i,l=c.data.get(s.dataId).values;let u;if("string"===s.dtype){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=CB(l)}else u=l;const d=n||s.dtype,h=t(u,d,a);return c.makeTensorInfo(s.shape,d,h)}}uO("cpu",(()=>new qX),1);const QX=XX(yN,(e=>e>=0?e:Math.exp(e)-1)),JX={kernelName:yN,backendName:"cpu",kernelFunc:QX};function $X(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const ZX={kernelName:MN,backendName:"cpu",kernelFunc:$X};function eY(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{alpha:a}=r;GX([o],"leakyRelu");const i=zE(o.shape),s=n.data.get(o.dataId).values,c=KE("float32",i);for(let l=0;l<s.length;l++)c[l]=s[l]<0?a*s[l]:s[l];return n.makeTensorInfo(o.shape,"float32",c)}const tY={kernelName:WN,backendName:"cpu",kernelFunc:eY};function nY(e){return(t,n,r,o,a)=>{const i=CF(t,n),s=i.length,c=nT(i),l=KE(a,zE(i)),u=t.length,d=n.length,h=nT(t),p=nT(n),f=SF(t,i),m=SF(n,i);if(f.length+m.length===0)for(let g=0;g<l.length;++g)l[g]=e(r[g%r.length],o[g%o.length]);else for(let g=0;g<l.length;++g){const t=uT(g,s,c),n=t.slice(-u);f.forEach((e=>n[e]=0));const a=lT(n,u,h),i=t.slice(-d);m.forEach((e=>i[e]=0));const v=lT(i,d,p);l[g]=e(r[a],o[v])}return[l,i]}}const rY=nY(((e,t)=>e<0?t*e:e));function oY(e){const{inputs:t,backend:n}=e,{x:r,alpha:o}=t;GX([r,o],"prelu");const a=n.data.get(r.dataId).values,i=n.data.get(o.dataId).values,[s,c]=rY(r.shape,o.shape,a,i,"float32");return n.makeTensorInfo(c,"float32",s)}const aY={kernelName:kR,backendName:"cpu",kernelFunc:oY},iY=XX(RR,(e=>Math.max(0,e))),sY={kernelName:RR,backendName:"cpu",kernelFunc:iY},cY=XX(PR,(e=>Math.min(Math.max(0,e),6))),lY={kernelName:PR,backendName:"cpu",kernelFunc:cY},uY=KX((e=>1/(1+Math.exp(-e)))),dY=XX(YR,(e=>1/(1+Math.exp(-e)))),hY={kernelName:YR,backendName:"cpu",kernelFunc:dY};function pY(e,t,n,r,o){if("linear"===n)return $X({inputs:{x:t},backend:e});if("relu"===n)return iY({inputs:{x:t},backend:e});if("elu"===n)return QX({inputs:{x:t},backend:e});if("relu6"===n)return cY({inputs:{x:t},backend:e});if("prelu"===n)return oY({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return eY({inputs:{x:t},backend:e,attrs:{alpha:o}});if("sigmoid"===n)return dY({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function fY(e){const{inputs:t,backend:n}=e,{real:r,imag:o}=t,a=n.data.get(r.dataId).values,i=n.data.get(o.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(o.shape,"float32",i)},s}const mY={kernelName:qT,backendName:"cpu",kernelFunc:fY};function gY(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return fY({inputs:{real:gY(e,t,"float32"),imag:gY(e,t,"float32")},backend:e})}const r=iT(zE(t),n);return e.makeTensorInfo(t,n,r)}function vY(e){const{inputs:t,backend:n}=e,{input:r}=t,o=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(o.dataId).values;return n.makeTensorInfo(o.shape,o.dtype,a)}const yY={kernelName:TR,backendName:"cpu",kernelFunc:vY};function bY(e,t,n,r){if("int32"===r){return[t,"int32",Int32Array.from(e)]}if("bool"===r){const r=rD([0],n),[o,a]=nY(((e,t)=>e!==t?1:0))(t,[],e,r,"bool");return[a,"bool",o]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function xY(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{dtype:a}=r;if("complex64"===a){if("complex64"===o.dtype)return $X({inputs:{x:o},backend:n});const e=gY(n,o.shape,o.dtype),t=xY({inputs:{x:o},backend:n,attrs:{dtype:"float32"}}),r=fY({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===o.dtype){const e=vY({inputs:{input:o},backend:n}),t=xY({inputs:{x:e},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(e),t}if(!YE(o.dtype,a)){const e=$X({inputs:{x:o},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:a}}const i=n.data.get(o.dataId).values,[s,c,l]=bY(i,o.shape,o.dtype,a);return n.makeTensorInfo(s,c,l)}const wY={kernelName:VT,backendName:"cpu",kernelFunc:xY};function kY(e,t,n,r){return null==n?n=>{let{inputs:o,backend:a}=n;const{a:i,b:s}=o,c=a;GX([i,s],e);const l=c.data.get(i.dataId).values,u=c.data.get(s.dataId).values,d="string"===i.dtype?CB(l):l,h="string"===i.dtype?CB(u):u,p=r||i.dtype,[f,m]=t(i.shape,s.shape,d,h,p);return c.makeTensorInfo(m,p,f)}:e=>{let{inputs:o,backend:a}=e;const{a:i,b:s}=o,c=a;if("complex64"===i.dtype||"complex64"===s.dtype){const e=xY({inputs:{x:i},backend:c,attrs:{dtype:"complex64"}}),t=c.data.get(e.dataId),r=t.complexTensorInfos.real,o=t.complexTensorInfos.imag,a=c.data.get(r.dataId).values,l=c.data.get(o.dataId).values,u=xY({inputs:{x:s},backend:c,attrs:{dtype:"complex64"}}),d=c.data.get(u.dataId),h=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,f=c.data.get(h.dataId).values,m=c.data.get(p.dataId).values,[g,v,y]=n(i.shape,s.shape,a,l,f,m),b=c.makeTensorInfo(y,"float32",g),x=c.makeTensorInfo(y,"float32",v),w=fY({inputs:{real:b,imag:x},backend:c});return c.disposeIntermediateTensorInfo(e),c.disposeIntermediateTensorInfo(u),c.disposeIntermediateTensorInfo(b),c.disposeIntermediateTensorInfo(x),w}{const e=c.data.get(i.dataId).values,n=c.data.get(s.dataId).values,o=r||i.dtype,[a,l]=t(i.shape,s.shape,e,n,o);return c.makeTensorInfo(l,o,a)}}}function SY(e){return(t,n,r,o,a,i)=>{const s=CF(t,n),c=zE(s),l=s.length,u=nT(s),d=KE("float32",c),h=KE("float32",c),p=SF(t,s),f=SF(n,s),m=Hz(r,o),g=Hz(a,i),v=t.length,y=nT(t),b=n.length,x=nT(n);if(p.length+f.length===0)for(let w=0;w<d.length;w++){const t=w%m.length,n=w%g.length,r=e(m[2*t],m[2*t+1],g[2*n],g[2*n+1]);d[w]=r.real,h[w]=r.imag}else for(let w=0;w<d.length;w++){const t=uT(w,l,u),n=t.slice(-v);p.forEach((e=>n[e]=0));const r=lT(n,v,y),o=t.slice(-b);f.forEach((e=>o[e]=0));const a=lT(o,b,x),i=e(m[2*r],m[2*r+1],g[2*a],g[2*a+1]);d[w]=i.real,h[w]=i.imag}return[d,h,s]}}const IY=nY(((e,t)=>e+t)),CY=SY(((e,t,n,r)=>({real:e+n,imag:t+r}))),AY=kY(ST,IY,CY),EY={kernelName:ST,backendName:"cpu",kernelFunc:AY};function TY(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{shape:a}=r,i=zE(o.shape),s=GE(a,i),c=zE(s);ME(i===c,(()=>"The new shape (".concat(s,") has ").concat(c," elements and the old ")+"shape (".concat(o.shape,") has ").concat(i," elements. The new shape and old ")+"shape must have the same number of elements.")),n.incRef(o.dataId);const l=n.data.get(o.dataId);if(null!=l.complexTensorInfos){const e=l.complexTensorInfos.real,t=l.complexTensorInfos.imag;e.shape=s,t.shape=s}return{dataId:o.dataId,shape:s,dtype:o.dtype}}const NY={kernelName:_R,backendName:"cpu",kernelFunc:TY};function RY(e){const{inputs:t,backend:n,attrs:r}=e,{a:o,b:a}=t,{transposeA:i,transposeB:s}=r;GX([o,a],"matMul");const c=o.shape.length,l=a.shape.length,u=i?o.shape[c-2]:o.shape[c-1],d=s?a.shape[l-1]:a.shape[l-2],h=i?o.shape[c-1]:o.shape[c-2],p=s?a.shape[l-2]:a.shape[l-1],f=o.shape.slice(0,-2),m=a.shape.slice(0,-2),g=zE(f),v=zE(m),y=CF(o.shape.slice(0,-2),a.shape.slice(0,-2)).concat([h,p]);ME(u===d,(()=>"Error in matMul: inner shapes (".concat(u,") and (")+"".concat(d,") of Tensors with shapes ").concat(o.shape," and ")+"".concat(a.shape," and transposeA=").concat(i)+" and transposeB=".concat(s," must match.")));const b=s?[v,p,d]:[v,d,p],x=TY({inputs:{x:o},backend:n,attrs:{shape:i?[g,u,h]:[g,h,u]}}),w=TY({inputs:{x:a},backend:n,attrs:{shape:b}}),k=i?x.shape[1]:x.shape[2],S=i?x.shape[2]:x.shape[1],I=s?w.shape[1]:w.shape[2],C=Math.max(g,v),A=n.data.get(x.dataId).values,E=n.data.get(w.dataId).values,T=nT(x.shape),N=nT(w.shape),[R,_,D]=i?[T[0],1,T[1]]:[T[0],T[1],1],[O,F,M]=s?[1,N[1],N[0]]:[N[1],1,N[0]],P=S*I,L=JO([C,S,I],x.dtype),z=L.values,B=n.blockSize;for(let U=0;U<C;U++){const e=U%g,t=U%v;for(let n=0;n<S;n+=B){const r=Math.min(n+B,S);for(let o=0;o<I;o+=B){const a=Math.min(o+B,I);for(let i=0;i<k;i+=B){const s=Math.min(i+B,k);for(let c=n;c<r;c++)for(let n=o;n<a;n++){let r=0;for(let o=i;o<s;o++){r+=A[e*R+c*_+o*D]*E[o*O+n*F+t*M]}z[U*P+(c*I+n)]+=r}}}}}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(y,L.dtype,L.values)}const _Y={kernelName:zT,backendName:"cpu",kernelFunc:RY};const DY={kernelName:T_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:o,b:a,bias:i,preluActivationWeights:s}=t,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:d}=r;let h,p,f;const m=[];h=RY({inputs:{a:o,b:a},attrs:{transposeA:c,transposeB:l},backend:n}),i&&(p=AY({inputs:{a:h,b:i},backend:n}),m.push(h),h=p),u&&(f=pY(n,h,u,s,d),m.push(h),h=f);for(const g of m)n.disposeIntermediateTensorInfo(g);return h}};function OY(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const FY={kernelName:xT,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend;GX(t,"abs");let r=new Float32Array(zE(t.shape));return r=OY(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}},MY=XX(wT,(e=>Math.acos(e))),PY={kernelName:wT,backendName:"cpu",kernelFunc:MY},LY=XX(kT,(e=>Math.acosh(e))),zY={kernelName:kT,backendName:"cpu",kernelFunc:LY};const BY={kernelName:IT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,r=t;GX(t,"addN");const o=r.map((e=>n.data.get(e.dataId).values)),a=JO(r[0].shape,r[0].dtype),i=a.values;for(let s=0;s<r.length;s++){const e=o[s];for(let t=0;t<i.length;t++)i[t]+=e[t]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}};function UY(e,t,n,r,o){const a=t.length,i=zE(t),s=nT(t),c=nT(o),l=KE(n,zE(o));for(let u=0;u<i;++u){const t=uT(u,a,s),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[r[e]];l[lT(n,a,c)]=e[u]}return l}function WY(e){const{inputs:t,attrs:n,backend:r}=e,{x:o}=t,{perm:a}=n;GX(o,"transpose");const i=o.shape.length,s=new Array(i);for(let l=0;l<s.length;l++)s[l]=o.shape[a[l]];const c=UY(r.data.get(o.dataId).values,o.shape,o.dtype,a,s);return{dataId:r.write(c,s,o.dtype),shape:s,dtype:o.dtype}}const jY={kernelName:x_,backendName:"cpu",kernelFunc:WY};const VY={kernelName:CT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r;GX(o,"all");const s=HE(a,o.shape);let c=s;const l=vP(c,o.shape.length);let u=o;null!=l&&(u=WY({inputs:{x:o},backend:n,attrs:{perm:l}}),c=bP(c.length,o.shape.length)),gP("all",c,u.shape.length);const[d,h]=fP(u.shape,c),p=zE(h),f=iT(zE(d),u.dtype),m=n.data.get(u.dataId).values;for(let v=0;v<f.length;++v){const e=v*p;let t=m[e];for(let n=0;n<p;++n){const r=m[e+n];t=t&&r}f[v]=t}null!=l&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,f);if(i){const e=TY({inputs:{x:g},backend:n,attrs:{shape:mP(d,s)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const GY={kernelName:AT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r;GX(o,"any");const s=HE(a,o.shape);let c=s;const l=vP(c,o.shape.length);let u=o;null!=l&&(u=WY({inputs:{x:o},backend:n,attrs:{perm:l}}),c=bP(c.length,o.shape.length)),gP("any",c,u.shape.length);const[d,h]=fP(u.shape,c),p=zE(h),f=iT(zE(d),u.dtype),m=n.data.get(u.dataId).values;for(let v=0;v<f.length;++v){const e=v*p;let t=m[e];for(let n=0;n<p;++n){const r=m[e+n];t=t||r}f[v]=t}null!=l&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,f);if(i){const e=TY({inputs:{x:g},backend:n,attrs:{shape:mP(d,s)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const HY={kernelName:ET,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a}=r;GX(o,"argMax");let i=HE(a,o.shape);const s=vP(i,o.shape.length);let c=o;const l=[];null!=s&&(c=WY({inputs:{x:o},backend:n,attrs:{perm:s}}),l.push(c),i=bP(i.length,c.shape.length)),i=[i[0]],gP("argMax",i,c.shape.length);const[u,d]=fP(c.shape,i),h=iT(zE(u),"int32"),p=zE(d),f=n.data.get(c.dataId).values;for(let m=0;m<h.length;++m){const e=m*p;let t=f[e],n=0;for(let r=0;r<p;++r){const o=f[e+r];o>t&&(t=o,n=r)}h[m]=n}return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(u,"int32",h)}};const qY={kernelName:TT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a}=r;GX(o,"argMin");let i=HE(a,o.shape);const s=vP(i,o.shape.length);let c=o;const l=[];null!=s&&(c=WY({inputs:{x:o},backend:n,attrs:{perm:s}}),l.push(c),i=bP(i.length,c.shape.length)),i=[i[0]],gP("argMin",i,c.shape.length);const[u,d]=fP(c.shape,i),h=iT(zE(u),"int32"),p=zE(d),f=n.data.get(c.dataId).values;for(let m=0;m<h.length;++m){const e=m*p;let t=f[e],n=0;for(let r=0;r<p;++r){const o=f[e+r];o<t&&(t=o,n=r)}h[m]=n}return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(u,"int32",h)}},KY=XX(NT,(e=>Math.asin(e))),XY={kernelName:NT,backendName:"cpu",kernelFunc:KY},YY=XX(RT,(e=>Math.asinh(e))),QY={kernelName:RT,backendName:"cpu",kernelFunc:YY},JY=XX(_T,(e=>Math.atan(e))),$Y={kernelName:_T,backendName:"cpu",kernelFunc:JY},ZY=nY(((e,t)=>Math.atan2(e,t))),eQ=kY(OT,ZY),tQ={kernelName:OT,backendName:"cpu",kernelFunc:eQ},nQ=XX(DT,(e=>Math.atanh(e))),rQ={kernelName:DT,backendName:"cpu",kernelFunc:nQ};function oQ(e,t,n,r,o,a){const i=o.strideHeight,s=o.strideWidth,c=o.dilationHeight,l=o.dilationWidth,u=o.effectiveFilterHeight,d=o.effectiveFilterWidth,h=o.padInfo.top,p=o.padInfo.left,f="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=JO(o.outShape,n),g=m.values,v=o.outShape[1]*o.outShape[2]*o.outShape[3],y=o.outShape[2]*o.outShape[3],b=o.outShape[3];for(let x=0;x<o.batchSize;++x){const t=x*v,n=x*r[0];for(let m=0;m<o.inChannels;++m)for(let v=0;v<o.outHeight;++v){const x=v*i-h,w=Math.max(0,x),k=Math.min(o.inHeight,u+x),S=t+v*y;for(let t=0;t<o.outWidth;++t){const i=t*s-p,u=Math.max(0,i),h=Math.min(o.inWidth,d+i);let v=f,y=0,x=0;for(let t=w;t<k;t+=c){const o=n+t*r[1];for(let t=u;t<h;t+=l){const n=e[o+t*r[2]+m];"max"===a&&n>v?v=n:"avg"===a&&(y+=n,x++)}if(isNaN(v))break}g[S+t*b+m]="avg"===a?y/x:v}}}return m}function aQ(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=JO(r.outShape,"int32"),s=r.strideHeight,c=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,f=r.padInfo.left,m=JO(t,n,e);for(let g=0;g<r.batchSize;++g)for(let e=0;e<r.inChannels;++e)for(let t=0;t<r.outHeight;++t){const n=t*s-p;let v=n;for(;v<0;)v+=l;const y=Math.min(r.inHeight,d+n);for(let s=0;s<r.outWidth;++s){const d=s*c-f;let p=d;for(;p<0;)p+=u;const b=Math.min(r.inWidth,h+d);let x=Number.NEGATIVE_INFINITY,w=-1;for(let t=v;t<y;t+=l){const i=t-n;for(let n=p;n<b;n+=u){const s=n-d,c=m.get(g,t,n,e);c>x&&(x=c,w=o?a?((g*r.inHeight+t)*r.inWidth+n)*r.inChannels+e:(t*r.inWidth+n)*r.inChannels+e:i*h+s)}}i.set(w,g,t,s,e)}}return i}function iQ(e,t,n,r,o,a){const i=o.strideDepth,s=o.strideHeight,c=o.strideWidth,l=o.dilationDepth,u=o.dilationHeight,d=o.dilationWidth,h=o.effectiveFilterDepth,p=o.effectiveFilterHeight,f=o.effectiveFilterWidth,m=o.padInfo.front,g=o.padInfo.top,v=o.padInfo.left,y="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=JO(o.outShape,n),x=b.values,w=o.outShape[1]*o.outShape[2]*o.outShape[3]*o.outShape[4],k=o.outShape[2]*o.outShape[3]*o.outShape[4],S=o.outShape[3]*o.outShape[4],I=o.outShape[4];for(let C=0;C<o.batchSize;++C){const t=C*w,n=C*r[0];for(let b=0;b<o.inChannels;++b)for(let w=0;w<o.outDepth;++w){const C=w*i-m;let A=C;for(;A<0;)A+=l;const E=Math.min(o.inDepth,h+C),T=t+w*k;for(let t=0;t<o.outHeight;++t){const i=t*s-g;let h=i;for(;h<0;)h+=u;const m=Math.min(o.inHeight,p+i),w=T+t*S;for(let t=0;t<o.outWidth;++t){const i=t*c-v;let s=i;for(;s<0;)s+=d;const p=Math.min(o.inWidth,f+i),g=w+t*I;let k=y,S=0,C=0;for(let t=A;t<E;t+=l){const o=n+t*r[1];for(let t=h;t<m;t+=u){const n=o+t*r[2];for(let t=s;t<p;t+=d){const o=e[n+t*r[3]+b];if("max"===a&&o>k?k=o:"avg"===a&&(S+=o,C++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}x[g+b]="avg"===a?S/Math.max(C,1):k}}}}return b}const sQ={kernelName:FT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t;GX(o,"avgPool");const{filterSize:a,strides:i,pad:s,dimRoundingMode:c}=r;ME(kM(i,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'")));const l=hM(o.shape,a,i,1,s,c);let u;if(1===l.filterWidth&&1===l.filterHeight&&BE(l.inShape,l.outShape))u=$X({inputs:{x:o},backend:n});else{const e=n.data.get(o.dataId).values,t=nT(o.shape),r=oQ(e,o.shape,o.dtype,t,l,"avg");u=n.makeTensorInfo(l.outShape,o.dtype,r.values)}return u}};const cQ={kernelName:PT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{filterSize:a,strides:i,pad:s,dimRoundingMode:c,dataFormat:l}=r;GX(o,"avgPool3d");const u=pM(o.shape,a,i,1,s,c,l),d=iQ(n.data.get(o.dataId).values,o.shape,o.dtype,nT(o.shape),u,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}};const lQ={kernelName:LT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,input:a}=t,{filterSize:i,strides:s,pad:c,dimRoundingMode:l}=r;GX([o,a],"avgPool3DGrad");const u=pM(a.shape,i,s,1,c,l),d=u.strideDepth,h=u.strideHeight,p=u.strideWidth,f=u.filterDepth,m=u.filterHeight,g=u.filterWidth,v=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,x=u.effectiveFilterDepth,w=u.effectiveFilterHeight,k=u.effectiveFilterWidth,S=x-1-u.padInfo.front,I=k-1-u.padInfo.left,C=w-1-u.padInfo.top,A=JO(a.shape,"float32"),E=1/(f*m*g),T=n.bufferSync(o);for(let N=0;N<u.batchSize;++N)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inDepth;++t)for(let n=0;n<u.inHeight;++n)for(let r=0;r<u.inWidth;++r){const o=t-S,a=n-C,i=r-I;let s=0;for(let t=0;t<x;t+=v){const n=(o+t)/d;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let t=0;t<w;t+=y){const r=(a+t)/h;if(!(r<0||r>=u.outHeight||Math.floor(r)!==r))for(let t=0;t<k;t+=b){const o=(i+t)/p;if(o<0||o>=u.outWidth||Math.floor(o)!==o)continue;s+=T.get(N,n,r,o,e)}}}A.set(s*E,N,t,n,r,e)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}};const uQ={kernelName:MT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,input:a}=t,i=a;GX([o,a],"avgPoolGrad");const{filterSize:s,strides:c,pad:l}=r,u=hM(i.shape,s,c,1,l),d=u.strideHeight,h=u.strideWidth,p=u.filterHeight,f=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,v=u.effectiveFilterHeight,y=u.effectiveFilterWidth,b=y-1-u.padInfo.left,x=v-1-u.padInfo.top,w=JO(i.shape,"float32"),k=1/(p*f),S=n.data.get(o.dataId).values,I=JO(o.shape,"float32",S);for(let C=0;C<u.batchSize;++C)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inHeight;++t)for(let n=0;n<u.inWidth;++n){const r=t-x,o=n-b;let a=0;for(let t=0;t<v;t+=m){const n=(r+t)/d;if(!(n<0||n>=u.outHeight||Math.floor(n)!==n))for(let t=0;t<y;t+=g){const r=(o+t)/h;if(r<0||r>=u.outWidth||Math.floor(r)!==r)continue;a+=I.get(C,n,r,e)}}w.set(a*k,C,t,n,e)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};const dQ={kernelName:RN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,scale:a,offset:i,mean:s,variance:c}=t;ME(s.shape.length===c.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),ME(null==i||s.shape.length===i.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),ME(null==a||s.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),GX([o,s,c,a,i],"batchNorm");let{varianceEpsilon:l}=r;null==l&&(l=.001);const u=n.data.get(o.dataId).values,d=n.data.get(s.dataId).values,h=n.data.get(c.dataId).values,p=a?n.data.get(a.dataId).values:new Float32Array([1]),f=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=f.length,v=p.length,y=h.length,b=d.length;let x=0,w=0,k=0,S=0;for(let I=0;I<u.length;++I)m[I]=f[x++]+(u[I]-d[w++])*p[k++]/Math.sqrt(h[S++]+l),x>=g&&(x=0),w>=b&&(w=0),k>=v&&(k=0),S>=y&&(S=0);return n.makeTensorInfo(o.shape,o.dtype,m)}};function hQ(e,t,n,r,o){const a=rM(r,t,n),i=zE(n),s=nT(r);if(a){const n=oM(t,s);return"string"===o?e.slice(n,n+i):e.subarray(n,n+i)}const c=JO(r,o,"string"===o?CB(e):e),l=JO(n,o);for(let u=0;u<l.size;++u){const e=l.indexToLoc(u),n=e.map(((e,n)=>e+t[n]));l.set(c.get(...n),...e)}return"string"===o?AB(l.values):l.values}function pQ(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{begin:a,size:i}=r;GX(o,"slice");const[s,c]=aM(o,a,i);HF(o,s,c);const l=hQ(n.data.get(o.dataId).values,s,c,o.shape,o.dtype);return n.makeTensorInfo(c,o.dtype,l)}const fQ={kernelName:HR,backendName:"cpu",kernelFunc:pQ};const mQ={kernelName:BT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{blockShape:a,crops:i}=r;GX([o],"batchToSpaceND");const s=a.reduce(((e,t)=>e*t)),c=Tz(o.shape,a,s),l=Nz(c.length,a.length),u=Rz(o.shape,a,s),d=_z(i,a.length),h=Dz(u,i,a.length),p=TY({inputs:{x:o},backend:n,attrs:{shape:c}}),f=WY({inputs:{x:p},backend:n,attrs:{perm:l}}),m=TY({inputs:{x:f},backend:n,attrs:{shape:u}}),g=pQ({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};function gQ(e,t,n,r,o){const a=zE(r),i=iT(o,n);for(let s=0;s<e.length;s++){const n=e[s];if(n<0)throw new Error("Input x must be non-negative!");n>=o||(i[n]+=a>0?t[s]:1)}return i}function vQ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=e.shape[0],a=e.shape[1],i=JO([o,n],t.dtype);for(let s=0;s<o;s++)for(let o=0;o<a;o++){const a=e.get(s,o);if(a<0)throw new Error("Input x must be non-negative!");a>=n||(r?i.set(1,s,a):t.size>0?i.set(i.get(s,a)+t.get(s,o),s,a):i.set(i.get(s,a)+1,s,a))}return i}const yQ={kernelName:UT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,weights:a}=t,{size:i}=r,s=gQ(n.data.get(o.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,s)}},bQ=nY(((e,t)=>e&t)),xQ={kernelName:WT,backendName:"cpu",kernelFunc:kY(WT,bQ)};const wQ={kernelName:jT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:o}=t,a=n.data.get(r.dataId).values,i=n.data.get(o.dataId).values,s=CF(Array.from(a),Array.from(i));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},kQ=KX((e=>Math.ceil(e))),SQ=YX(GT,kQ),IQ={kernelName:GT,backendName:"cpu",kernelFunc:SQ},CQ=XX(HT,((e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),AQ={kernelName:HT,backendName:"cpu",kernelFunc:CQ},EQ={kernelName:KT,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(zE(t.shape)),o=n.data.get(t.dataId),a=o.complexTensorInfos.real,i=o.complexTensorInfos.imag,s=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values;for(let l=0;l<s.length;l++){const e=s[l],t=c[l];r[l]=Math.hypot(e,t)}return n.makeOutput(r,t.shape,"float32")}};function TQ(e,t,n,r){const o=XE(n,zE(t));if(r&&"string"!==n){let t=0;e.forEach((e=>{const n=zE(e.shape);o.set(e.vals,t),t+=n}))}else{let r=0;e.forEach((e=>{const a="string"===n?CB(e.vals):e.vals;let i=0;for(let n=0;n<e.shape[0];++n){const s=n*t[1]+r;for(let t=0;t<e.shape[1];++t)o[s+t]=a[i++]}r+=e.shape[1]}))}return o}function NQ(e){const{inputs:t,backend:n}=e,{input:r}=t,o=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(o.dataId).values;return n.makeTensorInfo(o.shape,o.dtype,a)}const RQ={kernelName:LN,backendName:"cpu",kernelFunc:NQ};function _Q(e){const{inputs:t,backend:n,attrs:r}=e,{axis:o}=r,a=HE(o,t[0].shape)[0];yz(t.map((e=>e.shape)),a);let i=bz(t.map((e=>e.shape)),a);if(0===zE(i))return n.makeTensorInfo(i,t[0].dtype,[]);const s=t.filter((e=>zE(e.shape)>0));if(1===s.length)return $X({inputs:{x:s[0]},backend:n});if("complex64"===s[0].dtype){const e=s.map((e=>vY({inputs:{input:e},backend:n}))),t=s.map((e=>NQ({inputs:{input:e},backend:n}))),r=_Q({inputs:e,backend:n,attrs:{axis:a}}),o=_Q({inputs:t,backend:n,attrs:{axis:a}}),i=fY({inputs:{real:r,imag:o},backend:n});return e.forEach((e=>n.disposeIntermediateTensorInfo(e))),t.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),i}const c=s.map((e=>{const t=zE(e.shape.slice(a));return TY({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),l=c.map((e=>({vals:n.data.get(e.dataId).values,shape:e.shape})));i=bz(c.map((e=>e.shape)),1);const u=1===c[0].shape[0],d=TQ(l,i,t[0].dtype,u),h=bz(s.map((e=>e.shape)),a),p=n.makeTensorInfo(h,t[0].dtype,d);return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),p}const DQ={kernelName:XT,backendName:"cpu",kernelFunc:_Q};function OQ(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a}=t,{strides:i,pad:s,dataFormat:c,dilations:l,dimRoundingMode:u}=r;GX([o,a],"conv2d");const d=IM(c),h=fM(o.shape,a.shape,i,l,s,u,!1,d),p=h.filterHeight,f=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,v=h.padInfo.left,y=h.padInfo.top,b="channelsLast"===h.dataFormat,x=new vD(h.outShape,o.dtype),w=nT(o.shape),k=nT(a.shape),S=w[0],I=b?w[1]:w[2],C=b?w[2]:1,A=b?1:w[1],E=x.strides[0],T=b?x.strides[1]:x.strides[2],N=b?x.strides[2]:1,R=b?1:x.strides[1],_=n.data.get(o.dataId).values,D=n.data.get(a.dataId).values,O=x.values;for(let F=0;F<h.batchSize;++F){const e=F*S,t=F*E;for(let n=0;n<h.outHeight;++n){const r=t+n*T,o=n*h.strideHeight-y;for(let t=0;t<p;++t){const n=o+t*m;if(n<0||n>=h.inHeight)continue;const a=t*k[0],i=e+n*I;for(let e=0;e<h.outWidth;++e){const t=r+e*N,n=e*h.strideWidth-v;for(let e=0;e<f;++e){const r=n+e*g;if(r<0||r>=h.inWidth)continue;const o=i+r*C;let s=a+e*k[1];for(let e=0;e<h.inChannels;++e){const n=_[o+e*A];for(let e=0;e<h.outChannels;++e)O[t+e*R]+=n*D[s+e];s+=h.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,O)}const FQ={kernelName:YT,backendName:"cpu",kernelFunc:OQ};const MQ={kernelName:QT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,dy:a}=t,{strides:i,pad:s,dataFormat:c,dimRoundingMode:l,filterShape:u}=r;GX([o,a],"conv2dBackpropFilter");const d=IM(c),h=fM(o.shape,u,i,1,s,l,!1,d),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:g}=h,v="channelsLast"===h.dataFormat,y=new vD(h.filterShape,"float32"),b=h.padInfo.left,x=h.padInfo.top,w=n.data.get(o.dataId).values,k=n.data.get(a.dataId).values,S=new vD(o.shape,o.dtype,w),I=new vD(a.shape,a.dtype,k);for(let C=0;C<m;++C){const e=Math.max(0,Math.ceil((x-C)/p)),t=Math.min(h.outHeight,(h.inHeight+x-C)/p);for(let n=0;n<g;++n){const r=Math.max(0,Math.ceil((b-n)/f)),o=Math.min(h.outWidth,(h.inWidth+b-n)/f);for(let a=0;a<h.inChannels;++a)for(let i=0;i<h.outChannels;++i){let s=0;for(let c=0;c<h.batchSize;++c)for(let l=e;l<t;++l){const e=C+l*p-x;for(let t=r;t<o;++t){const r=n+t*f-b;s+=v?S.get(c,e,r,a)*I.get(c,l,t,i):S.get(c,a,e,r)*I.get(c,i,l,t)}}y.set(s,C,n,a,i)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const PQ={kernelName:JT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,filter:a}=t,{inputShape:i,strides:s,pad:c,dataFormat:l,dimRoundingMode:u}=r;GX([o,a],"conv2dBackpropInput");const d=nT(a.shape),h=nT(o.shape);let p=IM(l);const f=fM(i,a.shape,s,1,c,u,!1,p),m=new vD(f.inShape,"float32"),g=m.values,v=n.data.get(o.dataId).values,y=n.data.get(a.dataId).values,[b,x,w]=d,{batchSize:k,filterHeight:S,filterWidth:I,inChannels:C,inHeight:A,inWidth:E,outChannels:T,outHeight:N,outWidth:R,strideHeight:_,strideWidth:D}=f;p=f.dataFormat;const O=S-1-f.padInfo.top,F=I-1-f.padInfo.left,M="channelsLast"===p,P=m.strides[0],L=M?m.strides[1]:m.strides[2],z=M?m.strides[2]:1,B=M?1:m.strides[1],U=h[0],W=M?h[1]:h[2],j=M?h[2]:1,V=M?1:h[1];for(let G=0;G<k;++G)for(let e=0;e<C;++e)for(let t=0;t<A;++t){const n=t-O,r=Math.max(0,Math.ceil(n/_)),o=Math.min(N,(S+n)/_);for(let a=0;a<E;++a){const i=a-F,s=Math.max(0,Math.ceil(i/D)),c=Math.min(R,(I+i)/D);let l=0;for(let t=r;t<o;++t){const r=t*_-n;for(let n=s;n<c;++n){const o=U*G+W*t+j*n,a=b*(S-1-r)+x*(I-1-(n*D-i))+w*e;for(let e=0;e<T;++e){l+=v[o+V*e]*y[a+e]}}}g[P*G+L*t+z*a+B*e]=l}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};const LQ={kernelName:$T,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a}=t,{strides:i,pad:s,dilations:c}=r;GX([o,a],"conv3d");const l=mM(o.shape,a.shape,i,c,s),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:p,dilationHeight:f,dilationWidth:m,padInfo:g}=l,v=g.front,y=g.left,b=g.top,x=new vD(l.outShape,o.dtype),w=n.data.get(o.dataId).values,k=n.data.get(a.dataId).values,S=x.values,I=nT(o.shape),C=nT(a.shape);for(let A=0;A<l.batchSize;++A){const e=A*I[0],t=A*x.strides[0];for(let n=0;n<l.outDepth;++n){const r=t+n*x.strides[1],o=n*l.strideDepth-v;for(let t=0;t<u;++t){const n=o+t*p;if(n<0||n>=l.inDepth)continue;const a=t*C[0],i=e+n*I[1];for(let e=0;e<l.outHeight;++e){const t=r+e*x.strides[2],n=e*l.strideHeight-b;for(let e=0;e<d;++e){const r=n+e*f;if(r<0||r>=l.inHeight)continue;const o=a+e*C[1],s=i+r*I[2];for(let e=0;e<l.outWidth;++e){const n=t+e*l.outChannels,r=e*l.strideWidth-y;for(let e=0;e<h;++e){const t=r+e*m;if(t<0||t>=l.inWidth)continue;const a=o+e*C[2],i=s+t*l.inChannels;let c=a;for(let e=0;e<l.inChannels;++e){const t=w[i+e];for(let e=0;e<l.outChannels;++e)S[n+e]+=t*k[c+e];c+=l.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};const zQ={kernelName:ZT,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,dy:a}=t,{strides:i,pad:s,filterShape:c}=r;GX([o,a],"conv3dBackpropFilterV2");const l=nT(o.shape),u=nT(a.shape),d=mM(o.shape,c,i,1,s),h=d.strideDepth,p=d.strideHeight,f=d.strideWidth,m=d.filterDepth,g=d.filterHeight,v=d.filterWidth,y=new vD(d.filterShape,"float32"),b=y.values,[x,w,k,S]=y.strides,I=n.data.get(a.dataId).values,[C,A,E,T]=u,N=n.data.get(o.dataId).values,[R,_,D,O]=l,F=d.padInfo.front,M=d.padInfo.left,P=d.padInfo.top;for(let L=0;L<m;++L){const e=Math.max(0,Math.ceil((F-L)/h)),t=Math.min(d.outDepth,(d.inDepth+F-L)/h),n=L*x;for(let r=0;r<g;++r){const o=Math.max(0,Math.ceil((P-r)/p)),a=Math.min(d.outHeight,(d.inHeight+P-r)/p),i=r*w+n;for(let n=0;n<v;++n){const s=Math.max(0,Math.ceil((M-n)/f)),c=Math.min(d.outWidth,(d.inWidth+M-n)/f),l=n*k+i;for(let i=0;i<d.inChannels;++i){const u=i*S+l;for(let l=0;l<d.outChannels;++l){let m=0;for(let u=0;u<d.batchSize;++u){const d=u*R,g=u*C;for(let u=e;u<t;++u){const e=(L+u*h-F)*_+d,t=u*A+g;for(let u=o;u<a;++u){const o=(r+u*p-P)*D+e,a=u*E+t;for(let e=s;e<c;++e){const t=e*T+a;m+=N[(n+e*f-M)*O+o+i]*I[t+l]}}}}b[u+l]=m}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const BQ={kernelName:eN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,filter:a}=t,{pad:i,strides:s,inputShape:c}=r;GX([o],"conv3dBackpropInputV2");const l=nT(o.shape),u=nT(a.shape),d=mM(c,a.shape,s,1,i),h=new vD(d.inShape,"float32"),p=h.values,[f,m,g,v]=h.strides,y=n.data.get(o.dataId).values,[b,x,w,k]=l,S=n.data.get(a.dataId).values,[I,C,A,E]=u,{batchSize:T,filterDepth:N,filterHeight:R,filterWidth:_,inChannels:D,inDepth:O,inHeight:F,inWidth:M,outChannels:P,outDepth:L,outHeight:z,outWidth:B,strideDepth:U,strideHeight:W,strideWidth:j}=d,V=N-1-d.padInfo.front,G=R-1-d.padInfo.top,H=_-1-d.padInfo.left;for(let q=0;q<T;++q)for(let e=0;e<D;++e)for(let t=0;t<O;++t){const n=t-V,r=Math.max(0,Math.ceil(n/U)),o=Math.min(L,(N+n)/U);for(let a=0;a<F;++a){const i=a-G,s=Math.max(0,Math.ceil(i/W)),c=Math.min(z,(R+i)/W);for(let l=0;l<M;++l){const u=l-H,d=Math.max(0,Math.ceil(u/j)),h=Math.min(B,(_+u)/j);let T=0;for(let t=r;t<o;++t){const r=t*U-n;for(let n=s;n<c;++n){const o=n*W-i;for(let a=d;a<h;++a){const i=b*q+x*t+w*n+k*a,s=I*(N-1-r)+C*(R-1-o)+A*(_-1-(a*j-u))+E*e;for(let e=0;e<P;++e){T+=y[i+e]*S[s+e]}}}}p[f*q+m*t+g*a+v*l+e]=T}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}},UQ=XX(tN,(e=>Math.cos(e))),WQ={kernelName:tN,backendName:"cpu",kernelFunc:UQ},jQ=XX(nN,(e=>Math.cosh(e))),VQ={kernelName:nN,backendName:"cpu",kernelFunc:jQ};const GQ={kernelName:aN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:o,boxes:a,boxInd:i}=t,{cropSize:s,method:c,extrapolationValue:l}=r,[u,d,h,p]=o.shape,f=a.shape[0],[m,g]=s,v=JO([f,m,g,p],"float32"),y=n.data.get(a.dataId).values,b=n.data.get(i.dataId).values,x=n.data.get(o.dataId).values,w=nT(o.shape),k=nT(v.shape);for(let S=0;S<f;S++){const e=4*S,t=y[e],n=y[e+1],r=y[e+2],o=y[e+3],a=b[S];if(a>=u)continue;const i=m>1?(r-t)*(d-1)/(m-1):0,s=g>1?(o-n)*(h-1)/(g-1):0;for(let u=0;u<m;u++){const e=m>1?t*(d-1)+u*i:.5*(t+r)*(d-1);if(e<0||e>d-1)for(let t=0;t<g;t++)for(let e=0;e<p;e++){const n=e+t*k[2]+u*k[1]+S*k[0];v.values[n]=l}else if("bilinear"===c){const t=Math.floor(e),r=Math.ceil(e),i=e-t;for(let e=0;e<g;e++){const c=g>1?n*(h-1)+e*s:.5*(n+o)*(h-1);if(c<0||c>h-1){for(let t=0;t<p;t++){const n=t+e*k[2]+u*k[1]+S*k[0];v.values[n]=l}continue}const d=Math.floor(c),f=Math.ceil(c),m=c-d;for(let n=0;n<p;n++){let o=n+d*w[2]+t*w[1]+a*w[0];const s=x[o];o=n+f*w[2]+t*w[1]+a*w[0];const c=x[o];o=n+d*w[2]+r*w[1]+a*w[0];const l=x[o];o=n+f*w[2]+r*w[1]+a*w[0];const h=s+(c-s)*m,p=l+(x[o]-l)*m;o=n+e*k[2]+u*k[1]+S*k[0],v.values[o]=h+(p-h)*i}}}else for(let t=0;t<g;++t){const r=g>1?n*(h-1)+t*s:.5*(n+o)*(h-1);if(r<0||r>h-1){for(let e=0;e<p;e++){const n=e+t*k[2]+u*k[1]+S*k[0];v.values[n]=l}continue}const i=Math.round(r),c=Math.round(e);for(let e=0;e<p;e++){const n=e+i*w[2]+c*w[1]+a*w[0],r=e+t*k[2]+u*k[1]+S*k[0];v.values[r]=x[n]}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const HQ={kernelName:rN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,exclusive:i,reverse:s}=r;GX(o,"cumprod");const c=vP([a],o.shape.length);let l=o;null!=c&&(l=WY({inputs:{x:o},backend:n,attrs:{perm:c}}));const u=bP(1,o.shape.length)[0];if(u!==l.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(u));const d=RD(l.dtype,"int32"),h=aT(zE(l.shape),d),p=n.data.get(l.dataId).values,f=l.shape[l.shape.length-1],m=s?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let v=0;v<p.length;v+=f)for(let e=0;e<f;e++){const t=m(v,e);if(0===e)h[t]=i?1:p[t];else{const n=m(v,e-1);h[t]=i?p[n]*h[n]:p[t]*h[n]}}const g=n.makeTensorInfo(l.shape,d,h);if(null!=c){const e=WY({inputs:{x:g},backend:n,attrs:{perm:yP(c)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(l),e}return g}};const qQ={kernelName:oN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,exclusive:i,reverse:s}=r;GX(o,"cumsum");const c=vP([a],o.shape.length);let l=o;null!=c&&(l=WY({inputs:{x:o},backend:n,attrs:{perm:c}}));const u=bP(1,o.shape.length)[0];if(u!==l.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(u));const d=RD(l.dtype,"int32"),h=iT(zE(l.shape),d),p=n.data.get(l.dataId).values,f=l.shape[l.shape.length-1],m=s?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let v=0;v<p.length;v+=f)for(let e=0;e<f;e++){const t=m(v,e);if(0===e)h[t]=i?0:p[t];else{const n=m(v,e-1);h[t]=i?p[n]+h[n]:p[t]+h[n]}}const g=n.makeTensorInfo(l.shape,d,h);if(null!=c){const e=WY({inputs:{x:g},backend:n,attrs:{perm:yP(c)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(l),e}return g}};const KQ={kernelName:iN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,weights:a}=t,{size:i,binaryOutput:s}=r;if(1===o.shape.length){const e=gQ(n.data.get(o.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,e)}if(2===o.shape.length){const e=vQ(n.bufferSync(o),n.bufferSync(a),i,s);return n.makeTensorInfo(e.shape,a.dtype,e.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(o.shape.length,"."))}};const XQ={kernelName:sN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{blockSize:a,dataFormat:i}=r;ME("NHWC"===i,(()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(i)));const s=o.shape[0],c=o.shape[1],l=o.shape[2],u=o.shape[3],d=c*a,h=l*a,p=u/(a*a),f=n.data.get(o.dataId).values,m=new Float32Array(s*d*h*p);let g=0;for(let v=0;v<s;++v)for(let e=0;e<d;++e){const t=Math.floor(e/a),n=e%a;for(let e=0;e<h;++e){const r=Math.floor(e/a),o=(n*a+e%a)*p;for(let e=0;e<p;++e){const n=e+o+u*(r+l*(t+c*v));m[g++]=f[n]}}}return n.makeTensorInfo([s,d,h,p],o.dtype,m)}};function YQ(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a}=t,{strides:i,pad:s,dilations:c,dimRoundingMode:l}=r;GX([o,a],"depthwiseConv2DNative");const u=nT(o.shape),d=nT(a.shape);let h=c;null==h&&(h=[1,1]),ME(kM(i,h),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(h,"'")));const p=fM(o.shape,a.shape,i,h,s,l,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:v,padInfo:y}=p,b=y.left,x=y.top,w=p.outChannels/p.inChannels,k=new vD(p.outShape,o.dtype),S=n.data.get(o.dataId).values,I=n.data.get(a.dataId).values,C=k.values;for(let A=0;A<p.batchSize;++A){const e=A*u[0],t=A*k.strides[0];for(let n=0;n<p.outHeight;++n){const r=t+n*k.strides[1],o=n*p.strideHeight-x;for(let t=0;t<f;++t){const n=o+t*g;if(n<0||n>=p.inHeight)continue;const a=t*d[0],i=e+n*u[1];for(let e=0;e<p.outWidth;++e){const t=r+e*k.strides[2],n=e*p.strideWidth-b;for(let e=0;e<m;++e){const r=n+e*v;if(r<0||r>=p.inWidth)continue;const o=a+e*d[1],s=i+r*p.inChannels;let c=t,l=o;for(let e=0;e<p.inChannels;++e){const t=S[s+e];for(let e=0;e<w;++e)C[c+e]+=t*I[l+e];c+=w,l+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const QQ={kernelName:cN,backendName:"cpu",kernelFunc:YQ};const JQ={kernelName:lN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,dy:a}=t,{strides:i,dilations:s,pad:c,dimRoundingMode:l,filterShape:u}=r;GX([o,a],"depthwiseConv2dNativeBackpropFilter");const d=fM(o.shape,u,i,s,c,l,!0),{strideHeight:h,strideWidth:p,filterHeight:f,filterWidth:m}=d,g=new vD(d.filterShape,"float32"),v=d.padInfo.left,y=d.padInfo.top,b=d.outChannels/d.inChannels,x=n.data.get(o.dataId).values,w=new vD(o.shape,o.dtype,x),k=n.data.get(a.dataId).values,S=new vD(a.shape,a.dtype,k);for(let I=0;I<f;++I){const e=Math.max(0,Math.ceil((y-I)/h)),t=Math.min(d.outHeight,(d.inHeight+y-I)/h);for(let n=0;n<m;++n){const r=Math.max(0,Math.ceil((v-n)/p)),o=Math.min(d.outWidth,(d.inWidth+v-n)/p);for(let a=0;a<d.outChannels;++a){const i=Math.trunc(a/b),s=a%b;let c=0;for(let l=0;l<d.batchSize;++l)for(let s=e;s<t;++s){const e=I+s*h-y;for(let t=r;t<o;++t){const r=n+t*p-v;c+=w.get(l,e,r,i)*S.get(l,s,t,a)}}g.set(c,I,n,i,s)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};const $Q={kernelName:uN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,filter:a}=t,{strides:i,dilations:s,pad:c,dimRoundingMode:l,inputShape:u}=r;GX([o,a],"depthwiseConv2DNativeBackpropInput");const d=nT(o.shape),h=nT(a.shape),p=fM(u,a.shape,i,s,c,l,!0),f=new vD(p.inShape,"float32"),m=f.values,[g,v,y]=f.strides,b=n.data.get(o.dataId).values,[x,w,k]=d,S=n.data.get(a.dataId).values,[I,C,A]=h,{batchSize:E,filterHeight:T,filterWidth:N,inChannels:R,inHeight:_,inWidth:D,outChannels:O,outHeight:F,outWidth:M,strideHeight:P,strideWidth:L}=p,z=T-1-p.padInfo.top,B=N-1-p.padInfo.left,U=O/R;for(let W=0;W<E;++W)for(let e=0;e<R;++e)for(let t=0;t<_;++t){const n=t-z,r=Math.max(0,Math.ceil(n/P)),o=Math.min(F,(T+n)/P);for(let a=0;a<D;++a){const i=a-B,s=Math.max(0,Math.ceil(i/L)),c=Math.min(M,(N+i)/L);let l=0;for(let t=r;t<o;++t){const r=t*P-n;for(let n=s;n<c;++n){const o=x*W+w*t+k*n,a=I*(T-1-r)+C*(N-1-(n*L-i))+A*e;for(let t=0;t<U;++t){l+=b[o+(e*U+t)]*S[a+t]}}}m[g*W+v*t+y*a+e]=l}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}};const ZQ={kernelName:dN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,o=zE(r.shape),a=n.data.get(r.dataId).values,i=JO([o,o],r.dtype),s=i.values;for(let l=0;l<a.length;l++)s[l*o+l]=a[l];const c=[...r.shape,...r.shape];return n.makeTensorInfo(c,i.dtype,i.values)}},eJ={kernelName:hN,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:o,filter:a}=t,{strides:i,pad:s,dilations:c}=r,l=n,u=l.data.get(o.dataId).values,d=o.shape.length,h=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:v,outHeight:y,outWidth:b,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:S,filterWidth:I,dilationHeight:C,dilationWidth:A,outShape:E}=dM(o.shape,a.shape,i,s,"NHWC",c),T=zE(E),N=E.length,R=XE(o.dtype,T);for(let _=0;_<f;++_)for(let e=0;e<y;++e){const t=e*w-x.top;for(let n=0;n<b;++n){const r=n*k-x.left;for(let i=0;i<v;++i){let s=Number.MIN_SAFE_INTEGER;for(let e=0;e<S;++e){const n=t+e*C;if(n>=0&&n<m)for(let t=0;t<I;++t){const c=r+t*A;if(c>=0&&c<g){const r=lT([_,n,c,i],d,nT(o.shape)),l=lT([e,t,i],p,nT(a.shape)),f=u[r]+h[l];f>s&&(s=f)}}}R[lT([_,e,n,i],N,nT(E))]=s}}}return{dataId:l.write(rD(R,o.dtype),E,o.dtype),shape:E,dtype:o.dtype}}},tJ={kernelName:fN,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:o,filter:a,dy:i}=t,{strides:s,pad:c,dilations:l}=r,u=n,d=oT(o.shape,u.data.get(o.dataId).values),h=oT(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:v,outWidth:y,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:I,dilationWidth:C,outShape:A}=dM(o.shape,a.shape,s,c,"NHWC",l);ME(i.rank===A.length,(()=>"Error in ".concat(fN,", dy ")+"must have the same rank as output ".concat(A.length,", but got ")+"".concat(i.rank)));const E=oT(A,u.data.get(i.dataId).values),T=sT(a.shape,a.dtype);for(let N=0;N<p;++N)for(let e=0;e<v;++e){const t=e*x-b.top;for(let n=0;n<y;++n){const r=n*w-b.left;for(let o=0;o<g;++o){let a=Number.MIN_SAFE_INTEGER,i=0,s=0;for(let e=0;e<k;++e){const n=t+e*I;if(n>=0&&n<f)for(let t=0;t<S;++t){const c=r+t*C;if(c>=0&&c<m){const r=d[N][n][c][o]+h[e][t][o];r>a&&(a=r,i=e,s=t)}}}T[i][s][o]+=E[N][e][n][o]}}}return{dataId:u.write(rD(T,o.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},nJ={kernelName:pN,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:o,filter:a,dy:i}=t,{strides:s,pad:c,dilations:l}=r,u=n,d=oT(o.shape,u.data.get(o.dataId).values),h=oT(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:v,outWidth:y,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:I,dilationWidth:C,outShape:A}=dM(o.shape,a.shape,s,c,"NHWC",l);ME(i.rank===A.length,(()=>"Error in ".concat(pN,", dy ")+"must have the same rank as output ".concat(A.length,", but got ")+"".concat(i.rank)));const E=oT(A,u.data.get(i.dataId).values),T=sT(o.shape,o.dtype);for(let N=0;N<p;++N)for(let e=0;e<v;++e){const t=e*x-b.top;for(let n=0;n<y;++n){const r=n*w-b.left;for(let o=0;o<g;++o){let a=Number.MIN_SAFE_INTEGER,i=t<0?0:t,s=r<0?0:r;for(let e=0;e<k;++e){const n=t+e*I;if(n>=0&&n<f)for(let t=0;t<S;++t){const c=r+t*C;if(c>=0&&c<m){const r=d[N][n][c][o]+h[e][t][o];r>a&&(a=r,i=n,s=c)}}}T[N][i][s][o]+=E[N][e][n][o]}}}return{dataId:u.write(rD(T,o.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};const rJ={kernelName:mN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:o}=t,{canvas:a,options:i}=r,{contextOptions:s,imageOptions:c}=i||{},l=(null===c||void 0===c?void 0:c.alpha)||1,u=(null===s||void 0===s?void 0:s.contextType)||"2d";if("2d"!==u)throw new Error("Context type ".concat(s.contextType," is not supported by the CPU backend."));const d=a.getContext(u,(null===s||void 0===s?void 0:s.contextAttributes)||{});if(null==d)throw new Error("Could not get the context with ".concat(u," type."));const[h,p]=o.shape.slice(0,2),f=2===o.shape.length?1:o.shape[2],m=n.data.get(o.dataId).values,g="float32"===o.dtype?255:1,v=new Uint8ClampedArray(p*h*4);for(let b=0;b<h*p;++b){const e=[0,0,0,255*l];for(let n=0;n<f;n++){const t=m[b*f+n];if("float32"===o.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===o.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(t,"."));1===f?(e[0]=t*g,e[1]=t*g,e[2]=t*g):e[n]=t*g}const t=4*b;v[t+0]=Math.round(e[0]),v[t+1]=Math.round(e[1]),v[t+2]=Math.round(e[2]),v[t+3]=Math.round(e[3])}a.width=p,a.height=h;const y=new ImageData(v,p,h);return d.putImageData(y,0,0),o}},oJ=nY(((e,t)=>e*t)),aJ=SY(((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n}))),iJ=kY(dR,oJ,aJ),sJ={kernelName:dR,backendName:"cpu",kernelFunc:iJ};function cJ(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r;let s;GX(o,"sum"),s="bool"===o.dtype?xY({inputs:{x:o},backend:n,attrs:{dtype:"int32"}}):$X({inputs:{x:o},backend:n});const c=s.shape.length,l=HE(a,s.shape),u=vP(l,c);let d=l,h=s;null!=u&&(h=WY({inputs:{x:s},backend:n,attrs:{perm:u}}),d=bP(d.length,c)),gP("sum",d,h.shape.length);const[p,f]=fP(h.shape,d);let m=gY(n,p,RD(h.dtype,"int32"));const g=zE(f),v=n.data.get(m.dataId).values,y=n.data.get(h.dataId).values;for(let b=0;b<v.length;++b){const e=b*g;let t=0;for(let n=0;n<g;++n)t+=y[e+n];v[b]=t}if(i){const e=m;m=TY({inputs:{x:m},backend:n,attrs:{shape:mP(m.shape,l)}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(s),null!=u&&n.disposeIntermediateTensorInfo(h),m}const lJ={kernelName:$R,backendName:"cpu",kernelFunc:cJ};const uJ={kernelName:vN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:o}=r,a=t,{allDims:i,summedDims:s,idDims:c}=rB(o,a.length);aB(i.length,c,a);const{path:l,steps:u}=iB(s,c),d=u.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const e of u[m]){const{permutationIndices:t,expandDims:r}=oB(p,c[e]);let o;sB(t)?o=a[e]:(o=WY({inputs:{x:a[e]},backend:n,attrs:{perm:t}}),f.push(o));const i=o.shape.slice();for(let e=0;e<r.length;++e)i.splice(r[e],0,1);BE(o.shape,i)||(o=TY({inputs:{x:o},backend:n,attrs:{shape:i}}),f.push(o)),null===h?h=o:(h=iJ({inputs:{a:o,b:h},backend:n}),f.push(h))}m<d-1&&(l[m]>=0&&(h=cJ({inputs:{x:h},backend:n,attrs:{axis:l[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}};const dJ={kernelName:bN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{dy:r,y:o}=t;GX([r,o],"eluGrad");const a=new Float32Array(zE(o.shape)),i=n.data.get(o.dataId).values,s=n.data.get(r.dataId).values;for(let c=0;c<i.length;++c){const e=i[c];a[c]=e>=0?s[c]:s[c]*(e+1)}return n.makeTensorInfo(o.shape,"float32",a)}},hJ=nY(((e,t)=>e===t?1:0)),pJ=kY(wN,hJ,null,"bool"),fJ={kernelName:wN,backendName:"cpu",kernelFunc:pJ},mJ=Bz,gJ=Uz,vJ=Wz,yJ=jz,bJ=Vz,xJ=Gz,wJ=XX(xN,(e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+mJ*n);return t*(1-((((xJ*r+bJ)*r+yJ)*r+vJ)*r+gJ)*r*Math.exp(-n*n))})),kJ={kernelName:xN,backendName:"cpu",kernelFunc:wJ},SJ=KX((e=>Math.exp(e))),IJ=YX(kN,SJ,"float32"),CJ={kernelName:kN,backendName:"cpu",kernelFunc:IJ};function AJ(e){const{inputs:t,backend:n,attrs:r}=e,{input:o}=t,{dim:a}=r,i=o.shape.length,s=o.shape.slice();let c=a;return a<0&&(ME(-(i+1)<=a,(()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]"))),c=i+a+1),s.splice(c,0,1),TY({inputs:{x:o},backend:n,attrs:{shape:s}})}const EJ={kernelName:SN,backendName:"cpu",kernelFunc:AJ},TJ=KX((e=>Math.expm1(e))),NJ=YX(IN,TJ),RJ={kernelName:IN,backendName:"cpu",kernelFunc:NJ},_J=nY(((e,t)=>e/t)),DJ=kY(gN,_J),OJ={kernelName:gN,backendName:"cpu",kernelFunc:DJ},FJ=nY(((e,t)=>e-t)),MJ=SY(((e,t,n,r)=>({real:e-n,imag:t-r}))),PJ=kY(f_,FJ,MJ),LJ={kernelName:f_,backendName:"cpu",kernelFunc:PJ};function zJ(e,t,n){const r=e.shape,o=r[0],a=r[1],i=n.data.get(e.dataId),s=i.complexTensorInfos.real,c=i.complexTensorInfos.imag,l=[o,a],u=zE(l),d=KE("float32",u),h=KE("float32",u);for(let g=0;g<o;g++){const e=pQ({inputs:{x:s},backend:n,attrs:{begin:[g,0],size:[1,a]}}),r=pQ({inputs:{x:c},backend:n,attrs:{begin:[g,0],size:[1,a]}}),o=fY({inputs:{real:e,imag:r},backend:n}),{real:i,imag:l}=BJ(o,t,n),u=Hz(i,l);for(let t=0;t<a;t++){const e=Yz(u,t);d[g*a+t]=e.real,h[g*a+t]=e.imag}n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o)}const p=n.makeTensorInfo(l,"float32",d),f=n.makeTensorInfo(l,"float32",h),m=fY({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}function BJ(e,t,n){const r=zE(e.shape),o=n.data.get(e.dataId),a=n.data.get(o.complexTensorInfos.real.dataId).values,i=n.data.get(o.complexTensorInfos.imag.dataId).values;if(0===((s=r)&s-1)){const o=UJ(a,i,r,t,n),s=[e.shape[0],e.shape[1]];if(t){const e=n.makeTensorInfo(s,"float32",o.real),t=n.makeTensorInfo(s,"float32",o.imag),a=n.makeTensorInfo([],"float32",nD(r,"float32")),i=$X({inputs:{x:a},backend:n}),c=OJ.kernelFunc({inputs:{a:e,b:a},backend:n}),l=OJ.kernelFunc({inputs:{a:t,b:i},backend:n}),u=n.data.get(c.dataId).values,d=n.data.get(l.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),{real:u,imag:d}}return o}{const e=function(e,t,n){const r=new Float32Array(2*t);for(let o=0;o<t;o++){let a=0,i=0;for(let r=0;r<t;r++){const s=$z(o*r,t,n),c=Yz(e,r);a+=c.real*s.real-c.imag*s.imag,i+=c.real*s.imag+c.imag*s.real}n&&(a/=t,i/=t),Qz(r,a,i,o)}return r}(Hz(a,i),r,t);return qz(e)}var s}function UJ(e,t,n,r,o){if(1===n)return{real:e,imag:t};const a=Hz(e,t),i=n/2,s=Kz(a),c=s.real,l=s.imag,u=[c.length],d=o.makeTensorInfo(u,"float32",c),h=o.makeTensorInfo(u,"float32",l),p=fY({inputs:{real:d,imag:h},backend:o}),f=Xz(a),m=f.real,g=f.imag,v=[m.length],y=o.makeTensorInfo(v,"float32",m),b=o.makeTensorInfo(v,"float32",g),x=fY({inputs:{real:y,imag:b},backend:o}),w=UJ(c,l,i,r,o),k=w.real,S=w.imag,I=[k.length],C=o.makeTensorInfo(I,"float32",k),A=o.makeTensorInfo(I,"float32",S),E=fY({inputs:{real:C,imag:A},backend:o}),T=UJ(m,g,i,r,o),N=T.real,R=T.imag,_=[N.length],D=o.makeTensorInfo(_,"float32",N),O=o.makeTensorInfo(_,"float32",R),F=fY({inputs:{real:D,imag:O},backend:o}),M=Jz(n,r),P=[M.real.length],L=o.makeTensorInfo(P,"float32",M.real),z=o.makeTensorInfo(P,"float32",M.imag),B=fY({inputs:{real:L,imag:z},backend:o}),U=iJ({inputs:{a:B,b:F},backend:o}),W=AY({inputs:{a:E,b:U},backend:o}),j=PJ({inputs:{a:E,b:U},backend:o}),V=vY({inputs:{input:W},backend:o}),G=vY({inputs:{input:j},backend:o}),H=NQ({inputs:{input:W},backend:o}),q=NQ({inputs:{input:j},backend:o}),K=_Q({inputs:[V,G],backend:o,attrs:{axis:0}}),X=_Q({inputs:[H,q],backend:o,attrs:{axis:0}}),Y=o.data.get(K.dataId).values,Q=o.data.get(X.dataId).values;return o.disposeIntermediateTensorInfo(d),o.disposeIntermediateTensorInfo(h),o.disposeIntermediateTensorInfo(p),o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(b),o.disposeIntermediateTensorInfo(x),o.disposeIntermediateTensorInfo(C),o.disposeIntermediateTensorInfo(A),o.disposeIntermediateTensorInfo(E),o.disposeIntermediateTensorInfo(D),o.disposeIntermediateTensorInfo(O),o.disposeIntermediateTensorInfo(F),o.disposeIntermediateTensorInfo(L),o.disposeIntermediateTensorInfo(z),o.disposeIntermediateTensorInfo(B),o.disposeIntermediateTensorInfo(U),o.disposeIntermediateTensorInfo(W),o.disposeIntermediateTensorInfo(j),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(H),o.disposeIntermediateTensorInfo(G),o.disposeIntermediateTensorInfo(q),o.disposeIntermediateTensorInfo(K),o.disposeIntermediateTensorInfo(X),{real:Y,imag:Q}}const WJ={kernelName:CN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,o=zE(r.shape),a=r.shape[r.shape.length-1],i=TY({inputs:{x:r},backend:n,attrs:{shape:[o/a,a]}}),s=zJ(i,!1,n),c=TY({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),c}};function jJ(e){const{backend:t,attrs:n}=e,{shape:r,value:o,dtype:a}=n,i=a||ZE(o),s=XE(i,zE(r));return function(e,t){e.fill(t)}(s,o),t.makeTensorInfo(r,i,s)}const VJ={kernelName:AN,backendName:"cpu",kernelFunc:jJ};const GJ={kernelName:EN,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:o}=t,a=r,i=KE(o.dtype,zE(o.shape)),[s,c,l,u]=o.shape,d=a.data.get(o.dataId).values;for(let h=0;h<s;h++){const e=h*l*c*u;for(let t=0;t<c;t++){const n=t*(l*u);for(let t=0;t<l;t++){const r=t*u;for(let o=0;o<u;o++){const a=Math.round(l-t-1),s=e+n+r+o;let c=d[s];if(a>=0&&a<l){c=d[e+n+a*u+o]}i[s]=c}}}}return{dataId:a.write(i,o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}},HJ=KX((e=>Math.floor(e))),qJ=YX(TN,HJ),KJ={kernelName:TN,backendName:"cpu",kernelFunc:qJ},XJ=nY(((e,t)=>Math.floor(e/t))),YJ=kY(NN,XJ,null,"int32"),QJ={kernelName:NN,backendName:"cpu",kernelFunc:YJ};const JJ={kernelName:N_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a,bias:i,preluActivationWeights:s}=t,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r;let m=OQ({inputs:{x:o,filter:a},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const e=m;if("NCHW"===u&&1===i.shape.length&&1!==i.shape[0]){const e=TY({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=AY({inputs:{a:m,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else m=AY({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(e)}if(p){const e=m;if("NCHW"===u&&"prelu"===p&&1===s.shape.length&&1!==s.shape[0]){const e=TY({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=pY(n,m,p,e,f),n.disposeIntermediateTensorInfo(e)}else m=pY(n,m,p,s,f);n.disposeIntermediateTensorInfo(e)}return m}};const $J={kernelName:R_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a,bias:i,preluActivationWeights:s}=t,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r;let m=YQ({inputs:{x:o,filter:a},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const e=m;m=AY({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(e)}if(p){const e=m;m=pY(n,m,p,s,f),n.disposeIntermediateTensorInfo(e)}return m}};function ZJ(e,t,n,r,o,a,i,s,c){const l=JO([r,a],n);for(let u=0;u<r;u++){const n=[];let r=0;for(let t=0;t<o;t++){const a=e[u*o+t];r+=a*i[t],n.push(a)}if(r<0||r>=c/a)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(s));for(let e=0;e<a;e++)l.values[u*a+e]=t.get(...t.indexToLoc(r*a+e))}return l}const e$={kernelName:DN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:o}=t,a=zE(r.shape),i=o.shape,s=i[i.length-1],[c,l,u,d]=Oz(r,o);if(0===l)return n.makeTensorInfo(c,r.dtype,[]);const h=ZJ(n.data.get(o.dataId).values,n.bufferSync(r),r.dtype,l,s,u,d,r.shape,a);return n.makeTensorInfo(c,r.dtype,h.values)}};function t$(e,t,n){const r=JO(n,e.dtype);for(let o=0;o<r.size;++o){const n=r.indexToLoc(o).slice(),a=n[0],i=n[2],s=t.locToIndex([a,i]);n[2]=t.values[s];const c=e.locToIndex(n);0<=c&&c<e.values.length&&(r.values[o]=e.values[c])}return r}const n$={kernelName:_N,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,indices:a}=t,{axis:i,batchDims:s}=r;GX([o,a],"gatherV2");const c=HE(i,o.shape)[0],l=n.data.get(a.dataId).values,u=o.shape[c];for(let b=0;b<l.length;++b){const e=l[b];ME(e<=u-1&&e>=0,(()=>"GatherV2: the index value ".concat(e," is not in [0, ").concat(u-1,"]")))}let d=s;null==s&&(d=0);const h=zE(a.shape),p=IB(o,a,c,d),f=TY({inputs:{x:o},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),m=TY({inputs:{x:a},backend:n,attrs:{shape:[p.batchSize,h/p.batchSize]}}),g=[p.batchSize,p.outerSize,h/p.batchSize,p.sliceSize],v=n.bufferSync(m),y=t$(n.bufferSync(f),v,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(p.outputShape,y.dtype,y.values)}},r$=nY(((e,t)=>e>t?1:0)),o$=kY(ON,r$,null,"bool"),a$={kernelName:ON,backendName:"cpu",kernelFunc:o$},i$=nY(((e,t)=>e>=t?1:0)),s$=kY(FN,i$,null,"bool"),c$={kernelName:FN,backendName:"cpu",kernelFunc:s$};const l$={kernelName:PN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,o=zE(r.shape),a=r.shape[r.shape.length-1],i=TY({inputs:{x:r},backend:n,attrs:{shape:[o/a,a]}}),s=zJ(i,!0,n),c=TY({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),c}},u$=XX(zN,(e=>Number.isFinite(e)?1:0),"bool"),d$={kernelName:zN,backendName:"cpu",kernelFunc:u$},h$=XX(BN,(e=>Math.abs(e)===1/0?1:0),"bool"),p$={kernelName:BN,backendName:"cpu",kernelFunc:h$},f$=XX(UN,(e=>Number.isNaN(e)?1:0),"bool"),m$={kernelName:UN,backendName:"cpu",kernelFunc:f$},g$=nY(((e,t)=>e<t?1:0)),v$=kY(jN,g$,null,"bool"),y$={kernelName:jN,backendName:"cpu",kernelFunc:v$},b$=nY(((e,t)=>e<=t?1:0)),x$=kY(VN,b$,null,"bool"),w$={kernelName:VN,backendName:"cpu",kernelFunc:x$};function k$(e,t,n){const r=(t-e)/(n-1),o=iT(n,"float32");o[0]=e;for(let a=1;a<o.length;a++)o[a]=o[a-1]+r;return o}const S$={kernelName:GN,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:o,num:a}=n,i=k$(r,o,a);return t.makeTensorInfo([i.length],"float32",i)}},I$=KX((e=>Math.log(e))),C$=YX(HN,I$),A$={kernelName:HN,backendName:"cpu",kernelFunc:C$},E$=XX(qN,(e=>Math.log1p(e))),T$={kernelName:qN,backendName:"cpu",kernelFunc:E$},N$=nY(((e,t)=>e&&t)),R$=kY(KN,N$,null,"bool"),_$={kernelName:KN,backendName:"cpu",kernelFunc:R$},D$=XX(XN,(e=>e?0:1),"bool"),O$={kernelName:XN,backendName:"cpu",kernelFunc:D$},F$=nY(((e,t)=>e||t)),M$=kY(YN,F$,null,"bool"),P$={kernelName:YN,backendName:"cpu",kernelFunc:M$};const L$={kernelName:QN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{depthRadius:a,bias:i,alpha:s,beta:c}=r;GX(o,"LRN");const l=o.shape[3],u=l-1,d=n.data.get(o.dataId).values,h=zE(o.shape),p=new Float32Array(h);function f(e){const t=e%l;let n=e-t+Math.max(0,t-a);const r=e-t+Math.min(t+a,u);let o=0;for(;n<=r;n++){const e=d[n];o+=e*e}return o}for(let m=0;m<h;m++){const e=f(m),t=d[m]*Math.pow(i+s*e,-c);p[m]=t}return n.makeTensorInfo(o.shape,o.dtype,p)}};const z$={kernelName:JN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,y:a,dy:i}=t,{depthRadius:s,bias:c,alpha:l,beta:u}=r;GX(i,"LRNGrad");const d=zE(i.shape),h=i.shape[3],p=n.data.get(i.dataId).values,f=n.data.get(o.dataId).values,m=n.data.get(a.dataId).values,g=new Float32Array(d),v=d;for(let y=0;y<v;y++){const e=y%h,t=y-e+Math.max(0,e-s),n=y-e+Math.min(h,e+s+1);let r=0;for(let o=t;o<n;o++)r+=Math.pow(f[o],2);r=l*r+c;for(let o=t;o<n;o++){let e=-2*l*u*f[o]*m[y]/r;y===o&&(e+=Math.pow(r,-u)),e*=p[y],g[o]+=e}}return n.makeTensorInfo(i.shape,o.dtype,g)}};function B$(e,t,n,r){const o=KE(r,zE(n));for(let a=0;a<o.length;++a){const n=a*t;let r=e[n];for(let o=0;o<t;++o){const t=e[n+o];(Number.isNaN(t)||t>r)&&(r=t)}o[a]=r}return o}function U$(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{reductionIndices:a,keepDims:i}=r,s=n;let c=o.shape;const l=c.length,u=HE(a,c);let d=u;const h=vP(d,l);let p=s.data.get(o.dataId).values;if(null!=h){const e=new Array(l);for(let t=0;t<e.length;t++)e[t]=c[h[t]];p=UY(p,c,o.dtype,h,e),d=bP(d.length,l),c=e}GX(o,"max"),gP("max",d,l);const[f,m]=fP(c,d),g=B$(p,zE(m),f,o.dtype),v=s.write(g,f,o.dtype);let y=f;if(i){y=mP(f,u)}return{dataId:v,shape:y,dtype:o.dtype}}const W$={kernelName:$N,backendName:"cpu",kernelFunc:U$},j$=nY(((e,t)=>Math.max(e,t))),V$=kY(ZN,j$),G$={kernelName:ZN,backendName:"cpu",kernelFunc:V$};const H$={kernelName:eR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t;GX(o,"maxPool");const{filterSize:a,strides:i,pad:s,dimRoundingMode:c}=r;ME(kM(i,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'")));const l=hM(o.shape,a,i,1,s,c);let u;if(1===l.filterWidth&&1===l.filterHeight&&BE(l.inShape,l.outShape))u=$X({inputs:{x:o},backend:n});else{const e=n.data.get(o.dataId).values,t=nT(o.shape),r=oQ(e,o.shape,o.dtype,t,l,"max");u=n.makeTensorInfo(l.outShape,o.dtype,r.values)}return u}};const q$={kernelName:nR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{filterSize:a,strides:i,pad:s,dimRoundingMode:c,dataFormat:l}=r;GX(o,"maxPool3d");const u=pM(o.shape,a,i,1,s,c,l),d=iQ(n.data.get(o.dataId).values,o.shape,o.dtype,nT(o.shape),u,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}};const K$={kernelName:rR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,input:a}=t,{filterSize:i,strides:s,pad:c,dimRoundingMode:l}=r;GX([o,a],"maxPool3DGrad");const u=pM(a.shape,i,s,1,c,l),d=function(e,t){const n=JO(t.outShape,"int32"),r=t.strideDepth,o=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,s=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,p=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let v=0;v<t.outDepth;++v){const y=v*r-h;let b=y;for(;b<0;)b+=i;const x=Math.min(t.inDepth,l+y);for(let r=0;r<t.outHeight;++r){const l=r*o-p;let h=l;for(;h<0;)h+=s;const w=Math.min(t.inHeight,u+l);for(let o=0;o<t.outWidth;++o){const p=o*a-f;let k=p;for(;k<0;)k+=c;const S=Math.min(t.inWidth,d+p);let I=Number.NEGATIVE_INFINITY,C=-1;for(let t=b;t<x;t+=i){const n=t-y;for(let r=h;r<w;r+=s){const o=r-l;for(let a=k;a<S;a+=c){const i=a-p,s=e.get(m,t,r,a,g);s>=I&&(I=s,C=n*u*d+o*u+i)}}}n.set(C,m,v,r,o,g)}}}return n}(n.bufferSync(a),u),h=u.strideDepth,p=u.strideHeight,f=u.strideWidth,m=u.dilationDepth,g=u.dilationHeight,v=u.dilationWidth,y=u.effectiveFilterDepth,b=u.effectiveFilterHeight,x=u.effectiveFilterWidth,w=y-1-u.padInfo.front,k=x-1-u.padInfo.left,S=b-1-u.padInfo.top,I=JO(a.shape,"float32"),C=n.bufferSync(o);for(let A=0;A<u.batchSize;++A)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inDepth;++t)for(let n=0;n<u.inHeight;++n)for(let r=0;r<u.inWidth;++r){const o=t-w,a=n-S,i=r-k;let s=0;for(let t=0;t<y;t+=m){const n=(o+t)/h;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let r=0;r<b;r+=g){const o=(a+r)/p;if(!(o<0||o>=u.outHeight||Math.floor(o)!==o))for(let a=0;a<x;a+=v){const c=(i+a)/f;if(c<0||c>=u.outWidth||Math.floor(c)!==c)continue;const l=y*b*x-1-d.get(A,n,o,c,e)===t*b*x+r*x+a?1:0;if(0===l)continue;s+=C.get(A,n,o,c,e)*l}}}I.set(s,A,t,n,r,e)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}};const X$={kernelName:tR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,input:a,output:i}=t,s=a;GX([a,i],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:d}=r,h=hM(s.shape,c,l,1,u,d),p=n.data.get(s.dataId).values,f=JO(h.outShape,s.dtype,aQ(p,s.shape,s.dtype,h).values),m=h.strideHeight,g=h.strideWidth,v=h.dilationHeight,y=h.dilationWidth,b=h.effectiveFilterHeight,x=h.effectiveFilterWidth,w=x-1-h.padInfo.left,k=b-1-h.padInfo.top,S=JO(s.shape,"float32"),I=n.data.get(o.dataId).values,C=JO(o.shape,"float32",I);for(let A=0;A<h.batchSize;++A)for(let e=0;e<h.inChannels;++e)for(let t=0;t<h.inHeight;++t)for(let n=0;n<h.inWidth;++n){const r=t-k,o=n-w;let a=0;for(let t=0;t<b;t+=v){const n=(r+t)/m;if(!(n<0||n>=h.outHeight||Math.floor(n)!==n))for(let r=0;r<x;r+=y){const i=(o+r)/g;if(i<0||i>=h.outWidth||Math.floor(i)!==i)continue;const s=b*x-1-f.get(A,n,i,e)===t*x+r?1:0;if(0===s)continue;a+=C.get(A,n,i,e)*s}}S.set(a,A,t,n,e)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};const Y$={kernelName:oR,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:o}=t,{filterSize:a,strides:i,pad:s,includeBatchInIndex:c}=n,l=r;GX(o,"MaxPoolWithArgmax");const u=l.data.get(o.dataId).values,d=hM(o.shape,a,i,[1,1],s),[h,p]=function(e,t,n,r,o){const a=oQ(e,0,n,nT(t),o,"max"),i=aQ(e,t,n,o,!0,r);return[a.values,i.values]}(u,o.shape,o.dtype,c,d),f=l.write(h,d.outShape,o.dtype),m=l.write(p,d.outShape,o.dtype);return[{dataId:f,shape:d.outShape,dtype:o.dtype},{dataId:m,shape:d.outShape,dtype:"int32"}]}};const Q$={kernelName:aR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r,s=HE(a,o.shape),c=zE(fP(o.shape,s)[1]),l=[],u=n.makeTensorInfo([],"float32",new Float32Array([c]));l.push(u);const d=xY({inputs:{x:o},backend:n,attrs:{dtype:"float32"}});l.push(d);const h=DJ({inputs:{a:d,b:u},backend:n});l.push(h);const p=cJ({inputs:{x:h},backend:n,attrs:{axis:a,keepDims:i}});return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),p}};const J$={kernelName:iR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r;GX(o,"min");const s=HE(a,o.shape);let c=s;const l=vP(c,o.shape.length);let u=o;null!=l&&(u=WY({inputs:{x:o},backend:n,attrs:{perm:l}}),c=bP(c.length,o.shape.length)),gP("min",c,u.shape.length);const[d,h]=fP(u.shape,c),p=zE(h),f=iT(zE(d),u.dtype),m=n.data.get(u.dataId).values;for(let v=0;v<f.length;++v){const e=v*p;let t=m[e];for(let n=0;n<p;++n){const r=m[e+n];(Number.isNaN(r)||r<t)&&(t=r)}f[v]=t}null!=l&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,f);if(i){const e=TY({inputs:{x:g},backend:n,attrs:{shape:mP(d,s)}});return n.disposeIntermediateTensorInfo(g),e}return g}},$$=nY(((e,t)=>Math.min(e,t))),Z$=kY(sR,$$),eZ={kernelName:sR,backendName:"cpu",kernelFunc:Z$};const tZ={kernelName:cR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{paddings:a,mode:i}=r;GX(o,"mirrorPad");const s=a.map(((e,t)=>e[0]+o.shape[t]+e[1])),c=a.map((e=>e[0])),l=a.map(((e,t)=>e[0]+o.shape[t])),u="reflect"===i?0:1,d=n.data.get(o.dataId).values,h=o.shape.length,p=nT(o.shape),f=zE(s),m=s.length,g=nT(s),v=KE(o.dtype,f);for(let y=0;y<f;y++){let e=uT(y,m,g);for(let n=0;n<m;n++)e[n]<c[n]?e[n]=2*c[n]-e[n]-u:e[n]>=l[n]&&(e[n]=2*(l[n]-1)-e[n]+u);e=e.map(((e,t)=>e-c[t]));const t=lT(e,h,p);v[y]=d[t]}return{dataId:n.write(v,s,o.dtype),shape:s,dtype:o.dtype}}},nZ=nY(((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),rZ=kY(lR,nZ),oZ={kernelName:lR,backendName:"cpu",kernelFunc:rZ};function aZ(e){const{inputs:t,backend:n,attrs:r}=e,{logits:o}=t,{dim:a}=r,i=o.shape.length;let s=a;if(-1===s&&(s=i-1),s!==i-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(i," and dim was ").concat(s));const c=HE([s],o.shape),l=U$({inputs:{x:o},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),u=mP(l.shape,c),d=TY({inputs:{x:l},backend:n,attrs:{shape:u}}),h=PJ({inputs:{a:o,b:d},backend:n}),p=IJ({inputs:{x:h},backend:n}),f=cJ({inputs:{x:p},backend:n,attrs:{axis:c,keepDims:!1}}),m=TY({inputs:{x:f},backend:n,attrs:{shape:u}}),g=DJ({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const iZ={kernelName:t_,backendName:"cpu",kernelFunc:aZ};const sZ={kernelName:uR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:o}=t,{numSamples:a,seed:i,normalized:s}=r;GX(o,"multinomial");const c=s?o:aZ({inputs:{logits:o},backend:n,attrs:{dim:-1}}),l=c.shape[0],u=c.shape[1],d=n.data.get(c.dataId).values,h=[l,a],p=iT(zE(h),"int32");for(let f=0;f<l;++f){const e=f*u,t=new Float32Array(u-1);t[0]=d[e];for(let o=1;o<t.length;++o)t[o]=t[o-1]+d[e+o];const n=LP.alea(i.toString()),r=f*a;for(let o=0;o<a;++o){const e=n();p[r+o]=t.length;for(let n=0;n<t.length;n++)if(e<t[n]){p[r+o]=n;break}}}return s||n.disposeIntermediateTensorInfo(c),n.makeTensorInfo(h,"int32",p)}};function cZ(e,t,n){const r=nD(-1,n);return oJ([],t,r,e,n)}const lZ={kernelName:hR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;GX(r,"neg");const o=n.data.get(r.dataId).values,[a,i]=cZ(o,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,a)}},uZ=BL;const dZ={kernelName:fR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:o,scores:a}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c}=r;GX(o,"NonMaxSuppression");const l=n.data.get(o.dataId).values,u=n.data.get(a.dataId).values,{selectedIndices:d}=uZ(l,u,i,s,c);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},hZ=UL;const pZ={kernelName:mR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:o,scores:a}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c,padToMaxOutputSize:l}=r;GX(o,"NonMaxSuppressionPadded");const u=n.data.get(o.dataId).values,d=n.data.get(a.dataId).values,{selectedIndices:h,validOutputs:p}=hZ(u,d,i,s,c,l);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},fZ=WL;const mZ={kernelName:gR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:o,scores:a}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=r;GX(o,"NonMaxSuppressionWithScore");const u=n.data.get(o.dataId).values,d=n.data.get(a.dataId).values,h=i,p=s,f=c,m=l,{selectedIndices:g,selectedScores:v}=fZ(u,d,h,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}},gZ=nY(((e,t)=>e!==t?1:0)),vZ=kY(pR,gZ,null,"bool"),yZ={kernelName:pR,backendName:"cpu",kernelFunc:vZ};const bZ={kernelName:yR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:o}=t,{dtype:a,depth:i,onValue:s,offValue:c}=r;GX(o,"oneHot");const l=zE(o.shape),u=new Float32Array(l*i);u.fill(c);const d=n.data.get(o.dataId).values;for(let h=0;h<l;++h)d[h]>=0&&d[h]<i&&(u[h*i+d[h]]=s);return n.makeTensorInfo([...o.shape,i],a,u)}};function xZ(e){const{inputs:t,backend:n}=e,{x:r}=t;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const e=vY({inputs:{input:r},backend:n}),t=xZ({inputs:{x:e},backend:n}),o=NQ({inputs:{input:r},backend:n}),a=xZ({inputs:{x:o},backend:n}),i=fY({inputs:{real:t,imag:a},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),i}return jJ({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const wZ={kernelName:I_,backendName:"cpu",kernelFunc:xZ};const kZ={kernelName:vR,backendName:"cpu",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:o}=n;if("string"===o.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===o.dtype){const t=vY({inputs:{input:o},backend:r}),n=e({inputs:{x:t},backend:r}),a=NQ({inputs:{input:o},backend:r}),i=xZ({inputs:{x:a},backend:r}),s=fY({inputs:{real:n,imag:i},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(i),s}return jJ({backend:r,attrs:{shape:o.shape,value:1,dtype:o.dtype}})}};function SZ(e){const{inputs:t,backend:n,attrs:r}=e,{axis:o}=r;if(1===t.length)return AJ({inputs:{input:t[0]},backend:n,attrs:{dim:o}});const a=t[0].shape,i=t[0].dtype;t.forEach((e=>{PE(a,e.shape,"All tensors passed to stack must have matching shapes"),ME(i===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const s=[],c=_Q({inputs:t.map((e=>{const t=AJ({inputs:{input:e},backend:n,attrs:{dim:o}});return s.push(t),t})),backend:n,attrs:{axis:o}});return s.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}const IZ={kernelName:bR,backendName:"cpu",kernelFunc:SZ};const CZ={kernelName:xR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{paddings:a,constantValue:i}=r;GX(o,"pad");const s=a.map(((e,t)=>e[0]+o.shape[t]+e[1])),c=a.map((e=>e[0])),l=n.data.get(o.dataId).values,u=zE(o.shape),d=o.shape.length,h=nT(o.shape),p=zE(s),f=s.length,m=nT(s),g=KE(o.dtype,p);0!==i&&g.fill(i);for(let v=0;v<u;v++){g[lT(uT(v,d,h).map(((e,t)=>e+c[t])),f,m)]=l[v]}return{dataId:n.write(g,s,o.dtype),shape:s,dtype:o.dtype}}},AZ=nY(((e,t)=>Math.pow(e,t))),EZ=kY(wR,AZ),TZ={kernelName:wR,backendName:"cpu",kernelFunc:EZ};function NZ(e,t,n,r){const[o,a]=fP(e,r),i=RD(t,"int32"),s=iT(zE(o),i),c=zE(a);for(let l=0;l<s.length;++l){const e=l*c;let t=1;for(let r=0;r<c;++r)t*=n[e+r];s[l]=t}return{outVals:s,outShape:o,outDtype:i}}const RZ={kernelName:SR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r;GX(o,"prod");const s=o.shape.length,c=HE(a,o.shape),l=vP(c,s);let u=c,d=o;const h=[];null!=l&&(d=WY({inputs:{x:o},backend:n,attrs:{perm:l}}),h.push(d),u=bP(u.length,s));const p=n.data.get(d.dataId).values,{outVals:f,outShape:m,outDtype:g}=NZ(d.shape,d.dtype,p,u);let v=m;return i&&(v=mP(m,c)),h.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(v,g,f)}};function _Z(e,t,n,r){const o=[];let a=0;const i=t.length-1+n.length,s=new Array(i).fill(null).map((()=>[0]));!function(e,t){for(let n=0;n<e.length;++n){const r=e[n],o=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>o)throw new Error("Ragged splits must not point past values");for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let c=1;for(let l=0;l<t.length-1;++l){c*=t[l];const e=t[l+1];for(let t=1;t<c+1;++t)s[l].push(t*e)}for(let l=0;l<e.length;++l){let r=e[l],i=e[l]+1;for(let e=0;e<n.length;++e){const o=n[e],a=e+t.length-1;if(a>=0){const e=s[a],t=e[e.length-1]-o[r];for(let n=r;n<i;++n)s[a].push(o[n+1]+t)}r=o[r],i=o[i]}i!==r&&(o.push([r,i]),a+=i-r)}return{outSplits:s,valueSlices:o,numValues:a}}function DZ(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function OZ(e,t,n,r,o){const a=t.slice();a[0]=o;const i=XE(n,zE(a)),s=e.length;return function(e,t,n,r,o,a){const i=DZ(t,2)[1],s=DZ(a,2)[1];let c=0;for(const l of n)for(let t=l[0];t<l[1];++t){for(let n=0;n<r;++n)o[c*s+n]=e[t*i+n];++c}}(e,t,r,0===s?0:s/t[0],i,a),[i,a]}function FZ(e,t,n,r,o,a,i,s){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach(((e,r)=>{if(e<0||e>=n){const o=uT(r,t.length,nT(t)).join(",");throw new Error("indices[".concat(o,"] = ").concat(e," is not in [0, ").concat(n,")"))}}))}(a,i,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:l,valueSlices:u,numValues:d}=_Z(a,i,e,c),h=function(e){const t=[];for(let n=0;n<e.length;++n){const r=XE("int32",e[n].length);t.push(r),e[n].forEach(((e,t)=>r[t]=e))}return t}(l),p=OZ(n,r,o,u,d);return[h,p[0],p[1]]}const MZ={kernelName:IR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:o,paramsDenseValues:a,indices:i}=t,{outputRaggedRank:s}=r,c=o.map((e=>n.data.get(e.dataId).values)),l=o.map((e=>e.shape)),u=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,[h,p,f]=FZ(c,l,u,a.shape,a.dtype,d,i.shape),m=h.map((e=>n.makeTensorInfo([e.length],"int32",e))),g=n.makeTensorInfo(f,a.dtype,p);return m.concat([g])}},PZ=2147483647;function LZ(e,t,n,r,o,a,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(o.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const s=0===t.length,c=0===o.length,l=0===i.length,u=[];s||u.push(t[0]),c||u.push(o[0]),l||u.push(i[0]);for(let m=1;m<u.length;++m)if(u[m]!==u[m-1])throw new Error("starts, limits, and deltas must have the same shape");const d=0===u.length?1:u[0],h=XE("int32",d+1);h[0]=0;for(let m=0;m<d;++m){const t=s?e[0]:e[m],n=c?r[0]:r[m],o=l?a[0]:a[m];if(0===o)throw new Error("Requires delta != 0");let i;if(o>0&&n<t||o<0&&n>t)i=0;else if(i=Math.ceil(Math.abs((n-t)/o)),i>PZ)throw new Error("Requires ((limit - start) / delta) <= ".concat(PZ));h[m+1]=h[m]+i}const p=XE(n,h[d]);let f=0;for(let m=0;m<d;++m){const t=h[m+1]-h[m];let n=s?e[0]:e[m];const r=l?a[0]:a[m];for(let e=0;e<t;++e)p[f++]=n,n+=r}return[h,p]}const zZ={kernelName:CR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:o,deltas:a}=t,i=n.data.get(r.dataId).values,s=n.data.get(o.dataId).values,c=n.data.get(a.dataId).values,[l,u]=LZ(i,r.shape,r.dtype,s,o.shape,c,a.shape);return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([u.length],r.dtype,u)]}};var BZ=xz;class UZ{constructor(e,t,n,r,o,a,i,s,c,l){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=o,this.defaultValue=a,this.defaultValueShape=i,this.rowPartitionValues=s,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=kz(l),this.raggedRank=Sz(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===BZ.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===BZ.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case BZ.VALUE_ROWIDS:return UZ.getMaxWidthValueRowID(t);case BZ.ROW_SPLITS:return UZ.getMaxWidthRowSplit(t);default:throw new Error("Cannot handle partition type ".concat(BZ[this.getRowPartitionTypeByDimension(e-1)]))}}static getMaxWidthRowSplit(e){const t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){const t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(0===t)return 0;let n=0,r=e[0],o=0;for(let a=1;a<t;++a){const t=e[a];t!==r&&(r=t,o=Math.max(a-n,o),n=a)}return Math.max(t-n,o)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return jZ(e,n)}calculateOutputSize(e){const t=this.valuesShape;Iz(this.defaultValueShape,t);const n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=wz(this.raggedRank,n,t);r[0]<0&&(r[0]=e);for(let o=1;o<=this.raggedRank;++o)r[o]<0&&(r[o]=this.getMaxWidth(o));return r}calculateFirstParentOutputIndex(e,t,n){const r=Math.min(e,n),o=[];let a=0;for(let i=0;i<r;++i,a+=t)o.push(a);for(let i=r;i<e;++i)o.push(-1);return ME(o.length===e,(()=>"Final length of result must be equal to firstDimension.")),o}calculateOutputIndexRowSplit(e,t,n,r){const o=e.length,a=[];for(let i=0;i<o-1;++i){const o=e[i+1]-e[i];let s=Math.min(r,o),c=t[i];-1===c&&(s=0);for(let e=0;e<s;++e)a.push(c),c+=n;for(let e=0;e<o-s;++e)a.push(-1)}if(o>0&&a.length!==e[o-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,t,n,r){const o=e.length,a=[];if(0===o)return[];let i=0,s=e[0];if(s>=t.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(t.length));let c=t[s];a.push(c);for(let l=1;l<o;++l){const o=e[l];if(o===s)c>=0&&(++i,i<r?c+=n:c=-1);else{if(i=0,s=o,o>=t.length)throw new Error("Got nextValueRowId=".concat(o," which is not less than ").concat(t.length));c=t[o]}a.push(c)}if(a.length!==e.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(e,t,n,r){const o=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case BZ.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,t,n,r);case BZ.ROW_SPLITS:if(o.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(o.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(o,t,n,r);default:throw new Error("Unsupported partition type: ".concat(BZ[a]))}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case BZ.FIRST_DIM_SIZE:return e[0];case BZ.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case BZ.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(BZ[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let a=n.length-2;a>=0;--a)n[a]=n[a+1]*t[a+1];const r=jZ(t,!1),o=XE(this.valuesDType,zE(r));if(n[0]*t[0]>0){let a=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e){a=this.calculateOutputIndex(e-1,a,n[e],t[e])}this.setOutput(this.raggedRank,a,o,r)}return[r,o]}setOutput(e,t,n,r){if(0===n.length)return;const o=this.values,a=n;let i=r.slice();i=i.slice(e+1);const s=zE(i),c=t.length;let l=this.defaultValue;if(l.length!==s&&1!==l.length){const e=this.defaultValueShape;sO((()=>{const t=AM(l,e),n=OM(t,i);l=n.dataSync()}))}let u=0,d=0,h=0;for(let p=0;p<=c;++p){let e=p<c?t[p]:-1;if(e!==h){if(d<h){const e=o.subarray(u*s);WZ(a.subarray(d*s),e,(h-d)*s)}if(p>=c){const t=n.length;e=Math.floor(t/s)}if(e>h)if(1===this.defaultValue.length)a.subarray(h*s,e*s).fill(this.defaultValue[0]),h=e;else for(;e>h;){WZ(a.slice(h*s),l,s),++h}e<0?(u=p+1,d=h):(u=p,d=h,h=d+1)}else++h}}}function WZ(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function jZ(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error("Dimension ".concat(r," must be >= 0"));if(r<-1)throw new Error("Dimension ".concat(r," must be >= -1"));r=-1}n.push(r)}return n}function VZ(e,t,n,r,o,a,i,s,c,l){return new UZ(e,t,n,r,o,a,i,s,c,l).compute()}const GZ={kernelName:AR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:o,values:a,defaultValue:i,rowPartitionTensors:s}=t,{rowPartitionTypes:c}=r,l=n.data.get(o.dataId).values,u=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,h=s.map((e=>n.data.get(e.dataId).values)),p=s.map((e=>e.shape)),[f,m]=VZ(l,o.shape,u,a.shape,a.dtype,d,i.shape,h,p,c);return n.makeTensorInfo(f,a.dtype,m)}};function HZ(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return iT(0,r);const o=iT(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),o[0]=e;for(let a=1;a<o.length;a++)o[a]=o[a-1]+n;return o}const qZ={kernelName:ER,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:o,dtype:a,step:i}=n,s=HZ(r,o,i,a);return t.makeTensorInfo([s.length],a,s)}},KZ=XX(NR,(e=>1/e)),XZ={kernelName:NR,backendName:"cpu",kernelFunc:KZ};const YZ={kernelName:FR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:o}=t,{alignCorners:a,halfPixelCenters:i,size:s}=r;GX(o,"resizeBilinear");const c=nT(o.shape),[l,u]=s,[d,h,p,f]=o.shape,m=n.data.get(o.dataId).values,g=new Float32Array(zE([d,l,u,f])),v=[a&&l>1?h-1:h,a&&u>1?p-1:p],y=[a&&l>1?l-1:l,a&&u>1?u-1:u];let b=0;const x=v[0]/y[0],w=v[1]/y[1];for(let k=0;k<d;k++)for(let e=0;e<l;e++){let t;t=i?x*(e+.5)-.5:x*e;const n=Math.max(0,Math.floor(t)),r=t-n,o=Math.min(h-1,Math.ceil(t)),a=k*c[0]+n*c[1],s=k*c[0]+o*c[1];for(let e=0;e<u;e++){let t;t=i?w*(e+.5)-.5:w*e;const n=Math.max(0,Math.floor(t)),o=t-n,l=Math.min(p-1,Math.ceil(t)),u=a+n*c[2],d=s+n*c[2],h=a+l*c[2],v=s+l*c[2];for(let e=0;e<f;e++){const t=m[u+e],n=m[d+e],a=t+(m[h+e]-t)*o,i=a+(n+(m[v+e]-n)*o-a)*r;g[b++]=i}}}return n.makeTensorInfo([d,l,u,f],"float32",g)}};const QZ={kernelName:MR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:o,dy:a}=t,{alignCorners:i}=r;GX([a,o],"resizeBilinearGrad");const s=nT(o.shape),[c,l,u,d]=o.shape,[,h,p]=a.shape,f=new Float32Array(c*l*u*d),m=[i&&h>1?l-1:l,i&&p>1?u-1:u],g=[i&&h>1?h-1:h,i&&p>1?p-1:p],v=m[0]/g[0],y=m[1]/g[1],b=n.data.get(a.dataId).values;let x=0;for(let w=0;w<c;w++){const e=w*s[0];for(let t=0;t<h;t++){const n=t*v,r=Math.floor(n),o=Math.min(Math.ceil(n),l-1),a=e+r*s[1],i=e+o*s[1],c=n-r,h=1-c;for(let e=0;e<p;e++){const t=e*y,n=Math.floor(t),r=Math.min(Math.ceil(t),u-1),o=t-n,l=1-o,p=a+n*s[2],m=a+r*s[2],g=i+n*s[2],v=i+r*s[2],w=h*l,k=h*o,S=c*l,I=c*o;for(let e=0;e<d;e++){const t=b[x++];f[p+e]+=t*w,f[m+e]+=t*k,f[g+e]+=t*S,f[v+e]+=t*I}}}}return n.makeTensorInfo([c,u,l,d],"float32",f)}};const JZ={kernelName:DR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:o}=t,{alignCorners:a,halfPixelCenters:i,size:s}=r;GX(o,"resizeNearestNeighbor");const c=nT(o.shape),[l,u]=s,[d,h,p,f]=o.shape,m=n.data.get(o.dataId).values,g=new Float32Array(d*l*u*f),v=[a&&l>1?h-1:h,a&&u>1?p-1:p],y=[a&&l>1?l-1:l,a&&u>1?u-1:u],b=v[0]/y[0],x=v[1]/y[1];let w=0;for(let k=0;k<d;k++){const e=k*c[0];for(let t=0;t<l;t++){const n=i?b*(t+.5):b*t;let r=Math.min(h-1,a?Math.round(n):Math.floor(n));i&&(r=Math.max(0,r));const o=e+r*c[1];for(let e=0;e<u;e++){const t=i?x*(e+.5):x*e;let n=Math.min(p-1,a?Math.round(t):Math.floor(t));i&&(n=Math.max(0,n));const r=o+n*c[2];for(let e=0;e<f;e++){const t=m[r+e];g[w++]=t}}}}return n.makeTensorInfo([d,l,u,f],o.dtype,g)}};const $Z={kernelName:OR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:o,dy:a}=t,{alignCorners:i}=r;GX([a,o],"resizeNearestNeighborGrad");const s=nT(o.shape),c=nT(a.shape),[l,u,d,h]=o.shape,[,p,f]=a.shape,m=new Float32Array(l*u*d*h),g=n.data.get(a.dataId).values,v=[i&&p>1?u-1:u,i&&f>1?d-1:d],y=[i&&p>1?p-1:p,i&&f>1?f-1:f],b=v[0]/y[0],x=v[1]/y[1],w=1/b,k=1/x,S=2*Math.ceil(w)+2,I=2*Math.ceil(k)+2;for(let C=0;C<l;C++){const e=C*s[0];for(let t=0;t<u;t++){const n=e+t*s[1],r=Math.floor(t*w),o=Math.floor(r-S/2);for(let a=0;a<d;a++){const r=n+a*s[2],l=Math.floor(a*k),v=Math.floor(l-I/2);for(let n=0;n<h;n++){let s=0;for(let r=0;r<S;r++){const l=r+o;if(l<0||l>=p)continue;const h=e+l*c[1],m=l*b;if(t===Math.min(u-1,i?Math.round(m):Math.floor(m)))for(let e=0;e<I;e++){const t=e+v;if(t<0||t>=f)continue;const r=h+t*c[2],o=t*x;a===Math.min(d-1,i?Math.round(o):Math.floor(o))&&(s+=g[r+n])}}m[r+n]=s}}}}return n.makeTensorInfo(o.shape,o.dtype,m)}};const ZZ={kernelName:LR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{dims:a}=r;GX(o,"reverse");const i=o.shape.length,s=HE(a,o.shape);if(0===i)return $X({inputs:{x:o},backend:n});const c=new vD(o.shape,o.dtype),l=n.bufferSync(o);for(let u=0;u<c.size;u++){const e=c.indexToLoc(u),t=e.slice();s.forEach((e=>t[e]=o.shape[e]-1-t[e])),c.set(l.get(...t),...e)}return n.makeTensorInfo(c.shape,c.dtype,c.values)}},e0={kernelName:E_,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:o}=t,{radians:a,fillValue:i,center:s}=n,c=r,l=KE(o.dtype,zE(o.shape)),[u,d,h,p]=o.shape,[f,m]=Ez(s,d,h),g=Math.sin(a),v=Math.cos(a),y=c.data.get(o.dataId).values;for(let b=0;b<u;b++){const e=b*h*d*p;for(let t=0;t<d;t++){const n=t*(h*p);for(let r=0;r<h;r++){const o=r*p;for(let a=0;a<p;a++){const s=[u,t,r,a],c=s[2],b=s[1];let x=(c-f)*v-(b-m)*g,w=(c-f)*g+(b-m)*v;x=Math.round(x+f),w=Math.round(w+m);let k=i;if("number"!==typeof i&&(k=3===a?255:i[a]),x>=0&&x<h&&w>=0&&w<d){k=y[e+w*(h*p)+x*p+a]}l[e+n+o+a]=k}}}}return{dataId:c.write(l,o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}},t0=XX(zR,(e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),n0={kernelName:zR,backendName:"cpu",kernelFunc:t0},r0=KX((e=>1/Math.sqrt(e))),o0=YX(BR,r0),a0={kernelName:BR,backendName:"cpu",kernelFunc:o0};function i0(e,t,n,r,o,a,i,s,c,l){const u=[r/o,o],d=e.values,h=t.values;if(0===r)return JO(n,t.dtype);const p=c instanceof vD?c:JO(u,t.dtype);"string"===typeof c||"number"===typeof c?p.values.fill(c):"boolean"===typeof c&&p.values.fill(+c);for(let f=0;f<a;f++){const e=[];let a=0;for(let t=0;t<i;t++){const n=d[f*i+t];e.push(n),a+=n*s[t]}if(a<0||a>=r/o)throw new Error("Invalid indices: ".concat(e," does not index into ").concat(n));for(let n=0;n<o;n++)l?p.values[a*o+n]+=h[f*o+n]:p.values[a*o+n]=0===t.rank?h[0]:h[f*o+n]}return p}const s0={kernelName:UR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:o,updates:a}=t,{shape:i}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=Pz(0,o,i),h=i0(n.bufferSync(o),n.bufferSync(a),i,d,l,c,s,u,0,!0);return n.makeTensorInfo(i,h.dtype,h.values)}};function c0(e,t){let n=0,r=e.length,o=0;for(;n<r;)o=Math.floor((n+r)/2),e[o]<t?n=o+1:r=o;return r}function l0(e,t){let n=0,r=e.length,o=0;for(;n<r;)o=Math.floor((n+r)/2),e[o]<=t?n=o+1:r=o;return r}const u0={kernelName:jR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:o,values:a}=t,{side:i}=r,s=function(e,t,n,r,o,a){const i=XE("int32",n*o);for(let s=0;s<n;++s){const n=e.slice(s*r,(s+1)*r),c=s*o;for(let e=0;e<o;++e)i[c+e]="left"===a?c0(n,t[e+c]):l0(n,t[e+c])}return i}(n.data.get(o.dataId).values,n.data.get(a.dataId).values,o.shape[0],o.shape[1],a.shape[1],i);return n.makeTensorInfo(a.shape,"int32",s)}};const d0={kernelName:VR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:o,e:a}=t;GX([r,o,a],"select");const i=r.shape.length,s=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,l=n.data.get(a.dataId).values,u=RD(o.dtype,a.dtype),d=iT(zE(o.shape),u);let h=0;const p=0===i||i>1||1===o.shape.length?1:zE(o.shape.slice(1));for(let f=0;f<s.length;f++)for(let e=0;e<p;e++)1===s[f]?d[h++]=c[f]:d[h++]=l[f];return n.makeTensorInfo(o.shape,u,d)}},h0=Lz,p0=zz,f0=XX(GR,(e=>e>=0?p0*e:h0*(Math.exp(e)-1))),m0={kernelName:GR,backendName:"cpu",kernelFunc:f0},g0=XX(XR,(e=>e<0?-1:e>0?1:0)),v0={kernelName:XR,backendName:"cpu",kernelFunc:g0},y0=XX(qR,(e=>Math.sin(e))),b0={kernelName:qR,backendName:"cpu",kernelFunc:y0},x0=XX(KR,(e=>Math.sinh(e))),w0={kernelName:KR,backendName:"cpu",kernelFunc:x0},k0=Math.log(1.1920928955078125e-7)+2,S0=XX(QR,(e=>{const t=e>-k0,n=e<k0,r=Math.exp(e);let o;return o=n?r:t?e:Math.log(1+r),o})),I0={kernelName:QR,backendName:"cpu",kernelFunc:S0};const C0={kernelName:ZR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{blockShape:a,paddings:i}=r;GX([o],"spaceToBatchND");const s=zE(a),c=[[0,0]];c.push(...i);for(let g=1+a.length;g<o.shape.length;++g)c.push([0,0]);const l=CZ.kernelFunc({inputs:{x:o},backend:n,attrs:{paddings:c,constantValue:0}}),u=Tz(l.shape,a,s,!1),d=Nz(u.length,a.length,!1),h=Rz(l.shape,a,s,!1),p=TY({inputs:{x:l},backend:n,attrs:{shape:u}}),f=WY({inputs:{x:p},backend:n,attrs:{perm:d}}),m=TY({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}};function A0(e,t,n,r,o,a,i){const s=t[0],c=a[0],l=new Array(c),u=new Array(s),d=t[1];if(0===c){if(0!==s)throw new Error(uB(s));return[XE(n,0),[0,d],XE(o,0),l,u]}let h=!0,p=0;const f=new Array(c).fill(0);for(let g=0;g<s;++g){const t=e[g*d];if(t<0)throw new Error(dB(g,t));if(t>=c)throw new Error(hB(g,t,c));++f[t],h=h&&t>=p,p=t}let m=!0;for(let g=0;g<c;++g){const e=0===f[g];l[g]=e,m=m&&!e,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&h){const t=e,n=r;for(let e=0;e<s;++e)u[e]=e;return[t,[s,d],n,l,u]}{const t=f[c-1],a=XE(n,t*d),h=XE(o,t),p=new Array(c).fill(0);for(let n=0;n<s;++n){const t=e[n*d],o=p[t],i=(0===t?0:f[t-1])+o;p[t]++;for(let r=0;r<d;++r)a[i*d+r]=e[n*d+r];h[i]=r[n],u[n]=i}for(let e=0;e<c;++e){if(0===p[e]){const t=0===e?0:f[e-1];a[t*d+0]=e;for(let e=1;e<d;++e)a[t*d+e]=0;h[t]=i}}return[a,[t,d],h,l,u]}}const E0={kernelName:n_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:o,denseShape:a,defaultValue:i}=t;if(1!==a.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(a.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==o.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(o.shape));if(0!==i.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));const s=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values[0],[d,h,p,f,m]=A0(s,r.shape,r.dtype,c,o.dtype,l,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],o.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};function T0(e,t,n,r,o){const a=zE(r),i=t[0],s=o.length,c=[];let l=1,u=-1;for(let m=0;m<s;++m){const e=o[m];if(-1===e){if(-1!==u)throw new Error(pB(u,m));u=m,c.push(1)}else{if(e<0)throw new Error(fB(m,e));l*=e,c.push(e)}}if(-1!==u){if(l<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const e=Math.trunc(a/l);if(l*e!==a)throw new Error(gB(r,c));c[u]=e}if(zE(c)!==a)throw new Error(vB(r,c));const d=r.length,h=[];if(d>0){h[d-1]=1;for(let e=d-2;e>=0;--e)h[e]=h[e+1]*r[e+1]}const p=[];if(s>0){p[s-1]=1;for(let e=s-2;e>=0;--e)p[e]=p[e+1]*c[e+1]}const f=XE(n,i*s);for(let m=0;m<i;++m){let t=0;for(let n=0;n<d;++n)t+=e[m*d+n]*h[n];for(let e=0;e<s;++e)f[m*s+e]=Math.trunc(t/p[e]),t%=p[e]}return[f,[i,s],c]}const N0={kernelName:r_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:o,newShape:a}=t;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==o.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(o.shape));if(1!==a.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(a.shape));const i=Array.from(n.data.get(o.dataId).values),s=n.data.get(r.dataId).values,c=Array.from(n.data.get(a.dataId).values),[l,u,d]=T0(s,r.shape,r.dtype,i,c);return[n.makeTensorInfo(u,r.dtype,l),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}};function R0(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const s=r.length,c=[t[0],e.length/t[0]],l=c[1],u=s>0?o[s-1]+1:0;if(u<0)throw new Error("segment ids must be >= 0");const d=t.slice();d[0]=u;const h=XE(n,d.reduce(((e,t)=>e*t),1));if(0===s)return u>0&&h.fill(i),[h,d];if(u<=0)throw new Error("segment ids must be >= 0");let p=0,f=1,m=0,g=o[p];for(;;){let t=0;if(f<s){if(t=o[f],g===t){++f;continue}if(g>=t)throw new Error("segment ids are not increasing")}if(g<0||g>=u)throw new Error(xB(g,u));g>m&&h.fill(i,m*l,g*l);for(let n=p;n<f;++n){const t=r[n];if(t<0||t>=c[0])throw new Error(wB(n,r[n],c[0]));for(let n=0;n<l;n++)h[g*l+n]+=e[t*l+n]}if(a)for(let e=0;e<l;e++)h[g*l+e]/=f-p;if(p=f,++f,m=g+1,g=t,f>s)break}return m<u&&h.fill(i,m*l,u*l),[h,d]}const _0={kernelName:o_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:o,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==o.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(o.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(a.shape));if(o.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,s=n.data.get(o.dataId).values,c=n.data.get(a.dataId).values,[l,u]=R0(i,r.shape,r.dtype,s,c,!0);return n.makeTensorInfo(u,r.dtype,l)}};const D0={kernelName:a_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:o,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==o.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(o.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(a.shape));if(o.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,s=n.data.get(o.dataId).values,c=n.data.get(a.dataId).values,[l,u]=R0(i,r.shape,r.dtype,s,c);return n.makeTensorInfo(u,r.dtype,l)}};const O0={kernelName:i_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:o,sparseValues:a,defaultValue:i}=t,{outputShape:s}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:d,outputSize:h}=Pz(0,o,s),p=!1,f=n.bufferSync(o);let m;switch(a.dtype){case"bool":m=i0(f,n.bufferSync(a),s,h,u,l,c,d,Boolean(n.data.get(i.dataId).values[0]),p);break;case"float32":m=i0(f,n.bufferSync(a),s,h,u,l,c,d,n.data.get(i.dataId).values[0],p);break;case"int32":m=i0(f,n.bufferSync(a),s,h,u,l,c,d,n.data.get(i.dataId).values[0],p);break;case"string":m=i0(f,n.bufferSync(a),s,h,u,l,c,d,iD(n.data.get(i.dataId).values[0]),p);break;default:throw new Error("Unsupported type ".concat(a.dtype))}return n.makeTensorInfo(s,m.dtype,m.values)}};const F0={kernelName:e_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{numOrSizeSplits:a,axis:i}=r,s=HE(i,o.shape)[0],c=lB(o,a,s),l=new Array(o.shape.length).fill(0),u=o.shape.slice();return c.map((e=>{const t=[...u];t[s]=e;const r=pQ({inputs:{x:o},backend:n,attrs:{begin:l,size:t}});return l[s]+=e,r}))}},M0=KX((e=>Math.sqrt(e))),P0=XX(JR,(e=>Math.sqrt(e))),L0={kernelName:JR,backendName:"cpu",kernelFunc:P0},z0={kernelName:c_,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{x:r}=t,o=n;GX(r,"square");const a=o.data.get(r.dataId).values,i=new Float32Array(a.length);for(let s=0;s<a.length;++s){const e=a[s];i[s]=e*e}return{dataId:o.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},B0=nY(((e,t)=>{const n=e-t;return n*n})),U0=kY(s_,B0),W0={kernelName:s_,backendName:"cpu",kernelFunc:U0},j0=KX(((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:o}=t;return e.replace(new RegExp(n,r?"g":""),o)})),V0=YX(l_,j0),G0={kernelName:l_,backendName:"cpu",kernelFunc:V0},H0=XX(C_,((e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),q0={kernelName:C_,backendName:"cpu",kernelFunc:H0};function K0(e,t,n,r){const o=JO(e,t.dtype);for(let a=0;a<o.size;a++){const e=o.indexToLoc(a),i=new Array(e.length);for(let t=0;t<i.length;t++)i[t]=e[t]*n[t]+r[t];o.set(t.get(...i),...e)}return o}const X0={kernelName:u_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{begin:a,end:i,strides:s,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r;GX(o,"stridedSlice");const{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:v,begin:y,end:b,strides:x}=iM(o.shape,a,i,s,c,l,u,d,h);let w;if(m)w=TY({inputs:{x:o},backend:n,attrs:{shape:f}});else if(g||v){ME(o.shape.length>=1,(()=>"Input must have rank at least 1, got: ".concat(o.shape.length)));const e=KF(y,b,x),t=pQ({inputs:{x:o},backend:n,attrs:{begin:y,size:e}});w=TY({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{const e=K0(p,n.bufferSync(o),x,y);w=n.makeTensorInfo(f,e.dtype,e.values)}return w}};class Y0{constructor(e,t,n,r,o,a){this.separator=aD(e),this.nGramWidths=t,this.leftPad=aD(n),this.rightPad=aD(r),this.padWidth=o,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,o,a){for(let i=0;i<o;++i){const s=this.getPadWidth(a),c=Math.max(0,s-i),l=Math.max(0,s-(o-(i+1))),u=a-(c+l),d=t+(c>0?0:i-s);let h=0;h+=c*this.leftPad.length;for(let t=0;t<u;++t)h+=e[d+t].length;h+=l*this.rightPad.length;h+=(c+l+u-1)*this.separator.length,n[r+i]=new Uint8Array(h);const p=n[r+i];let f=0;const m=e=>e.forEach((e=>p[f++]=e));for(let e=0;e<c;++e)m(this.leftPad),m(this.separator);for(let t=0;t<u-1;++t)m(e[d+t]),m(this.separator);if(u>0){m(e[d+u-1]);for(let e=0;e<l;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<l-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){const n=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error("First split value must be 0, got ".concat(e));for(let o=1;o<r;++o){let r=t[o]>=e;if(r=r&&t[o]<=n,!r)throw new Error("Invalid split value ".concat(t[o],", must be in [").concat(e,", ").concat(n,"]"));e=t[o]}if(e!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(e))}const o=r-1,a=XE("int32",r);if(0===n||0===r){const e=new Array(n);for(let t=0;t<=o;++t)a[t]=0;return[e,a]}a[0]=0;for(let s=1;s<=o;++s){const e=t[s]-t[s-1];let n=0;this.nGramWidths.forEach((t=>{n+=this.getNumNGrams(e,t)})),this.preserveShort&&e>0&&0===n&&(n=1),a[s]=a[s-1]+n}const i=new Array(a[o]);for(let s=0;s<o;++s){const n=t[s];let r=a[s];if(this.nGramWidths.forEach((o=>{const a=t[s+1]-t[s],c=this.getNumNGrams(a,o);this.createNGrams(e,n,i,r,c,o),r+=c})),this.preserveShort&&r===a[s]){const o=t[s+1]-t[s];if(0===o)continue;const a=o+2*this.padWidth,c=1;this.createNGrams(e,n,i,r,c,a)}}return[i,a]}}function Q0(e,t,n,r,o,a,i,s){return new Y0(n,r,o,a,i,s).compute(e,t)}const J0={kernelName:d_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:o,nGramWidths:a,leftPad:i,rightPad:s,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:d}=t,h=n.data.get(u.dataId).values,p=n.data.get(d.dataId).values,[f,m]=Q0(h,p,o,a,i,s,c,l);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}};function $0(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){const o=t[0];let a=e.indexOf(o);for(;-1!==a;){const t=e.subarray(0,a);n&&0===t.length||r.push(t),a=(e=e.subarray(a+1)).indexOf(o)}return void(n&&0===e.length||r.push(e))}let o=0;for(let a=0;a<e.length+1;a++)if(a===e.length||-1!==t.indexOf(e[a])){const t=e.subarray(o,a);n&&0===t.length||r.push(t),o=a+1}}function Z0(e,t,n){const r=e.length,o=[];let a=0,i=0;const s=new Array(r);for(let h=0;h<r;++h){const r=o.length;$0(e[h],t,n,o);const c=o.length-r;s[h]=c,a+=c,i=Math.max(i,c)}const c=XE("int32",2*a),l=new Array(a),u=[r,i];let d=0;for(let h=0;h<r;++h)for(let e=0;e<s[h];++e)c[2*d]=h,c[2*d+1]=e,l[d]=o[d],++d;return[c,l,u]}const e1={kernelName:h_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:o}=r,{input:a,delimiter:i}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));const s=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values[0],[l,u,d]=Z0(s,c,o),h=u.length;return[n.makeTensorInfo([h,2],"int32",l),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};function t1(e,t){const n=XE("int32",e.length);for(let r=0;r<e.length;++r)n[r]=tD(e[r]).modulo(t).getLowBitsUnsigned();return n}const n1={kernelName:p_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:o}=r,{input:a}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const i=t1(n.data.get(a.dataId).values,o);return n.makeTensorInfo(a.shape,"int32",i)}},r1=XX(m_,(e=>Math.tan(e))),o1={kernelName:m_,backendName:"cpu",kernelFunc:r1},a1=XX(g_,(e=>Math.tanh(e)));const i1={kernelName:WR,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{tensor:r,indices:o,updates:a}=t,{sliceRank:i,numUpdates:s,sliceSize:c,strides:l,outputSize:u}=Pz(0,o,r.shape),d=n.bufferSync(o),h=n.bufferSync(a),p=n.bufferSync(r),f=i0(d,h,r.shape,u,c,s,i,l,p,!1);return n.makeTensorInfo(r.shape,f.dtype,f.values)}};function s1(e,t){const n=new Array(e.rank);for(let o=0;o<n.length;o++)n[o]=e.shape[o]*t[o];const r=JO(n,e.dtype);for(let o=0;o<r.values.length;++o){const t=r.indexToLoc(o),n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=t[r]%e.shape[r];const a=e.locToIndex(n);r.values[o]=e.values[a]}return r}const c1={kernelName:v_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{reps:a}=r;GX(o,"tile");const i=s1(n.bufferSync(o),a);return n.makeTensorInfo(i.shape,i.dtype,i.values)}},l1=(e,t)=>{const n=t.value-e.value;return 0===n?e.index-t.index:n};function u1(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;for(;r>n;){if(r-n>600){const o=r-n+1,a=t-n+1,i=Math.log(o),s=.5*Math.exp(2*i/3),c=.5*Math.sqrt(i*s*(o-s)/o)*Math.sign(a-o/2);u1(e,t,Math.max(n,Math.floor(t-a*s/o+c)),Math.min(r,Math.floor(t+(o-a)*s/o+c)))}const o=e[t];let a=n,i=r;for(FE(e,n,t),l1(e[r],o)>0&&FE(e,n,r);a<i;){for(FE(e,a,i),a++,i--;l1(e[a],o)<0;)a+=1;for(;l1(e[i],o)>0;)i-=1}0===l1(e[n],o)?FE(e,n,i):(i+=1,FE(e,i,r)),i<=t&&(n=i+1),t<=i&&(r=i-1)}}function d1(e,t,n,r,o){const a=t[t.length-1],[i,s]=[e.length/a,a],c=KE(n,i*r),l=KE("int32",i*r);for(let d=0;d<i;d++){const t=d*s,n=e.subarray(t,t+s);let a=new Array(n.length);n.forEach(((e,t)=>a[t]={value:e,index:t})),r<a.length&&(u1(a,r),a=a.slice(0,r)),o&&a.sort(l1);const i=d*r,u=c.subarray(i,i+r),h=l.subarray(i,i+r);for(let e=0;e<r;e++)u[e]=a[e].value,h[e]=a[e].index}const u=t.slice();return u[u.length-1]=r,[JO(u,n,c),JO(u,"int32",l)]}const h1={kernelName:y_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{k:a,sorted:i}=r;GX(o,"topk");const s=n.data.get(o.dataId).values,[c,l]=d1(s,o.shape,o.dtype,a,i);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}};const p1={kernelName:b_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{image:o,transforms:a}=t,{interpolation:i,fillMode:s,fillValue:c,outputShape:l}=n,[u,d,h,p]=o.shape,[f,m]=null!=l?l:[d,h],g=[u,f,m,p],v=nT(o.shape),y=v[0],b=v[1],x=v[2],w=nT(g),k=w[0],S=w[1],I=w[2],C=KE(o.dtype,zE(g));C.fill(c);const A=r.data.get(o.dataId).values,E=r.data.get(a.dataId).values;for(let T=0;T<u;++T){const e=1===a.shape[0]?E:E.subarray(8*T,8*T+8);for(let t=0;t<f;++t)for(let n=0;n<m;++n)for(let r=0;r<p;++r){let o;const a=e[6]*n+e[7]*t+1;if(0===a)continue;const l=(e[0]*n+e[1]*t+e[2])/a,u=(e[3]*n+e[4]*t+e[5])/a,p=f1(l,h,s),f=f1(u,d,s);switch(i){case"nearest":o=g1(A,d,h,y,b,x,T,f,p,r,c);break;case"bilinear":o=v1(A,d,h,y,b,x,T,f,p,r,c);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(i))}C[T*k+t*S+n*I+r]=o}return r.makeTensorInfo(g,o.dtype,C)}return{dataId:r.write(C,g,o.dtype),shape:o.shape,dtype:o.dtype}}};function f1(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{const e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return DE(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{const e=t-1;n-=t*Math.trunc(n/e)}return DE(0,n,t-1)}(e,t);case"nearest":return function(e,t){return DE(0,e,t-1)}(e,t);default:return function(e){return e}(e)}}function m1(e,t,n,r,o,a,i,s,c,l,u){return 0<=s&&s<t&&0<=c&&c<n?e[i*r+s*o+c*a+l]:u}function g1(e,t,n,r,o,a,i,s,c,l,u){return m1(e,t,n,r,o,a,i,Math.round(s),Math.round(c),l,u)}function v1(e,t,n,r,o,a,i,s,c,l,u){const d=Math.floor(s),h=Math.floor(c),p=d+1,f=h+1;return(p-s)*((f-c)*m1(e,t,n,r,o,a,i,d,h,l,u)+(c-h)*m1(e,t,n,r,o,a,i,d,f,l,u))+(s-d)*((f-c)*m1(e,t,n,r,o,a,i,p,h,l,u)+(c-h)*m1(e,t,n,r,o,a,i,p,f,l,u))}function y1(e,t,n,r){const o=HE(t,n)[0],a=[1,n[0],1];for(let f=0;f<o;f++)a[0]*=n[f];a[1]=n[o];for(let f=o+1;f<n.length;f++)a[2]*=n[f];const i=new Map,s=new Int32Array(n[o]),c=new vD(a,r,e),l=[],u=1===a[0]&&1===a[2];for(let f=0;f<n[o];f++){let t;if(u)t=e[f].toString();else{const e=[];for(let t=0;t<a[0];t++)for(let n=0;n<a[2];n++)e.push(c.get(t,f,n));t=e.join(",")}const n=i.get(t);if(null!=n)s[f]=n;else{const e=i.size;i.set(t,e),s[f]=e,l.push(f)}}const d=a.slice();d[1]=i.size;const h=new vD(d,r);l.forEach(((e,t)=>{for(let n=0;n<a[0];n++)for(let r=0;r<a[2];r++)h.set(c.get(n,e,r),n,t,r)}));const p=n.slice();return p[o]=d[1],{outputValues:h.values,outputShape:p,indices:s}}const b1={kernelName:w_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:o}=n,{x:a}=t;GX(a,"unique");const i=r.data.get(a.dataId).values,{outputValues:s,outputShape:c,indices:l}=y1(i,o,a.shape,a.dtype);return[r.makeTensorInfo(c,a.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}};const x1={kernelName:k_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:o}=t;let{axis:a}=r;a<0&&(a+=o.shape.length);const i=o.shape.length,s=o.shape[a],c=new Array(i-1);let l=0;for(let p=0;p<i;p++)p!==a&&(c[l++]=o.shape[p]);const u=new Array(i).fill(0),d=o.shape.slice();d[a]=1;const h=new Array(s);for(let p=0;p<h.length;p++){u[a]=p;const e=pQ({inputs:{x:o},backend:n,attrs:{begin:u,size:d}});h[p]=TY({inputs:{x:e},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(e)}return h}};const w1={kernelName:S_,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,segmentIds:a}=t,{numSegments:i}=r;GX(o,"unsortedSegmentSum");const s=[],c=[],l=o.shape.length-a.shape.length;let u=a;for(let h=0;h<l;++h){const e=AJ({inputs:{input:u},backend:n,attrs:{dim:h+1}});u=e,c.push(e)}for(let h=0;h<i;++h){const e=nD(h,"int32"),t=n.makeTensorInfo([],"int32",e),r=pJ({inputs:{a:t,b:u},backend:n}),a=xY({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),i=iJ({inputs:{a:a,b:o},backend:n}),l=cJ({inputs:{x:i},backend:n,attrs:{axis:0,keepDims:!1}});s.push(l),c.push(t),c.push(r),c.push(a),c.push(i),c.push(l)}const d=SZ({inputs:s,backend:n,attrs:{axis:0}});return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),d}},k1=[DY,FY,PY,zY,EY,BY,VY,GY,HY,qY,XY,QY,$Y,tQ,rQ,sQ,cQ,lQ,uQ,_Y,dQ,mQ,yQ,xQ,wQ,wY,IQ,AQ,mY,EQ,DQ,FQ,MQ,PQ,LQ,zQ,BQ,WQ,VQ,GQ,HQ,qQ,KQ,XQ,QQ,JQ,$Q,ZQ,eJ,tJ,nJ,rJ,uJ,JX,dJ,fJ,kJ,CJ,EJ,RJ,WJ,VJ,GJ,KJ,QJ,JJ,$J,e$,n$,a$,c$,ZX,l$,RQ,d$,p$,m$,tY,y$,w$,S$,A$,T$,_$,O$,P$,L$,z$,W$,G$,H$,q$,K$,X$,Y$,Q$,J$,eZ,tZ,oZ,sZ,sJ,lZ,dZ,pZ,mZ,yZ,bZ,kZ,IZ,CZ,TZ,aY,RZ,MZ,zZ,GZ,qZ,yY,OJ,XZ,sY,lY,NY,YZ,QZ,JZ,$Z,ZZ,e0,n0,a0,s0,u0,d0,m0,hY,v0,b0,w0,fQ,iZ,I0,C0,E0,N0,_0,D0,O0,F0,L0,z0,W0,G0,q0,X0,J0,e1,n1,LJ,lJ,o1,{kernelName:g_,backendName:"cpu",kernelFunc:a1},i1,c1,h1,p1,jY,b1,x1,w1,wZ];for(const n of k1)z_(n);const S1={},I1={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function C1(e,t){if(!(e in S1)||null!=t){const n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==t?function(e){if(mT().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",(t=>{t.preventDefault(),delete S1[e]}),!1),mT().getBool("SOFTWARE_WEBGL_ENABLED")&&(I1.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",I1)||n.getContext("experimental-webgl",I1);return n.getContext("webgl2",I1)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;S1[e]=n}const n=S1[e];return null==n||n.isContextLost()?(delete S1[e],C1(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),S1[e])}var A1,E1,T1;function N1(e,t){return[t,e]}function R1(e){const t=zE(e);return WE(Math.ceil(t/4))}function _1(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function D1(e,t){const n=e;let r,o,a,i,s,c,l,u,d,h;return 2===mT().getNumber("WEBGL_VERSION")?(r=n.R32F,o=n.R16F,a=n.RGBA16F,i=n.RGBA32F,s=n.RED,l=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,c=n.RGBA8):(r=e.RGBA,o=e.RGBA,a=e.RGBA,i=n.RGBA,s=e.RGBA,l=4,u=4,d=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,c=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:c,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}function O1(e,t){const n=t();return mT().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(A1||(A1={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(E1||(E1={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(T1||(T1={}));function F1(e){return!!(mT().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function M1(e,t){return G1(e,(()=>e.getExtension(t)),'Extension "'+t+'" not supported on this browser.')}const P1=/ERROR: [0-9]+:([0-9]+):/g;function L1(e,t){const n=P1.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);const r=+n[1],o=e.split("\n"),a=o.length.toString().length+2,i=o.map(((e,t)=>jE((t+1).toString(),a)+e));let s=0;for(let d=0;d<i.length;d++)s=Math.max(i[d].length,s);const c=i.slice(0,r-1),l=i.slice(r-1,r),u=i.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(jE(l[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function z1(e,t){if(O1(e,(()=>e.validateProgram(t))),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function B1(e,t,n,r,o,a,i){const s=e.getAttribLocation(t,n);return-1!==s&&(O1(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,r))),O1(e,(()=>e.vertexAttribPointer(s,o,e.FLOAT,!1,a,i))),O1(e,(()=>e.enableVertexAttribArray(s))),!0)}function U1(e,t,n,r){O1(e,(()=>function(e,t,n){H1(e,n),O1(e,(()=>e.activeTexture(e.TEXTURE0+n))),O1(e,(()=>e.bindTexture(e.TEXTURE_2D,t)))}(e,t,r))),O1(e,(()=>e.uniform1i(n,r)))}function W1(e,t,n){O1(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,n))),O1(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)))}function j1(e,t){O1(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,t))),O1(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)))}function V1(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function G1(e,t,n){const r=O1(e,(()=>t()));if(null==r)throw new Error(n);return r}function H1(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){const e="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(e,"."))}}function q1(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return zE(e.slice(0,e.length-t))}function K1(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function X1(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[q1(e),...K1(e)]),t}function Y1(e){return e%2===0}function Q1(e,t){if(BE(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(Y1(n)&&Y1(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&Y1(e[0])&&Y1(t[0])}let J1,$1;function Z1(e,t){return null!=e.getExtension(t)}function e2(e){try{if(null!=C1(e))return!0}catch(_se){return console.log("Error when getting WebGL context: ",_se),!1}return!1}function t2(e){if(0===e)return!1;const t=C1(e);if(1!==e){if(Z1(t,"EXT_color_buffer_float"))return n2(t);const e="EXT_color_buffer_half_float";if(Z1(t,e)){const n=t.getExtension(e);return function(e,t){const n=D1(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const o=1,a=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,o,a,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),s}(t,n)}return!1}if(!Z1(t,"OES_texture_float"))return!1;if(!Z1(t,"WEBGL_color_buffer_float"))return!1;return n2(t)}function n2(e){const t=D1(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function r2(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&ME("complex64"!==e.dtype,(()=>"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."))}))}const o2=mT();function a2(){let e,t,n,r,o,a,i,s,c,l;return 2===mT().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",o="texture",a="outputColor",i="out vec4 outputColor;",s=mT().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",c="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",o="texture2D",a="gl_FragColor",i="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:a,defineOutput:i,defineSpecialNaN:s,defineSpecialInf:c,defineRound:l}}function i2(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=nT(t);return r.map(((t,o)=>{const a="int ".concat(e[o]," = ").concat(n," / ").concat(t),i=o===r.length-1?"int ".concat(e[o+1]," = ").concat(n," - ").concat(e[o]," * ").concat(t):"index -= ".concat(e[o]," * ").concat(t);return"".concat(a,"; ").concat(i,";")})).join("")}function s2(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=nT(t);return r.map(((t,o)=>{const a="int ".concat(e[o]," = ").concat(n," / outShapeStrides[").concat(o,"]"),i=o===r.length-1?"int ".concat(e[o+1]," = ").concat(n," - ").concat(e[o]," * outShapeStrides[").concat(o,"]"):"index -= ".concat(e[o]," * outShapeStrides[").concat(o,"]");return"".concat(a,"; ").concat(i,";")})).join("")}function c2(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=function(e,t){const n=e.length,r=e.map((e=>"".concat(t,"[").concat(e,"]"))),o=new Array(n-1);o[n-2]=r[n-1];for(let a=n-3;a>=0;--a)o[a]="(".concat(o[a+1]," * ").concat(r[a+1],")");return o}(e.map(((e,t)=>t)),t);return r.map(((t,o)=>{const a="int ".concat(e[o]," = ").concat(n," / ").concat(r[o]),i=o===r.length-1?"int ".concat(e[o+1]," = ").concat(n," - ").concat(e[o]," * ").concat(r[o]):"index -= ".concat(e[o]," * ").concat(r[o]);return"".concat(a,"; ").concat(i,";")})).join("")}function l2(e){const t=nT(e).map((e=>e.toString()));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}o2.registerFlag("HAS_WEBGL",(()=>o2.getNumber("WEBGL_VERSION")>0)),o2.registerFlag("WEBGL_VERSION",(()=>e2(2)?2:e2(1)?1:0)),o2.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),o2.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===o2.get("WEBGL_VERSION"))),o2.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),o2.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),o2.registerFlag("WEBGL_PACK",(()=>o2.getBool("HAS_WEBGL"))),o2.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_PACK_CLIP",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_PACK_REDUCE",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_LAZILY_UNPACK",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_CONV_IM2COL",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(()=>o2.getBool("WEBGL_PACK"))),o2.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(e){if(null==J1){const t=C1(e);J1=t.getParameter(t.MAX_TEXTURE_SIZE)}return J1}(o2.getNumber("WEBGL_VERSION")))),o2.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(e){if(null==$1){const t=C1(e);$1=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,$1)}(o2.getNumber("WEBGL_VERSION")))),o2.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const e=o2.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t;const n=C1(e);return t=Z1(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Z1(n,"EXT_disjoint_timer_query")?1:0,t}(e)})),o2.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>o2.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!HD())),o2.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(e){if(0===e)return!1;const t=C1(e);if(1===e){if(!Z1(t,"OES_texture_float"))return!1}else if(!Z1(t,"EXT_color_buffer_float"))return!1;return n2(t)}(o2.getNumber("WEBGL_VERSION")))),o2.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!o2.getBool("WEBGL_FORCE_F16_TEXTURES")&&o2.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),o2.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>t2(o2.getNumber("WEBGL_VERSION")))),o2.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(e=o2.getNumber("WEBGL_VERSION"))&&null!=C1(e).fenceSync;var e})),o2.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>o2.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),o2.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(e=>{if("number"!==typeof e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),o2.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>HD()?1:-1),(e=>{if("number"!==typeof e)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))})),o2.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),o2.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),o2.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),o2.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),o2.registerFlag("WEBGL_EXP_CONV",(()=>!1)),o2.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>o2.getBool("IS_TEST"))),o2.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),o2.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),o2.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),o2.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));const u2="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:d2}=r;function h2(e,t,n){const r=[];if(e.forEach((e=>{const t=zE(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){const{uniformShape:t}=k2(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((e=>{r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))}));const o=r.join("\n"),a=e.map((e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,o="";o+=n?f2(e,r):p2(e,r);const a=e.shapeInfo.logicalShape,i=t.logicalShape;a.length<=i.length&&(o+=n?function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),o="get"+r+"AtOutCoords",a=e.shapeInfo.logicalShape.length,i=t.logicalShape.length,s=d2(e.shapeInfo.logicalShape,t.logicalShape),c=w2(i),l=i-a;let u;const d=["x","y","z","w","u","v"];u=0===a?"":i<2&&s.length>=1?"coords = 0;":s.map((e=>"coords.".concat(d[e+l]," = 0;"))).join("\n");let h="";h=i<2&&a>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>"coords.".concat(d[t+l]))).join(", ");let p="return outputValue;";const f=1===zE(e.shapeInfo.logicalShape),m=zE(t.logicalShape),g=1===m;if(1!==a||f||g){if(f&&!g)p=1===i?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){const e=a-2,t=a-1;s.indexOf(e)>-1&&s.indexOf(t)>-1?p="return vec4(outputValue.x);":s.indexOf(e)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(t)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(o,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(u,"\n      vec4 outputValue = get").concat(r,"(").concat(h,");\n      ").concat(p,"\n    }\n  ")}(e,t):function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),o="get"+r+"AtOutCoords",a=t.texShape,i=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,c=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===c&&null==e.shapeInfo.flatOffset&&BE(i,a))return"\n      float ".concat(o,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const l=w2(c),u=d2(e.shapeInfo.logicalShape,t.logicalShape),d=c-s;let h;const p=["x","y","z","w","u","v"];h=0===s?"":c<2&&u.length>=1?"coords = 0;":u.map((e=>"coords.".concat(p[e+d]," = 0;"))).join("\n");let f="";f=c<2&&s>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>"coords.".concat(p[t+d]))).join(", ");return"\n    float ".concat(o,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(h,"\n      return get").concat(r,"(").concat(f,");\n    }\n  ")}(e,t));return o}(e,t,n.packedInputs,n.enableShapeUniforms))).join("\n"),i=t.texShape,s=a2(),c=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(s);let l,u,d=function(e){const t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(m2,"\n    ").concat(g2,"\n    ").concat(v2,"\n  ");return t}(s);t.isPacked?(l=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(BE(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");const o=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(o,");\n      int c = imod(index, ").concat(o,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],o=Math.ceil(e[2]/2),a=o*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(o,");\n      int c = imod(index, ").concat(o,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],o=Math.ceil(e[e.length-1]/2),a=o*Math.ceil(e[e.length-2]/2);let i=a,s="",c="b, r, c";for(let l=2;l<e.length-1;l++)i*=e[e.length-l-1],s="\n      int b".concat(l," = index / ").concat(i,";\n      index -= b").concat(l," * ").concat(i,";\n    ")+s,c="b".concat(l,", ")+c;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(o,");\n      int c = imod(index, ").concat(o,") * 2;\n\n      return ivec").concat(e.length,"(").concat(c,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,i,n.enableShapeUniforms),u=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(s)):(l=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(BE(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){const t=s2(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(t,"\n    return ivec3(r, c, d);\n  }\n")}const r=i2(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){const t=s2(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(t,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const r=i2(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){const n=i2(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){const n=i2(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,i,n.enableShapeUniforms),u=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(s)),n.packedInputs&&(d+=y2);return[d,c,u,o,l,a,n.userCode].join("\n")}function p2(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");const[o,a]=e.shapeInfo.texShape;if(1===o&&1===a)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const i=b2(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(i,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const[s,c]=e.shapeInfo.texShape;return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(c,", ").concat(i,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(x2(e),"\n      }\n    ");const o=e.shapeInfo.texShape,a=o[0],i=o[1];if(1===i&&1===a)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const s=b2(n);if(1===i)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===a)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(t)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(i,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape;if(null!=a&&BE(n,a)){if(t)return"\n      float ".concat(o,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const e=a[0],n=a[1];return"\n    float ".concat(o,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(e,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}const{newShape:i,keptDims:s}=qE(n),c=i;if(c.length<n.length){const n=S2(e,c),r=["row","col"];return"\n      ".concat(p2(n,t),"\n      float ").concat(o,"(int row, int col) {\n        return ").concat(o,"(").concat(I2(r,s),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(o,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(x2(e),"\n      }\n    ");const l=a[0],u=a[1],d=b2(r);if(1===u)return t?"\n      float ".concat(o,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(o,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(l,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===l)return t?"\n      float ".concat(o,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(o,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(t)return"\n      float ".concat(o,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(d,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(o,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(l,", ").concat(u,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[1]*n[2],i=n[2],{newShape:s,keptDims:c}=qE(n),l=s;if(l.length<n.length){const n=S2(e,l),r=["row","col","depth"];return"\n        ".concat(p2(n,t),"\n        float ").concat(o,"(int row, int col, int depth) {\n          return ").concat(o,"(").concat(I2(r,c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(o,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(a,", ").concat(i,", 1)));\n        ").concat(x2(e),"\n      }\n    ");const u=e.shapeInfo.texShape,d=u[0],h=u[1],p=e.shapeInfo.flatOffset;if(h===a&&null==p)return t?"\n      float ".concat(o,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(o,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(h,".0, ").concat(d,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(h===i&&null==p)return t?"\n      float ".concat(o,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(o,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(h,".0, ").concat(d,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");const f=b2(r);if(t)return"\n    float ".concat(o,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(o,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a," + col * ").concat(i," + depth + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(h,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[3],i=n[2]*a,s=n[1]*i,{newShape:c,keptDims:l}=qE(n);if(c.length<n.length){const n=S2(e,c),r=["row","col","depth","depth2"];return"\n      ".concat(p2(n,t),"\n      float ").concat(o,"(int row, int col, int depth, int depth2) {\n        return ").concat(o,"(").concat(I2(r,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(o,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(i,", ").concat(a,", 1)));\n        ").concat(x2(e),"\n      }\n    ");const u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1],f="int stride2 = ".concat(r,"Shape[3];"),m="int stride1 = ".concat(r,"Shape[2] * stride2;"),g="int stride0 = ".concat(r,"Shape[1] * stride1;");if(p===s&&null==u)return t?"\n      float ".concat(o,"(int row, int col, int depth, int depth2) {\n        ").concat(f,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(o,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(p===a&&null==u)return t?"\n      float ".concat(o,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(o,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const v=b2(r);if(t)return"\n    float ".concat(o,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(f,"\n      ").concat(m,"\n      ").concat(g,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(v,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(o,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(i," +\n          depth * ").concat(a," + depth2;\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index + ").concat(v,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[4],a=t[3]*o,i=t[2]*a,s=t[1]*i,{newShape:c,keptDims:l}=qE(t);if(c.length<t.length){const t=S2(e,c),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(p2(t),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(I2(n,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(i,", ").concat(a,", ").concat(o,")) +\n          depth3;\n        ").concat(x2(e),"\n      }\n    ");const u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1];if(p===s&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(i,", ").concat(a,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===o&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const f=b2(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(i," + depth * ").concat(a," +\n          depth2 * ").concat(o," + depth3 + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:o,keptDims:a}=qE(t);if(o.length<t.length){const t=S2(e,o),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(p2(t),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(I2(n,a),");\n      }\n    ")}const i=t[5],s=t[4]*i,c=t[3]*s,l=t[2]*c,u=t[1]*l;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(l,", ").concat(c,", ").concat(s,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(i,", 1)));\n        ").concat(x2(e),"\n      }\n    ");const d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1];if(f===u&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(l,", ").concat(c,", ").concat(s,", ").concat(i,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===i&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const m=b2(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(l," + depth * ").concat(c," +\n          depth2 * ").concat(s," + depth3 * ").concat(i," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function f2(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=a2();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape,a=a2();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");const i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,i=a[0],s=a[1],c=a2();if(null!=a&&BE(n,a))return t?"\n      vec4 ".concat(o,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(c.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(o,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(i,".0);\n\n        return ").concat(c.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(o,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(c.texture2D,"(").concat(r,", uv);\n    }\n  ");const l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=Math.ceil(n[1]/2);return"\n    vec4 ".concat(o,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(l[0],", ").concat(l[1],", row, col);\n      return ").concat(c.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===n[0]){const r=[1,2],a=S2(e,n.slice(1)),i=["b","row","col"];return"\n        ".concat(f2(a,t),"\n        vec4 ").concat(o,"(int b, int row, int col) {\n          return ").concat(o,"(").concat(I2(i,r),");\n        }\n      ")}const s=a2();if(t)return"\n    vec4 ".concat(o,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");const c=i[0],l=i[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return"\n    vec4 ".concat(o,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(l,", ").concat(d,", ").concat(u,", b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=a2();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ");const a=e.shapeInfo.logicalShape,i=a.length,s=e.shapeInfo.texShape,c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=c[0],u=c[1],d=Math.ceil(a[i-1]/2);let h=d*Math.ceil(a[i-2]/2),p="int b, int row, int col",f="b * ".concat(h," + (row / 2) * ").concat(d," + (col / 2)");for(let m=2;m<i-1;m++)p="int b".concat(m,", ")+p,h*=a[i-m-1],f="b".concat(m," * ").concat(h," + ")+f;return"\n    vec4 ".concat(r,"(").concat(p,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(l,");\n      return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}const m2="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",g2="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",v2="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",y2="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function b2(e){return"offset".concat(e)}function x2(e){const t=e.name,n=zE(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function w2(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function k2(e,t,n){const{newShape:r,keptDims:o}=qE(t),a=t.length,i=e&&3===a&&1===t[0],s=i?t.slice(1):r,c=!e&&a>1&&!BE(t,n)&&r.length<a||i;return{useSqueezeShape:c,uniformShape:c?s:t,keptDims:o}}function S2(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function I2(e,t){return t.map((t=>e[t])).join(", ")}function C2(e,t,n,r){const o=n.map(((e,n)=>{const r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),a=o.map((e=>e.shapeInfo)),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=h2(o,i,t),c=function(e,t){const n=G1(e,(()=>e.createShader(e.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(O1(e,(()=>e.shaderSource(n,t))),O1(e,(()=>e.compileShader(n))),mT().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw L1(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,s),l=e.createProgram(c);return mT().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:c,source:s,webGLProgram:l,inShapeInfos:a,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(l),Object.assign({program:t,fragmentShader:c,source:s,webGLProgram:l,inShapeInfos:a,outShapeInfo:i},A2(e,t,l)))}function A2(e,t,n){const r=[],o=[];let a,i,s,c=null,l=null;l=e.getUniformLocation(n,"NAN",!1),1===mT().getNumber("WEBGL_VERSION")&&(c=e.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of t.variableNames){const o={name:d,uniform:e.getUniformLocation(n,d,u),offset:e.getUniformLocation(n,"offset".concat(d),u)};t.enableShapeUniforms&&(o.shape=e.getUniformLocation(n,"".concat(d,"Shape"),u),o.texShape=e.getUniformLocation(n,"".concat(d,"TexShape"),u)),r.push(o)}if(t.enableShapeUniforms&&(a=e.getUniformLocation(n,"outShape",u),s=e.getUniformLocation(n,"outShapeStrides",u),i=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(const d of t.customUniforms)o.push(e.getUniformLocation(n,d.name,u));return{variablesLocations:r,customUniformLocations:o,infLoc:c,nanLoc:l,outShapeLocation:a,outShapeStridesLocation:s,outTexShapeLocation:i}}function E2(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach(((e,n)=>{const r=e.logicalShape,o=t[n],a=o.shape;if(!BE(r,a))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(a," must match"));if(e.isUniform&&o.isUniform)return;const i=e.texShape,s=o.isUniform?null:o.texData.texShape;if(!BE(i,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(i," and ").concat(s," must match"))}))}function T2(e){return mT().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class N2{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=A1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=a2();this.outputShape=e,this.enableShapeUniforms=T2(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?s2(["r","c","d"],e):i2(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class R2{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=A1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=a2();this.outputShape=e,this.enableShapeUniforms=T2(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?s2(["r","c","d"],e):i2(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class _2{constructor(e){this.variableNames=["A"],this.outTexUsage=E1.DOWNLOAD;const t=a2();this.outputShape=e,this.userCode="\n      ".concat(u2,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}class D2{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=E1.DOWNLOAD;const t=a2();this.outputShape=e,this.userCode="\n      ".concat(u2,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}const O2={R:0,G:1,B:2,A:3};class F2{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=a2();this.outputShape=e,this.enableShapeUniforms=T2(this.outputShape.length);let o="result";t&&(o="floor(result * 255. + 0.5)");let a="";for(let i=0;i<n.length;i++){const e=n[i];a+="\n          if(offset == ".concat(i,") {\n            result = values[").concat(O2[e],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":l2(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(r.texture2D,"(A, uv);\n          ").concat(a,"\n        }\n        ").concat(r.output," = vec4(").concat(o,", 0., 0., 0.);\n      }\n    ")}}class M2{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=a2();this.outputShape=e,this.enableShapeUniforms=T2(this.outputShape.length);let r="",o="result";t&&(o="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let t=0;t<=1;t++){const o=2*a+t;r+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(t," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(t,";\n          if (localCoords[1] + ").concat(a," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(a,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(o,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(o,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(o,"] = values[2];\n            } else {\n              result[").concat(o,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":l2(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(r,"\n\n          ").concat(n.output," = ").concat(o,";\n        }\n    ")}}function P2(e){const t=a2();return function(e,t){const n=G1(e,(()=>e.createShader(e.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(O1(e,(()=>e.shaderSource(n,t))),O1(e,(()=>e.compileShader(n))),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function L2(e){return function(e,t){const n=G1(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return O1(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),O1(e,(()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function z2(e){return function(e,t){const n=G1(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return O1(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n))),O1(e,(()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Uint16Array([0,1,2,2,1,3]))}function B2(e,t,n,r,o,a){!function(e,t){const n=mT().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const n="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(e>n||t>n){const r="[".concat(e,"x").concat(t,"]"),o="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+o+".")}}(t,n);const i=function(e){return G1(e,(()=>e.createTexture()),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return O1(e,(()=>e.bindTexture(s,i))),O1(e,(()=>e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE))),O1(e,(()=>e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE))),O1(e,(()=>e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST))),O1(e,(()=>e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST))),1===mT().getNumber("WEBGL_VERSION")?O1(e,(()=>e.texImage2D(s,0,r,t,n,0,o,a,null))):O1(e,(()=>e.texStorage2D(s,1,r,t,n))),O1(e,(()=>e.bindTexture(e.TEXTURE_2D,null))),{texture:i,texShape:[n,t]}}function U2(e){return e.internalFormatFloat}function W2(e){return e.internalFormatHalfFloat}function j2(e){return e.downloadTextureFormat}function V2(e){return e.internalFormatPackedFloat}function G2(e){return e.internalFormatPackedHalfFloat}function H2(e,t,n,r,o,a,i,s){const c=e,l=new Float32Array(function(e,t){const[n,r]=_1(e,t);return n*r*4}(a,i));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}class q2{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=mT().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,function(e,t){S1[e]=t}(t,e)):this.gl=C1(t),e=this.gl,2===mT().getNumber("WEBGL_VERSION")){const t=e;this.createVertexArray=()=>O1(t,(()=>t.createVertexArray())),this.bindVertexArray=e=>O1(t,(()=>t.bindVertexArray(e))),this.deleteVertexArray=e=>O1(t,(()=>t.deleteVertexArray(e))),this.getVertexArray=()=>O1(t,(()=>t.getParameter(t.VERTEX_ARRAY_BINDING)))}else if(null!=e){const t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>O1(e,(()=>t.createVertexArrayOES())),this.bindVertexArray=n=>O1(e,(()=>t.bindVertexArrayOES(n))),this.deleteVertexArray=n=>O1(e,(()=>t.deleteVertexArrayOES(n))),this.getVertexArray=()=>O1(e,(()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===mT().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=M1(this.gl,e),Z1(this.gl,t))this.textureHalfFloatExtension=M1(this.gl,t);else if(mT().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Z1(this.gl,r))this.colorBufferHalfFloatExtension=M1(this.gl,r);else if(mT().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Z1(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Z1(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=L2(this.gl),this.indexBuffer=z2(this.gl),this.framebuffer=function(e){return G1(e,(()=>e.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=D1(this.gl,this.textureHalfFloatExtension)}get debug(){return mT().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;O1(e,(()=>e.finish())),O1(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),O1(e,(()=>e.deleteFramebuffer(this.framebuffer))),O1(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,null))),O1(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null))),O1(e,(()=>e.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[o,a]=N1(t,n);return B2(e,o,a,U2(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[o,a]=N1(t,n);return B2(e,o,a,W2(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[o,a]=N1(t,n);return B2(e,o,a,j2(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),function(e,t,n){O1(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),n.data instanceof Uint8Array?2===mT().getNumber("WEBGL_VERSION")?O1(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data))):O1(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data))):2===mT().getNumber("WEBGL_VERSION")?O1(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n))):O1(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n))),O1(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,o,a){let i,s,c;O1(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),o instanceof Uint8Array?(i=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,c=e.RGBA):(i=new Float32Array(n*r*4),s=e.FLOAT,c=a.internalFormatPackedFloat),i.set(o),2===mT().getNumber("WEBGL_VERSION")?O1(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,i))):O1(e,(()=>e.texImage2D(e.TEXTURE_2D,0,c,n,r,0,e.RGBA,s,i))),O1(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[o,a]=_1(t,n);return B2(e,o,a,G2(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[o,a]=_1(t,n);return B2(e,o,a,V2(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(j1(this.gl,this.framebuffer),this.outputTexture=null),O1(this.gl,(()=>this.gl.deleteTexture(e)))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n,r){const[o,a]=N1(t,n),i=new Uint8Array(t*n*4);return O1(e,(()=>e.readPixels(0,0,o,a,r.downloadTextureFormat,e.UNSIGNED_BYTE,i))),new Float32Array(i.buffer)}(this.gl,t,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(e,t,n,r,o,a){return H2(this.gl,e,0,0,0,o,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,n){const r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const r=function(e,t,n){const r=e.createBuffer();O1(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r)));const o=16*t*n;return O1(e,(()=>e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ))),O1(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0))),O1(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null))),r}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(mT().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,o=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const e=r.clientWaitSync(o,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=o}else mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n){const r=new Float32Array(t*n*4);return O1(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r))),r}(this.gl,t,n)))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=P2(t));const n=function(e){return G1(e,(()=>e.createProgram()),"Unable to create WebGLProgram.")}(t);O1(t,(()=>t.attachShader(n,this.vertexShader))),O1(t,(()=>t.attachShader(n,e))),function(e,t){if(O1(e,(()=>e.linkProgram(t))),!mT().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&z1(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;O1(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),function(e,t,n){O1(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),B1(e,t,"clipSpacePos",n,3,20,0)&&B1(e,t,"uv",n,2,20,12)}(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(O1(this.gl,(()=>this.gl.deleteProgram(e))),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&z1(this.gl,this.program),O1(this.gl,(()=>this.gl.useProgram(e)))}getUniformLocation(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return G1(e,(()=>e.getUniformLocation(t,n)),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),O1(this.gl,(()=>this.gl.getAttribLocation(e,t)))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),U1(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[r,o]=_1(t,n);this.setOutputMatrixTextureDriver(e,r,o)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&z1(this.gl,this.program),V1(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}O1(e,(()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),O1(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=M1(this.gl,2===mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await VE((()=>this.disposed||this.isQueryAvailable(e,mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(e,mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){const e=function(e){let t=0;for(;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in mT().platform&&(n=mT().platform.setTimeoutCustom.bind(mT().platform)),VE((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),W1(this.gl,e,this.framebuffer),this.debug&&V1(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(W1(this.gl,this.outputTexture,this.framebuffer),this.debug&&V1(this.gl)):j1(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const r=this.gl;W1(r,e,this.framebuffer),this.debug&&V1(r),this.outputTexture=e,O1(r,(()=>r.viewport(0,0,t,n))),O1(r,(()=>r.scissor(0,0,t,n)))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),O1(this.gl,(()=>this.gl.scissor(e,t,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{mx:K2,XI:X2,Nk:Y2,f6:Q2,ct:J2,YG:$2,hH:Z2,z3:e3,sG:t3,uM:n3,vS:r3,qB:o3,GG:a3,rq:i3,lg:s3,WR:c3,cu:l3,GE:u3,px:d3,jC:h3,He:p3,hE:f3,BF:m3,Dk:g3,cl:v3,_B:y3,ub:b3,_f:x3,Ku:w3,qy:k3,Zy:S3,bu:I3,zv:C3,dH:A3,HS:E3,yH:T3,l3:N3,z9:R3,x6:_3,_m:D3,eW:O3,GK:F3,SP:M3,yr:P3,dl:L3,Dw:z3,xT:B3,_X:U3,wz:W3}=o;function j3(e,t){return["x","y","z","w","u","v"].slice(0,t).map((t=>"".concat(e,".").concat(t)))}function V3(e,t){return 1===t?[e]:j3(e,t)}class G3{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=T2(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=V3("rc",this.rank),t=w2(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),o=this.getOutput(e);this.userCode="\n        void main() {\n          ".concat(t," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(r,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let o="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let t=2;t<this.rank;t++)o="".concat(e[e.length-1-t],",")+o;t.push(o)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}getOutput(e){const t=this.getSourceCoordsArr(e);if(1===this.rank){const e=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(e," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}class H3{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=T2(this.outputShape.length);let n="";for(let r=0;r<4;r++){let e="thisRC = rc;";r%2===1&&(e+="thisRC.z += 1;"),r>1&&(e+="thisRC.y += 1;"),n+="\n        ".concat(e,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){const n=t?c2(["r","c","d"],"inputShape"):i2(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":l2(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class q3{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const r=X3(t,n),o=Y3(e,r,n);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const a=K3(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const e=this.freeTextures[o].pop();return this.usedTextures[o].push(e),e}let i;return r===T1.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===T1.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===T1.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===T1.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===T1.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(i),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),i}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;const o=X3(n,r),a=Y3(t,o,r);a in this.freeTextures||(this.freeTextures[a]=[]);const i=K3(t,o,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=mT().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;const c=this.usedTextures[a],l=c&&c.indexOf(e);if(null==l||l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[l]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));const t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));for(const e in this.usedTextures)this.usedTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function K3(e,t,n,r,o){const a=function(e,t){switch(e){case T1.PACKED_2X2_FLOAT32:return V2(t);case T1.PACKED_2X2_FLOAT16:return G2(t);case T1.UNPACKED_FLOAT32:return U2(t);case T1.UNPACKED_FLOAT16:return W2(t);case T1.PACKED_4X1_UNSIGNED_BYTE:return j2(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);let i;if(o){const[t,n]=_1(e[0],e[1]);i=t*n}else{const[t,n]=N1(e[0],e[1]);i=t*n}const s=function(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,a);return i*s}function X3(e,t){if(e===E1.UPLOAD)return T1.PACKED_2X2_FLOAT32;if(e===E1.RENDER||null==e)return function(e){return mT().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?T1.PACKED_2X2_FLOAT32:T1.UNPACKED_FLOAT32:e?T1.PACKED_2X2_FLOAT16:T1.UNPACKED_FLOAT16}(t);if(e===E1.DOWNLOAD||e===E1.PIXELS)return T1.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function Y3(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}class Q3{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=T2(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const J3="if (isnan(x)) return x;",$3="return abs(x);";const Z3=J3+"\n  return (x < 0.0) ? 0.0 : x;\n",e4=J3+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",t4="return x;";class n4{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=T2(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class r4{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=T2(this.outputShape.length);const t=e.length,n=V3("rc",t),r=w2(t),o=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),a=n.slice(-2),i=t<=1?"rc":"vec2(".concat(a.join(","),")");this.userCode="\n      void main() {\n        ".concat(r," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(o,");\n\n        setOutput(getChannel(packedInput, ").concat(i,"));\n      }\n    ")}}const o4=EB,a4={};const i4=mT().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class s4 extends NE{nextDataId(){return s4.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!mT().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof q2)t=e;else{const n=C1(mT().getNumber("WEBGL_VERSION"),e);t=new q2(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=C1(mT().getNumber("WEBGL_VERSION"));t=new q2(e),this.binaryCache=((n=mT().getNumber("WEBGL_VERSION"))in a4||(a4[n]={}),a4[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new q3(this.gpgpu),this.numMBBeforeWarning=null==mT().global.screen?1024:mT().global.screen.height*mT().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new TE(this,aO())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,o,a){const i=this.makeTensorInfo(t,n),s=this.texData.get(i.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,o]},s.texShape=[r,o];const c=X1(t),l=new F2(c,!1,a),u=this.runWebGLProgram(l,[i],n,[[r,o]]);return u.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(i),u.dataId}write(e,t,n){if((mT().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||mT().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:E1.UPLOAD,refCount:1}),r}refCount(e){if(this.texData.has(e)){return this.texData.get(e).refCount}return 0}incRef(e){this.texData.get(e).refCount++}decRef(e){if(this.texData.has(e)){this.texData.get(e).refCount--}}move(e,t,n,r,o){if(mT().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:E1.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:o,slice:a,shape:i,isPacked:s}=t;if(null!=a){let t;t=s?new n4(i,t4):new Q3(i,t4);const n=this.runWebGLProgram(t,[{dataId:e,shape:i,dtype:r}],r),o=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),o}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;const c=null!=this.activeTimers;let l,u;if(c&&(l=oD()),"complex64"===r){u=Hz(this.readSync(o.real.dataId),this.readSync(o.imag.dataId))}else u=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=oD()-l),this.convertAndCacheOnCPU(e,u)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise((e=>t.push(e)))}const t=this.texData.get(e),{values:n,shape:r,slice:o,dtype:a,complexTensorInfos:i,isPacked:s}=t;if(null!=o){let t;t=s?new n4(r,t4):new Q3(r,t4);const n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:a}],a),o=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),o}if(null!=n)return this.convertAndCacheOnCPU(e);if(mT().getBool("DEBUG")&&!mT().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===mT().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c,l,u=null;if("complex64"!==a&&mT().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const t=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(t.texture.texture,...R1(r))}if(this.pendingRead.set(e,[]),"complex64"!==a&&await this.gpgpu.createAndWaitForFence(),"complex64"===a){const e=await Promise.all([this.read(i.real.dataId),this.read(i.imag.dataId)]);l=Hz(e[0],e[1])}else if(null==u)l=this.getValuesFromTexture(e);else{const e=zE(r);l=this.gpgpu.downloadFloat32MatrixFromBuffer(u,e)}if(null!=c&&this.disposeIntermediateTensorInfo(c),null!=u){const e=this.gpgpu.gl;O1(e,(()=>e.deleteBuffer(u)))}const d=this.convertAndCacheOnCPU(e,l),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach((e=>e(d))),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&aO().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(e),{values:r,shape:o,slice:a,dtype:i,isPacked:s,texture:c}=n;if("complex64"===i)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=a){let n;n=s?new n4(o,t4):new Q3(o,t4);const r=this.runWebGLProgram(n,[{dataId:e,shape:o,dtype:i}],i),a=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),a}if(null==c)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const l=this.decode(e,t.customTexShape),u=aO().makeTensorFromTensorInfo(l),d=this.texData.get(l.dataId);return Object.assign({tensorRef:u},d.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>iD(e)));return JO(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return JO(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const n=e[t];if(!F1(n)){if(mT().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:r}=this.texData.get(e),o=zE(t);if(mT().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(e),r=this.texData.get(n.dataId),a=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...R1(t)).subarray(0,o);return this.disposeIntermediateTensorInfo(n),a}const a=mT().getBool("WEBGL_PACK")&&!0===r,i=a?X1(t):t,s=a?new D2(i):new _2(i),c=this.runWebGLProgram(s,[{shape:i,dtype:n,dataId:e}],"float32"),l=this.texData.get(c.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture.texture,l.texShape[0],l.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(c),u}timerAvailable(){return mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();const o=cD(this.activeTimers.map((e=>e.query))).filter((e=>null!=e)),a=cD(this.activeTimers.map((e=>e.name))).filter((e=>null!=e));this.activeTimers=t,r&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(o);i.kernelMs=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}(e),i.getExtraProfileInfo=()=>e.map(((e,t)=>({name:a[t],ms:e}))).map((e=>"".concat(e.name,": ").concat(e.ms))).join(", ")}else i.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,i})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:oD(),endMs:null}}endTimer(e){return mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=oD(),e)}async getQueryTime(e){if(mT().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:r,usage:o,isPacked:a,slice:i}=this.texData.get(e),s=i&&i.origDataId||e,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,o,a)));const l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i4;return mT().getBool("WEBGL_CPU_FORWARD")&&e.every((e=>null==this.texData.get(e.dataId).texture&&zE(e.shape)<t))}getGPGPUContext(){return this.gpgpu}where(e){__("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return o4(e.shape,t)}packedUnaryOp(e,t,n){const r=new n4(e.shape,t),o=this.compileAndRun(r,[e],n);return aO().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=A3(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(mT().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,$3,e.dtype);const t=new Q3(e.shape,$3),n=this.compileAndRun(t,[e]);return aO().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&JE(n[0])){const o=n.map((e=>aD(e)));r=this.write(o,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return aO().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new r4(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new G3(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[q1(e.shape),...K1(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},o=[q1(t),...K1(t)],a=new H3(o,n),i=[n],s=this.runWebGLProgram(a,[r],e.dtype,i,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:r,shape:o,dtype:a}=n;if(null!=t){ME(zE(o)<=t[0]*t[1]*4,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}const i=X1(o);let s;s=r?new R2(i):new N2(i);const c=[null!=t?t:R1(i)];return{dtype:a,shape:o,dataId:this.runWebGLProgram(s,[{shape:i,dtype:a,dataId:e}],a,c,!0,t).dataId}}runWebGLProgram(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0;const i=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(i.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===A1.DENSE){const t=null!=a?a:R1(e.outputShape);s.texShape=t.map((e=>2*e))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===zE(i.shape))return s.values=KE(i.dtype,0),i;const c=[],l=t.map((t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&zE(t.shape)<=mT().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),c.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!Q1(n.shape,t.shape)){const e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),c.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(i.dataId);const u={shape:i.shape,texData:s,isUniform:!1},d=function(e,t,n){let r="";t.concat(n).forEach((t=>{const o=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const a=t.texData.texShape,{useSqueezeShape:i,uniformShape:s,keptDims:c}=k2(e.packedInputs,t.shape,a);let l="",u="",d="";if(1===s.length&&e.packedInputs){const e=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];l="".concat(e[0]>1,"_").concat(e[1]>1)}else if(2!==s.length||e.packedInputs){if(s.length>2&&!e.packedInputs){const e=nT(s);d="".concat(e[0]===a[1],"_").concat(e[e.length-1]===a[1])}}else u="".concat(s[0]>1,"_").concat(s[1]>1);const h=t.shape.length,p=2===s.length&&BE(t.shape,a),f=1===zE(t.shape),m=SF(t.shape,n.shape),g=!e.packedInputs&&h===n.shape.length&&BE(a,n.texData.texShape),v=e.packedInputs||s.length>2?"":"".concat(a[0]>1,"_").concat(a[1]>1);r+="".concat(h,"_").concat(g,"_").concat(i?c:"","_").concat(s.length,"_").concat(f,"_").concat(m,"_").concat(p,"_").concat(l,"_").concat(u,"_").concat(d,"_").concat(v,"_").concat(o)}else{const e=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(e,"_").concat(o)}}));const o=e.userCode;let a=e.constructor.name;return a+="_"+r+"_"+o+"".concat(mT().getNumber("WEBGL_VERSION")),a}(e,l,u),h=this.getAndSaveBinary(d,(()=>C2(this.gpgpu,e,l,u))),p=null!=this.activeTimers;let f;p&&(f=this.startTimer()),mT().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,o){t.program.enableShapeUniforms||(E2(t.inShapeInfos,n),E2([t.outShapeInfo],[r]));const a=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(a.texture,i[0],i[1]):e.setOutputMatrixTexture(a.texture,i[0],i[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===mT().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let c=0;c<n.length;++c){const r=n[c],{uniform:o,offset:a,shape:i,texShape:s}=t.variablesLocations[c];if(i){const{uniformShape:n}=k2(t.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(i,new Int32Array(n));break;case 2:e.gl.uniform2iv(i,new Int32Array(n));break;case 3:e.gl.uniform3iv(i,new Int32Array(n));break;case 4:e.gl.uniform4iv(i,new Int32Array(n))}}if(s&&e.gl.uniform2i(s,r.texData.texShape[0],r.texData.texShape[1]),null!=o)if(r.isUniform)if(zE(r.shape)<2)e.gl.uniform1f(o,r.uniformValues[0]);else{let t=r.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(o,t)}else null!=r.texData.slice&&null!=a&&e.gl.uniform1i(a,r.texData.slice.flatOffset),e.setInputMatrixTexture(r.texData.texture.texture,o,c)}const s=t.outShapeLocation;if(s)switch(r.shape.length){case 1:e.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(s,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const n=nT(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&o)for(let c=0;c<t.program.customUniforms.length;++c){const n=t.program.customUniforms[c],r=t.customUniformLocations[c],a=o[c];if("float"===n.type)e.gl.uniform1fv(r,a);else if("vec2"===n.type)e.gl.uniform2fv(r,a);else if("vec3"===n.type)e.gl.uniform3fv(r,a);else if("vec4"===n.type)e.gl.uniform4fv(r,a);else if("int"===n.type)e.gl.uniform1iv(r,a);else if("ivec2"===n.type)e.gl.uniform2iv(r,a);else if("ivec3"===n.type)e.gl.uniform3iv(r,a);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(r,a)}}e.executeProgram()}(this.gpgpu,h,l,u,r),c.forEach((e=>this.disposeIntermediateTensorInfo(e))),p&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));const m=mT().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const e=oD();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!mT().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===o){const e=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),e}return i}compileAndRun(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;return this.runWebGLProgram(e,t,n,r,o)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!mT().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach((e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=sO((()=>{if(!mT().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=mT().getBool("DEBUG");mT().set("DEBUG",!1);const t=this.abs(lF(1e-8)).dataSync()[0];if(mT().set("DEBUG",e),t>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:r,values:o,texture:a,usage:i,isPacked:s}=t;if(null!=a)return;const c=null!=this.activeTimers;let l;c&&(l=oD());let u=t.texShape;if(null==u&&(u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=mT().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=mT().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&mT().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map(((t,n)=>n>=e.length-2?OE(e[n]):e[n]))).length&&(e=[2,e[0]])),2!==e.length){const t=qE(e);e=t.newShape}let o=zE(e),a=null;e.length<=1&&o<=n?a=[1,o]:2===e.length&&e[0]<=n&&e[1]<=n?a=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?a=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?a=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?a=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(a=[e[0],e[1]*e[2]*e[3]]);const i=null!=a&&Math.max(...a)>r&&Math.min(...a)<=(t?2:1)&&Math.min(...a)>0;if(null==a||i)if(t){const t=q1(e);let n=2,r=2;e.length&&([n,r]=K1(e)),o=t*(n/2)*(r/2),a=WE(o).map((e=>2*e))}else a=WE(o);return a}(n,s),t.texShape=u),null!=o){const e=X1(n);let a,i=u[1],d=u[0];const h=o instanceof Uint8Array||o instanceof Uint8ClampedArray;!s&&h||([i,d]=_1(u[0],u[1])),a=s?new M2(e,h):new F2(e,h);const p=h?[d,i]:u,f=this.makeTensorInfo(p,r),m=this.texData.get(f.dataId);m.usage=h?E1.PIXELS:E1.UPLOAD,m.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),i,d,o);const g=[[d,i]],v=!0,y=this.runWebGLProgram(a,[f],r,g,v),b=this.texData.get(y.dataId);t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,mT().get("ENGINE_COMPILE_ONLY")?this.disposeData(y.dataId):(t.texture=b.texture,t.values=null,this.texData.delete(y.dataId)),this.disposeIntermediateTensorInfo(f),c&&(this.uploadWaitMs+=oD()-l)}else{const e=this.acquireTexture(u,i,r,s);t.texture=e}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:r}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(e," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*QE(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise((e=>{try{this.checkCompletion_(t),e(!0)}catch(n){throw n}}));e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await vz(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw L1(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:o,outShapeLocation:a,outShapeStridesLocation:i,outTexShapeLocation:s}=A2(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=o,e.outShapeLocation=a,e.outShapeStridesLocation=i,e.outTexShapeLocation=s}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:r,height:o,width:a,channels:i}=e,s=aO().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=s.writeTexture(r,t,n,o,a,i);return aO().makeTensorFromDataId(c,t,n,s)}}s4.nextDataId=0;qD()&&uO("webgl",(()=>new s4),2);const c4="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class l4{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=CF(t,n),this.enableShapeUniforms=T2(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const u4="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class d4{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=CF(t,n);const o=this.outputShape.length;this.enableShapeUniforms=T2(o);let a="";if(r)if(0===o||1===zE(this.outputShape))a="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const e=w2(o);if(a="\n          ".concat(e," coords = getOutputCoords();\n        "),1===o)this.enableShapeUniforms?a+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":a+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const e=V3("coords",o);this.enableShapeUniforms?a+="\n            bool nextRowOutOfBounds =\n              (".concat(e[o-2]," + 1) >= outShape[").concat(o," - 2];\n            bool nextColOutOfBounds =\n              (").concat(e[o-1]," + 1) >= outShape[").concat(o," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):a+="\n            bool nextRowOutOfBounds =\n              (".concat(e[o-2]," + 1) >= ").concat(this.outputShape[o-2],";\n            bool nextColOutOfBounds =\n              (").concat(e[o-1]," + 1) >= ").concat(this.outputShape[o-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(a,"\n\n        setOutput(result);\n      }\n    ")}}function h4(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const p4={kernelName:MN,backendName:"webgl",kernelFunc:h4};function f4(e){const{inputs:t,backend:n}=e,{real:r,imag:o}=t,a=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(a.dataId),s=h4({inputs:{x:r},backend:n}),c=h4({inputs:{x:o},backend:n});return i.complexTensorInfos={real:s,imag:c},a}const m4={kernelName:qT,backendName:"webgl",kernelFunc:f4},g4="return (a < 0.) ? b * a : a;",v4="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const y4={kernelName:WN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{alpha:a}=r,i=n.makeTensorInfo([],"float32",nD(a,"float32")),s=mT().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new d4(v4,o.shape,i.shape):new l4(g4,o.shape,i.shape),c=n.runWebGLProgram(s,[o,i],"float32");return n.disposeIntermediateTensorInfo(i),c}},b4="return (a < 0.) ? b * a : a;",x4="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const w4={kernelName:kR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r,alpha:o}=t,a=mT().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new d4(x4,r.shape,o.shape):new l4(b4,r.shape,o.shape);return n.runWebGLProgram(a,[r,o],"float32")}},k4="if (isnan(x)) return x;";function S4(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:r,dtype:o}=e;return e=>{let{inputs:a,backend:i}=e;const{x:s}=a,c=i,l=o||s.dtype;if(c.shouldExecuteOnCPU([s])&&null!=r){const e=c.texData.get(s.dataId),t=r(e.values,l);return c.makeTensorInfo(s.shape,l,t)}let u;return u=mT().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new n4(s.shape,n):new Q3(s.shape,t),c.runWebGLProgram(u,[s],l)}}function I4(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:r=!1,supportsComplex:o=!1,cpuKernelImpl:a,dtype:i}=e;return e=>{let{inputs:s,backend:c}=e;const{a:l,b:u}=s,d=c;if(o&&"complex64"===l.dtype){const e=d.texData.get(l.dataId),n=d.texData.get(u.dataId),[r,o]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((e=>{const[n,r]=e,o={dataId:n.dataId,dtype:n.dtype,shape:l.shape},a={dataId:r.dataId,dtype:r.dtype,shape:u.shape},i=new l4(t,l.shape,u.shape);return d.runWebGLProgram(i,[o,a],RD(n.dtype,r.dtype))})),a=f4({inputs:{real:r,imag:o},backend:d});return d.disposeIntermediateTensorInfo(r),d.disposeIntermediateTensorInfo(o),a}const h=i||RD(l.dtype,u.dtype);if(("string"===l.dtype||"string"===u.dtype||d.shouldExecuteOnCPU([l,u]))&&null!=a){const e=d.texData.get(l.dataId).values,t=d.texData.get(u.dataId).values,n="string"===l.dtype?CB(e):e,r="string"===l.dtype?CB(t):t,[o,i]=a(l.shape,u.shape,n,r,h),s=d.makeTensorInfo(i,h);return d.texData.get(s.dataId).values=o,s}let p;return p=mT().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new d4(n,l.shape,u.shape,r):new l4(t,l.shape,u.shape),d.runWebGLProgram(p,[l,u],h)}}function C4(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":Z3;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":e4;if("prelu"===e)return t?x4:b4;if("leakyrelu"===e)return t?v4:g4;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}class A4{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=T2(this.outputShape.length);const l=r?e[1]:e[2],u=Math.ceil(l/2),d=r?"i * 2, rc.y":"rc.y, i * 2",h=o?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";i&&(m=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(i,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(i,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(i,"\n        }"),g="result = activation(result);");const v=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let y="rc.x",b="rc.x";e[0]<t[0]?y="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(b="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(y,";\n        int batchB = ").concat(b,";\n        for (int i = 0; i < ").concat(u,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(f[0],");\n          result += (").concat(p[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(v,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}}const E4="return areal * breal - aimag * bimag;",T4="return areal * bimag + aimag * breal;";class N4{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=CF(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const R4="return a * b;";function _4(e){const{inputs:t,backend:n}=e,{a:r,b:o}=t,a=RD(r.dtype,o.dtype);if("complex64"===r.dtype){const e=n.texData.get(r.dataId),t=n.texData.get(o.dataId),a=new N4(E4,r.shape,o.shape),i=new N4(T4,r.shape,o.shape),s=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:o.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:o.shape}],c=n.runWebGLProgram(a,s,"float32"),l=n.runWebGLProgram(i,s,"float32"),u=f4({inputs:{real:c,imag:l},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),u}if(n.shouldExecuteOnCPU([r,o])){const e=n.texData.get(r.dataId),t=n.texData.get(o.dataId),[i,s]=m3(r.shape,o.shape,e.values,t.values,a),c=n.makeTensorInfo(s,a);return n.texData.get(c.dataId).values=i,c}let i;return i=mT().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new d4(R4,r.shape,o.shape):new l4(R4,r.shape,o.shape),n.runWebGLProgram(i,[r,o],a)}const D4={kernelName:dR,backendName:"webgl",kernelFunc:_4};function O4(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{shape:a}=r,i=n,s=zE(o.shape),c=GE(a,s),l=zE(c);ME(s===l,(()=>"The new shape (".concat(c,") has ").concat(l," elements and the old ")+"shape (".concat(o.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."));const u=i.texData.get(o.dataId);return!u.isPacked||Q1(o.shape,c)||null!==u.texture&&Q1(u.shape,c)?(i.incRef(o.dataId),{dataId:o.dataId,shape:c,dtype:o.dtype}):function(e,t,n){const r=[q1(e.shape),...K1(e.shape)],o={dtype:e.dtype,shape:r,dataId:e.dataId},a=[q1(t),...K1(t)],i=new H3(a,r),s=[r],c=n.runWebGLProgram(i,[o],e.dtype,s,!0);return{dataId:c.dataId,shape:t,dtype:c.dtype}}(o,c,i)}const F4={kernelName:_R,backendName:"webgl",kernelFunc:O4};class M4{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:o,outSize:a}=e;this.outputShape=[r,a];const i=4*Math.floor(n/4),s=n%4;let c="sumValue += dot(values, ones);";if(null!=t){const e=1/t;c="sumValue += dot(values * ".concat(UE(e)?e.toPrecision(2):e,", ones);")}let l="";o%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(i,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(i,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class P4{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:o,outSize:a}=e;this.outputShape=[r,a];let i="0.0",s="";"prod"===t?i="1.0":"min"===t?(i="1.0 / 1e-20",s="min"):"max"===t&&(i="-1.0 / 1e-20",s="max");let c="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?c="sumValue":"prod"===t?c="prodValue":"all"===t?c="allValue":"any"===t&&(c="anyValue");const l=4*Math.floor(n/4),u=n%4;let d="\n      if (".concat("sum"===t,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===t,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===t," || ").concat("max"===t,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),h="vec4";"all"===t?(i="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(i="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");let p="";o%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(i,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(i,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===u,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===u,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===u,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}}function L4(e,t,n,r){const o=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const n=t.length?t[t.length-1].outSize:e[1],r=Az(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape);let a=e;for(let i=0;i<o.length;i++){const{inSize:s,windowSize:c,outSize:l}=o[i];let u,d;u="mean"===n?0===i?new M4({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l},s):new M4({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l}):new P4({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l},n),d=a,a=r.runWebGLProgram(u,[a],t),d.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(d)}return a}class z4{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];this.outputShape=n,this.rank=n.length;const r=w2(this.rank),o=function(e){const t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let o=0;o<e.length;o++)r[e[o]]=n[o];return r.join()}(t);this.userCode="\n    void main() {\n      ".concat(r," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}}class B4{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let l=0;l<n.length;l++)n[l]=e[t[l]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const r=w2(this.rank),o=j3("rc",this.rank),a=new Array(this.rank);for(let l=0;l<t.length;l++)a[t[l]]=o[l];const i="vec2(".concat(a.slice(-2).join(),")"),s="++".concat(o[this.rank-1]," < ").concat(n[this.rank-1]),c="getChannel(getA(".concat(a.join(),"), ").concat(i,")");this.userCode="\n    void main() {\n      ".concat(r," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(c,";\n      if(").concat(s,") {\n        result[1] = ").concat(c,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(c,";\n        if(").concat(s,") {\n          result[3] = ").concat(c,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function U4(e,t,n){const r=mT().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new B4(e.shape,t):new z4(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function W4(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r;return function(e,t,n,r){const o=t,a=e.shape.length,i=HE(o,e.shape);let s=i;const c=vP(s,a),l=null!=c;let u=e;l&&(u=U4(e,c,r),s=bP(s.length,a)),gP("sum",s,a);const[d,h]=fP(u.shape,s);let p=d;n&&(p=mP(d,i));const f=zE(h),m=O4({inputs:{x:u},attrs:{shape:[zE(e.shape)/f,f]},backend:r}),g=L4(m,_D(e.dtype),"sum",r),v=O4({inputs:{x:g},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),l&&r.disposeIntermediateTensorInfo(u),v}(o,a,i,n)}const j4={kernelName:$R,backendName:"webgl",kernelFunc:W4};function V4(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{perm:a}=r,i=n,s=o.shape.length,c=new Array(s);for(let u=0;u<c.length;u++)c[u]=o.shape[a[u]];let l;if(i.shouldExecuteOnCPU([o])){const e=i.texData.get(o.dataId).values,t=U3(e,o.shape,o.dtype,a,c);l=i.makeTensorInfo(c,o.dtype);i.texData.get(l.dataId).values=t}else l=U4(o,a,i);return l}const G4={kernelName:x_,backendName:"webgl",kernelFunc:V4};function H4(e){let{a:t,b:n,transposeA:r,transposeB:o,backend:a,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:c=0,activation:l=null}=e;const u=t.shape.length,d=n.shape.length,h=r?t.shape[u-2]:t.shape[u-1],p=o?n.shape[d-1]:n.shape[d-2],f=r?t.shape[u-1]:t.shape[u-2],m=o?n.shape[d-2]:n.shape[d-1],g=t.shape.slice(0,-2),v=n.shape.slice(0,-2),y=zE(g),b=zE(v),x=CF(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,m]);ME(h===p,(()=>"Error in matMul: inner shapes (".concat(h,") and (")+"".concat(p,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(o," must match.")));const w=r?[y,h,f]:[y,f,h],k=o?[b,m,p]:[b,p,m],S=O4({inputs:{x:t},backend:a,attrs:{shape:w}}),I=O4({inputs:{x:n},backend:a,attrs:{shape:k}}),C=[S,I],A=Math.max(y,b),E=r?S.shape[1]:S.shape[2],T=null!=i,N=null!=s,R="leakyrelu"===l,_=null!=l?C4(l,!0):null;let D;if((1===f||1===m)&&E>1e3&&!1===(T||N||R||null!=_)){let e=S,t=I;r&&(e=V4({inputs:{x:S},backend:a,attrs:{perm:[0,2,1]}}),C.push(e)),o&&(t=V4({inputs:{x:I},backend:a,attrs:{perm:[0,2,1]}}),C.push(t));const n=1===m;let i=e;1!==m&&(i=O4({inputs:{x:e},backend:a,attrs:{shape:[A,E,1]}}),C.push(i));const s=1===m?2:1;let c=t;n&&(c=O4({inputs:{x:t},backend:a,attrs:{shape:[A,1,E]}}),C.push(c));const l=_4({inputs:{a:i,b:c},backend:a});D=W4({inputs:{x:l},backend:a,attrs:{axis:s,keepDims:!0}}),C.push(l)}else{const e=RD(t.dtype,n.dtype),l=new A4(w,k,[A,f,m],r,o,T,_,N,R),u=[S,I];if(null!=i&&u.push(i),N&&u.push(s),R){const e=a.makeTensorInfo([],"float32",nD(c,"float32"));u.push(e),C.push(e)}D=a.runWebGLProgram(l,u,e)}const O=O4({inputs:{x:D},backend:a,attrs:{shape:x}});C.push(D);for(const F of C)a.disposeIntermediateTensorInfo(F);return O}const q4={kernelName:T_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:o,b:a,bias:i,preluActivationWeights:s}=t,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:d}=r;return H4({a:o,b:a,transposeA:c,transposeB:l,backend:n,bias:i,preluActivationWeights:s,leakyreluAlpha:d,activation:u})}},K4="return abs(x);";const X4={kernelName:xT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const e=n.texData.get(r.dataId),t=A3(e.values);return n.makeTensorInfo(r.shape,r.dtype,t)}let o;return o=mT().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new n4(r.shape,K4):new Q3(r.shape,K4),n.runWebGLProgram(o,[r],r.dtype)}},Y4=S4({opSnippet:J3+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),Q4={kernelName:wT,backendName:"webgl",kernelFunc:Y4},J4=S4({opSnippet:J3+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),$4={kernelName:kT,backendName:"webgl",kernelFunc:J4},Z4="return a + b;",e5=I4({opSnippet:Z4,packedOpSnippet:Z4,supportsComplex:!0,cpuKernelImpl:K2}),t5={kernelName:ST,backendName:"webgl",kernelFunc:e5};class n5{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(((e,t)=>"T".concat(t)));const n=[];this.variableNames.forEach((e=>{n.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));const r=this.variableNames.map((e=>"v".concat(e))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}class r5{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(((e,t)=>"T".concat(t)));const n=[];this.variableNames.forEach((e=>{n.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));const r=this.variableNames.map((e=>"v".concat(e))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}const o5={kernelName:IT,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,o=n;if(1===o.length)return h4({inputs:{x:o[0]},backend:r});if(o.length>mT().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(o.length/2),n=e({inputs:o.slice(0,t),backend:r}),a=e({inputs:o.slice(t),backend:r});return e({inputs:[n,a],backend:r})}const a=o.map((e=>e.dtype)).reduce(((e,t)=>RD(e,t))),i=o.map((e=>e.shape)),s=mT().getBool("WEBGL_PACK")?new r5(o[0].shape,i):new n5(o[0].shape,i);return r.runWebGLProgram(s,o,a)}};const a5={kernelName:CT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r,s=o.shape.length,c=HE(a,o.shape);let l=c;const u=vP(l,s);let d=o;null!=u&&(d=V4({inputs:{x:o},backend:n,attrs:{perm:u}}),l=bP(l.length,s)),gP("all",l,s);const[h,p]=fP(d.shape,l),f=O4({inputs:{x:d},backend:n,attrs:{shape:[-1,zE(p)]}}),m=L4(f,f.dtype,"all",n);let g;if(i){g=O4({inputs:{x:m},backend:n,attrs:{shape:mP(h,c)}})}else g=O4({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(d),g}};const i5={kernelName:AT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r,s=o.shape.length,c=HE(a,o.shape);let l=c;const u=vP(l,s);let d=o;null!=u&&(d=V4({inputs:{x:o},backend:n,attrs:{perm:u}}),l=bP(l.length,s)),gP("any",l,s);const[h,p]=fP(d.shape,l),f=O4({inputs:{x:d},backend:n,attrs:{shape:[-1,zE(p)]}}),m=L4(f,f.dtype,"any",n);let g;if(i){g=O4({inputs:{x:m},backend:n,attrs:{shape:mP(h,c)}})}else g=O4({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(d),g}};class s5{constructor(e,t,n){this.variableNames=["A"];const{windowSize:r,batchSize:o,outSize:a}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];const i="max"===t?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(i," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}class c5{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ME(e.length>2,(()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2.")));const o=e[e.length-1],a=Math.ceil(o/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");const i=this.outputShape,s=i.length,c=w2(s),l=V3("coords",s);let u,d;if(1===a){d=s+1;const e=w2(d);u="\n        ".concat(e," sourceLocR = ").concat(e,"(").concat(l.join(),", 0);\n        ++").concat(l[s-1],";\n        ").concat(e," sourceLocG = ").concat(e,"(").concat(l.join(),", 0);\n        ++").concat(l[s-2],";\n        ").concat(e," sourceLocA = ").concat(e,"(").concat(l.join(),", 0);\n        --").concat(l[s-1],";\n        ").concat(e," sourceLocB = ").concat(e,"(").concat(l.join(),", 0);\n        --").concat(l[s-2],";")}else d=s,u="\n        ".concat(c," sourceLocR = coords;\n        ++").concat(l[s-1],";\n        ").concat(c," sourceLocG = coords;\n        ++").concat(l[s-2],";\n        ").concat(c," sourceLocA = coords;\n        --").concat(l[s-1],";\n        ").concat(c," sourceLocB = coords;\n        --").concat(l[s-2],";");const h=["x","y","z","w","u","v"].slice(0,d),p="."+h[d-1],f=h.map((e=>"int "+e)),m=V3("sourceLocR",d-1).concat("inIdx.r"),g=V3("sourceLocG",d-1).concat("inIdx.g"),v=V3("sourceLocB",d-1).concat("inIdx.b"),y=V3("sourceLocA",d-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",x=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),")));"),w="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(v.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(y.join(),") : 0.)"),k=r?"":"\n      float getBestIndicesAChannel(".concat(f.join(),") {\n        return getChannel(getBestIndicesA(").concat(h.join(),"),\n                                          vec2(").concat(h.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(f.join(),") {\n        return getChannel(getA(").concat(h.join(),"),\n                               vec2(").concat(h.slice(-2).join(),"));\n      }\n      ").concat(k,"\n      void main() {\n        ").concat(c," coords = getOutputCoords();\n        bool hasNextCol = ").concat(l[s-1]," < ").concat(i[s-1]-1,";\n        bool hasNextRow = ").concat(l[s-2]," < ").concat(i[s-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(p,", sourceLocG").concat(p,",\n          sourceLocB").concat(p,", sourceLocA").concat(p,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat(x,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(b,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function l5(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=t.shape[0],a=t.shape[1];null!=r&&(o=r.shape[0],a=r.shape[1]);const i=Az(a),s={windowSize:i,inSize:a,batchSize:o,outSize:Math.ceil(a/i)},c=new s5(s,n,null==r),l=[t];null!=r&&l.push(r);const u=e.runWebGLProgram(c,l,"int32");if(1===u.shape[1])return u;const d=l5(e,t,n,u);return e.disposeIntermediateTensorInfo(u),d}function u5(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=null!=r?r.shape:t.shape,a=Az(o[o.length-1]),i=new c5(o,a,n,null==r),s=null==r?[t]:[t,r],c=e.runWebGLProgram(i,s,"int32");if(c.shape.length===t.shape.length){const r=u5(e,t,n,c);return e.disposeIntermediateTensorInfo(c),r}return c}function d5(e,t,n,r){const o=[n];if(gP("arg"+r.charAt(0).toUpperCase()+r.slice(1),o,t.shape.length),!mT().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const n=[],a=e.texData.get(t.dataId);let i=t;null!==a&&a.isPacked&&(i=e.unpackTensor(t),n.push(i));const[s,c]=fP(i.shape,o),l=zE(c),u=O4({inputs:{x:i},backend:e,attrs:{shape:[-1,l]}});n.push(u);const d=l5(e,u,r);n.push(d);const h=O4({inputs:{x:d},backend:e,attrs:{shape:s}});return n.forEach((t=>e.disposeIntermediateTensorInfo(t))),h}return u5(e,t,r)}const h5={kernelName:ET,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a}=r;let i=HE(a,o.shape);const s=vP(i,o.shape.length);let c=o;const l=[];null!=s&&(c=V4({inputs:{x:o},backend:n,attrs:{perm:s}}),l.push(c),i=bP(i.length,c.shape.length)),gP("argMax",[i[0]],c.shape.length);const u=d5(n,c,i[0],"max");return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),u}};const p5={kernelName:TT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a}=r;let i=HE(a,o.shape);const s=vP(i,o.shape.length);let c=o;const l=[];null!=s&&(c=V4({inputs:{x:o},backend:n,attrs:{perm:s}}),l.push(c),i=bP(i.length,c.shape.length)),gP("argMin",[i[0]],c.shape.length);const u=d5(n,c,i[0],"min");return l.forEach((e=>n.disposeIntermediateTensorInfo(e))),u}},f5=S4({opSnippet:J3+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),m5={kernelName:NT,backendName:"webgl",kernelFunc:f5},g5=S4({opSnippet:J3+"return log(x + sqrt(x * x + 1.0));"}),v5={kernelName:RT,backendName:"webgl",kernelFunc:g5},y5=S4({opSnippet:J3+"\n  return atan(x);\n"}),b5={kernelName:_T,backendName:"webgl",kernelFunc:y5},x5=I4({opSnippet:c4+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+u4+"\n  return result;\n"}),w5={kernelName:OT,backendName:"webgl",kernelFunc:x5},k5=S4({opSnippet:J3+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),S5={kernelName:DT,backendName:"webgl",kernelFunc:k5};class I5{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,i=e.strideHeight,s=e.strideWidth,c=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const f="avg"===t,m="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),g="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d");let v="0.0";if(f||(v="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(i,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(t," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?o?m:g:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let y="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / max(count, 1.0)");const b=4*Math.floor(a/4),x=a%4,w="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(y,");\n      }\n    ")}}class C5{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,i=e.strideDepth,s=e.strideHeight,c=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const y="avg"===t;let b="0.0";if(y||(b="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(i,", ").concat(s,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(v,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(t," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?o?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(p," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let x="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(x="avgValue / max(count, 1.0)");const w=4*Math.floor(a/4),k=a%4,S="\n      if (".concat(y,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(i,", ").concat(s,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(v,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(S,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(2===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(3===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(S,"\n            }\n          }\n        }\n        setOutput(").concat(x,");\n      }\n    ")}}const A5={kernelName:FT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t;r2(o,"avgPool");const{filterSize:a,strides:i,pad:s,dimRoundingMode:c}=r;ME(kM(i,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'")));const l=hM(o.shape,a,i,1,s,c);if(1===l.filterWidth&&1===l.filterHeight&&BE(l.inShape,l.outShape))return h4({inputs:{x:o},backend:n});const u=new I5(l,"avg",!1);return n.runWebGLProgram(u,[o],"float32")}};const E5={kernelName:PT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{filterSize:a,strides:i,pad:s,dimRoundingMode:c,dataFormat:l}=r,u=pM(o.shape,a,i,[1,1,1],s,c,l),d=new C5(u,"avg",!1);return n.runWebGLProgram(d,[o],"float32")}};class T5{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,a=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.top,u=c-1-e.padInfo.left,d=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(u,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(i,") {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class N5{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=u-1-e.padInfo.front,f=d-1-e.padInfo.top,m=h-1-e.padInfo.left,g=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(o,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const R5={kernelName:LT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,input:a}=t,i=a,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,d=pM(i.shape,s,c,[1,1,1],l,u),h=new N5(d);return n.runWebGLProgram(h,[o],i.dtype)}};const _5={kernelName:MT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,input:a}=t,i=a;r2([o,a],"avgPoolGrad");const{filterSize:s,strides:c,pad:l}=r,u=hM(i.shape,s,c,1,l),d=new T5(u);return n.runWebGLProgram(d,[o],i.dtype)}};const D5={kernelName:zT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:o,b:a}=t,{transposeA:i,transposeB:s}=r;return H4({a:o,b:a,transposeA:i,transposeB:s,backend:n})}};class O5{constructor(e,t,n,r,o,a){this.outputShape=[],this.variableNames=["x","mean","variance"],CF(e,t),CF(e,n);let i="0.0";null!=r&&(CF(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let s="1.0";null!=o&&(CF(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(i,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(a,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class F5{constructor(e,t,n,r,o,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],CF(e,t),CF(e,n);let i="vec4(0.0)";null!=r&&(CF(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let s="vec4(1.0)";null!=o&&(CF(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(i,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(a,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const M5={kernelName:RN,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:o,mean:a,variance:i,offset:s,scale:c}=t;ME(a.shape.length===i.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),ME(null==s||a.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),ME(null==c||a.shape.length===c.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:l}=r;null==l&&(l=.001);const u=[o,a,i];let d=null;null!=s&&(d=s.shape,u.push(s));let h=null;null!=c&&(h=c.shape,u.push(c));const p=mT().getBool("WEBGL_PACK_NORMALIZATION")?new F5(o.shape,a.shape,i.shape,d,h,l):new O5(o.shape,a.shape,i.shape,d,h,l);return n.runWebGLProgram(p,u,u[0].dtype)}};class P5{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=w2(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(e){if(1===e)return"sourceLoc";if(e<=6)return L5.slice(0,e).map((e=>"sourceLoc."+e)).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank);let r;const o=e.map(((e,t)=>"sourceLoc.".concat(L5[t]," = start[").concat(t,"] + coords.").concat(L5[t],";")));r="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const L5=["x","y","z","w","u","v"];class z5{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=w2(this.rank),n=V3("coords",this.rank),r=V3("sourceLoc",this.rank),o=1===this.rank?"sourceLoc":"vec2(".concat(r.slice(-2).join(),")"),a="getChannel(getSource(".concat(r.join(),"), ").concat(o,")"),i="\n      result.x = ".concat(a,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(r[this.rank-1],";\n        result.y = ").concat(a,";\n        --").concat(r[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(r[this.rank-2],";\n        result.z = ").concat(a,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(r[this.rank-1],";\n          result.w = ").concat(a,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map(((e,t)=>"start[".concat(t,"]"))).join(),");"):e.map(((e,t)=>"".concat(r[t]," = ").concat(n[t]," + start[").concat(t,"];"))).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(i,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}}function B5(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{begin:a,size:i}=r,[s,c]=aM(o,a,i);if(HF(o,s,c),0===zE(c))return n.makeTensorInfo(c,o.dtype,[]);if(n.shouldExecuteOnCPU([o])||"string"===o.dtype){const e=n.texData.get(o.dataId),t=E3(e.values,s,c,o.shape,o.dtype);return n.makeTensorInfo(c,o.dtype,t)}const{isPacked:l}=n.texData.get(o.dataId),u=rM(o.shape,s,c);if(l||!u){const e=mT().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new z5(c):new P5(c),t=[s];return n.runWebGLProgram(e,[o],o.dtype,t)}return n.uploadToGPU(o.dataId),function(e,t,n,r){const o=r.texData.get(e.dataId),a=r.makeTensorInfo(n,e.dtype),i=r.texData.get(a.dataId);Object.assign(i,o),i.refCount=1,i.shape=n,i.dtype=e.dtype;let s=oM(t,nT(e.shape));o.slice&&(s+=o.slice.flatOffset),i.slice={flatOffset:s,origDataId:o.slice&&o.slice.origDataId||e.dataId};const c=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,c+1),a}(o,s,c,n)}const U5={kernelName:HR,backendName:"webgl",kernelFunc:B5},W5={kernelName:BT,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{blockShape:a,crops:i}=r;ME(o.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const s=a.reduce(((e,t)=>e*t)),c=Tz(o.shape,a,s),l=Nz(c.length,a.length),u=Rz(o.shape,a,s),d=_z(i,a.length),h=Dz(u,i,a.length),p=[],f=O4({inputs:{x:o},backend:n,attrs:{shape:c}}),m=V4({inputs:{x:f},backend:n,attrs:{perm:l}}),g=O4({inputs:{x:m},backend:n,attrs:{shape:u}}),v=B5({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(g),p.forEach((e=>n.disposeIntermediateTensorInfo(e))),v}};const j5={kernelName:UT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,weights:a}=t,{size:i}=r,s=n.readSync(o.dataId),c=n.readSync(a.dataId),l=X2(s,c,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,l)}};const V5={kernelName:WT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{a:r,b:o}=t,a=mT().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=mT().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,o])||1===i){const e=n.texData.get(r.dataId).values,t=n.texData.get(o.dataId).values,[a,i]=Q2(r.shape,o.shape,e,t,r.dtype),s=n.makeTensorInfo(i,r.dtype);return n.texData.get(s.dataId).values=a,s}let s;return s=a?new d4("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,o.shape,!1):new l4("\n  return float(int(a.r) & int(b.r));\n",r.shape,o.shape),n.runWebGLProgram(s,[r,o],r.dtype)}};const G5={kernelName:jT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:o}=t,a=n.readSync(r.dataId),i=n.readSync(o.dataId),s=CF(Array.from(a),Array.from(i));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},H5=I4({opSnippet:"return float(a != b);",cpuKernelImpl:v3,dtype:"bool"}),q5={kernelName:pR,backendName:"webgl",kernelFunc:H5};function K5(e){const{inputs:t,backend:n}=e,{input:r}=t;return h4({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const X5={kernelName:TR,backendName:"webgl",kernelFunc:K5};const Y5={kernelName:VT,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r,attrs:o}=t,{x:a}=n,{dtype:i}=o;if("complex64"===i){if("complex64"===a.dtype)return h4({inputs:{x:a},backend:r});const t=DP(a.shape),n=e({inputs:{x:a},backend:r,attrs:{dtype:"float32"}}),o=f4({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),o}if("complex64"===a.dtype){const t=K5({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:i}});return r.disposeIntermediateTensorInfo(t),n}if(!YE(a.dtype,i)){const e=h4({inputs:{x:a},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:i}}if(r.shouldExecuteOnCPU([a])){const e=r.texData.get(a.dataId).values,[t,n,o]=J2(e,a.shape,a.dtype,i);return r.makeTensorInfo(t,n,o)}if("int32"===i)return function(e,t){const n=new Q3(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(a,r);if("bool"===i){const e=r.makeTensorInfo([],"bool",KE("bool",1)),t=H5({inputs:{a:a,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(i))}},Q5="return ceil(x);",J5=S4({opSnippet:Q5,packedOpSnippet:Q5,cpuKernelImpl:$2}),$5={kernelName:GT,backendName:"webgl",kernelFunc:J5};class Z5{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class e6{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const t6={kernelName:HT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{clipValueMin:a,clipValueMax:i}=r;let s;s=mT().getBool("WEBGL_PACK_CLIP")?new e6(o.shape):new Z5(o.shape);const c=[[a],[i]];return n.runWebGLProgram(s,[o],o.dtype,c)}};class n6{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function r6(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const o6={kernelName:KT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,o=n.texData.get(r.dataId),a=new n6(r.shape),i=[r6(r,o.complexTensorInfos.real),r6(r,o.complexTensorInfos.imag)];return n.runWebGLProgram(a,i,i[0].dtype)}};class a6{constructor(e){this.outputShape=[],this.outputShape=bz(e,1),this.variableNames=e.map(((e,t)=>"T".concat(t)));const t=new Array(e.length-1);t[0]=e[0][1];for(let a=1;a<t.length;a++)t[a]=t[a-1]+e[a][1];const n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let a=1;a<t.length;a++){const e=t[a-1];n.push("else if (yC < ".concat(t[a],") ")+"setOutput(getT".concat(a,"(yR, yC-").concat(e,"));"))}const r=t.length,o=t[t.length-1];n.push("else setOutput(getT".concat(r,"(yR, yC-").concat(o,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class i6{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=bz(e,t);const n=this.outputShape,r=n.length,o=w2(r),a=V3("coords",r),i=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(((e,t)=>"T".concat(t)));const s=new Array(e.length-1);s[0]=e[0][t];for(let f=1;f<s.length;f++)s[f]=s[f-1]+e[f][t];const c=i[t],l=i.slice(-2),u=i.join();let d="if (".concat(c," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(l.join(),"));\n        }");for(let f=1;f<s.length;f++){const e=s[f-1];d+="\n        if (".concat(c," < ").concat(s[f],"  && ").concat(c," >= ").concat(s[f-1],") {\n          return getChannel(\n            getT").concat(f,"(").concat(s6(i,c,e),"),\n            vec2(").concat(s6(l,c,e),"));\n        }")}const h=s.length,p=s[s.length-1];d+="\n        return getChannel(\n          getT".concat(h,"(").concat(s6(i,c,p),"),\n          vec2(").concat(s6(l,c,p),"));"),this.userCode="\n      float getValue(".concat(i.map((e=>"int "+e)),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(a,"), 0., 0., 0.);\n\n        ").concat(a[r-1]," = ").concat(a[r-1]," + 1;\n        if (").concat(a[r-1]," < ").concat(n[r-1],") {\n          result.g = getValue(").concat(a,");\n        }\n\n        ").concat(a[r-2]," = ").concat(a[r-2]," + 1;\n        if (").concat(a[r-2]," < ").concat(n[r-2],") {\n          result.a = getValue(").concat(a,");\n        }\n\n        ").concat(a[r-1]," = ").concat(a[r-1]," - 1;\n        if (").concat(a[r-2]," < ").concat(n[r-2]," &&\n            ").concat(a[r-1]," < ").concat(n[r-1],") {\n          result.b = getValue(").concat(a,");\n        }\n        setOutput(result);\n      }\n    ")}}function s6(e,t,n){const r=e.indexOf(t);return e.map(((e,t)=>t===r?"".concat(e," - ").concat(n):e)).join()}function c6(e){const{inputs:t,backend:n}=e,{input:r}=t;return h4({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const l6={kernelName:LN,backendName:"webgl",kernelFunc:c6};function u6(e,t,n){const r=e[0].dtype;if("complex64"===r){const r=e.map((e=>K5({inputs:{input:e},backend:n}))),o=e.map((e=>c6({inputs:{input:e},backend:n}))),a=u6(r,t,n),i=u6(o,t,n),s=f4({inputs:{real:a,imag:i},backend:n});return r.forEach((e=>n.disposeIntermediateTensorInfo(e))),o.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),s}let o=n.shouldExecuteOnCPU(e);if("string"===r&&(o=!0),o){const o=e.map((e=>{const r=zE(e.shape.slice(t));return O4({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),a=o.map((e=>({vals:n.readSync(e.dataId),shape:e.shape}))),i=bz(o.map((e=>e.shape)),1),s=1===o[0].shape[0],c=Z2(a,i,r,s),l=bz(e.map((e=>e.shape)),t),u=n.makeTensorInfo(l,r,c);return o.forEach((e=>n.disposeIntermediateTensorInfo(e))),u}const a=e.filter((e=>zE(e.shape)>0)),i=mT().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(1===a.length){const t=i?new Q3(e[0].shape,t4):new n4(e[0].shape,t4);return n.runWebGLProgram(t,e,r)}const s=mT().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>s){const e=[];for(let o=0;o<a.length;o+=s){const r=a.slice(o,o+s);e.push(u6(r,t,n))}const r=u6(e,t,n);for(const t of e)n.disposeIntermediateTensorInfo(t);return r}if(i){const e=new i6(a.map((e=>e.shape)),t);return n.runWebGLProgram(e,a,r)}const{tensors2D:c,outShape:l}=function(e,t,n){const r=bz(e.map((e=>e.shape)),t),o=e.map((e=>O4({inputs:{x:e},attrs:{shape:[-1,zE(e.shape.slice(t))]},backend:n})));return{tensors2D:o,outShape:r}}(a,t,n),u=new a6(c.map((e=>e.shape))),d=n.runWebGLProgram(u,c,r);c.forEach((e=>n.disposeIntermediateTensorInfo(e)));const h=O4({inputs:{x:d},attrs:{shape:l},backend:n});return n.disposeIntermediateTensorInfo(d),h}function d6(e){const{inputs:t,backend:n,attrs:r}=e,{axis:o}=r,a=HE(o,t[0].shape)[0];yz(t.map((e=>e.shape)),a);const i=bz(t.map((e=>e.shape)),a);if(0===zE(i))return n.makeTensorInfo(i,t[0].dtype,[]);const s=t.filter((e=>zE(e.shape)>0));return 1===s.length?h4({inputs:{x:s[0]},backend:n}):u6(s,a,n)}const h6={kernelName:XT,backendName:"webgl",kernelFunc:d6};class p6{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=e.outShape;const a=e.padInfo.top,i=e.padInfo.left,s=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g=m?1:2,v=m?2:3,y=m?3:1;let b="",x="";n&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(a,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(v,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===f,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===f,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===f,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}}class f6{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,u=e.filterDepth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(o,", ").concat(a,", ").concat(i,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===f,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class m6{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=T2(this.outputShape.length);const a=e.padInfo.left,i=e.strideWidth,s=e.dilationWidth,c=e.filterHeight,l=e.filterWidth,u=l;let d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<l;m++)d+="\n           vec4 xTexelC".concat(2*m,";\n           int xTexelC").concat(2*m,"Ready;\n           vec4 xTexelC").concat(2*m+1,";\n           int xTexelC").concat(2*m+1,"Ready;\n           vec4 xC").concat(m,";");d+="\n     for (int r = 0; r < ".concat(c,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let m=0;m<l;m++)d+="\n           xTexelC".concat(2*m," = vec4(0.0);\n           xTexelC").concat(2*m,"Ready = 0;\n           xTexelC").concat(2*m+1," = vec4(0.0);\n           xTexelC").concat(2*m+1,"Ready = 0;\n           xC").concat(m," = vec4(0.0);");d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(u+1)/2;m++){const t=2*m;if(d+="\n           xC = xCCorner + ".concat(t*s,";\n           "),1===i){if(t<l&&(a%2===1?(d+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n               "),d+=1===s&&t>0?"\n                 xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                   } else {\n                     xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                   }\n                   ")):d+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xC").concat(t," = xTexelC").concat(t,";\n                 "),t+1<l)){const e=a%2===0?OE(s):s;s%2===0&&a%2===1||s%2!==0&&a%2!==1?(d+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                     xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(t+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(t+1,"Ready = 1;\n                   }\n                   "),d+=s>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                     } else {\n                      xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                     }\n                     "):"\n                     xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                     ")):d+=1===e?"\n                     xC".concat(t+1," = xTexelC").concat(t,";\n                     "):"\n                     xCOffset = xC + ".concat(e,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                       xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(t+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(t+1,"Ready = 1;\n                     }\n\n                     xC").concat(t+1," = xTexelC").concat(t+1,";\n                     ")}}else t<l&&(a%2===1?(d+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n               "),t+1<l&&(d+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                 "))):(d+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(\n                   xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n               "),t+1<l&&(d+="\n                   xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                 "))));t<l&&(d+="\n             wTexel = getW(r, ".concat(t,", d1, d2);\n             dotProd += xC").concat(t,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(t,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),t+1<l&&(d+="\n               wTexel = getW(r, ".concat(t+1,", d1, d2);\n               dotProd += xC").concat(t+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(t+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";let h="",p="";n&&(h=r?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):o?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),p="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(h,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(d,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(f,"\n         ").concat(p,"\n         setOutput(result);\n       }\n     ")}}class g6{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=T2(this.outputShape.length);const{dataFormat:n}=t,r=a2(),o="channelsLast"===n,a=o?1:2,i=o?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {");let c="";for(let l=0;l<=1;l++)for(let e=0;e<=1;e++)c+="\n          blockIndex = rc.z + ".concat(e,";\n          pos = rc.y + ").concat(l,";\n\n          ").concat(s,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(a,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(i,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(o,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*l+e,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*l+e,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(c,"\n\n        ").concat(r.output," = result;\n      }\n    ")}}function v6(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function y6(e){let{x:t,filter:n,convInfo:r,backend:o,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:c=null}=e;const l=t.shape,u=o.texData.get(t.dataId),d=r.inChannels,h=l[0]*l[1]*l[2],p=r.outChannels,f="channelsLast"===r.dataFormat,m=!1;let g;const v=[];if(null!=i){const e=v6(i.shape,f);null!=e&&(i=O4({inputs:{x:i},backend:o,attrs:{shape:e}}),v.push(i))}if(null!=a){const e=v6(a.shape,f);null!=e&&(a=O4({inputs:{x:a},backend:o,attrs:{shape:e}}),v.push(a))}if(!((1===h||1===p)&&d>1e3)&&u.isPacked&&f&&null!=u.texture&&l[2]%2!==0&&BE(u.shape.slice(-3),l.slice(-3))){const e=l[0]*l[1]*(l[2]+1),d={dataId:t.dataId,shape:[1,e,r.inChannels],dtype:t.dtype},h=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,ME(Q1(u.shape,d.shape),(()=>"packed reshape ".concat(u.shape," to ").concat(d.shape," isn't free")));const p=O4({inputs:{x:n},backend:o,attrs:{shape:[1,r.inChannels,r.outChannels]}});v.push(p);const f=H4({a:d,b:p,backend:o,transposeA:false,transposeB:m,bias:a,activation:c,preluActivationWeights:i,leakyreluAlpha:s}),y=o.texData.get(f.dataId);ME(y.isPacked,(()=>"batchMatMul result is expected to be packed")),u.shape=h,y.shape=r.outShape,g=h4({inputs:{x:f},backend:o}),g.shape=r.outShape,v.push(f)}else{const e=r.outHeight*r.outWidth,l=O4({inputs:{x:t},backend:o,attrs:{shape:f?[r.batchSize,e,r.inChannels]:[r.batchSize,r.inChannels,e]}}),u=O4({inputs:{x:n},backend:o,attrs:{shape:[1,r.inChannels,r.outChannels]}}),d=H4({a:f?l:u,b:f?u:l,transposeA:!f,transposeB:m,backend:o,bias:a,activation:c,preluActivationWeights:i,leakyreluAlpha:s});g=O4({inputs:{x:d},backend:o,attrs:{shape:r.outShape}}),v.push(l),v.push(u),v.push(d)}for(const y of v)o.disposeIntermediateTensorInfo(y);return g}function b6(e){let{x:t,filter:n,convInfo:r,backend:o,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:c=null}=e;const{filterWidth:l,filterHeight:u,inChannels:d,outWidth:h,outHeight:p,dataFormat:f}=r,m="channelsLast"===f,g=l*u*d,v=p*h,y=[r.batchSize,g,v],b=[];if(null!=i){const e=v6(i.shape,m);null!=e&&(i=O4({inputs:{x:i},backend:o,attrs:{shape:e}}),b.push(i))}if(null!=a){const e=v6(a.shape,m);null!=e&&(a=O4({inputs:{x:a},backend:o,attrs:{shape:e}}),b.push(a))}const x=O4({inputs:{x:n},backend:o,attrs:{shape:[1,g,zE(n.shape)/g]}});b.push(x);const w=new g6(y,r),k=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],S=o.runWebGLProgram(w,[t],"float32",k),I=O4({inputs:{x:S},backend:o,attrs:{shape:y}});b.push(S),b.push(I);const C=null!=a,A=null!=i,E="leakyrelu"===c,T=c?C4(c,!0):null,N=new A4(m?I.shape:x.shape,m?x.shape:I.shape,m?[r.batchSize,v,r.outChannels]:[r.batchSize,r.outChannels,v],!0,!1,C,T,A,E),R=m?[I,x]:[x,I];if(a&&R.push(a),A&&R.push(i),E){const e=o.makeTensorInfo([],"float32",nD(s,"float32"));R.push(e),b.push(e)}const _=o.runWebGLProgram(N,R,"float32"),D=O4({inputs:{x:_},backend:o,attrs:{shape:r.outShape}});b.push(_);for(const O of b)o.disposeIntermediateTensorInfo(O);return D}const x6={kernelName:YT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a}=t,{strides:i,pad:s,dataFormat:c,dilations:l,dimRoundingMode:u}=r,d=IM(c),h=fM(o.shape,a.shape,i,l,s,u,!1,d);let p;if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===d&&mT().getBool("WEBGL_EXP_CONV")){const e=new m6(h),t=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=n.runWebGLProgram(e,[o,a],"float32",t)}else if(mT().getBool("WEBGL_CONV_IM2COL"))p=b6({x:o,filter:a,convInfo:h,backend:n});else{const e=new p6(h);p=n.runWebGLProgram(e,[o,a],"float32")}else p=y6({x:o,filter:a,convInfo:h,backend:n});const f=O4({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),f}};class w6{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,a="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(a?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class k6{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,a="channelsLast"===e.dataFormat,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,c=a?1:2,l=a?2:3,u=a?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(a,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class S6{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,a=e.padInfo.top,i=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(o,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class I6{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,a=e.strideHeight,i=e.strideWidth,s=t-1-e.padInfo.front,c=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(o,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const C6={kernelName:QT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,dy:a}=t,{strides:i,pad:s,dataFormat:c,dimRoundingMode:l,filterShape:u}=r,d=IM(c),h=fM(o.shape,u,i,1,s,l,!1,d),p=new w6(h);return n.runWebGLProgram(p,[o,a],"float32")}};class A6{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=T2(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,o=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(r,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}const E6={kernelName:JT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,filter:a}=t,{inputShape:i,strides:s,pad:c,dataFormat:l,dimRoundingMode:u}=r,d=IM(l),h=fM(i,a.shape,s,1,c,u,!1,d);if(mT().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===d){const e=[[h.strideHeight,h.strideWidth]],t=new A6(h);return n.runWebGLProgram(t,[o,a],"float32",e)}{const e=new k6(h);return n.runWebGLProgram(e,[o,a],"float32")}}};const T6={kernelName:$T,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a}=t,{strides:i,pad:s,dilations:c}=r,l=mM(o.shape,a.shape,i,c,s),u=new f6(l);return n.runWebGLProgram(u,[o,a],"float32")}};const N6={kernelName:ZT,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,dy:a}=t,{strides:i,pad:s,filterShape:c}=r,l=mM(o.shape,c,i,1,s),u=new S6(l);return n.runWebGLProgram(u,[o,a],"float32")}};const R6={kernelName:eN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,filter:a}=t,{pad:i,strides:s,inputShape:c}=r,l=mM(c,a.shape,s,1,i),u=new I6(l);return n.runWebGLProgram(u,[o,a],"float32")}},_6=S4({opSnippet:k4+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(u4,"\n  return result;\n")}),D6={kernelName:tN,backendName:"webgl",kernelFunc:_6},O6=S4({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),F6={kernelName:nN,backendName:"webgl",kernelFunc:O6};class M6{constructor(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,i,s,c]=e,[l]=t,[u,d]=n;this.outputShape=[l,u,d,c];const h="bilinear"===r?1:0,[p,f]=["".concat(i-1,".0"),"".concat(s-1,".0")],[m,g,v]=u>1?["".concat((i-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(p," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(p)],[y,b,x]=d>1?["".concat((s-1)/(d-1)),"(x2-x1) * width_ratio","x1*".concat(f," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(f)];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(y,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(a,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(b,";\n\n        float in_y = ").concat(v,";\n        if( in_y < 0.0 || in_y > ").concat(p," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n        float in_x = ").concat(x,";\n        if( in_x < 0.0 || in_x > ").concat(f," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(h," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}const P6={kernelName:aN,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{image:o,boxes:a,boxInd:i}=t,{cropSize:s,method:c,extrapolationValue:l}=r,u=new M6(o.shape,a.shape,s,c,l);return n.runWebGLProgram(u,[o,a,i],"float32")}};var L6;!function(e){e.Prod="*",e.Sum="+"}(L6||(L6={}));class z6{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,a=this.op===L6.Prod?"1.0":"0.0",i=n?a:"getX(".concat(B6(o,"coords",this.op),")"),s=this.outputShape[this.outputShape.length-1];let c="",l="";n?(c=r?"end != ".concat(s-1):"end != 0",l=r?"end + 1":"end - 1"):(c=r?"end + pow2 < ".concat(s):"end >= pow2",l=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(w2(o)," coords = getOutputCoords();\n        int end = ").concat(U6(o,"coords",this.op),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(l,";\n          ").concat(U6(o,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(B6(o,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function B6(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function U6(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function W6(e,t,n,r,o,a){const i=t.shape.length,s=vP([r],i);let c=t;null!=s&&(c=V4({inputs:{x:t},backend:n,attrs:{perm:s}}));const l=bP(1,i)[0];if(l!==i-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));const u=c.shape[l];let d=h4({inputs:{x:c},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const t=new z6(e,c.shape,!1,a),r=[[h]],o=d;d=n.runWebGLProgram(t,[d],d.dtype,r),n.disposeIntermediateTensorInfo(o)}if(o){const t=new z6(e,c.shape,o,a),r=d;d=n.runWebGLProgram(t,[d],d.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=s){const e=V4({inputs:{x:d},backend:n,attrs:{perm:yP(s)}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(c),e}return d}const j6={kernelName:rN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,exclusive:i,reverse:s}=r;return W6(L6.Prod,o,n,a,i,s)}};const V6={kernelName:oN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,exclusive:i,reverse:s}=r;return W6(L6.Sum,o,n,a,i,s)}};const G6={kernelName:iN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,weights:a}=t,{size:i,binaryOutput:s}=r;if(1===o.shape.length){const e=n.readSync(o.dataId),t=n.readSync(a.dataId),r=X2(e,t,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,r)}if(2===o.shape.length){const e=n.bufferSync(o),t=n.bufferSync(a),r=Y2(e,t,i,s);return n.makeTensorInfo(r.shape,a.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(o.shape.length,"."))}};class H6{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const q6={kernelName:sN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{blockSize:a,dataFormat:i}=r,s=o.shape[0],c=("NHWC"===i?o.shape[1]:o.shape[2])*a,l=("NHWC"===i?o.shape[2]:o.shape[3])*a,u=("NHWC"===i?o.shape[3]:o.shape[1])/(a*a),d=new H6("NHWC"===i?[s,c,l,u]:[s,u,c,l],a,i);return n.runWebGLProgram(d,[o],o.dtype)}};class K6{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=T2(this.outputShape.length);const a=e.filterHeight,i=e.filterWidth,s=e.outChannels/e.inChannels;let c="",l="";n&&(c=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),l="result = activation(result);");const u=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(c,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(a,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(u,"\n        ").concat(l,"\n        setOutput(result);\n      }\n    ")}}class X6{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=T2(this.outputShape.length);const a=e.outChannels/e.inChannels,i=e.padInfo.left,s=e.strideWidth,c=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,d=u;let h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<u;g++)h+="\n          vec4 xTexelC".concat(2*g,";\n          int xTexelC").concat(2*g,"Ready;\n          vec4 xTexelC").concat(2*g+1,";\n          int xTexelC").concat(2*g+1,"Ready;\n          vec4 xC").concat(g,";");h+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      ");for(let g=0;g<u;g++)h+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(d+1)/2;g++){const e=2*g;if(h+="\n          xC = xCCorner + ".concat(e*c,";\n          "),1===s){if(e<u&&(i%2===1?(h+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n              "),h+=1===c&&e>0?"\n                xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                  } else {\n                    xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                  }\n                  ")):h+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xC").concat(e," = xTexelC").concat(e,";\n                "),e+1<u)){const t=i%2===0?OE(c):c;c%2===0&&i%2===1||c%2!==0&&i%2!==1?(h+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                    xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(e+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(e+1,"Ready = 1;\n                  }\n                  "),h+=c>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                    } else {\n                     xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                    }\n                    "):"\n                    xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                    ")):h+=1===t?"\n                    xC".concat(e+1," = xTexelC").concat(e,";\n                    "):"\n                    xCOffset = xC + ".concat(t,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                      xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(e+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(e+1,"Ready = 1;\n                    }\n\n                    xC").concat(e+1," = xTexelC").concat(e+1,";\n                    ")}}else e<u&&(i%2===1?(h+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n              "),e+1<u&&(h+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                "))):(h+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(\n                  xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n              "),e+1<u&&(h+="\n                  xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                "))));e<u&&(h+="\n            wTexel = getW(r, ".concat(e,", d1, q);\n            dotProd += xC").concat(e," * vec4(wTexel.xz, wTexel.xz);\n          "),e+1<u&&(h+="\n              wTexel = getW(r, ".concat(e+1,", d1, q);\n              dotProd += xC").concat(e+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}h+="\n    }\n  ",h+="\n      }\n    ";let p="",f="";n&&(p=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),f="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(p,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(a,";\n        int q = d2 - d1 * ").concat(a,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(h,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(m,"\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}}const Y6={kernelName:cN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a}=t,{strides:i,pad:s,dilations:c,dimRoundingMode:l}=r;let u=c;null==u&&(u=[1,1]),ME(kM(i,u),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(u,"'")));const d=fM(o.shape,a.shape,i,u,s,l,!0);let h;h=mT().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?new X6(d):new K6(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[o,a],"float32",p)}};class Q6{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(a," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class J6{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,a=t-1-e.padInfo.top,i=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const $6={kernelName:lN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,dy:a}=t,{strides:i,dilations:s,pad:c,dimRoundingMode:l,filterShape:u}=r,d=fM(o.shape,u,i,s,c,l,!0),h=new Q6(d);return n.runWebGLProgram(h,[o,a],"float32")}};const Z6={kernelName:uN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,filter:a}=t,{strides:i,dilations:s,pad:c,dimRoundingMode:l,inputShape:u}=r,d=fM(u,a.shape,i,s,c,l,!0),h=new J6(d);return n.runWebGLProgram(h,[o,a],"float32")}};class e9{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const t9={kernelName:dN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,o=[...r.shape,...r.shape],a=zE(r.shape),i=O4({inputs:{x:r},backend:n,attrs:{shape:[a]}}),s=new e9(a),c=n.runWebGLProgram(s,[i],i.dtype),l=O4({inputs:{x:c},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(c),l}};class n9{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:r,strideHeight:o,strideWidth:a,filterHeight:i,filterWidth:s,dilationHeight:c,dilationWidth:l}=e,{top:u,left:d}=r;this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(a,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(i,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}const r9={kernelName:hN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a}=t,{strides:i,pad:s,dilations:c}=r,l=dM(o.shape,a.shape,i,s,"NHWC",c);let u;const d=new n9(l);u=n.runWebGLProgram(d,[o,a],"float32");const h=O4({inputs:{x:u},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(u),h}};const o9={kernelName:vN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:o}=r,a=t,{allDims:i,summedDims:s,idDims:c}=rB(o,a.length);aB(i.length,c,a);const{path:l,steps:u}=iB(s,c),d=u.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const e of u[m]){const{permutationIndices:t,expandDims:r}=oB(p,c[e]);let o;sB(t)?o=a[e]:(o=V4({inputs:{x:a[e]},backend:n,attrs:{perm:t}}),f.push(o));const i=o.shape.slice();for(let e=0;e<r.length;++e)i.splice(r[e],0,1);BE(o.shape,i)||(o=O4({inputs:{x:o},backend:n,attrs:{shape:i}}),f.push(o)),null===h?h=o:(h=_4({inputs:{a:o,b:h},backend:n}),f.push(h))}m<d-1&&(l[m]>=0&&(h=W4({inputs:{x:h},backend:n,attrs:{axis:l[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}},a9=S4({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),i9={kernelName:yN,backendName:"webgl",kernelFunc:a9},s9={kernelName:bN,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n}=e,{dy:r,y:o}=t,a=mT().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new d4("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,o.shape):new l4("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,o.shape);return n.runWebGLProgram(a,[r,o],r.dtype)}},c9=I4({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:e3}),l9={kernelName:wN,backendName:"webgl",kernelFunc:c9},u9=S4({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(Bz,";\n  float a1 = ").concat(Uz,";\n  float a2 = ").concat(Wz,";\n  float a3 = ").concat(jz,";\n  float a4 = ").concat(Vz,";\n  float a5 = ").concat(Gz,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),d9={kernelName:xN,backendName:"webgl",kernelFunc:u9},h9=S4({opSnippet:k4+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:t3,dtype:"float32"}),p9={kernelName:kN,backendName:"webgl",kernelFunc:h9};function f9(e){const{inputs:t,attrs:n,backend:r}=e,{dim:o}=n,{input:a}=t,i=a.shape.length,s=a.shape.slice();let c=o;return o<0&&(ME(-(i+1)<=o,(()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]"))),c=i+o+1),s.splice(c,0,1),O4({inputs:{x:a},backend:r,attrs:{shape:s}})}const m9={kernelName:SN,backendName:"webgl",kernelFunc:f9},g9="return exp(x) - 1.0;",v9=S4({opSnippet:g9,packedOpSnippet:g9,cpuKernelImpl:n3}),y9={kernelName:IN,backendName:"webgl",kernelFunc:v9};class b9{constructor(e,t,n){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const o=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),a=n?"".concat(r,".0"):"1.0";let i;if("real"===e)i="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(a,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function x9(e,t,n){const r=n.texData.get(e.dataId),o=zE(e.shape),a=e.shape[e.shape.length-1],i=O4({inputs:{x:e},backend:n,attrs:{shape:[o/a,a]}}),s=i.shape,c=new b9("real",s,t),l=new b9("imag",s,t),u=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],d=n.runWebGLProgram(c,u,"float32"),h=n.runWebGLProgram(l,u,"float32"),p=f4({inputs:{real:d,imag:h},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h);const f=O4({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(p),f}const w9={kernelName:CN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return x9(r,!1,n)}};class k9{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function S9(e){const{backend:t,attrs:n}=e,{shape:r,value:o}=n;let{dtype:a}=n;if(a=a||ZE(o),"string"===a){const e=XE(a,zE(r));return e.fill(o),t.makeTensorInfo(r,a,e)}{const e=new k9(r,o),n=[[o]];return t.runWebGLProgram(e,[],a,n)}}const I9={kernelName:AN,backendName:"webgl",kernelFunc:S9};class C9{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const A9={kernelName:EN,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{image:r}=t,o=n,a=new C9(r.shape);return o.runWebGLProgram(a,[r],r.dtype)}},E9="return floor(x);",T9=S4({opSnippet:E9,packedOpSnippet:E9,cpuKernelImpl:r3}),N9={kernelName:TN,backendName:"webgl",kernelFunc:T9},R9=I4({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),_9={kernelName:NN,backendName:"webgl",kernelFunc:R9};class D9{constructor(e){this.variableNames=["A"];const t=a2(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(r,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class O9{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=a2(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(r,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}const F9={kernelName:A_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:o}=t;const{numChannels:a}=r,i="undefined"!==typeof HTMLVideoElement&&o instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&o instanceof HTMLImageElement,[c,l]=i?[o.videoWidth,o.videoHeight]:[o.width,o.height],u=[l,c],d=[l,c,a];if(s||i){const e=mT().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=M9&&e===P9||(P9=e,M9=document.createElement("canvas").getContext("2d",{willReadFrequently:P9})),M9.canvas.width=c,M9.canvas.height=l,M9.drawImage(o,0,0,c,l),o=M9.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=E1.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);const p=mT().getBool("WEBGL_PACK")?new O9(d):new D9(d),f=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),f}};let M9,P9=mT().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const L9={kernelName:N_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a,bias:i,preluActivationWeights:s}=t,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,m=IM(u),g=fM(o.shape,a.shape,c,d,l,h,!1,m);let v;const y=[],b=null!=i,x=null!=s,w="leakyrelu"===p,k=()=>{const e=[o,a],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=O4({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return y.push(t),t}return e};if(b&&e.push(t(i,u)),x&&e.push(t(s,u)),w){const t=n.makeTensorInfo([],"float32",nD(f,"float32"));e.push(t),y.push(t)}return e};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===m&&mT().getBool("WEBGL_EXP_CONV")){const e=p?C4(p,!0):null,t=new m6(g,b,e,x,w),r=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],o=k();v=n.runWebGLProgram(t,o,"float32",r)}else if(mT().getBool("WEBGL_CONV_IM2COL"))v=b6({x:o,filter:a,convInfo:g,backend:n,bias:i,activation:p,preluActivationWeights:s,leakyreluAlpha:f});else{const e=p?C4(p,!1):null,t=new p6(g,b,e,x,w),r=k();v=n.runWebGLProgram(t,r,"float32")}else v=y6({x:o,filter:a,convInfo:g,backend:n,bias:i,activation:p,preluActivationWeights:s,leakyreluAlpha:f});const S=O4({inputs:{x:v},backend:n,attrs:{shape:g.outShape}});return y.push(v),y.forEach((e=>n.disposeIntermediateTensorInfo(e))),S}};const z9={kernelName:R_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,filter:a,bias:i,preluActivationWeights:s}=t,{strides:c,pad:l,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r,f=[];let m=u;null==m&&(m=[1,1]),ME(kM(c,m),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(c," and dilations '").concat(m,"'")));const g=fM(o.shape,a.shape,c,m,l,d,!0),v=mT().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,y=h?C4(h,v):null,b=[o,a],x=null!=i,w=null!=s,k="leakyrelu"===h;if(x&&b.push(i),w&&b.push(s),k){const e=n.makeTensorInfo([],"float32",nD(p,"float32"));b.push(e),f.push(e)}let S;S=v?new X6(g,x,y,w,k):new K6(g,x,y,w,k);const I=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],C=n.runWebGLProgram(S,b,"float32",I);return f.forEach((e=>n.disposeIntermediateTensorInfo(e))),C}};class B9{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const o=w2(n.length);let a="\n    int index;";for(let i=0;i<this.sliceDim;i++)a+="\n          index = round(getIndices(coords[0], ".concat(i,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[i],";\n          flattenIndex += index * ").concat(this.strides[i],";");this.userCode="\n         void main() {\n          ".concat(o," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(a,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}const U9={kernelName:DN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:o}=t,a=o.shape,i=a[a.length-1],s=zE(r.shape),[c,l,u,d]=Oz(r,o),h=O4({inputs:{x:o},backend:n,attrs:{shape:[l,i]}}),p=O4({inputs:{x:r},backend:n,attrs:{shape:[zE(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,o])||"string"===r.dtype){const e=n.readSync(o.dataId),t=n.bufferSync(r),a=o3(e,t,r.dtype,l,i,u,d,r.shape,s);return n.makeTensorInfo(c,r.dtype,a.values)}const f=new B9(i,d,[l,u],r.shape),m=n.runWebGLProgram(f,[p,h],p.dtype),g=O4({inputs:{x:m},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}};class W9{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=w2(this.rank),r=function(e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<e.length;r++)2===r?n.push("index"):n.push("".concat(t[r]));return n.join()}(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(r,"));\n      }\n    ")}}function j9(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,indices:a}=t,{axis:i,batchDims:s}=r,c=HE(i,o.shape)[0];if(mT().get("DEBUG")){const e=n.readSync(a.dataId),t=o.shape[c];for(let n=0;n<e.length;++n){const r=e[n];ME(r<=t-1&&r>=0,(()=>"GatherV2: the index value ".concat(r," is not in [0, ").concat(t-1,"]")))}}const l=IB(o,a,c,s),u=zE(a.shape),d=[],h=O4({inputs:{x:o},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),p=O4({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,u/l.batchSize]}});d.push(h),d.push(p);const f=[l.batchSize,l.outerSize,u/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([o,a])||"string"===o.dtype){const e=n.bufferSync(p),t=n.bufferSync(h),r=a3(t,e,f);return d.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(l.outputShape,r.dtype,r.values)}const m=new W9(h.shape,f),g=n.runWebGLProgram(m,[h,p],h.dtype);d.push(g);const v=O4({inputs:{x:g},backend:n,attrs:{shape:l.outputShape}});return d.forEach((e=>n.disposeIntermediateTensorInfo(e))),v}const V9={kernelName:_N,backendName:"webgl",kernelFunc:j9},G9=I4({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:i3,dtype:"bool"}),H9={kernelName:ON,backendName:"webgl",kernelFunc:G9},q9=I4({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:s3}),K9={kernelName:FN,backendName:"webgl",kernelFunc:q9};const X9={kernelName:PN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return x9(r,!0,n)}},Y9=S4({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),Q9={kernelName:zN,backendName:"webgl",kernelFunc:Y9},J9=S4({opSnippet:"return float(isinf(x));",dtype:"bool"}),$9={kernelName:BN,backendName:"webgl",kernelFunc:J9},Z9=S4({opSnippet:"return float(isnan(x));",dtype:"bool"}),e8={kernelName:UN,backendName:"webgl",kernelFunc:Z9},t8=I4({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:c3,dtype:"bool"}),n8={kernelName:jN,backendName:"webgl",kernelFunc:t8},r8=I4({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:l3,dtype:"bool"}),o8={kernelName:VN,backendName:"webgl",kernelFunc:r8};const a8={kernelName:GN,backendName:"webgl",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:o,num:a}=n,i=u3(r,o,a);return t.makeTensorInfo([i.length],"float32",i)}},i8=S4({opSnippet:k4+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:d3}),s8={kernelName:HN,backendName:"webgl",kernelFunc:i8},c8=S4({opSnippet:k4+"\n  return log(1.0 + x);\n"}),l8={kernelName:qN,backendName:"webgl",kernelFunc:c8},u8=I4({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),d8={kernelName:KN,backendName:"webgl",kernelFunc:u8},h8=S4({opSnippet:"return float(!(x >= 1.0));"}),p8={kernelName:XN,backendName:"webgl",kernelFunc:h8},f8=I4({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),m8={kernelName:YN,backendName:"webgl",kernelFunc:f8};class g8{constructor(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];const a=t,i=e[3]-1;let s;this.outputShape=e;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===o?"inversesqrt(".concat(c,")"):1===o?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(a,"; j <= ").concat(a,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(i,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(s,";\n        setOutput(val);\n      }\n    ")}}class v8{constructor(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=t,i=e[3]-1;let s;this.outputShape=e;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===o?"inversesqrt(".concat(c,")"):1===o?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(a,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(a,"; j <= ").concat(a,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(i,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(s,";\n        setOutput(result);\n      }\n    ")}}const y8={kernelName:QN,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{depthRadius:a,bias:i,alpha:s,beta:c}=r,l=mT().getBool("WEBGL_PACK_NORMALIZATION")?new v8(o.shape,a,i,s,c):new g8(o.shape,a,i,s,c);return n.runWebGLProgram(l,[o],o.dtype)}};class b8{constructor(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(o,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(o,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}const x8={kernelName:JN,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:o,y:a,dy:i}=t,{depthRadius:s,bias:c,alpha:l,beta:u}=r,d=new b8(o.shape,s,c,l,u);return n.runWebGLProgram(d,[o,a,i],o.dtype)}};function w8(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{reductionIndices:a,keepDims:i}=r,s=o.shape.length,c=HE(a,o.shape);let l=c;const u=vP(l,s),d=null!=u,h=n.shouldExecuteOnCPU([o]);let p=o;if(d){if(h){const e=n.texData.get(p.dataId).values,t=new Array(s);for(let n=0;n<t.length;n++)t[n]=o.shape[u[n]];const r=U3(e,o.shape,o.dtype,u,t);p=n.makeTensorInfo(t,o.dtype);n.texData.get(p.dataId).values=r}else p=U4(o,u,n);l=bP(l.length,s)}gP("max",l,s);const[f,m]=fP(p.shape,l);let g,v=f;if(i&&(v=mP(f,c)),h){const e=n.texData.get(p.dataId).values,t=h3(e,zE(m),v,o.dtype);g=n.makeTensorInfo(v,o.dtype);n.texData.get(g.dataId).values=t}else g=function(e,t,n,r){const o=zE(t),a=O4({inputs:{x:e},attrs:{shape:[zE(e.shape)/o,o]},backend:r}),i=L4(a,e.dtype,"max",r),s=O4({inputs:{x:i},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(i),s}(p,m,v,n);return d&&n.disposeIntermediateTensorInfo(p),g}const k8={kernelName:$N,backendName:"webgl",kernelFunc:w8},S8=I4({opSnippet:c4+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+u4+"\n  return result;\n",cpuKernelImpl:p3}),I8={kernelName:ZN,backendName:"webgl",kernelFunc:S8};const C8={kernelName:eR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t;r2(o,"maxPool");const{filterSize:a,strides:i,pad:s,dimRoundingMode:c}=r;ME(kM(i,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'")));const l=hM(o.shape,a,i,1,s,c);if(1===l.filterWidth&&1===l.filterHeight&&BE(l.inShape,l.outShape))return h4({inputs:{x:o},backend:n});const u=new I5(l,"max",!1);return n.runWebGLProgram(u,[o],o.dtype)}};const A8={kernelName:nR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{filterSize:a,strides:i,pad:s,dataFormat:c,dimRoundingMode:l}=r,u=pM(o.shape,a,i,[1,1,1],s,l,c),d=new C5(u,"max",!1);return n.runWebGLProgram(d,[o],o.dtype)}};class E8{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,a=e.effectiveFilterWidth,i=o-1-e.padInfo.top,s=a-1-e.padInfo.left,c=o*a-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(a,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(a," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class T8{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterDepth,c=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=s-1-e.padInfo.front,d=c-1-e.padInfo.top,h=l-1-e.padInfo.left,p=s*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(d,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(a,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(i,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const N8={kernelName:rR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,input:a}=t,i=a,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,d=pM(i.shape,s,c,[1,1,1],l,u),h=new C5(d,"max",!0),p=n.runWebGLProgram(h,[i],i.dtype),f=new T8(d),m=n.runWebGLProgram(f,[o,p],i.dtype);return n.disposeIntermediateTensorInfo(p),m}};const R8={kernelName:tR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:o,input:a,output:i}=t,s=a;r2([a,i],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:d}=r,h=hM(s.shape,c,l,1,u,d),p=new I5(h,"max",!0),f=n.runWebGLProgram(p,[s],s.dtype),m=new E8(h),g=n.runWebGLProgram(m,[o,f],s.dtype);return n.disposeIntermediateTensorInfo(f),g}};const _8={kernelName:oR,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:o}=t,{filterSize:a,strides:i,pad:s,includeBatchInIndex:c}=n,l=r;ME(4===o.shape.length,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(o.shape.length,".")));const u=[1,1];ME(kM(i,u),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(u,"'")));const d=hM(o.shape,a,i,u,s),[h,p]=function(e,t,n,r){let o=new I5(n,"max",!1);const a=r.runWebGLProgram(o,[e],"float32");return o=new I5(n,"max",!0,!0,t),[a,r.runWebGLProgram(o,[e],"float32")]}(o,c,d,l);return[h,p]}};const D8={kernelName:aR,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:o}=t,{keepDims:a,axis:i}=n,s=r,c=o.shape.length,l=HE(i,o.shape);let u=l;const d=vP(u,c),h=null!=d,p=s.shouldExecuteOnCPU([o]),f=[];let m=o;if(h){if(p){const e=s.texData.get(m.dataId).values,t=new Array(c);for(let r=0;r<t.length;r++)t[r]=o.shape[d[r]];const n=U3(e,o.shape,o.dtype,d,t);m=s.makeTensorInfo(t,o.dtype);s.texData.get(m.dataId).values=n}else m=U4(o,d,s);f.push(m),u=bP(u.length,c)}gP("sum",u,c);const[g,v]=fP(m.shape,u);let y=g;a&&(y=mP(g,l));const b=function(e,t,n,r){const o=zE(t),a=O4({inputs:{x:e},attrs:{shape:[zE(e.shape)/o,o]},backend:r}),i=L4(a,"float32","mean",r),s=O4({inputs:{x:i},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(i),s}(m,v,y,s);for(const x of f)s.disposeIntermediateTensorInfo(x);return b}};const O8={kernelName:iR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r,s=o.shape.length,c=HE(a,o.shape);let l=c;const u=vP(l,s);let d=o;null!=u&&(d=V4({inputs:{x:o},backend:n,attrs:{perm:u}}),l=bP(l.length,o.shape.length)),gP("min",l,s);const[h,p]=fP(d.shape,l),f=O4({inputs:{x:d},backend:n,attrs:{shape:[-1,zE(p)]}}),m=L4(f,f.dtype,"min",n);let g;if(i){g=O4({inputs:{x:m},backend:n,attrs:{shape:mP(h,c)}})}else g=O4({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(d),g}},F8=I4({opSnippet:c4+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+u4+"\n  return result;\n",cpuKernelImpl:f3}),M8={kernelName:sR,backendName:"webgl",kernelFunc:F8};class P8{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,o=w2(r),a=t.map((e=>e[0])).join(","),i=t.map(((t,n)=>t[0]+e[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c="reflect"===n?0:1;this.userCode=1!==r?"\n      ".concat(o," start = ").concat(o,"(").concat(a,");\n      ").concat(o," end = ").concat(o,"(").concat(i,");\n\n      void main() {\n        ").concat(o," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(r,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(o," coords = outC - start;\n        setOutput(getX(").concat(s,"));\n      }\n    "):"\n        int start = ".concat(a,";\n        int end = ").concat(i,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class L8{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,o=w2(r),a=t.map((e=>e[0])).join(","),i=t.map(((t,n)=>t[0]+e[n])).join(","),s=V3("rc",r),c=V3("source",r),l="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(c.slice(-2).join(),")"),d="reflect"===n?0:1;let h="";if(1===r){const e="\n        ".concat(o," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");h="\n        ".concat(o," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(l,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ")}else{const e="\n        ".concat(o," source = rc;\n        ").concat(o," lt = ").concat(o,"(lessThan(source, start));\n        ").concat(o," gte = ").concat(o,"(greaterThanEqual(source, end));\n        ").concat(o," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");h="\n        ".concat(o," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(l,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(s[r-2]," += 1;\n        if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {\n          ").concat(e,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          ").concat(s[r-1]," += 1;\n          if(").concat(l,") {\n            ").concat(e,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(a,");\n      const ").concat(o," end = ").concat(o,"(").concat(i,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")}}const z8={kernelName:cR,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:o}=t,{paddings:a,mode:i}=r,s=mT().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new L8(o.shape,a,i):new P8(o.shape,a,i);return n.runWebGLProgram(s,[o],o.dtype)}},B8=I4({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+u4+"\n  return result;\n"}),U8={kernelName:lR,backendName:"webgl",kernelFunc:B8};class W8{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}}const j8=I4({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),V8={kernelName:gN,backendName:"webgl",kernelFunc:j8},G8="return a - b;",H8=I4({opSnippet:G8,packedOpSnippet:G8,supportsComplex:!0,cpuKernelImpl:L3}),q8={kernelName:f_,backendName:"webgl",kernelFunc:H8};function K8(e){const{inputs:t,backend:n,attrs:r}=e,{logits:o}=t,{dim:a}=r,i=HE([a],o.shape),s=w8({inputs:{x:o},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),c=mP(s.shape,i),l=O4({inputs:{x:s},backend:n,attrs:{shape:c}}),u=H8({inputs:{a:o,b:l},backend:n}),d=h9({inputs:{x:u},backend:n}),h=W4({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),p=O4({inputs:{x:h},backend:n,attrs:{shape:c}}),f=j8({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}const X8={kernelName:t_,backendName:"webgl",kernelFunc:K8};const Y8={kernelName:uR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:o}=t,{numSamples:a,seed:i,normalized:s}=r,c=s?o:K8({inputs:{logits:o},backend:n,attrs:{dim:o.shape.length-1}}),l=c.shape[0],u=c.shape[1],d=new W8(l,u,a),h=[[i]],p=n.runWebGLProgram(d,[c],"int32",h);return s||n.disposeIntermediateTensorInfo(c),p}},Q8=J3+"\n  return -x;\n";const J8={kernelName:hR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const e=n.texData.get(r.dataId),[t,o]=g3(e.values,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,t)}let o;return o=mT().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new n4(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new Q3(r.shape,Q8),n.runWebGLProgram(o,[r],r.dtype)}},$8=BL;const Z8={kernelName:fR,backendName:"webgl",kernelFunc:function(e){__("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:o,scores:a}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c}=r,l=n.readSync(o.dataId),u=n.readSync(a.dataId),{selectedIndices:d}=$8(l,u,i,s,c);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},e7=UL;const t7={kernelName:mR,backendName:"webgl",kernelFunc:function(e){__("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:o,scores:a}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c,padToMaxOutputSize:l}=r,u=n.readSync(o.dataId),d=n.readSync(a.dataId),{selectedIndices:h,validOutputs:p}=e7(u,d,i,s,c,l);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},n7=WL;const r7={kernelName:gR,backendName:"webgl",kernelFunc:function(e){__("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:o,scores:a}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=r,u=n.readSync(o.dataId),d=n.readSync(a.dataId),h=i,p=s,f=c,m=l,{selectedIndices:g,selectedScores:v}=n7(u,d,h,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}};class o7{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}const a7={kernelName:yR,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:o}=t,{dtype:a,depth:i,onValue:s,offValue:c}=r,l=zE(o.shape),u=new o7(l,i,s,c),d=O4({inputs:{x:o},backend:n,attrs:{shape:[l]}}),h=n.runWebGLProgram(u,[d],a);n.disposeIntermediateTensorInfo(d);const p=O4({inputs:{x:h},backend:n,attrs:{shape:[...o.shape,i]}});return n.disposeIntermediateTensorInfo(h),p}};function i7(e){const{inputs:t,backend:n}=e,{x:r}=t;if("complex64"===r.dtype){const e=K5({inputs:{input:r},backend:n}),t=i7({inputs:{x:e},backend:n}),o=c6({inputs:{input:r},backend:n}),a=i7({inputs:{x:o},backend:n}),i=f4({inputs:{real:t,imag:a},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),i}return S9({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const s7={kernelName:I_,backendName:"webgl",kernelFunc:i7};const c7={kernelName:vR,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:o}=n;if("string"===o.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===o.dtype){const t=K5({inputs:{input:o},backend:r}),n=e({inputs:{x:t},backend:r}),a=c6({inputs:{input:o},backend:r}),i=i7({inputs:{x:a},backend:r}),s=f4({inputs:{real:n,imag:i},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(i),s}return S9({attrs:{shape:o.shape,dtype:o.dtype,value:1},backend:r})}};const l7={kernelName:bR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:o}=r;if(1===t.length)return f9({inputs:{input:t[0]},backend:n,attrs:{dim:o}});const a=t[0].shape,i=t[0].dtype;t.forEach((e=>{PE(a,e.shape,"All tensors passed to stack must have matching shapes"),ME(i===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const s=[],c=d6({inputs:t.map((e=>{const t=f9({inputs:{input:e},backend:n,attrs:{dim:o}});return s.push(t),t})),backend:n,attrs:{axis:o}});return s.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}};class u7{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,o=w2(r),a=t.map((e=>e[0])).join(","),i=t.map(((t,n)=>t[0]+e[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      ".concat(o," start = ").concat(o,"(").concat(a,");\n      ").concat(o," end = ").concat(o,"(").concat(i,");\n\n      void main() {\n        ").concat(o," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(o," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(a,";\n        int end = ").concat(i,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class d7{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,o=w2(r),a=t.map((e=>e[0])).join(","),i=t.map(((t,n)=>t[0]+e[n])).join(","),s=V3("rc",r),c=V3("source",r),l="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(c.slice(-2).join(),")"),d=["".concat(o," rc = outputLoc;"),"".concat(s[r-1]," += 1;\n       if(").concat(l,") {\n      "),1===r?"":"}\n       rc = outputLoc;\n       ".concat(s[r-2]," += 1;\n       if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {"),1===r?"":"  ".concat(s[r-1]," += 1;\n         if(").concat(l,") {")],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===r?2:4;f<m;f++)p+="\n        ".concat(d[f],"\n        if (").concat(h,") {\n          result[").concat(f,"] = float(value);\n        } else {\n          ").concat(o," source = rc - start;\n          result[").concat(f,"] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ");p+=1===r?"} ":"}}",this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(a,");\n      const ").concat(o," end = ").concat(o,"(").concat(i,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}const h7=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{paddings:a,constantValue:i}=r;if(0===zE(o.shape)){const e=a.map(((e,t)=>e[0]+o.shape[t]+e[1]));return S9({backend:n,attrs:{shape:e,value:i,dtype:o.dtype}})}const s=mT().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new d7(o.shape,a,i):new u7(o.shape,a,i),c=[[i]];return n.runWebGLProgram(s,[o],o.dtype,c)},p7={kernelName:xR,backendName:"webgl",kernelFunc:h7},f7=I4({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+u4+"\n  return result;\n"}),m7={kernelName:wR,backendName:"webgl",kernelFunc:f7};const g7={kernelName:SR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{axis:a,keepDims:i}=r,s=o.shape.length,c=[],l=HE(a,o.shape);let u=l;const d=vP(u,s);let h,p=o;if(null!=d&&(p=V4({inputs:{x:o},backend:n,attrs:{perm:d}}),u=bP(u.length,s),c.push(p)),gP("prod",u,s),n.shouldExecuteOnCPU([p])){const e=n.texData.get(p.dataId).values,{outVals:t,outShape:r,outDtype:o}=y3(p.shape,p.dtype,e,u);h=n.makeTensorInfo(r,o,t)}else{const[e,t]=fP(p.shape,u),r=zE(t),a=O4({inputs:{x:p},backend:n,attrs:{shape:[-1,r]}}),i=L4(a,_D(o.dtype),"prod",n);h=O4({inputs:{x:i},backend:n,attrs:{shape:e}}),c.push(a),c.push(i)}if(i){c.push(h);const e=mP(h.shape,l);h=O4({inputs:{x:h},backend:n,attrs:{shape:e}})}return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),h}};const v7={kernelName:IR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:o,paramsDenseValues:a,indices:i}=t,{outputRaggedRank:s}=r,c=o.map((e=>n.readSync(e.dataId))),l=o.map((e=>e.shape)),u=n.readSync(a.dataId),d=n.readSync(i.dataId),[h,p,f]=b3(c,l,u,a.shape,a.dtype,d,i.shape,s),m=h.map((e=>n.makeTensorInfo([e.length],"int32",e))),g=n.makeTensorInfo(f,a.dtype,p);return m.concat([g])}};const y7={kernelName:CR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:o,deltas:a}=t,i=n.readSync(r.dataId),s=n.readSync(o.dataId),c=n.readSync(a.dataId),[l,u]=x3(i,r.shape,r.dtype,s,o.shape,c,a.shape);return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([u.length],r.dtype,u)]}};const b7={kernelName:AR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:o,values:a,defaultValue:i,rowPartitionTensors:s}=t,{rowPartitionTypes:c}=r,l=n.readSync(o.dataId),u=n.readSync(a.dataId),d=n.readSync(i.dataId),h=s.map((e=>n.readSync(e.dataId))),p=s.map((e=>e.shape)),[f,m]=w3(l,o.shape,u,a.shape,a.dtype,d,i.shape,h,p,c);return n.makeTensorInfo(f,a.dtype,m)}},x7=e=>{const{backend:t,attrs:n}=e,{start:r,stop:o,step:a,dtype:i}=n,s=k3(r,o,a,i);return t.makeTensorInfo([s.length],i,s)},w7={kernelName:ER,backendName:"webgl",kernelFunc:x7},k7=S4({opSnippet:"return 1.0 / x;"}),S7={kernelName:NR,backendName:"webgl",kernelFunc:k7},I7=S4({opSnippet:J3+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),C7={kernelName:RR,backendName:"webgl",kernelFunc:I7},A7=S4({opSnippet:J3+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),E7={kernelName:PR,backendName:"webgl",kernelFunc:A7};class T7{constructor(e,t,n,r,o){this.variableNames=["A"],this.outputShape=[];const[a,i,s,c]=e;this.outputShape=[a,t,n,c];const l=[r&&t>1?i-1:i,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];let d;d=o?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(i,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class N7{constructor(e,t,n,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,i,s,c]=e;this.outputShape=[a,t,n,c];const l=[r&&t>1?i-1:i,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];let d;d=o?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],",\n          ").concat(l[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(i,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}const R7={kernelName:FR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:o}=t,{alignCorners:a,halfPixelCenters:i,size:s}=r,[c,l]=s,u=mT().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new N7(o.shape,c,l,a,i):new T7(o.shape,c,l,a,i);return n.runWebGLProgram(u,[o],"float32")}};class _7{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,o]=t,[,a,i]=e,s=[n&&a>1?r-1:r,n&&i>1?o-1:o],c=[n&&a>1?a-1:a,n&&i>1?i-1:i],l=s[0]/c[0],u=s[1]/c[1],d=1/l,h=1/u,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(a,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(i,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(r-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const D7={kernelName:MR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:o,dy:a}=t,{alignCorners:i}=r,s=new _7(a.shape,o.shape,i);return n.runWebGLProgram(s,[a],a.dtype)}};class O7{constructor(e,t,n,r,o){this.variableNames=["A"],this.outputShape=[];const[a,i,s,c]=e;this.outputShape=[a,t,n,c];const l=[r&&t>1?i-1:i,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0";let h;h=o?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(i,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class F7{constructor(e,t,n,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,i,s,c]=e;this.outputShape=[a,t,n,c];const l=[r&&t>1?i-1:i,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0";let h;h=o?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],",\n          ").concat(l[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(i,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}const M7={kernelName:DR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:o}=t,{alignCorners:a,halfPixelCenters:i,size:s}=r,[c,l]=s,u=mT().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new F7(o.shape,c,l,a,i):new O7(o.shape,c,l,a,i);return n.runWebGLProgram(u,[o],o.dtype)}};class P7{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,o]=t,[,a,i]=e,s=[n&&a>1?r-1:r,n&&i>1?o-1:o],c=[n&&a>1?a-1:a,n&&i>1?i-1:i],l=s[0]/c[0],u=s[1]/c[1],d=1/l,h=1/u,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(a,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(i,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(s[0],") *\n                (float(dyR) / float(").concat(c[0],"));\n\n            float sourceFracCol =\n                float(").concat(s[1],") *\n                  (float(dyC) / float(").concat(c[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const L7={kernelName:OR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:o,dy:a}=t,{alignCorners:i}=r,s=new P7(a.shape,o.shape,i);return n.runWebGLProgram(s,[a],a.dtype)}};class z7{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      "));const r=e.map(((n,r)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(r))).join(","),o=w2(n);this.userCode="\n      void main() {\n        ".concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(r,"));\n      }\n    ")}}class B7{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;const r=V3("rc",n),o="".concat(r[n-1]," + 1 < ").concat(this.outputShape[n-1]),a="".concat(r[n-2]," + 1 < ").concat(this.outputShape[n-2]),i=w2(n);function s(n){const r=e.map(((r,o)=>function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - ").concat(r[n]," - 1"):"".concat(r[n])}(o,n))),o=r.join(","),a=r.slice(-2).join(",");return"getChannel(getX(".concat(o,"), vec2(").concat(a,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(o,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(i," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return s(e)}(r.slice()),";\n          if(").concat(o,"){\n            result.g = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice()),";\n          }\n          if(").concat(a,") {\n            result.b = ").concat(function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice()),";\n            if(").concat(o,") {\n              result.a = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}const U7={kernelName:LR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{dims:a}=r,i=o.shape.length,s=HE(a,o.shape);if(0===i)return h4({inputs:{x:o},backend:n});const c=mT().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new B7(o.shape,s):new z7(o.shape,s);return n.runWebGLProgram(c,[o],o.dtype)}};class W7{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],r=e[2];this.outputShape=e;let o="";o="number"===typeof t?"float outputValue = ".concat(t.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(o,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const j7={kernelName:E_,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:o}=t,{radians:a,fillValue:i,center:s}=n,c=r,l=new W7(o.shape,i),[u,d]=Ez(s,o.shape[1],o.shape[2]),h=[[u,d,Math.sin(a),Math.cos(a)]];return c.runWebGLProgram(l,[o],o.dtype,h)}},V7=S4({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),G7={kernelName:zR,backendName:"webgl",kernelFunc:V7},H7=S4({opSnippet:"return inversesqrt(x);",cpuKernelImpl:S3}),q7={kernelName:BR,backendName:"webgl",kernelFunc:H7};class K7{constructor(e,t,n,r,o,a){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const s=w2(o.length),c=w2(a.length);let l="";1===n?l="i":2===n&&(l="i, j");const u="getIndices(".concat(l,")");let d="";1===r?d="i":2===r&&(d="i, coords[1]");const h="getUpdates(".concat(d,")");let p="";i&&(p="coords[0], coords[1]");const f="getDefaultValue(".concat(p,")"),m=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(o,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(u,");\n              flattenedIndex += index * ").concat(m,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(f,", sum, float(found)));\n        }\n      ")}}class X7{constructor(e,t,n,r,o,a){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const s=w2(o.length),c=w2(a.length);let l="";1===n?l="i":2===n&&(l="i, j");const u="getIndices(".concat(l,")");let d="";1===r?d="i":2===r&&(d="i, coords[1]");const h="getUpdates(".concat(d,")");let p="";i&&(p="coords[0], coords[1]");const f="getDefaultValue(".concat(p,")"),m=t>1?"strides[j]":"strides",g=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(o,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(u,");\n              flattenedIndex += index.xz * ").concat(m,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(g,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(h,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(f,", sum, found));\n        }\n      ")}}const Y7={kernelName:UR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:o,updates:a}=t,{shape:i}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=Pz(0,o,i),h=[d/l,l];if(0===d)return n.makeTensorInfo(i,o.dtype);const p=O4({inputs:{x:o},backend:n,attrs:{shape:[c,s]}}),f=O4({inputs:{x:a},backend:n,attrs:{shape:[c,l]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;g=mT().getBool("WEBGL_PACK")?new X7(c,s,p.shape.length,f.shape.length,u,h):new K7(c,s,p.shape.length,f.shape.length,u,h);const v=n.runWebGLProgram(g,[f,p,m],f.dtype),y=O4({inputs:{x:v},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),y}};class Q7{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const o="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),a=2===mT().getNumber("WEBGL_VERSION")?"while (left < right) {":o,i="left"===r?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(a,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(i," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}const J7={kernelName:jR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:o,values:a}=t,{side:i}=r,s=new Q7(o.shape[0],o.shape[1],a.shape[1],i),c=[[o.shape[1]]];return n.runWebGLProgram(s,[o,a],"int32",c)}};class $7{constructor(e,t,n){let r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)o="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=[];for(let r=0;r<t.length;r++)i.push("".concat(n[r])),r<e&&a.push("".concat(n[r]));r=a.join(),o=i.join()}const a=w2(n);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        float cVal = getC(").concat(r,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(o,"));\n        } else {\n          setOutput(getB(").concat(o,"));\n        }\n      }\n    ")}}const Z7={kernelName:VR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:o,e:a}=t,i=new $7(r.shape.length,o.shape,o.shape.length);return n.runWebGLProgram(i,[r,o,a],RD(o.dtype,a.dtype))}},eee=S4({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(Lz,";\n  float scale = ").concat(zz,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),tee={kernelName:GR,backendName:"webgl",kernelFunc:eee},nee=S4({opSnippet:k4+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:C3}),ree={kernelName:YR,backendName:"webgl",kernelFunc:nee},oee=S4({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),aee={kernelName:XR,backendName:"webgl",kernelFunc:oee},iee=S4({opSnippet:k4+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(u4,"\n  return result;\n")}),see={kernelName:qR,backendName:"webgl",kernelFunc:iee},cee=S4({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),lee={kernelName:KR,backendName:"webgl",kernelFunc:cee},uee=S4({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),dee={kernelName:QR,backendName:"webgl",kernelFunc:uee},hee={kernelName:ZR,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{blockShape:a,paddings:i}=r;ME(o.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const s=a.reduce(((e,t)=>e*t)),c=[[0,0]];c.push(...i);for(let v=1+a.length;v<o.shape.length;++v)c.push([0,0]);const l=[],u=h7({inputs:{x:o},backend:n,attrs:{paddings:c,constantValue:0}}),d=Tz(u.shape,a,s,!1),h=Nz(d.length,a.length,!1),p=Rz(u.shape,a,s,!1),f=O4({inputs:{x:u},backend:n,attrs:{shape:d}}),m=V4({inputs:{x:f},backend:n,attrs:{perm:h}}),g=O4({inputs:{x:m},backend:n,attrs:{shape:p}});return l.push(u),l.push(f),l.push(m),l.forEach((e=>n.disposeIntermediateTensorInfo(e))),g}};const pee={kernelName:n_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:o,denseShape:a,defaultValue:i}=t;if(1!==a.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(a.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==o.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(o.shape));if(0!==i.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));const s=n.readSync(r.dataId),c=n.readSync(o.dataId),l=n.readSync(a.dataId),u=n.readSync(i.dataId)[0],[d,h,p,f,m]=T3(s,r.shape,r.dtype,c,o.dtype,l,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],o.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};const fee={kernelName:r_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:o,newShape:a}=t;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==o.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(o.shape));if(1!==a.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(a.shape));const i=Array.from(n.readSync(o.dataId)),s=n.readSync(r.dataId),c=Array.from(n.readSync(a.dataId)),[l,u,d]=N3(s,r.shape,r.dtype,i,c);return[n.makeTensorInfo(u,r.dtype,l),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}};const mee={kernelName:o_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:o,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==o.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(o.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(a.shape));const i=n.readSync(r.dataId),s=n.readSync(o.dataId),c=n.readSync(a.dataId),[l,u]=R3(i,r.shape,r.dtype,s,c,!0);return n.makeTensorInfo(u,r.dtype,l)}};const gee={kernelName:a_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:o,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==o.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(o.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(a.shape));const i=n.readSync(r.dataId),s=n.readSync(o.dataId),c=n.readSync(a.dataId),[l,u]=R3(i,r.shape,r.dtype,s,c);return n.makeTensorInfo(u,r.dtype,l)}};const vee={kernelName:i_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:o,sparseValues:a,defaultValue:i}=t,{outputShape:s}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:d,outputSize:h}=Pz(0,o,s),p=!1;if("string"===a.dtype){const e=n.bufferSync(o),t=n.bufferSync(a),r=iD(n.readSync(i.dataId)[0]),f=I3(e,t,s,h,u,l,c,d,r,p);return n.makeTensorInfo(s,f.dtype,f.values)}const f=new K7(l,c,o.shape.length,a.shape.length,d,[h,1],p),m=n.runWebGLProgram(f,[a,o,i],a.dtype),g=O4({inputs:{x:m},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(m),g}};const yee={kernelName:e_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{numOrSizeSplits:a,axis:i}=r,s=HE(i,o.shape)[0],c=lB(o,a,s),l=o.shape.length,u=new Array(l).fill(0),d=o.shape.slice();return c.map((e=>{const t=[...d];t[s]=e;const r=B5({inputs:{x:o},backend:n,attrs:{begin:u,size:t}});return u[s]+=e,r}))}},bee="return sqrt(x);",xee=S4({opSnippet:bee,packedOpSnippet:bee,cpuKernelImpl:_3}),wee={kernelName:JR,backendName:"webgl",kernelFunc:xee},kee={kernelName:c_,backendName:"webgl",kernelFunc:S4({opSnippet:"return x * x;"})},See="return (a - b) * (a - b);",Iee=I4({opSnippet:See,packedOpSnippet:See}),Cee={kernelName:s_,backendName:"webgl",kernelFunc:Iee};const Aee={kernelName:l_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t;if("string"!==o.dtype)throw new Error("Input must be of datatype string");const a=CB(n.readSync(o.dataId)),i=D3(a,"string",r);return n.makeTensorInfo(o.shape,"string",i)}};const Eee={kernelName:C_,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e;const{x:o}=t,a=J3+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),i=new Q3(o.shape,a);return r.runWebGLProgram(i,[o],o.dtype)}};class Tee{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,o=w2(n.length),a=w2(n.length);let i="";if(1===r)i="coords * strides + begin";else{let e=0;i=n.map(((t,r)=>(e++,1===n.length?"coords * strides[".concat(r,"] + begin[").concat(r,"]"):"coords[".concat(e-1,"] * strides[").concat(r,"] + begin[").concat(r,"]")))).join(",")}this.userCode="\n      ".concat(o," begin = ").concat(o,"(").concat(e,");\n      ").concat(o," strides = ").concat(o,"(").concat(t,");\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        setOutput(getX(").concat(i,"));\n      }\n    ")}}const Nee={kernelName:u_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{begin:a,end:i,strides:s,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:v,begin:y,end:b,strides:x}=iM(o.shape,a,i,s,c,l,u,d,h);let w;if(m)w=O4({inputs:{x:o},backend:n,attrs:{shape:f}});else if(g||v){ME(o.shape.length>=1,(()=>"Input must have rank at least 1, got: ".concat(o.shape.length)));const e=KF(y,b,x),t=B5({inputs:{x:o},backend:n,attrs:{begin:y,size:e}});w=O4({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{if(n.shouldExecuteOnCPU([o])){const e=n.readSync(o.dataId),t=JO(o.shape,o.dtype,e),r=O3(p,t,x,y);w=n.makeTensorInfo(f,o.dtype,r.values)}else{const e=new Tee(y,x,p);w=n.runWebGLProgram(e,[o],o.dtype)}}const k=O4({inputs:{x:w},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(w),k}};const Ree={kernelName:d_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:o,nGramWidths:a,leftPad:i,rightPad:s,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:d}=t,h=n.readSync(u.dataId),p=n.readSync(d.dataId),[f,m]=F3(h,p,o,a,i,s,c,l);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}};const _ee={kernelName:h_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:o}=r,{input:a,delimiter:i}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));const s=n.readSync(a.dataId),c=n.readSync(i.dataId)[0],[l,u,d]=M3(s,c,o),h=u.length;return[n.makeTensorInfo([h,2],"int32",l),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};const Dee={kernelName:p_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:o}=r,{input:a}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(a.dataId),s=P3(i,o);return n.makeTensorInfo(a.shape,"int32",s)}},Oee=S4({opSnippet:"return tan(x);"}),Fee={kernelName:m_,backendName:"webgl",kernelFunc:Oee},Mee=S4({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),Pee={kernelName:g_,backendName:"webgl",kernelFunc:Mee};const Lee={kernelName:WR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:o,indices:a,updates:i}=t,{}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=Pz(0,a,o.shape),h=[d/l,l];if(0===d)return n.makeTensorInfo(o.shape,a.dtype);const p=O4({inputs:{x:a},backend:n,attrs:{shape:[c,s]}}),f=O4({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),m=O4({inputs:{x:o},backend:n,attrs:{shape:h}}),g=new K7(c,s,p.shape.length,f.shape.length,u,h,!1,!0),v=n.runWebGLProgram(g,[f,p,m],m.dtype),y=O4({inputs:{x:v},backend:n,attrs:{shape:o.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),y}};class zee{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[a]*t[a];this.outputShape=n,this.rank=n.length;const r=w2(this.rank),o=function(e){const t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let o=0;o<e.length;o++)r.push("imod(".concat(n[o],", ").concat(e[o],")"));return r.join()}(e);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}}function Bee(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{reps:a}=r;if("string"===o.dtype||o.shape.length>5){const e=n.readSync(o.dataId),t="string"===o.dtype?e.map((e=>iD(e))):e,r=JO(o.shape,o.dtype,t),i=z3(r,a);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const i=new zee(o.shape,a);return n.runWebGLProgram(i,[o],o.dtype)}const Uee={kernelName:v_,backendName:"webgl",kernelFunc:Bee};class Wee{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class jee{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function Vee(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function Gee(e){let t=1;for(;t<e;)t*=2;return t}const Hee={kernelName:y_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o}=t,{k:a,sorted:i}=r,s=mT().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=mT().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=o.shape,u=l[l.length-1];if(n.shouldExecuteOnCPU([o])||u<s||a>c){const e=n.readSync(o.dataId),[t,r]=B3(e,l,o.dtype,a,i);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===a)return l[l.length-1]=0,[n.makeTensorInfo(l,o.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(1===u)return[o,S9({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const d=n.texData.get(o.dataId),h=null!==d&&d.isPacked,p=h?n.unpackTensor(o):o,f=zE(l)/u,m=O4({inputs:{x:p},attrs:{shape:[f,u]},backend:n});h&&Vee(n,p);const g=Gee(a),v=Gee(u);let y=null;const b=()=>null===y?[m,m]:[m,y],x=(e,t,r)=>{const o=b(),a=new Wee(r),i=[[u],[null===y?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=y;y=n.runWebGLProgram(a,o,"int32",i),Vee(n,s)};for(let C=1;C<g;C*=2){const e=2*C;for(let t=C;t>=1;t/=2)x(e,t,[f,v])}for(let C=v;C>g;C/=2){const e=b(),t=new jee([f,C/2]),r=[[u],[null===y?1:0],[g]],o=y;y=n.runWebGLProgram(t,e,"int32",r),Vee(n,o);const a=g/2,i=2*a;for(let n=a;n>=1;n/=2)x(i,n,y.shape)}let w=y;y=B5({inputs:{x:y},backend:n,attrs:{begin:0,size:[f,a]}}),Vee(n,w);let k=j9({inputs:{x:m,indices:y},backend:n,attrs:{axis:1,batchDims:1}});Vee(n,m);const S=l.slice(0,-1);S.push(a),w=y,y=O4({inputs:{x:y},attrs:{shape:S},backend:n}),Vee(n,w);const I=k;return k=O4({inputs:{x:k},attrs:{shape:S},backend:n}),Vee(n,I),[k,y]}};class qee{constructor(e,t,n,r,o,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const i="nearest"===n?1:2;let s;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(o,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(o,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(i," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}const Kee={kernelName:b_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:o,transforms:a}=t,{interpolation:i,fillMode:s,fillValue:c,outputShape:l}=r,[u,d,h,p]=o.shape,[f,m]=null!=l?l:[d,h],g=new qee(d,h,i,s,c,[u,f,m,p]);return n.runWebGLProgram(g,[o,a],"float32")}};const Xee={kernelName:w_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:o}=n,{x:a}=t;r2(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(a.dataId),{outputValues:s,outputShape:c,indices:l}=W3(i,o,a.shape,a.dtype);return[r.makeTensorInfo(c,a.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}};const Yee={kernelName:k_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:o}=t;let{axis:a}=r;a<0&&(a+=o.shape.length);const i=o,s=i.shape.length,c=o.shape[a],l=new Array(s-1);let u=0;for(let m=0;m<s;m++)m!==a&&(l[u++]=i.shape[m]);const d=[],h=new Array(s).fill(0),p=i.shape.slice();p[a]=1;const f=new Array(c);for(let m=0;m<f.length;m++){h[a]=m;const e=B5({inputs:{x:i},backend:n,attrs:{begin:h,size:p}}),t=O4({inputs:{x:e},backend:n,attrs:{shape:l}});f[m]=t,d.push(e)}return d.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}};class Qee{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,r=e.batchSize,o=e.inSize,a=e.numSegments,i=a*Math.ceil(o/n);this.outputShape=[r,i];const s=4*Math.floor(n/4),c=n%4,l="\n        sumValue += dot(values, segFilter);\n    ";let u="";o%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      "));let d="";o%n>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(a,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(a,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}const Jee={kernelName:S_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:o,segmentIds:a}=t,{numSegments:i}=r,s=o.shape.length,c=[];let l=0;const u=vP([l],s);let d=o;null!=u&&(d=V4({inputs:{x:o},backend:n,attrs:{perm:u}}),c.push(d),l=bP(1,s)[0]);const h=SB(d.shape,l,i),p=zE([d.shape[l]]),f=O4({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});c.push(f);const m=_D(o.dtype),g=(e,t,r,o,a)=>{const i=e.shape[0],s=e.shape[1],l=kB(s,a),u=new Qee({windowSize:l,inSize:s,batchSize:i,numSegments:a},t),d=n.compileAndRun(u,[e,r],o);if(c.push(d),d.shape[1]===a)return d;const h=x7({backend:n,attrs:{start:0,stop:a,step:1,dtype:"float32"}}),p=Bee({inputs:{x:h},backend:n,attrs:{reps:[s/l]}});c.push(h),c.push(p);return g(d,t,p,o,a)},v=O4({inputs:{x:g(f,"unsortedSegmentSum",a,m,i)},backend:n,attrs:{shape:h}});let y=v;if(null!=u){c.push(v);const e=yP(u);y=V4({inputs:{x:y},backend:n,attrs:{perm:e}})}return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),y}},$ee=[q4,X4,Q4,$4,t5,o5,a5,i5,h5,p5,m5,v5,b5,w5,S5,A5,E5,R5,_5,D5,M5,W5,j5,V5,G5,Y5,$5,t6,m4,o6,h6,x6,C6,E6,T6,N6,R6,D6,F6,P6,j6,V6,G6,q6,Y6,$6,Z6,t9,r9,o9,i9,s9,l9,d9,p9,m9,y9,w9,I9,A9,N9,_9,F9,L9,z9,U9,V9,H9,K9,p4,X9,l6,Q9,$9,e8,y4,n8,o8,a8,s8,l8,d8,p8,m8,y8,x8,k8,I8,C8,A8,N8,R8,_8,D8,O8,M8,z8,U8,Y8,D4,J8,Z8,t7,r7,q5,a7,c7,l7,p7,m7,w4,g7,v7,y7,b7,w7,X5,V8,S7,C7,E7,F4,R7,D7,M7,L7,U7,j7,G7,q7,Y7,J7,Z7,tee,ree,aee,see,lee,U5,X8,dee,hee,pee,fee,mee,gee,vee,yee,wee,kee,Cee,Aee,Eee,Nee,Ree,_ee,Dee,q8,j4,Fee,Pee,Lee,Uee,Hee,Kee,G4,Xee,Yee,Jee,s7];for(const n of $ee)z_(n);const Zee=new class{constructor(){this.model=null,this.isModelLoaded=!1}async loadModel(){try{const t={modelUrl:"/Agroscan/model/model.json"};console.log("Loading model from:",t.modelUrl);try{const e=await fetch(t.modelUrl);if(!e.ok)throw new Error("Failed to fetch model: ".concat(e.status," ").concat(e.statusText));console.log("Model file found successfully")}catch(e){throw console.error("Error checking model file:",e),new Error("Model file not found. Please ensure model files are in the correct location.")}this.model=await GH(t.modelUrl),console.log("Model loaded successfully"),console.log("Warming up model...");const n=DP([1,224,224,3]),r=await this.model.predict(n);return console.log("Warmup prediction shape:",r.shape),n.dispose(),r.dispose(),console.log("Model warm-up complete"),this.isModelLoaded=!0,!0}catch(e){throw console.error("Error loading model:",e),this.isModelLoaded=!1,e}}async predict(e){if(!this.isModelLoaded){console.error("Model not loaded. Attempting to load model...");try{await this.loadModel()}catch(t){throw console.error("Failed to load model:",t),new Error("Model not loaded. Please try again later.")}}try{console.log("Preprocessing image...");const t=sO((()=>{const t=jF(e).resizeNearestNeighbor([224,224]).toFloat().div(255).expandDims();return console.log("Preprocessed image shape:",t.shape),t}));console.log("Making prediction...");const n=await this.model.predict(t);console.log("Raw predictions shape:",n.shape);const r=await n.data();return t.dispose(),n.dispose(),console.log("Prediction complete"),r}catch(t){throw console.error("Error making prediction:",t),t}}isModelReady(){return this.isModelLoaded}},ete=["Daun_Tomat_Virus_Mosaicvirus","Daun_Tomat_Virus_Begomovirus","Daun_Tomat_Tungau_Labalaba","Daun_Tomat_Sehat","Daun_Tomat_Jamur_Target_spot","Daun_Tomat_Jamur_Septoria","Daun_Tomat_Jamur_Fulva","Daun_Tomat_Hawar_Tua","Daun_Tomat_Hawar_Muda","Daun_Tomat_Bakteri","Daun_Kentang_Sehat","Daun_Kentang_Hawar_Tua","Daun_Kentang_Hawar_Muda","Daun_Jagung_Sehat","Daun_Jagung_Karat","Daun_Jagung_Jamur","Daun_Jagung_Hawar","Daun_Apel_Sehat","Daun_Apel_Kudis","Daun_Apel_Karat","Daun_Apel_Busuk","Daun_Anggur_Sehat","Daun_Anggur_Hawar","Daun_Anggur_Esca","Daun_Anggur_Busuk"],tte=(e,t)=>{const n={Tomat:{Virus_Mosaicvirus:"Penyakit virus mosaik pada tomat yang menyebabkan bercak-bercak kuning pada daun.",Virus_Begomovirus:"Penyakit virus begomovirus yang menyebabkan daun menguning dan keriting.",Tungau_Labalaba:"Serangan tungau laba-laba yang menyebabkan bercak-bercak putih pada daun.",Sehat:"Tanaman tomat dalam kondisi sehat.",Jamur_Target_spot:"Penyakit bercak target yang disebabkan oleh jamur Corynespora cassiicola.",Jamur_Septoria:"Penyakit bercak septoria yang disebabkan oleh jamur Septoria lycopersici.",Jamur_Fulva:"Penyakit embun tepung yang disebabkan oleh jamur Fulvia fulva.",Hawar_Tua:"Penyakit hawar daun yang sudah parah.",Hawar_Muda:"Penyakit hawar daun pada tahap awal.",Bakteri:"Penyakit bakteri pada tomat."},Kentang:{Sehat:"Tanaman kentang dalam kondisi sehat.",Hawar_Tua:"Penyakit hawar daun yang sudah parah pada kentang.",Hawar_Muda:"Penyakit hawar daun pada tahap awal pada kentang."},Jagung:{Sehat:"Tanaman jagung dalam kondisi sehat.",Karat:"Penyakit karat pada jagung.",Jamur:"Penyakit jamur pada jagung.",Hawar:"Penyakit hawar pada jagung."},Apel:{Sehat:"Tanaman apel dalam kondisi sehat.",Kudis:"Penyakit kudis pada apel.",Karat:"Penyakit karat pada apel.",Busuk:"Penyakit busuk pada apel."},Anggur:{Sehat:"Tanaman anggur dalam kondisi sehat.",Hawar:"Penyakit hawar pada anggur.",Esca:"Penyakit esca pada anggur.",Busuk:"Penyakit busuk pada anggur."}};return n[e]&&n[e][t]?n[e][t]:"Deskripsi untuk ".concat(e," dengan penyakit ").concat(t," tidak tersedia. Silakan konsultasikan dengan ahli pertanian.")},nte=(e,t)=>{const n={Tomat:{Virus_Mosaicvirus:"Gunakan varietas tahan virus. Kontrol vektor virus. Buang tanaman yang terinfeksi.",Virus_Begomovirus:"Gunakan varietas tahan virus. Kontrol vektor virus. Buang tanaman yang terinfeksi.",Tungau_Labalaba:"Gunakan akarisida. Tingkatkan kelembaban. Gunakan predator alami.",Sehat:"Lanjutkan perawatan rutin.",Jamur_Target_spot:"Gunakan fungisida. Buang daun yang terinfeksi. Tingkatkan sirkulasi udara.",Jamur_Septoria:"Gunakan fungisida. Buang daun yang terinfeksi. Hindari penyiraman dari atas.",Jamur_Fulva:"Gunakan fungisida. Buang daun yang terinfeksi. Tingkatkan sirkulasi udara.",Hawar_Tua:"Buang tanaman yang terinfeksi. Gunakan fungisida preventif.",Hawar_Muda:"Gunakan fungisida. Buang daun yang terinfeksi.",Bakteri:"Gunakan bakterisida. Buang bagian yang terinfeksi."},Kentang:{Sehat:"Lanjutkan perawatan rutin.",Hawar_Tua:"Buang tanaman yang terinfeksi. Gunakan fungisida preventif.",Hawar_Muda:"Gunakan fungisida. Buang daun yang terinfeksi."},Jagung:{Sehat:"Lanjutkan perawatan rutin.",Karat:"Gunakan fungisida. Gunakan varietas tahan.",Jamur:"Gunakan fungisida. Buang bagian yang terinfeksi.",Hawar:"Gunakan fungisida. Buang daun yang terinfeksi."},Apel:{Sehat:"Lanjutkan perawatan rutin.",Kudis:"Gunakan fungisida. Buang daun yang terinfeksi.",Karat:"Gunakan fungisida. Buang daun yang terinfeksi.",Busuk:"Buang buah yang terinfeksi. Gunakan fungisida."},Anggur:{Sehat:"Lanjutkan perawatan rutin.",Hawar:"Gunakan fungisida. Buang daun yang terinfeksi.",Esca:"Potong bagian yang terinfeksi. Gunakan fungisida.",Busuk:"Buang buah yang terinfeksi. Gunakan fungisida."}};return n[e]&&n[e][t]?n[e][t]:"Untuk penanganan ".concat(e," dengan penyakit ").concat(t,", silakan konsultasikan dengan ahli pertanian untuk mendapatkan rekomendasi yang tepat.")};const rte=function(){const[e,t]=(0,i.useState)(null),[n,r]=(0,i.useState)(null),[o,a]=(0,i.useState)(!1),[s,c]=(0,i.useState)(null),[l,u]=(0,i.useState)(null),d=(0,i.useRef)(),h=(0,i.useRef)(),[p,f]=(0,i.useState)(!1),{currentUser:m}=aw(),g=()=>{d.current.click()};return(0,Be.jsx)(ZC,{maxWidth:"sm",sx:{py:6,minHeight:"80vh"},children:(0,Be.jsxs)(PS,{elevation:2,sx:{borderRadius:4,p:{xs:3,md:5},mt:4,boxShadow:2},children:[(0,Be.jsx)(aS,{variant:"h5",align:"center",sx:{fontWeight:800,color:"#219653",mb:2},children:"Scan Tanaman"}),(0,Be.jsx)(aS,{align:"center",sx:{color:"#555",mb:3},children:"Unggah gambar tanaman Anda untuk mendapatkan diagnosis cepat tentang kesehatan dan kebutuhan nutrisinya."}),p?(0,Be.jsxs)(ww,{sx:{textAlign:"center",mb:2},children:[(0,Be.jsx)(EE(),{audio:!1,ref:h,screenshotFormat:"image/jpeg",videoConstraints:{facingMode:"environment"},style:{width:"100%",borderRadius:8}}),(0,Be.jsxs)(HA,{direction:"row",spacing:2,justifyContent:"center",sx:{mt:2},children:[(0,Be.jsx)(aI,{onClick:()=>{const e=h.current.getScreenshot();e&&fetch(e).then((e=>e.blob())).then((n=>{const o=new File([n],"capture.jpg",{type:"image/jpeg"});t(o),r(e),f(!1),u(null),c(null)}))},variant:"contained",sx:{bgcolor:"#219653",color:"white",fontWeight:800,borderRadius:3},children:"Ambil Gambar"}),(0,Be.jsx)(aI,{onClick:()=>{f(!1)},variant:"outlined",sx:{fontWeight:700,borderRadius:3},children:"Batal"})]})]}):(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsx)(ww,{sx:{width:"100%",maxWidth:340,height:180,border:"2px dashed #219653",borderRadius:3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"#F7F9FA",cursor:"pointer",mb:3,mx:"auto",position:"relative",overflow:"hidden",transition:"border 0.2s","&:hover":{borderColor:"#17643b"}},onClick:g,children:n?(0,Be.jsx)(ww,{component:"img",src:n,alt:"Preview",sx:{width:"100%",height:"100%",objectFit:"cover",borderRadius:2}}):(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsx)(CE.A,{sx:{fontSize:60,color:"#219653",mb:1}}),(0,Be.jsxs)(aS,{color:"text.secondary",sx:{fontSize:15},children:["Seret & lepas gambar di sini, atau ",(0,Be.jsx)("span",{style:{color:"#219653",fontWeight:700},children:"Pilih File"})]})]})}),(0,Be.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const n=e.target.files[0];if(n){const e=(e=>["image/jpeg","image/png","image/jpg"].includes(e.type)?e.size>5242880?"Image size should be less than 5MB":null:"Please upload a valid image file (JPEG, PNG)")(n);if(e)return void c(e);t(n),r(URL.createObjectURL(n)),c(null),u(null)}},style:{display:"none"},ref:d}),s&&(0,Be.jsx)(iE,{severity:"error",sx:{width:"100%",mb:2},children:s}),(0,Be.jsxs)(HA,{direction:"row",spacing:2,justifyContent:"center",sx:{mt:2,mb:1},children:[(0,Be.jsx)(aI,{variant:"outlined",startIcon:(0,Be.jsx)(AC.A,{}),onClick:()=>{f(!0),c(null),u(null)},sx:{fontWeight:700,borderRadius:3},children:"Ambil Foto"}),(0,Be.jsx)(aI,{variant:"contained",startIcon:(0,Be.jsx)(CE.A,{}),onClick:g,sx:{bgcolor:"#219653",color:"white",fontWeight:800,borderRadius:3,"&:hover":{bgcolor:"#17643b"}},children:"Upload Gambar"})]})]}),(0,Be.jsx)(aI,{variant:"contained",size:"large",sx:{bgcolor:"#219653",color:"white",fontWeight:800,borderRadius:3,px:4,py:1.5,mt:2,mb:1,fontSize:16,"&:hover":{bgcolor:"#17643b"}},onClick:async()=>{if(e)if(m){a(!0),c(null),u(null);try{const r=await(t=e,new Promise(((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=t=>{const r=new Image;r.src=t.target.result,r.onload=()=>{const t=document.createElement("canvas");let n=r.width,o=r.height;const a=800;n>o&&n>a?(o=Math.round(o*a/n),n=a):o>a&&(n=Math.round(n*a/o),o=a),t.width=n,t.height=o,t.getContext("2d").drawImage(r,0,0,n,o);const i=t.toDataURL("image/jpeg",.7);e(i)},r.onerror=n},r.onerror=n}))),o=await(async e=>{try{Zee.isModelReady()||await Zee.loadModel();const t=document.createElement("img");t.src=URL.createObjectURL(e),await new Promise((e=>{t.onload=e}));const n=await Zee.predict(t),r=Math.max(...n),o=n.indexOf(r),a=ete[o].split("_"),i=a[1],s=a.slice(2).join("_");return{plant:i,disease:s,confidence:Math.round(100*r),description:tte(i,s),treatment:nte(i,s)}}catch(s){throw console.error("Error in classification:",s),s}})(e);try{await Lm(Df(nw,"scans"),{userId:m.uid,image:r,result:o,timestamp:Um()})}catch(n){n.message&&n.message.includes("longer than 1048487 bytes")?c("Gagal menyimpan hasil scan: Ukuran gambar terlalu besar untuk Firestore."):c("Analisis selesai tetapi gagal menyimpan hasil ke riwayat. Silakan coba lagi.")}u(o)}catch(Dse){Dse.message.includes("Failed to classify")||Dse.message.includes("Gagal memproses gambar")?c(Dse.message):c("Gagal menganalisis gambar atau memproses. Silakan coba lagi.")}finally{a(!1)}var t}else c("Silakan login untuk menganalisis gambar");else c("Silakan pilih gambar terlebih dahulu")},disabled:!e||o,children:o?(0,Be.jsx)(IE,{size:24,color:"inherit"}):"Lakukan Scan"}),l&&(0,Be.jsxs)(PS,{elevation:1,sx:{bgcolor:"#F7F9FA",borderRadius:3,p:3,mt:3,textAlign:"center",boxShadow:0},children:[(0,Be.jsxs)(aS,{variant:"subtitle1",sx:{fontWeight:700,color:"#219653",mb:1},children:["Hasil Deteksi: ",l.disease]}),(0,Be.jsxs)(aS,{sx:{color:"#555",mb:1},children:["Akurasi: ",l.confidence,"%"]}),(0,Be.jsx)(aS,{sx:{color:"#888",fontSize:15},children:l.description}),(0,Be.jsx)(aS,{sx:{color:"#888",fontSize:15,mt:1},children:l.treatment})]})]})})},ote=(0,hS.A)((0,Be.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function ate(e){return(0,Aw.Ay)("MuiChip",e)}const ite=(0,vw.A)("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),ste=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],cte=(0,Iw.Ay)("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{color:r,iconColor:o,clickable:a,onDelete:i,size:s,variant:c}=n;return[{["& .".concat(ite.avatar)]:t.avatar},{["& .".concat(ite.avatar)]:t["avatar".concat((0,$k.A)(s))]},{["& .".concat(ite.avatar)]:t["avatarColor".concat((0,$k.A)(r))]},{["& .".concat(ite.icon)]:t.icon},{["& .".concat(ite.icon)]:t["icon".concat((0,$k.A)(s))]},{["& .".concat(ite.icon)]:t["iconColor".concat((0,$k.A)(o))]},{["& .".concat(ite.deleteIcon)]:t.deleteIcon},{["& .".concat(ite.deleteIcon)]:t["deleteIcon".concat((0,$k.A)(s))]},{["& .".concat(ite.deleteIcon)]:t["deleteIconColor".concat((0,$k.A)(r))]},{["& .".concat(ite.deleteIcon)]:t["deleteIcon".concat((0,$k.A)(c),"Color").concat((0,$k.A)(r))]},t.root,t["size".concat((0,$k.A)(s))],t["color".concat((0,$k.A)(r))],a&&t.clickable,a&&"default"!==r&&t["clickableColor".concat((0,$k.A)(r),")")],i&&t.deletable,i&&"default"!==r&&t["deletableColor".concat((0,$k.A)(r))],t[c],t["".concat(c).concat((0,$k.A)(r))]]}})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?t.palette.grey[700]:t.palette.grey[300];return(0,Fe.A)({maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",["&.".concat(ite.disabled)]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},["& .".concat(ite.avatar)]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:r,fontSize:t.typography.pxToRem(12)},["& .".concat(ite.avatarColorPrimary)]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},["& .".concat(ite.avatarColorSecondary)]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},["& .".concat(ite.avatarSmall)]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},["& .".concat(ite.icon)]:(0,Fe.A)({marginLeft:5,marginRight:-6},"small"===n.size&&{fontSize:18,marginLeft:4,marginRight:-4},n.iconColor===n.color&&(0,Fe.A)({color:t.vars?t.vars.palette.Chip.defaultIconColor:r},"default"!==n.color&&{color:"inherit"})),["& .".concat(ite.deleteIcon)]:(0,Fe.A)({WebkitTapHighlightColor:"transparent",color:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / 0.26)"):(0,Sw.X4)(t.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / 0.4)"):(0,Sw.X4)(t.palette.text.primary,.4)}},"small"===n.size&&{fontSize:16,marginRight:4,marginLeft:-4},"default"!==n.color&&{color:t.vars?"rgba(".concat(t.vars.palette[n.color].contrastTextChannel," / 0.7)"):(0,Sw.X4)(t.palette[n.color].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[n.color].contrastText}})},"small"===n.size&&{height:24},"default"!==n.color&&{backgroundColor:(t.vars||t).palette[n.color].main,color:(t.vars||t).palette[n.color].contrastText},n.onDelete&&{["&.".concat(ite.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.selectedChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):(0,Sw.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},n.onDelete&&"default"!==n.color&&{["&.".concat(ite.focusVisible)]:{backgroundColor:(t.vars||t).palette[n.color].dark}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({},n.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.selectedChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):(0,Sw.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)},["&.".concat(ite.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.selectedChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):(0,Sw.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},"&:active":{boxShadow:(t.vars||t).shadows[1]}},n.clickable&&"default"!==n.color&&{["&:hover, &.".concat(ite.focusVisible)]:{backgroundColor:(t.vars||t).palette[n.color].dark}})}),(e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({},"outlined"===n.variant&&{backgroundColor:"transparent",border:t.vars?"1px solid ".concat(t.vars.palette.Chip.defaultBorder):"1px solid ".concat("light"===t.palette.mode?t.palette.grey[400]:t.palette.grey[700]),["&.".concat(ite.clickable,":hover")]:{backgroundColor:(t.vars||t).palette.action.hover},["&.".concat(ite.focusVisible)]:{backgroundColor:(t.vars||t).palette.action.focus},["& .".concat(ite.avatar)]:{marginLeft:4},["& .".concat(ite.avatarSmall)]:{marginLeft:2},["& .".concat(ite.icon)]:{marginLeft:4},["& .".concat(ite.iconSmall)]:{marginLeft:2},["& .".concat(ite.deleteIcon)]:{marginRight:5},["& .".concat(ite.deleteIconSmall)]:{marginRight:3}},"outlined"===n.variant&&"default"!==n.color&&{color:(t.vars||t).palette[n.color].main,border:"1px solid ".concat(t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / 0.7)"):(0,Sw.X4)(t.palette[n.color].main,.7)),["&.".concat(ite.clickable,":hover")]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,Sw.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity)},["&.".concat(ite.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / ").concat(t.vars.palette.action.focusOpacity,")"):(0,Sw.X4)(t.palette[n.color].main,t.palette.action.focusOpacity)},["& .".concat(ite.deleteIcon)]:{color:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / 0.7)"):(0,Sw.X4)(t.palette[n.color].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[n.color].main}}})})),lte=(0,Iw.Ay)("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{const{ownerState:n}=e,{size:r}=n;return[t.label,t["label".concat((0,$k.A)(r))]]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},"outlined"===t.variant&&{paddingLeft:11,paddingRight:11},"small"===t.size&&{paddingLeft:8,paddingRight:8},"small"===t.size&&"outlined"===t.variant&&{paddingLeft:7,paddingRight:7})}));function ute(e){return"Backspace"===e.key||"Delete"===e.key}const dte=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiChip"}),{avatar:r,className:o,clickable:a,color:s="default",component:c,deleteIcon:l,disabled:u=!1,icon:d,label:h,onClick:p,onDelete:f,onKeyDown:m,onKeyUp:g,size:v="medium",variant:y="filled",tabIndex:b,skipFocusWhenDisabled:x=!1}=n,w=(0,Me.A)(n,ste),k=i.useRef(null),S=(0,Uw.A)(k,t),I=e=>{e.stopPropagation(),f&&f(e)},C=!(!1===a||!p)||a,A=C||f?Ik:c||"div",E=(0,Fe.A)({},n,{component:A,disabled:u,size:v,color:s,iconColor:i.isValidElement(d)&&d.props.color||s,onDelete:!!f,clickable:C,variant:y}),T=(e=>{const{classes:t,disabled:n,size:r,color:o,iconColor:a,onDelete:i,clickable:s,variant:c}=e,l={root:["root",c,n&&"disabled","size".concat((0,$k.A)(r)),"color".concat((0,$k.A)(o)),s&&"clickable",s&&"clickableColor".concat((0,$k.A)(o)),i&&"deletable",i&&"deletableColor".concat((0,$k.A)(o)),"".concat(c).concat((0,$k.A)(o))],label:["label","label".concat((0,$k.A)(r))],avatar:["avatar","avatar".concat((0,$k.A)(r)),"avatarColor".concat((0,$k.A)(o))],icon:["icon","icon".concat((0,$k.A)(r)),"iconColor".concat((0,$k.A)(a))],deleteIcon:["deleteIcon","deleteIcon".concat((0,$k.A)(r)),"deleteIconColor".concat((0,$k.A)(o)),"deleteIcon".concat((0,$k.A)(c),"Color").concat((0,$k.A)(o))]};return(0,kw.A)(l,ate,t)})(E),N=A===Ik?(0,Fe.A)({component:c||"div",focusVisibleClassName:T.focusVisible},f&&{disableRipple:!0}):{};let R=null;f&&(R=l&&i.isValidElement(l)?i.cloneElement(l,{className:(0,cw.A)(l.props.className,T.deleteIcon),onClick:I}):(0,Be.jsx)(ote,{className:(0,cw.A)(T.deleteIcon),onClick:I}));let _=null;r&&i.isValidElement(r)&&(_=i.cloneElement(r,{className:(0,cw.A)(T.avatar,r.props.className)}));let D=null;return d&&i.isValidElement(d)&&(D=i.cloneElement(d,{className:(0,cw.A)(T.icon,d.props.className)})),(0,Be.jsxs)(cte,(0,Fe.A)({as:A,className:(0,cw.A)(T.root,o),disabled:!(!C||!u)||void 0,onClick:p,onKeyDown:e=>{e.currentTarget===e.target&&ute(e)&&e.preventDefault(),m&&m(e)},onKeyUp:e=>{e.currentTarget===e.target&&(f&&ute(e)?f(e):"Escape"===e.key&&k.current&&k.current.blur()),g&&g(e)},ref:S,tabIndex:x&&u?-1:b,ownerState:E},N,w,{children:[_||D,(0,Be.jsx)(lte,{className:(0,cw.A)(T.label),ownerState:E,children:h}),R]}))})),hte=dte;var pte=n(9120);const fte=function(){const[e,t]=(0,i.useState)([]),[n,r]=(0,i.useState)(!0),[o,a]=(0,i.useState)(null),[s,c]=(0,i.useState)(null),{currentUser:l}=aw();(0,i.useEffect)((()=>{(async()=>{if(l)try{const e=vm(Df(nw,"scans"),function(e,t,n){const r=t,o=pm("where",e);return ym._create(o,r,n)}("userId","==",l.uid));let n=(await Mm(e)).docs.map((e=>ot({id:e.id},e.data())));n=n.sort(((e,t)=>new Date(t.timestamp)-new Date(e.timestamp))),t(n)}catch(Dse){a("Gagal mengambil riwayat.")}finally{r(!1)}else r(!1)})()}),[l]);const u=()=>{c(null)};return l?n?(0,Be.jsx)(ww,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:(0,Be.jsx)(IE,{})}):o?(0,Be.jsx)(ZC,{maxWidth:"sm",sx:{py:6},children:(0,Be.jsx)(iE,{severity:"error",children:o})}):s?(0,Be.jsxs)(ZC,{maxWidth:"sm",sx:{py:6,minHeight:"80vh"},children:[(0,Be.jsxs)(ww,{sx:{display:"flex",alignItems:"center",mb:3},children:[(0,Be.jsx)(dI,{onClick:u,sx:{mr:1},children:(0,Be.jsx)(pte.A,{})}),(0,Be.jsx)(aS,{variant:"h5",sx:{fontWeight:800,color:"#219653"},children:"Detail Scan"})]}),(0,Be.jsxs)(PS,{elevation:2,sx:{p:3,borderRadius:4,boxShadow:2},children:[s.image&&(0,Be.jsx)(ww,{component:"img",src:s.image,alt:"Scan Tanaman Detail",sx:{width:"100%",height:"auto",maxHeight:400,objectFit:"contain",borderRadius:2,mb:2}}),(0,Be.jsxs)(aS,{variant:"h6",sx:{fontWeight:700,color:"#222",mb:1},children:["Penyakit/Hasil: ",s.result.disease]}),(0,Be.jsxs)(aS,{variant:"body1",sx:{color:"#555",mb:1},children:["Akurasi: ",s.result.confidence,"%"]}),(0,Be.jsxs)(aS,{variant:"body2",color:"text.secondary",children:["Tanggal Scan: ",new Date(s.timestamp).toLocaleString()]})]})]}):(0,Be.jsxs)(ZC,{maxWidth:"sm",sx:{py:6,minHeight:"80vh"},children:[(0,Be.jsx)(aS,{variant:"h5",align:"center",sx:{fontWeight:800,color:"#219653",mb:4},children:"Riwayat Scan & Analisis"}),0===e.length?(0,Be.jsxs)(iE,{severity:"info",children:["Belum ada riwayat scan atau analisis.",(0,Be.jsx)("br",{}),(0,Be.jsx)("span",{style:{fontSize:12,color:"#888"},children:"Debug: Pastikan UID user login sama dengan userId di Firestore."})]}):(0,Be.jsx)(ww,{sx:{display:"flex",flexDirection:"column",gap:3},children:e.map(((e,t)=>(0,Be.jsxs)(PS,{elevation:1,sx:{p:2,borderRadius:3,boxShadow:1,display:"flex",alignItems:"center",gap:2},children:[e.image&&(0,Be.jsx)(ww,{component:"img",src:e.image,alt:"Scan Tanaman",sx:{width:70,height:70,objectFit:"cover",borderRadius:1.5,flexShrink:0}}),(0,Be.jsxs)(ww,{sx:{flex:1,display:"flex",flexDirection:"column",minWidth:0},children:[e.result&&e.result.disease&&(0,Be.jsx)(hte,{label:e.result.disease,color:e.result.disease.toLowerCase().includes("sehat")?"success":"warning",sx:{fontWeight:700,fontSize:13,px:1,mb:.5,alignSelf:"flex-start"},size:"small"}),(0,Be.jsxs)(aS,{variant:"caption",color:"text.secondary",sx:{fontSize:12,overflowWrap:"break-word"},children:[e.timestamp&&e.timestamp.toDate?new Date(e.timestamp.toDate()).toLocaleDateString():"Tanggal tidak tersedia",e.result&&"number"===typeof e.result.confidence&&" | Akurasi: ".concat(e.result.confidence,"%")]})]}),(0,Be.jsx)(aI,{variant:"outlined",size:"small",onClick:()=>(e=>{c(e)})(e),sx:{fontWeight:700,borderRadius:2,flexShrink:0},children:"Detail"})]},e.id)))})]}):(0,Be.jsx)(ZC,{maxWidth:"sm",sx:{py:6},children:(0,Be.jsx)(iE,{severity:"info",children:"Silakan login untuk melihat riwayat scan Anda."})})};let mte;function gte(){if(mte)return mte;const e=document.createElement("div"),t=document.createElement("div");return t.style.width="10px",t.style.height="1px",e.appendChild(t),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e),mte="reverse",e.scrollLeft>0?mte="default":(e.scrollLeft=1,0===e.scrollLeft&&(mte="negative")),document.body.removeChild(e),mte}function vte(e,t){const n=e.scrollLeft;if("rtl"!==t)return n;switch(gte()){case"negative":return e.scrollWidth-e.clientWidth+n;case"reverse":return e.scrollWidth-e.clientWidth-n;default:return n}}function yte(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}const bte=["onChange"],xte={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};const wte=(0,hS.A)((0,Be.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),kte=(0,hS.A)((0,Be.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight");function Ste(e){return(0,Aw.Ay)("MuiTabScrollButton",e)}const Ite=(0,vw.A)("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),Cte=["className","slots","slotProps","direction","orientation","disabled"],Ate=(0,Iw.Ay)(Ik,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.orientation&&t[n.orientation]]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({width:40,flexShrink:0,opacity:.8,["&.".concat(Ite.disabled)]:{opacity:0}},"vertical"===t.orientation&&{width:"100%",height:40,"& svg":{transform:"rotate(".concat(t.isRtl?-90:90,"deg)")}})})),Ete=i.forwardRef((function(e,t){var n,r;const o=(0,Cw.b)({props:e,name:"MuiTabScrollButton"}),{className:a,slots:i={},slotProps:s={},direction:c}=o,l=(0,Me.A)(o,Cte),u=He(),d=(0,Fe.A)({isRtl:u},o),h=(e=>{const{classes:t,orientation:n,disabled:r}=e,o={root:["root",n,r&&"disabled"]};return(0,kw.A)(o,Ste,t)})(d),p=null!=(n=i.StartScrollButtonIcon)?n:wte,f=null!=(r=i.EndScrollButtonIcon)?r:kte,m=pI({elementType:p,externalSlotProps:s.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:d}),g=pI({elementType:f,externalSlotProps:s.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:d});return(0,Be.jsx)(Ate,(0,Fe.A)({component:"div",className:(0,cw.A)(h.root,a),ref:t,role:null,ownerState:d,tabIndex:null},l,{children:"left"===c?(0,Be.jsx)(p,(0,Fe.A)({},m)):(0,Be.jsx)(f,(0,Fe.A)({},g))}))})),Tte=Ete;function Nte(e){return(0,Aw.Ay)("MuiTabs",e)}const Rte=(0,vw.A)("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]);var _te=n(2427);const Dte=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","slots","slotProps","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],Ote=(e,t)=>e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:e.firstChild,Fte=(e,t)=>e===t?e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:e.lastChild,Mte=(e,t,n)=>{let r=!1,o=n(e,t);for(;o;){if(o===e.firstChild){if(r)return;r=!0}const t=o.disabled||"true"===o.getAttribute("aria-disabled");if(o.hasAttribute("tabindex")&&!t)return void o.focus();o=n(e,o)}},Pte=(0,Iw.Ay)("div",{name:"MuiTabs",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{["& .".concat(Rte.scrollButtons)]:t.scrollButtons},{["& .".concat(Rte.scrollButtons)]:n.scrollButtonsHideMobile&&t.scrollButtonsHideMobile},t.root,n.vertical&&t.vertical]}})((e=>{let{ownerState:t,theme:n}=e;return(0,Fe.A)({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},t.vertical&&{flexDirection:"column"},t.scrollButtonsHideMobile&&{["& .".concat(Rte.scrollButtons)]:{[n.breakpoints.down("sm")]:{display:"none"}}})})),Lte=(0,Iw.Ay)("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.scroller,n.fixed&&t.fixed,n.hideScrollbar&&t.hideScrollbar,n.scrollableX&&t.scrollableX,n.scrollableY&&t.scrollableY]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},t.fixed&&{overflowX:"hidden",width:"100%"},t.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},t.scrollableX&&{overflowX:"auto",overflowY:"hidden"},t.scrollableY&&{overflowY:"auto",overflowX:"hidden"})})),zte=(0,Iw.Ay)("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.flexContainer,n.vertical&&t.flexContainerVertical,n.centered&&t.centered]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({display:"flex"},t.vertical&&{flexDirection:"column"},t.centered&&{justifyContent:"center"})})),Bte=(0,Iw.Ay)("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(e,t)=>t.indicator})((e=>{let{ownerState:t,theme:n}=e;return(0,Fe.A)({position:"absolute",height:2,bottom:0,width:"100%",transition:n.transitions.create()},"primary"===t.indicatorColor&&{backgroundColor:(n.vars||n).palette.primary.main},"secondary"===t.indicatorColor&&{backgroundColor:(n.vars||n).palette.secondary.main},t.vertical&&{height:"100%",width:2,right:0})})),Ute=(0,Iw.Ay)((function(e){const{onChange:t}=e,n=(0,Me.A)(e,bte),r=i.useRef(),o=i.useRef(null),a=()=>{r.current=o.current.offsetHeight-o.current.clientHeight};return(0,Ak.A)((()=>{const e=(0,cC.A)((()=>{const e=r.current;a(),e!==r.current&&t(r.current)})),n=(0,lC.A)(o.current);return n.addEventListener("resize",e),()=>{e.clear(),n.removeEventListener("resize",e)}}),[t]),i.useEffect((()=>{a(),t(r.current)}),[t]),(0,Be.jsx)("div",(0,Fe.A)({style:xte},n,{ref:o}))}))({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),Wte={};const jte=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiTabs"}),r=OI(),o=He(),{"aria-label":a,"aria-labelledby":s,action:c,centered:l=!1,children:u,className:d,component:h="div",allowScrollButtonsMobile:p=!1,indicatorColor:f="primary",onChange:m,orientation:g="horizontal",ScrollButtonComponent:v=Tte,scrollButtons:y="auto",selectionFollowsFocus:b,slots:x={},slotProps:w={},TabIndicatorProps:k={},TabScrollButtonProps:S={},textColor:I="primary",value:C,variant:A="standard",visibleScrollbar:E=!1}=n,T=(0,Me.A)(n,Dte),N="scrollable"===A,R="vertical"===g,_=R?"scrollTop":"scrollLeft",D=R?"top":"left",O=R?"bottom":"right",F=R?"clientHeight":"clientWidth",M=R?"height":"width",P=(0,Fe.A)({},n,{component:h,allowScrollButtonsMobile:p,indicatorColor:f,orientation:g,vertical:R,scrollButtons:y,textColor:I,variant:A,visibleScrollbar:E,fixed:!N,hideScrollbar:N&&!E,scrollableX:N&&!R,scrollableY:N&&R,centered:l&&!N,scrollButtonsHideMobile:!p}),L=(e=>{const{vertical:t,fixed:n,hideScrollbar:r,scrollableX:o,scrollableY:a,centered:i,scrollButtonsHideMobile:s,classes:c}=e,l={root:["root",t&&"vertical"],scroller:["scroller",n&&"fixed",r&&"hideScrollbar",o&&"scrollableX",a&&"scrollableY"],flexContainer:["flexContainer",t&&"flexContainerVertical",i&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",s&&"scrollButtonsHideMobile"],scrollableX:[o&&"scrollableX"],hideScrollbar:[r&&"hideScrollbar"]};return(0,kw.A)(l,Nte,c)})(P),z=pI({elementType:x.StartScrollButtonIcon,externalSlotProps:w.startScrollButtonIcon,ownerState:P}),B=pI({elementType:x.EndScrollButtonIcon,externalSlotProps:w.endScrollButtonIcon,ownerState:P});const[U,W]=i.useState(!1),[j,V]=i.useState(Wte),[G,H]=i.useState(!1),[q,K]=i.useState(!1),[X,Y]=i.useState(!1),[Q,J]=i.useState({overflow:"hidden",scrollbarWidth:0}),$=new Map,Z=i.useRef(null),ee=i.useRef(null),te=()=>{const e=Z.current;let t,n;if(e){const n=e.getBoundingClientRect();t={clientWidth:e.clientWidth,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,scrollLeftNormalized:vte(e,o?"rtl":"ltr"),scrollWidth:e.scrollWidth,top:n.top,bottom:n.bottom,left:n.left,right:n.right}}if(e&&!1!==C){const e=ee.current.children;if(e.length>0){const t=e[$.get(C)];0,n=t?t.getBoundingClientRect():null}}return{tabsMeta:t,tabMeta:n}},ne=(0,Ww.A)((()=>{const{tabsMeta:e,tabMeta:t}=te();let n,r=0;if(R)n="top",t&&e&&(r=t.top-e.top+e.scrollTop);else if(n=o?"right":"left",t&&e){const a=o?e.scrollLeftNormalized+e.clientWidth-e.scrollWidth:e.scrollLeft;r=(o?-1:1)*(t[n]-e[n]+a)}const a={[n]:r,[M]:t?t[M]:0};if(isNaN(j[n])||isNaN(j[M]))V(a);else{const e=Math.abs(j[n]-a[n]),t=Math.abs(j[M]-a[M]);(e>=1||t>=1)&&V(a)}})),re=function(e){let{animation:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t?function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>{};const{ease:a=yte,duration:i=300}=r;let s=null;const c=t[e];let l=!1;const u=()=>{l=!0},d=r=>{if(l)return void o(new Error("Animation cancelled"));null===s&&(s=r);const u=Math.min(1,(r-s)/i);t[e]=a(u)*(n-c)+c,u>=1?requestAnimationFrame((()=>{o(null)})):requestAnimationFrame(d)};c===n?o(new Error("Element already at target position")):requestAnimationFrame(d)}(_,Z.current,e,{duration:r.transitions.duration.standard}):Z.current[_]=e},oe=e=>{let t=Z.current[_];R?t+=e:(t+=e*(o?-1:1),t*=o&&"reverse"===gte()?-1:1),re(t)},ae=()=>{const e=Z.current[F];let t=0;const n=Array.from(ee.current.children);for(let r=0;r<n.length;r+=1){const o=n[r];if(t+o[F]>e){0===r&&(t=e);break}t+=o[F]}return t},ie=()=>{oe(-1*ae())},se=()=>{oe(ae())},ce=i.useCallback((e=>{J({overflow:null,scrollbarWidth:e})}),[]),le=(0,Ww.A)((e=>{const{tabsMeta:t,tabMeta:n}=te();if(n&&t)if(n[D]<t[D]){const r=t[_]+(n[D]-t[D]);re(r,{animation:e})}else if(n[O]>t[O]){const r=t[_]+(n[O]-t[O]);re(r,{animation:e})}})),ue=(0,Ww.A)((()=>{N&&!1!==y&&Y(!X)}));i.useEffect((()=>{const e=(0,cC.A)((()=>{Z.current&&ne()}));let t;const n=n=>{n.forEach((e=>{e.removedNodes.forEach((e=>{var n;null==(n=t)||n.unobserve(e)})),e.addedNodes.forEach((e=>{var n;null==(n=t)||n.observe(e)}))})),e(),ue()},r=(0,lC.A)(Z.current);let o;return r.addEventListener("resize",e),"undefined"!==typeof ResizeObserver&&(t=new ResizeObserver(e),Array.from(ee.current.children).forEach((e=>{t.observe(e)}))),"undefined"!==typeof MutationObserver&&(o=new MutationObserver(n),o.observe(ee.current,{childList:!0})),()=>{var n,a;e.clear(),r.removeEventListener("resize",e),null==(n=o)||n.disconnect(),null==(a=t)||a.disconnect()}}),[ne,ue]),i.useEffect((()=>{const e=Array.from(ee.current.children),t=e.length;if("undefined"!==typeof IntersectionObserver&&t>0&&N&&!1!==y){const n=e[0],r=e[t-1],o={root:Z.current,threshold:.99},a=new IntersectionObserver((e=>{H(!e[0].isIntersecting)}),o);a.observe(n);const i=new IntersectionObserver((e=>{K(!e[0].isIntersecting)}),o);return i.observe(r),()=>{a.disconnect(),i.disconnect()}}}),[N,y,X,null==u?void 0:u.length]),i.useEffect((()=>{W(!0)}),[]),i.useEffect((()=>{ne()})),i.useEffect((()=>{le(Wte!==j)}),[le,j]),i.useImperativeHandle(c,(()=>({updateIndicator:ne,updateScrollButtons:ue})),[ne,ue]);const de=(0,Be.jsx)(Bte,(0,Fe.A)({},k,{className:(0,cw.A)(L.indicator,k.className),ownerState:P,style:(0,Fe.A)({},j,k.style)}));let he=0;const pe=i.Children.map(u,(e=>{if(!i.isValidElement(e))return null;const t=void 0===e.props.value?he:e.props.value;$.set(t,he);const n=t===C;return he+=1,i.cloneElement(e,(0,Fe.A)({fullWidth:"fullWidth"===A,indicator:n&&!U&&de,selected:n,selectionFollowsFocus:b,onChange:m,textColor:I,value:t},1!==he||!1!==C||e.props.tabIndex?{}:{tabIndex:0}))})),fe=(()=>{const e={};e.scrollbarSizeListener=N?(0,Be.jsx)(Ute,{onChange:ce,className:(0,cw.A)(L.scrollableX,L.hideScrollbar)}):null;const t=N&&("auto"===y&&(G||q)||!0===y);return e.scrollButtonStart=t?(0,Be.jsx)(v,(0,Fe.A)({slots:{StartScrollButtonIcon:x.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:z},orientation:g,direction:o?"right":"left",onClick:ie,disabled:!G},S,{className:(0,cw.A)(L.scrollButtons,S.className)})):null,e.scrollButtonEnd=t?(0,Be.jsx)(v,(0,Fe.A)({slots:{EndScrollButtonIcon:x.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:B},orientation:g,direction:o?"left":"right",onClick:se,disabled:!q},S,{className:(0,cw.A)(L.scrollButtons,S.className)})):null,e})();return(0,Be.jsxs)(Pte,(0,Fe.A)({className:(0,cw.A)(L.root,d),ownerState:P,ref:t,as:h},T,{children:[fe.scrollButtonStart,fe.scrollbarSizeListener,(0,Be.jsxs)(Lte,{className:L.scroller,ownerState:P,style:{overflow:Q.overflow,[R?"margin".concat(o?"Left":"Right"):"marginBottom"]:E?void 0:-Q.scrollbarWidth},ref:Z,children:[(0,Be.jsx)(zte,{"aria-label":a,"aria-labelledby":s,"aria-orientation":"vertical"===g?"vertical":null,className:L.flexContainer,ownerState:P,onKeyDown:e=>{const t=ee.current,n=(0,_te.A)(t).activeElement;if("tab"!==n.getAttribute("role"))return;let r="horizontal"===g?"ArrowLeft":"ArrowUp",a="horizontal"===g?"ArrowRight":"ArrowDown";switch("horizontal"===g&&o&&(r="ArrowRight",a="ArrowLeft"),e.key){case r:e.preventDefault(),Mte(t,n,Fte);break;case a:e.preventDefault(),Mte(t,n,Ote);break;case"Home":e.preventDefault(),Mte(t,null,Ote);break;case"End":e.preventDefault(),Mte(t,null,Fte)}},ref:ee,role:"tablist",children:pe}),U&&de]}),fe.scrollButtonEnd]}))})),Vte=jte;function Gte(e){return(0,Aw.Ay)("MuiTab",e)}const Hte=(0,vw.A)("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]),qte=["className","disabled","disableFocusRipple","fullWidth","icon","iconPosition","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"],Kte=(0,Iw.Ay)(Ik,{name:"MuiTab",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.label&&n.icon&&t.labelIcon,t["textColor".concat((0,$k.A)(n.textColor))],n.fullWidth&&t.fullWidth,n.wrapped&&t.wrapped,{["& .".concat(Hte.iconWrapper)]:t.iconWrapper}]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({},t.typography.button,{maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center"},n.label&&{flexDirection:"top"===n.iconPosition||"bottom"===n.iconPosition?"column":"row"},{lineHeight:1.25},n.icon&&n.label&&{minHeight:72,paddingTop:9,paddingBottom:9,["& > .".concat(Hte.iconWrapper)]:(0,Fe.A)({},"top"===n.iconPosition&&{marginBottom:6},"bottom"===n.iconPosition&&{marginTop:6},"start"===n.iconPosition&&{marginRight:t.spacing(1)},"end"===n.iconPosition&&{marginLeft:t.spacing(1)})},"inherit"===n.textColor&&{color:"inherit",opacity:.6,["&.".concat(Hte.selected)]:{opacity:1},["&.".concat(Hte.disabled)]:{opacity:(t.vars||t).palette.action.disabledOpacity}},"primary"===n.textColor&&{color:(t.vars||t).palette.text.secondary,["&.".concat(Hte.selected)]:{color:(t.vars||t).palette.primary.main},["&.".concat(Hte.disabled)]:{color:(t.vars||t).palette.text.disabled}},"secondary"===n.textColor&&{color:(t.vars||t).palette.text.secondary,["&.".concat(Hte.selected)]:{color:(t.vars||t).palette.secondary.main},["&.".concat(Hte.disabled)]:{color:(t.vars||t).palette.text.disabled}},n.fullWidth&&{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},n.wrapped&&{fontSize:t.typography.pxToRem(12)})})),Xte=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiTab"}),{className:r,disabled:o=!1,disableFocusRipple:a=!1,fullWidth:s,icon:c,iconPosition:l="top",indicator:u,label:d,onChange:h,onClick:p,onFocus:f,selected:m,selectionFollowsFocus:g,textColor:v="inherit",value:y,wrapped:b=!1}=n,x=(0,Me.A)(n,qte),w=(0,Fe.A)({},n,{disabled:o,disableFocusRipple:a,selected:m,icon:!!c,iconPosition:l,label:!!d,fullWidth:s,textColor:v,wrapped:b}),k=(e=>{const{classes:t,textColor:n,fullWidth:r,wrapped:o,icon:a,label:i,selected:s,disabled:c}=e,l={root:["root",a&&i&&"labelIcon","textColor".concat((0,$k.A)(n)),r&&"fullWidth",o&&"wrapped",s&&"selected",c&&"disabled"],iconWrapper:["iconWrapper"]};return(0,kw.A)(l,Gte,t)})(w),S=c&&d&&i.isValidElement(c)?i.cloneElement(c,{className:(0,cw.A)(k.iconWrapper,c.props.className)}):c;return(0,Be.jsxs)(Kte,(0,Fe.A)({focusRipple:!a,className:(0,cw.A)(k.root,r),ref:t,role:"tab","aria-selected":m,disabled:o,onClick:e=>{!m&&h&&h(e,y),p&&p(e)},onFocus:e=>{g&&!m&&h&&h(e,y),f&&f(e)},ownerState:w,tabIndex:m?0:-1},x,{children:["top"===l||"start"===l?(0,Be.jsxs)(i.Fragment,{children:[S,d]}):(0,Be.jsxs)(i.Fragment,{children:[d,S]}),u]}))})),Yte=Xte;var Qte=n(3656),Jte=n(5194),$te=n(5940);const Zte=[{label:"Jenis Tanaman",icon:(0,Be.jsx)(Qte.A,{})},{label:"Penyakit Tanaman",icon:(0,Be.jsx)(Jte.A,{})},{label:"Cara Penanganan",icon:(0,Be.jsx)($te.A,{})}],ene="AIzaSyDDJlg60fGLe4nuuNBaEkoUDmZJ6h9iB0A";const tne=function(){const[e,t]=(0,i.useState)(0),[n,r]=(0,i.useState)([]),[o,a]=(0,i.useState)(!0),[s,c]=(0,i.useState)(null);return(0,i.useEffect)((()=>{(async()=>{a(!0),c(null);try{let t="";switch(e){case 0:t="edukasi jenis tanaman pertanian";break;case 1:t="edukasi penyakit tanaman";break;case 2:t="cara penanganan penyakit tanaman";break;default:t="edukasi pertanian"}const n="".concat("https://www.googleapis.com/youtube/v3","/search?part=snippet&q=").concat(encodeURIComponent(t),"&type=video&maxResults=10&key=").concat(ene),o=await fetch(n);if(!o.ok){const e=await o.text();throw new Error("Gagal mengambil video edukasi: ".concat(o.status," - ").concat(e))}const a=await o.json();r(a.items||[])}catch(Dse){c(Dse.message)}finally{a(!1)}})()}),[e]),(0,Be.jsx)(ZC,{maxWidth:"md",sx:{py:6,minHeight:"80vh"},children:(0,Be.jsxs)(PS,{elevation:2,sx:{borderRadius:4,p:{xs:3,md:5},mt:4,boxShadow:2},children:[(0,Be.jsx)(aS,{variant:"h5",align:"center",sx:{fontWeight:800,color:"#219653",mb:2},children:"Edukasi Pertanian"}),(0,Be.jsx)(aS,{align:"center",sx:{color:"#555",mb:4},children:"Perkaya pengetahuan Anda tentang pertanian dengan artikel edukasi dan panduan informatif kami."}),(0,Be.jsx)(Vte,{value:e,onChange:(e,n)=>t(n),centered:!0,sx:{mb:4},children:Zte.map(((e,t)=>(0,Be.jsx)(Yte,{icon:e.icon,label:e.label},e.label)))}),0===e&&(0,Be.jsxs)(ww,{children:[(0,Be.jsx)(aS,{variant:"h6",sx:{fontWeight:700,mb:3},children:"Video Edukasi Jenis Tanaman"}),o?(0,Be.jsx)(ww,{sx:{display:"flex",justifyContent:"center"},children:(0,Be.jsx)(IE,{})}):s?(0,Be.jsx)(iE,{severity:"error",children:s}):0===n.length?(0,Be.jsx)(iE,{severity:"info",children:"Tidak ada video ditemukan."}):(0,Be.jsx)(kA,{container:!0,spacing:3,children:n.map((e=>(0,Be.jsx)(kA,{item:!0,xs:12,md:6,children:(0,Be.jsx)(ww,{sx:{bgcolor:"#F7F9FA",borderRadius:3,boxShadow:1,p:2},children:(0,Be.jsxs)("a",{href:"https://www.youtube.com/watch?v=".concat(e.id.videoId),target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},children:[(0,Be.jsx)(ww,{component:"img",src:e.snippet.thumbnails.high.url,alt:e.snippet.title,sx:{width:"100%",height:"auto",borderRadius:2,mb:1}}),(0,Be.jsx)(aS,{variant:"subtitle1",sx:{fontWeight:700,color:"#222"},children:e.snippet.title}),(0,Be.jsx)(aS,{variant:"body2",color:"text.secondary",sx:{fontSize:13},children:e.snippet.description})]})})},e.id.videoId)))})]}),1===e&&(0,Be.jsxs)(ww,{children:[(0,Be.jsx)(aS,{variant:"h6",sx:{fontWeight:700,mb:3},children:"Video Edukasi Penyakit Tanaman"}),o?(0,Be.jsx)(ww,{sx:{display:"flex",justifyContent:"center"},children:(0,Be.jsx)(IE,{})}):s?(0,Be.jsx)(iE,{severity:"error",children:s}):0===n.length?(0,Be.jsx)(iE,{severity:"info",children:"Tidak ada video ditemukan."}):(0,Be.jsx)(kA,{container:!0,spacing:3,children:n.map((e=>(0,Be.jsx)(kA,{item:!0,xs:12,md:6,children:(0,Be.jsx)(ww,{sx:{bgcolor:"#F7F9FA",borderRadius:3,boxShadow:1,p:2},children:(0,Be.jsxs)("a",{href:"https://www.youtube.com/watch?v=".concat(e.id.videoId),target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},children:[(0,Be.jsx)(ww,{component:"img",src:e.snippet.thumbnails.high.url,alt:e.snippet.title,sx:{width:"100%",height:"auto",borderRadius:2,mb:1}}),(0,Be.jsx)(aS,{variant:"subtitle1",sx:{fontWeight:700,color:"#222"},children:e.snippet.title}),(0,Be.jsx)(aS,{variant:"body2",color:"text.secondary",sx:{fontSize:13},children:e.snippet.description})]})})},e.id.videoId)))})]}),2===e&&(0,Be.jsxs)(ww,{children:[(0,Be.jsx)(aS,{variant:"h6",sx:{fontWeight:700,mb:3},children:"Video Cara Penanganan"}),o?(0,Be.jsx)(ww,{sx:{display:"flex",justifyContent:"center"},children:(0,Be.jsx)(IE,{})}):s?(0,Be.jsx)(iE,{severity:"error",children:s}):0===n.length?(0,Be.jsx)(iE,{severity:"info",children:"Tidak ada video ditemukan."}):(0,Be.jsx)(kA,{container:!0,spacing:3,children:n.map((e=>(0,Be.jsx)(kA,{item:!0,xs:12,md:6,children:(0,Be.jsx)(ww,{sx:{bgcolor:"#F7F9FA",borderRadius:3,boxShadow:1,p:2},children:(0,Be.jsxs)("a",{href:"https://www.youtube.com/watch?v=".concat(e.id.videoId),target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},children:[(0,Be.jsx)(ww,{component:"img",src:e.snippet.thumbnails.high.url,alt:e.snippet.title,sx:{width:"100%",height:"auto",borderRadius:2,mb:1}}),(0,Be.jsx)(aS,{variant:"subtitle1",sx:{fontWeight:700,color:"#222"},children:e.snippet.title}),(0,Be.jsx)(aS,{variant:"body2",color:"text.secondary",sx:{fontSize:13},children:e.snippet.description})]})})},e.id.videoId)))})]})]})})};var nne=n(5844),rne=n(7868),one=n(3468);const ane=["onChange","maxRows","minRows","style","value"];function ine(e){return parseInt(e,10)||0}const sne={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function cne(e){return function(e){for(const t in e)return!1;return!0}(e)||0===e.outerHeightStyle&&!e.overflowing}const lne=i.forwardRef((function(e,t){const{onChange:n,maxRows:r,minRows:o=1,style:a,value:s}=e,c=(0,Me.A)(e,ane),{current:l}=i.useRef(null!=s),u=i.useRef(null),d=(0,mS.A)(t,u),h=i.useRef(null),p=i.useRef(null),f=i.useCallback((()=>{const t=u.current,n=p.current;if(!t||!n)return;const a=(0,KI.A)(t).getComputedStyle(t);if("0px"===a.width)return{outerHeightStyle:0,overflowing:!1};n.style.width=a.width,n.value=t.value||e.placeholder||"x","\n"===n.value.slice(-1)&&(n.value+=" ");const i=a.boxSizing,s=ine(a.paddingBottom)+ine(a.paddingTop),c=ine(a.borderBottomWidth)+ine(a.borderTopWidth),l=n.scrollHeight;n.value="x";const d=n.scrollHeight;let h=l;o&&(h=Math.max(Number(o)*d,h)),r&&(h=Math.min(Number(r)*d,h)),h=Math.max(h,d);return{outerHeightStyle:h+("border-box"===i?s+c:0),overflowing:Math.abs(h-l)<=1}}),[r,o,e.placeholder]),m=(0,HI.A)((()=>{const e=u.current,t=f();if(!e||!t||cne(t))return!1;const n=t.outerHeightStyle;return null!=h.current&&h.current!==n})),g=i.useCallback((()=>{const e=u.current,t=f();if(!e||!t||cne(t))return;const n=t.outerHeightStyle;h.current!==n&&(h.current=n,e.style.height="".concat(n,"px")),e.style.overflow=t.overflowing?"hidden":""}),[f]),v=i.useRef(-1);(0,xI.A)((()=>{const e=(0,one.A)(g),t=null==u?void 0:u.current;if(!t)return;const n=(0,KI.A)(t);let r;return n.addEventListener("resize",e),"undefined"!==typeof ResizeObserver&&(r=new ResizeObserver((()=>{m()&&(r.unobserve(t),cancelAnimationFrame(v.current),g(),v.current=requestAnimationFrame((()=>{r.observe(t)})))})),r.observe(t)),()=>{e.clear(),cancelAnimationFrame(v.current),n.removeEventListener("resize",e),r&&r.disconnect()}}),[f,g,m]),(0,xI.A)((()=>{g()}));return(0,Be.jsxs)(i.Fragment,{children:[(0,Be.jsx)("textarea",(0,Fe.A)({value:s,onChange:e=>{l||g(),n&&n(e)},ref:d,rows:o,style:a},c)),(0,Be.jsx)("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:p,tabIndex:-1,style:(0,Fe.A)({},sne,a,{paddingTop:0,paddingBottom:0})})]})})),une=lne;function dne(e){let{props:t,states:n,muiFormControl:r}=e;return n.reduce(((e,n)=>(e[n]=t[n],r&&"undefined"===typeof t[n]&&(e[n]=r[n]),e)),{})}const hne=i.createContext(void 0);function pne(){return i.useContext(hne)}var fne=n(869);const mne=function(e){let{styles:t,themeId:n,defaultTheme:r={}}=e;const o=fw(r),a="function"===typeof t?t(n&&o[n]||o):t;return(0,Be.jsx)(fne.A,{styles:a})};const gne=function(e){return(0,Be.jsx)(mne,(0,Fe.A)({},e,{defaultTheme:DI.A,themeId:Je.A}))};function vne(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function yne(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(vne(e.value)&&""!==e.value||t&&vne(e.defaultValue)&&""!==e.defaultValue)}function bne(e){return(0,Aw.Ay)("MuiInputBase",e)}const xne=(0,vw.A)("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),wne=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],kne=(e,t)=>{const{ownerState:n}=e;return[t.root,n.formControl&&t.formControl,n.startAdornment&&t.adornedStart,n.endAdornment&&t.adornedEnd,n.error&&t.error,"small"===n.size&&t.sizeSmall,n.multiline&&t.multiline,n.color&&t["color".concat((0,$k.A)(n.color))],n.fullWidth&&t.fullWidth,n.hiddenLabel&&t.hiddenLabel]},Sne=(e,t)=>{const{ownerState:n}=e;return[t.input,"small"===n.size&&t.inputSizeSmall,n.multiline&&t.inputMultiline,"search"===n.type&&t.inputTypeSearch,n.startAdornment&&t.inputAdornedStart,n.endAdornment&&t.inputAdornedEnd,n.hiddenLabel&&t.inputHiddenLabel]},Ine=(0,Iw.Ay)("div",{name:"MuiInputBase",slot:"Root",overridesResolver:kne})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",["&.".concat(xne.disabled)]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},n.multiline&&(0,Fe.A)({padding:"4px 0 5px"},"small"===n.size&&{paddingTop:1}),n.fullWidth&&{width:"100%"})})),Cne=(0,Iw.Ay)("input",{name:"MuiInputBase",slot:"Input",overridesResolver:Sne})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode,o=(0,Fe.A)({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),a={opacity:"0 !important"},i=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return(0,Fe.A)({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":o,"&::-moz-placeholder":o,"&:-ms-input-placeholder":o,"&::-ms-input-placeholder":o,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},["label[data-shrink=false] + .".concat(xne.formControl," &")]:{"&::-webkit-input-placeholder":a,"&::-moz-placeholder":a,"&:-ms-input-placeholder":a,"&::-ms-input-placeholder":a,"&:focus::-webkit-input-placeholder":i,"&:focus::-moz-placeholder":i,"&:focus:-ms-input-placeholder":i,"&:focus::-ms-input-placeholder":i},["&.".concat(xne.disabled)]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},"small"===n.size&&{paddingTop:1},n.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===n.type&&{MozAppearance:"textfield"})})),Ane=(0,Be.jsx)(gne,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),Ene=i.forwardRef((function(e,t){var n;const r=(0,Cw.b)({props:e,name:"MuiInputBase"}),{"aria-describedby":o,autoComplete:a,autoFocus:s,className:c,components:l={},componentsProps:u={},defaultValue:d,disabled:h,disableInjectingGlobalStyles:p,endAdornment:f,fullWidth:m=!1,id:g,inputComponent:v="input",inputProps:y={},inputRef:b,maxRows:x,minRows:w,multiline:k=!1,name:S,onBlur:I,onChange:C,onClick:A,onFocus:E,onKeyDown:T,onKeyUp:N,placeholder:R,readOnly:_,renderSuffix:D,rows:O,slotProps:F={},slots:M={},startAdornment:P,type:L="text",value:z}=r,B=(0,Me.A)(r,wne),U=null!=y.value?y.value:z,{current:W}=i.useRef(null!=U),j=i.useRef(),V=i.useCallback((e=>{0}),[]),G=(0,Uw.A)(j,b,y.ref,V),[H,q]=i.useState(!1),K=pne();const X=dne({props:r,muiFormControl:K,states:["color","disabled","error","hiddenLabel","size","required","filled"]});X.focused=K?K.focused:H,i.useEffect((()=>{!K&&h&&H&&(q(!1),I&&I())}),[K,h,H,I]);const Y=K&&K.onFilled,Q=K&&K.onEmpty,J=i.useCallback((e=>{yne(e)?Y&&Y():Q&&Q()}),[Y,Q]);(0,Ak.A)((()=>{W&&J({value:U})}),[U,J,W]);i.useEffect((()=>{J(j.current)}),[]);let $=v,Z=y;k&&"input"===$&&(Z=O?(0,Fe.A)({type:void 0,minRows:O,maxRows:O},Z):(0,Fe.A)({type:void 0,maxRows:x,minRows:w},Z),$=une);i.useEffect((()=>{K&&K.setAdornedStart(Boolean(P))}),[K,P]);const ee=(0,Fe.A)({},r,{color:X.color||"primary",disabled:X.disabled,endAdornment:f,error:X.error,focused:X.focused,formControl:K,fullWidth:m,hiddenLabel:X.hiddenLabel,multiline:k,size:X.size,startAdornment:P,type:L}),te=(e=>{const{classes:t,color:n,disabled:r,error:o,endAdornment:a,focused:i,formControl:s,fullWidth:c,hiddenLabel:l,multiline:u,readOnly:d,size:h,startAdornment:p,type:f}=e,m={root:["root","color".concat((0,$k.A)(n)),r&&"disabled",o&&"error",c&&"fullWidth",i&&"focused",s&&"formControl",h&&"medium"!==h&&"size".concat((0,$k.A)(h)),u&&"multiline",p&&"adornedStart",a&&"adornedEnd",l&&"hiddenLabel",d&&"readOnly"],input:["input",r&&"disabled","search"===f&&"inputTypeSearch",u&&"inputMultiline","small"===h&&"inputSizeSmall",l&&"inputHiddenLabel",p&&"inputAdornedStart",a&&"inputAdornedEnd",d&&"readOnly"]};return(0,kw.A)(m,bne,t)})(ee),ne=M.root||l.Root||Ine,re=F.root||u.root||{},oe=M.input||l.Input||Cne;return Z=(0,Fe.A)({},Z,null!=(n=F.input)?n:u.input),(0,Be.jsxs)(i.Fragment,{children:[!p&&Ane,(0,Be.jsxs)(ne,(0,Fe.A)({},re,!Bw(ne)&&{ownerState:(0,Fe.A)({},ee,re.ownerState)},{ref:t,onClick:e=>{j.current&&e.currentTarget===e.target&&j.current.focus(),A&&A(e)}},B,{className:(0,cw.A)(te.root,re.className,c,_&&"MuiInputBase-readOnly"),children:[P,(0,Be.jsx)(hne.Provider,{value:null,children:(0,Be.jsx)(oe,(0,Fe.A)({ownerState:ee,"aria-invalid":X.error,"aria-describedby":o,autoComplete:a,autoFocus:s,defaultValue:d,disabled:X.disabled,id:g,onAnimationStart:e=>{J("mui-auto-fill-cancel"===e.animationName?j.current:{value:"x"})},name:S,placeholder:R,readOnly:_,required:X.required,rows:O,value:U,onKeyDown:T,onKeyUp:N,type:L},Z,!Bw(oe)&&{as:$,ownerState:(0,Fe.A)({},ee,Z.ownerState)},{ref:G,className:(0,cw.A)(te.input,Z.className,_&&"MuiInputBase-readOnly"),onBlur:e=>{I&&I(e),y.onBlur&&y.onBlur(e),K&&K.onBlur?K.onBlur(e):q(!1)},onChange:function(e){if(!W){const t=e.target||j.current;if(null==t)throw new Error((0,rne.A)(1));J({value:t.value})}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];y.onChange&&y.onChange(e,...n),C&&C(e,...n)},onFocus:e=>{X.disabled?e.stopPropagation():(E&&E(e),y.onFocus&&y.onFocus(e),K&&K.onFocus?K.onFocus(e):q(!0))}}))}),f,D?D((0,Fe.A)({},X,{startAdornment:P})):null]}))]})})),Tne=Ene;function Nne(e){return(0,Aw.Ay)("MuiInput",e)}const Rne=(0,Fe.A)({},xne,(0,vw.A)("MuiInput",["root","underline","input"])),_ne=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],Dne=(0,Iw.Ay)(Ine,{shouldForwardProp:e=>(0,jk.A)(e)||"classes"===e,name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...kne(e,t),!n.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:n}=e;let r="light"===t.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r="rgba(".concat(t.vars.palette.common.onBackgroundChannel," / ").concat(t.vars.opacity.inputUnderline,")")),(0,Fe.A)({position:"relative"},n.formControl&&{"label + &":{marginTop:16}},!n.disableUnderline&&{"&::after":{borderBottom:"2px solid ".concat((t.vars||t).palette[n.color].main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},["&.".concat(Rne.focused,":after")]:{transform:"scaleX(1) translateX(0)"},["&.".concat(Rne.error)]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:"1px solid ".concat(r),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},["&:hover:not(.".concat(Rne.disabled,", .").concat(Rne.error,"):before")]:{borderBottom:"2px solid ".concat((t.vars||t).palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(r)}},["&.".concat(Rne.disabled,":before")]:{borderBottomStyle:"dotted"}})})),One=(0,Iw.Ay)(Cne,{name:"MuiInput",slot:"Input",overridesResolver:Sne})({}),Fne=i.forwardRef((function(e,t){var n,r,o,a;const i=(0,Cw.b)({props:e,name:"MuiInput"}),{disableUnderline:s,components:c={},componentsProps:l,fullWidth:u=!1,inputComponent:d="input",multiline:h=!1,slotProps:p,slots:f={},type:m="text"}=i,g=(0,Me.A)(i,_ne),v=(e=>{const{classes:t,disableUnderline:n}=e,r={root:["root",!n&&"underline"],input:["input"]},o=(0,kw.A)(r,Nne,t);return(0,Fe.A)({},t,o)})(i),y={root:{ownerState:{disableUnderline:s}}},b=(null!=p?p:l)?(0,PC.A)(null!=p?p:l,y):y,x=null!=(n=null!=(r=f.root)?r:c.Root)?n:Dne,w=null!=(o=null!=(a=f.input)?a:c.Input)?o:One;return(0,Be.jsx)(Tne,(0,Fe.A)({slots:{root:x,input:w},slotProps:b,fullWidth:u,inputComponent:d,multiline:h,ref:t,type:m},g,{classes:v}))}));Fne.muiName="Input";const Mne=Fne;function Pne(e){return(0,Aw.Ay)("MuiFilledInput",e)}const Lne=(0,Fe.A)({},xne,(0,vw.A)("MuiFilledInput",["root","underline","input"])),zne=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],Bne=(0,Iw.Ay)(Ine,{shouldForwardProp:e=>(0,jk.A)(e)||"classes"===e,name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...kne(e,t),!n.disableUnderline&&t.underline]}})((e=>{let{theme:t,ownerState:n}=e;var r;const o="light"===t.palette.mode,a=o?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",i=o?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",s=o?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",c=o?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return(0,Fe.A)({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:s,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i}},["&.".concat(Lne.focused)]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i},["&.".concat(Lne.disabled)]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:c}},!n.disableUnderline&&{"&::after":{borderBottom:"2px solid ".concat(null==(r=(t.vars||t).palette[n.color||"primary"])?void 0:r.main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},["&.".concat(Lne.focused,":after")]:{transform:"scaleX(1) translateX(0)"},["&.".concat(Lne.error)]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:"1px solid ".concat(t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / ").concat(t.vars.opacity.inputUnderline,")"):a),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},["&:hover:not(.".concat(Lne.disabled,", .").concat(Lne.error,"):before")]:{borderBottom:"1px solid ".concat((t.vars||t).palette.text.primary)},["&.".concat(Lne.disabled,":before")]:{borderBottomStyle:"dotted"}},n.startAdornment&&{paddingLeft:12},n.endAdornment&&{paddingRight:12},n.multiline&&(0,Fe.A)({padding:"25px 12px 8px"},"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9}))})),Une=(0,Iw.Ay)(Cne,{name:"MuiFilledInput",slot:"Input",overridesResolver:Sne})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9},n.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})})),Wne=i.forwardRef((function(e,t){var n,r,o,a;const i=(0,Cw.b)({props:e,name:"MuiFilledInput"}),{components:s={},componentsProps:c,fullWidth:l=!1,inputComponent:u="input",multiline:d=!1,slotProps:h,slots:p={},type:f="text"}=i,m=(0,Me.A)(i,zne),g=(0,Fe.A)({},i,{fullWidth:l,inputComponent:u,multiline:d,type:f}),v=(e=>{const{classes:t,disableUnderline:n}=e,r={root:["root",!n&&"underline"],input:["input"]},o=(0,kw.A)(r,Pne,t);return(0,Fe.A)({},t,o)})(i),y={root:{ownerState:g},input:{ownerState:g}},b=(null!=h?h:c)?(0,PC.A)(y,null!=h?h:c):y,x=null!=(n=null!=(r=p.root)?r:s.Root)?n:Bne,w=null!=(o=null!=(a=p.input)?a:s.Input)?o:Une;return(0,Be.jsx)(Tne,(0,Fe.A)({slots:{root:x,input:w},componentsProps:b,fullWidth:l,inputComponent:u,multiline:d,ref:t,type:f},m,{classes:v}))}));Wne.muiName="Input";const jne=Wne;var Vne;const Gne=["children","classes","className","label","notched"],Hne=(0,Iw.Ay)("fieldset",{shouldForwardProp:jk.A})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),qne=(0,Iw.Ay)("legend",{shouldForwardProp:jk.A})((e=>{let{ownerState:t,theme:n}=e;return(0,Fe.A)({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:n.transitions.create("width",{duration:150,easing:n.transitions.easing.easeOut})},t.withLabel&&(0,Fe.A)({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:n.transitions.create("max-width",{duration:50,easing:n.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:n.transitions.create("max-width",{duration:100,easing:n.transitions.easing.easeOut,delay:50})}))}));function Kne(e){return(0,Aw.Ay)("MuiOutlinedInput",e)}const Xne=(0,Fe.A)({},xne,(0,vw.A)("MuiOutlinedInput",["root","notchedOutline","input"])),Yne=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],Qne=(0,Iw.Ay)(Ine,{shouldForwardProp:e=>(0,jk.A)(e)||"classes"===e,name:"MuiOutlinedInput",slot:"Root",overridesResolver:kne})((e=>{let{theme:t,ownerState:n}=e;const r="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return(0,Fe.A)({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,["&:hover .".concat(Xne.notchedOutline)]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{["&:hover .".concat(Xne.notchedOutline)]:{borderColor:t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / 0.23)"):r}},["&.".concat(Xne.focused," .").concat(Xne.notchedOutline)]:{borderColor:(t.vars||t).palette[n.color].main,borderWidth:2},["&.".concat(Xne.error," .").concat(Xne.notchedOutline)]:{borderColor:(t.vars||t).palette.error.main},["&.".concat(Xne.disabled," .").concat(Xne.notchedOutline)]:{borderColor:(t.vars||t).palette.action.disabled}},n.startAdornment&&{paddingLeft:14},n.endAdornment&&{paddingRight:14},n.multiline&&(0,Fe.A)({padding:"16.5px 14px"},"small"===n.size&&{padding:"8.5px 14px"}))})),Jne=(0,Iw.Ay)((function(e){const{className:t,label:n,notched:r}=e,o=(0,Me.A)(e,Gne),a=null!=n&&""!==n,i=(0,Fe.A)({},e,{notched:r,withLabel:a});return(0,Be.jsx)(Hne,(0,Fe.A)({"aria-hidden":!0,className:t,ownerState:i},o,{children:(0,Be.jsx)(qne,{ownerState:i,children:a?(0,Be.jsx)("span",{children:n}):Vne||(Vne=(0,Be.jsx)("span",{className:"notranslate",children:"\u200b"}))})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})((e=>{let{theme:t}=e;const n="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / 0.23)"):n}})),$ne=(0,Iw.Ay)(Cne,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:Sne})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},"small"===n.size&&{padding:"8.5px 14px"},n.multiline&&{padding:0},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0})})),Zne=i.forwardRef((function(e,t){var n,r,o,a,s;const c=(0,Cw.b)({props:e,name:"MuiOutlinedInput"}),{components:l={},fullWidth:u=!1,inputComponent:d="input",label:h,multiline:p=!1,notched:f,slots:m={},type:g="text"}=c,v=(0,Me.A)(c,Yne),y=(e=>{const{classes:t}=e,n=(0,kw.A)({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Kne,t);return(0,Fe.A)({},t,n)})(c),b=pne(),x=dne({props:c,muiFormControl:b,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),w=(0,Fe.A)({},c,{color:x.color||"primary",disabled:x.disabled,error:x.error,focused:x.focused,formControl:b,fullWidth:u,hiddenLabel:x.hiddenLabel,multiline:p,size:x.size,type:g}),k=null!=(n=null!=(r=m.root)?r:l.Root)?n:Qne,S=null!=(o=null!=(a=m.input)?a:l.Input)?o:$ne;return(0,Be.jsx)(Tne,(0,Fe.A)({slots:{root:k,input:S},renderSuffix:e=>(0,Be.jsx)(Jne,{ownerState:w,className:y.notchedOutline,label:null!=h&&""!==h&&x.required?s||(s=(0,Be.jsxs)(i.Fragment,{children:[h,"\u2009","*"]})):h,notched:"undefined"!==typeof f?f:Boolean(e.startAdornment||e.filled||e.focused)}),fullWidth:u,inputComponent:d,multiline:p,ref:t,type:g},v,{classes:(0,Fe.A)({},y,{notchedOutline:null})}))}));Zne.muiName="Input";const ere=Zne;function tre(e){return(0,Aw.Ay)("MuiFormLabel",e)}const nre=(0,vw.A)("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),rre=["children","className","color","component","disabled","error","filled","focused","required"],ore=(0,Iw.Ay)("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return(0,Fe.A)({},t.root,"secondary"===n.color&&t.colorSecondary,n.filled&&t.filled)}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",["&.".concat(nre.focused)]:{color:(t.vars||t).palette[n.color].main},["&.".concat(nre.disabled)]:{color:(t.vars||t).palette.text.disabled},["&.".concat(nre.error)]:{color:(t.vars||t).palette.error.main}})})),are=(0,Iw.Ay)("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((e=>{let{theme:t}=e;return{["&.".concat(nre.error)]:{color:(t.vars||t).palette.error.main}}})),ire=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiFormLabel"}),{children:r,className:o,component:a="label"}=n,i=(0,Me.A)(n,rre),s=dne({props:n,muiFormControl:pne(),states:["color","required","focused","disabled","error","filled"]}),c=(0,Fe.A)({},n,{color:s.color||"primary",component:a,disabled:s.disabled,error:s.error,filled:s.filled,focused:s.focused,required:s.required}),l=(e=>{const{classes:t,color:n,focused:r,disabled:o,error:a,filled:i,required:s}=e,c={root:["root","color".concat((0,$k.A)(n)),o&&"disabled",a&&"error",i&&"filled",r&&"focused",s&&"required"],asterisk:["asterisk",a&&"error"]};return(0,kw.A)(c,tre,t)})(c);return(0,Be.jsxs)(ore,(0,Fe.A)({as:a,ownerState:c,className:(0,cw.A)(l.root,o),ref:t},i,{children:[r,s.required&&(0,Be.jsxs)(are,{ownerState:c,"aria-hidden":!0,className:l.asterisk,children:["\u2009","*"]})]}))})),sre=ire;function cre(e){return(0,Aw.Ay)("MuiInputLabel",e)}(0,vw.A)("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const lre=["disableAnimation","margin","shrink","variant","className"],ure=(0,Iw.Ay)(sre,{shouldForwardProp:e=>(0,jk.A)(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{["& .".concat(nre.asterisk)]:t.asterisk},t.root,n.formControl&&t.formControl,"small"===n.size&&t.sizeSmall,n.shrink&&t.shrink,!n.disableAnimation&&t.animated,n.focused&&t.focused,t[n.variant]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},n.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===n.size&&{transform:"translate(0, 17px) scale(1)"},n.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!n.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},"filled"===n.variant&&(0,Fe.A)({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(12px, 13px) scale(1)"},n.shrink&&(0,Fe.A)({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===n.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===n.variant&&(0,Fe.A)({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(14px, 9px) scale(1)"},n.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))})),dre=i.forwardRef((function(e,t){const n=(0,Cw.b)({name:"MuiInputLabel",props:e}),{disableAnimation:r=!1,shrink:o,className:a}=n,i=(0,Me.A)(n,lre),s=pne();let c=o;"undefined"===typeof c&&s&&(c=s.filled||s.focused||s.adornedStart);const l=dne({props:n,muiFormControl:s,states:["size","variant","required","focused"]}),u=(0,Fe.A)({},n,{disableAnimation:r,formControl:s,shrink:c,size:l.size,variant:l.variant,required:l.required,focused:l.focused}),d=(e=>{const{classes:t,formControl:n,size:r,shrink:o,disableAnimation:a,variant:i,required:s}=e,c={root:["root",n&&"formControl",!a&&"animated",o&&"shrink",r&&"normal"!==r&&"size".concat((0,$k.A)(r)),i],asterisk:[s&&"asterisk"]},l=(0,kw.A)(c,cre,t);return(0,Fe.A)({},t,l)})(u);return(0,Be.jsx)(ure,(0,Fe.A)({"data-shrink":c,ownerState:u,ref:t,className:(0,cw.A)(d.root,a)},i,{classes:d}))})),hre=dre;function pre(e){return(0,Aw.Ay)("MuiFormControl",e)}(0,vw.A)("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const fre=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],mre=(0,Iw.Ay)("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return(0,Fe.A)({},t.root,t["margin".concat((0,$k.A)(n.margin))],n.fullWidth&&t.fullWidth)}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},"normal"===t.margin&&{marginTop:16,marginBottom:8},"dense"===t.margin&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})})),gre=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiFormControl"}),{children:r,className:o,color:a="primary",component:s="div",disabled:c=!1,error:l=!1,focused:u,fullWidth:d=!1,hiddenLabel:h=!1,margin:p="none",required:f=!1,size:m="medium",variant:g="outlined"}=n,v=(0,Me.A)(n,fre),y=(0,Fe.A)({},n,{color:a,component:s,disabled:c,error:l,fullWidth:d,hiddenLabel:h,margin:p,required:f,size:m,variant:g}),b=(e=>{const{classes:t,margin:n,fullWidth:r}=e,o={root:["root","none"!==n&&"margin".concat((0,$k.A)(n)),r&&"fullWidth"]};return(0,kw.A)(o,pre,t)})(y),[x,w]=i.useState((()=>{let e=!1;return r&&i.Children.forEach(r,(t=>{if(!(0,Ck.A)(t,["Input","Select"]))return;const n=(0,Ck.A)(t,["Select"])?t.props.input:t;n&&n.props.startAdornment&&(e=!0)})),e})),[k,S]=i.useState((()=>{let e=!1;return r&&i.Children.forEach(r,(t=>{(0,Ck.A)(t,["Input","Select"])&&(yne(t.props,!0)||yne(t.props.inputProps,!0))&&(e=!0)})),e})),[I,C]=i.useState(!1);c&&I&&C(!1);const A=void 0===u||c?I:u;let E;const T=i.useMemo((()=>({adornedStart:x,setAdornedStart:w,color:a,disabled:c,error:l,filled:k,focused:A,fullWidth:d,hiddenLabel:h,size:m,onBlur:()=>{C(!1)},onEmpty:()=>{S(!1)},onFilled:()=>{S(!0)},onFocus:()=>{C(!0)},registerEffect:E,required:f,variant:g})),[x,a,c,l,k,A,d,h,E,f,m,g]);return(0,Be.jsx)(hne.Provider,{value:T,children:(0,Be.jsx)(mre,(0,Fe.A)({as:s,ownerState:y,className:(0,cw.A)(b.root,o),ref:t},v,{children:r}))})})),vre=gre;function yre(e){return(0,Aw.Ay)("MuiFormHelperText",e)}const bre=(0,vw.A)("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var xre;const wre=["children","className","component","disabled","error","filled","focused","margin","required","variant"],kre=(0,Iw.Ay)("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.size&&t["size".concat((0,$k.A)(n.size))],n.contained&&t.contained,n.filled&&t.filled]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,["&.".concat(bre.disabled)]:{color:(t.vars||t).palette.text.disabled},["&.".concat(bre.error)]:{color:(t.vars||t).palette.error.main}},"small"===n.size&&{marginTop:4},n.contained&&{marginLeft:14,marginRight:14})})),Sre=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiFormHelperText"}),{children:r,className:o,component:a="p"}=n,i=(0,Me.A)(n,wre),s=dne({props:n,muiFormControl:pne(),states:["variant","size","disabled","error","filled","focused","required"]}),c=(0,Fe.A)({},n,{component:a,contained:"filled"===s.variant||"outlined"===s.variant,variant:s.variant,size:s.size,disabled:s.disabled,error:s.error,filled:s.filled,focused:s.focused,required:s.required}),l=(e=>{const{classes:t,contained:n,size:r,disabled:o,error:a,filled:i,focused:s,required:c}=e,l={root:["root",o&&"disabled",a&&"error",r&&"size".concat((0,$k.A)(r)),n&&"contained",s&&"focused",i&&"filled",c&&"required"]};return(0,kw.A)(l,yre,t)})(c);return(0,Be.jsx)(kre,(0,Fe.A)({as:a,ownerState:c,className:(0,cw.A)(l.root,o),ref:t},i,{children:" "===r?xre||(xre=(0,Be.jsx)("span",{className:"notranslate",children:"\u200b"})):r}))})),Ire=Sre,Cre=XI,Are=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function Ere(e,t,n){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:n?null:e.firstChild}function Tre(e,t,n){return e===t?n?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:n?null:e.lastChild}function Nre(e,t){if(void 0===t)return!0;let n=e.innerText;return void 0===n&&(n=e.textContent),n=n.trim().toLowerCase(),0!==n.length&&(t.repeating?n[0]===t.keys[0]:0===n.indexOf(t.keys.join("")))}function Rre(e,t,n,r,o,a){let i=!1,s=o(e,t,!!t&&n);for(;s;){if(s===e.firstChild){if(i)return!1;i=!0}const t=!r&&(s.disabled||"true"===s.getAttribute("aria-disabled"));if(s.hasAttribute("tabindex")&&Nre(s,a)&&!t)return s.focus(),!0;s=o(e,s,n)}return!1}const _re=i.forwardRef((function(e,t){const{actions:n,autoFocus:r=!1,autoFocusItem:o=!1,children:a,className:s,disabledItemsFocusable:c=!1,disableListWrap:l=!1,onKeyDown:u,variant:d="selectedMenu"}=e,h=(0,Me.A)(e,Are),p=i.useRef(null),f=i.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});(0,Ak.A)((()=>{r&&p.current.focus()}),[r]),i.useImperativeHandle(n,(()=>({adjustStyleForScrollbar:(e,t)=>{let{direction:n}=t;const r=!p.current.style.width;if(e.clientHeight<p.current.clientHeight&&r){const t="".concat(Cre((0,_te.A)(e)),"px");p.current.style["rtl"===n?"paddingLeft":"paddingRight"]=t,p.current.style.width="calc(100% + ".concat(t,")")}return p.current}})),[]);const m=(0,Uw.A)(p,t);let g=-1;i.Children.forEach(a,((e,t)=>{i.isValidElement(e)?(e.props.disabled||("selectedMenu"===d&&e.props.selected||-1===g)&&(g=t),g===t&&(e.props.disabled||e.props.muiSkipListHighlight||e.type.muiSkipListHighlight)&&(g+=1,g>=a.length&&(g=-1))):g===t&&(g+=1,g>=a.length&&(g=-1))}));const v=i.Children.map(a,((e,t)=>{if(t===g){const t={};return o&&(t.autoFocus=!0),void 0===e.props.tabIndex&&"selectedMenu"===d&&(t.tabIndex=0),i.cloneElement(e,t)}return e}));return(0,Be.jsx)(zw,(0,Fe.A)({role:"menu",ref:m,className:s,onKeyDown:e=>{const t=p.current,n=e.key,r=(0,_te.A)(t).activeElement;if("ArrowDown"===n)e.preventDefault(),Rre(t,r,l,c,Ere);else if("ArrowUp"===n)e.preventDefault(),Rre(t,r,l,c,Tre);else if("Home"===n)e.preventDefault(),Rre(t,null,l,c,Ere);else if("End"===n)e.preventDefault(),Rre(t,null,l,c,Tre);else if(1===n.length){const o=f.current,a=n.toLowerCase(),i=performance.now();o.keys.length>0&&(i-o.lastTime>500?(o.keys=[],o.repeating=!0,o.previousKeyMatched=!0):o.repeating&&a!==o.keys[0]&&(o.repeating=!1)),o.lastTime=i,o.keys.push(a);const s=r&&!o.repeating&&Nre(r,o);o.previousKeyMatched&&(s||Rre(t,r,!1,c,Ere,o))?e.preventDefault():o.previousKeyMatched=!1}u&&u(e)},tabIndex:r?0:-1},h,{children:v}))})),Dre=_re,Ore=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Fre(e){return"scale(".concat(e,", ").concat(e**2,")")}const Mre={entering:{opacity:1,transform:Fre(1)},entered:{opacity:1,transform:"none"}},Pre="undefined"!==typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Lre=i.forwardRef((function(e,t){const{addEndListener:n,appear:r=!0,children:o,easing:a,in:s,onEnter:c,onEntered:l,onEntering:u,onExit:d,onExited:h,onExiting:p,style:f,timeout:m="auto",TransitionComponent:g=_I}=e,v=(0,Me.A)(e,Ore),y=(0,ek.A)(),b=i.useRef(),x=OI(),w=i.useRef(null),k=(0,Uw.A)(w,fI(o),t),S=e=>t=>{if(e){const n=w.current;void 0===t?e(n):e(n,t)}},I=S(u),C=S(((e,t)=>{FI(e);const{duration:n,delay:r,easing:o}=MI({style:f,timeout:m,easing:a},{mode:"enter"});let i;"auto"===m?(i=x.transitions.getAutoHeightDuration(e.clientHeight),b.current=i):i=n,e.style.transition=[x.transitions.create("opacity",{duration:i,delay:r}),x.transitions.create("transform",{duration:Pre?i:.666*i,delay:r,easing:o})].join(","),c&&c(e,t)})),A=S(l),E=S(p),T=S((e=>{const{duration:t,delay:n,easing:r}=MI({style:f,timeout:m,easing:a},{mode:"exit"});let o;"auto"===m?(o=x.transitions.getAutoHeightDuration(e.clientHeight),b.current=o):o=t,e.style.transition=[x.transitions.create("opacity",{duration:o,delay:n}),x.transitions.create("transform",{duration:Pre?o:.666*o,delay:Pre?n:n||.333*o,easing:r})].join(","),e.style.opacity=0,e.style.transform=Fre(.75),d&&d(e)})),N=S(h);return(0,Be.jsx)(g,(0,Fe.A)({appear:r,in:s,nodeRef:w,onEnter:C,onEntered:A,onEntering:I,onExit:T,onExited:N,onExiting:E,addEndListener:e=>{"auto"===m&&y.start(b.current||0,e),n&&n(w.current,e)},timeout:"auto"===m?null:m},v,{children:(e,t)=>i.cloneElement(o,(0,Fe.A)({style:(0,Fe.A)({opacity:0,transform:Fre(.75),visibility:"exited"!==e||s?void 0:"hidden"},Mre[e],f,o.props.style),ref:k},t))}))}));Lre.muiSupportAuto=!0;const zre=Lre;function Bre(e){return(0,Aw.Ay)("MuiPopover",e)}(0,vw.A)("MuiPopover",["root","paper"]);const Ure=["onEntering"],Wre=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],jre=["slotProps"];function Vre(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.height/2:"bottom"===t&&(n=e.height),n}function Gre(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.width/2:"right"===t&&(n=e.width),n}function Hre(e){return[e.horizontal,e.vertical].map((e=>"number"===typeof e?"".concat(e,"px"):e)).join(" ")}function qre(e){return"function"===typeof e?e():e}const Kre=(0,Iw.Ay)(sC,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Xre=(0,Iw.Ay)(PS,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Yre=i.forwardRef((function(e,t){var n,r,o;const a=(0,Cw.b)({props:e,name:"MuiPopover"}),{action:s,anchorEl:c,anchorOrigin:l={vertical:"top",horizontal:"left"},anchorPosition:u,anchorReference:d="anchorEl",children:h,className:p,container:f,elevation:m=8,marginThreshold:g=16,open:v,PaperProps:y={},slots:b,slotProps:x,transformOrigin:w={vertical:"top",horizontal:"left"},TransitionComponent:k=zre,transitionDuration:S="auto",TransitionProps:{onEntering:I}={},disableScrollLock:C=!1}=a,A=(0,Me.A)(a.TransitionProps,Ure),E=(0,Me.A)(a,Wre),T=null!=(n=null==x?void 0:x.paper)?n:y,N=i.useRef(),R=(0,Uw.A)(N,T.ref),_=(0,Fe.A)({},a,{anchorOrigin:l,anchorReference:d,elevation:m,marginThreshold:g,externalPaperSlotProps:T,transformOrigin:w,TransitionComponent:k,transitionDuration:S,TransitionProps:A}),D=(e=>{const{classes:t}=e;return(0,kw.A)({root:["root"],paper:["paper"]},Bre,t)})(_),O=i.useCallback((()=>{if("anchorPosition"===d)return u;const e=qre(c),t=(e&&1===e.nodeType?e:(0,_te.A)(N.current).body).getBoundingClientRect();return{top:t.top+Vre(t,l.vertical),left:t.left+Gre(t,l.horizontal)}}),[c,l.horizontal,l.vertical,u,d]),F=i.useCallback((e=>({vertical:Vre(e,w.vertical),horizontal:Gre(e,w.horizontal)})),[w.horizontal,w.vertical]),M=i.useCallback((e=>{const t={width:e.offsetWidth,height:e.offsetHeight},n=F(t);if("none"===d)return{top:null,left:null,transformOrigin:Hre(n)};const r=O();let o=r.top-n.vertical,a=r.left-n.horizontal;const i=o+t.height,s=a+t.width,l=(0,lC.A)(qre(c)),u=l.innerHeight-g,h=l.innerWidth-g;if(null!==g&&o<g){const e=o-g;o-=e,n.vertical+=e}else if(null!==g&&i>u){const e=i-u;o-=e,n.vertical+=e}if(null!==g&&a<g){const e=a-g;a-=e,n.horizontal+=e}else if(s>h){const e=s-h;a-=e,n.horizontal+=e}return{top:"".concat(Math.round(o),"px"),left:"".concat(Math.round(a),"px"),transformOrigin:Hre(n)}}),[c,d,O,F,g]),[P,L]=i.useState(v),z=i.useCallback((()=>{const e=N.current;if(!e)return;const t=M(e);null!==t.top&&(e.style.top=t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,L(!0)}),[M]);i.useEffect((()=>(C&&window.addEventListener("scroll",z),()=>window.removeEventListener("scroll",z))),[c,C,z]);i.useEffect((()=>{v&&z()})),i.useImperativeHandle(s,(()=>v?{updatePosition:()=>{z()}}:null),[v,z]),i.useEffect((()=>{if(!v)return;const e=(0,cC.A)((()=>{z()})),t=(0,lC.A)(c);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}}),[c,v,z]);let B=S;"auto"!==S||k.muiSupportAuto||(B=void 0);const U=f||(c?(0,_te.A)(qre(c)).body:void 0),W=null!=(r=null==b?void 0:b.root)?r:Kre,j=null!=(o=null==b?void 0:b.paper)?o:Xre,V=pI({elementType:j,externalSlotProps:(0,Fe.A)({},T,{style:P?T.style:(0,Fe.A)({},T.style,{opacity:0})}),additionalProps:{elevation:m,ref:R},ownerState:_,className:(0,cw.A)(D.paper,null==T?void 0:T.className)}),G=pI({elementType:W,externalSlotProps:(null==x?void 0:x.root)||{},externalForwardedProps:E,additionalProps:{ref:t,slotProps:{backdrop:{invisible:!0}},container:U,open:v},ownerState:_,className:(0,cw.A)(D.root,p)}),{slotProps:H}=G,q=(0,Me.A)(G,jre);return(0,Be.jsx)(W,(0,Fe.A)({},q,!Bw(W)&&{slotProps:H,disableScrollLock:C},{children:(0,Be.jsx)(k,(0,Fe.A)({appear:!0,in:v,onEntering:(e,t)=>{I&&I(e,t),z()},onExited:()=>{L(!1)},timeout:B},A,{children:(0,Be.jsx)(j,(0,Fe.A)({},V,{children:h}))}))}))})),Qre=Yre;function Jre(e){return(0,Aw.Ay)("MuiMenu",e)}(0,vw.A)("MuiMenu",["root","paper","list"]);const $re=["onEntering"],Zre=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],eoe={vertical:"top",horizontal:"right"},toe={vertical:"top",horizontal:"left"},noe=(0,Iw.Ay)(Qre,{shouldForwardProp:e=>(0,jk.A)(e)||"classes"===e,name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),roe=(0,Iw.Ay)(Xre,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),ooe=(0,Iw.Ay)(Dre,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),aoe=i.forwardRef((function(e,t){var n,r;const o=(0,Cw.b)({props:e,name:"MuiMenu"}),{autoFocus:a=!0,children:s,className:c,disableAutoFocusItem:l=!1,MenuListProps:u={},onClose:d,open:h,PaperProps:p={},PopoverClasses:f,transitionDuration:m="auto",TransitionProps:{onEntering:g}={},variant:v="selectedMenu",slots:y={},slotProps:b={}}=o,x=(0,Me.A)(o.TransitionProps,$re),w=(0,Me.A)(o,Zre),k=He(),S=(0,Fe.A)({},o,{autoFocus:a,disableAutoFocusItem:l,MenuListProps:u,onEntering:g,PaperProps:p,transitionDuration:m,TransitionProps:x,variant:v}),I=(e=>{const{classes:t}=e;return(0,kw.A)({root:["root"],paper:["paper"],list:["list"]},Jre,t)})(S),C=a&&!l&&h,A=i.useRef(null);let E=-1;i.Children.map(s,((e,t)=>{i.isValidElement(e)&&(e.props.disabled||("selectedMenu"===v&&e.props.selected||-1===E)&&(E=t))}));const T=null!=(n=y.paper)?n:roe,N=null!=(r=b.paper)?r:p,R=pI({elementType:y.root,externalSlotProps:b.root,ownerState:S,className:[I.root,c]}),_=pI({elementType:T,externalSlotProps:N,ownerState:S,className:I.paper});return(0,Be.jsx)(noe,(0,Fe.A)({onClose:d,anchorOrigin:{vertical:"bottom",horizontal:k?"right":"left"},transformOrigin:k?eoe:toe,slots:{paper:T,root:y.root},slotProps:{root:R,paper:_},open:h,ref:t,transitionDuration:m,TransitionProps:(0,Fe.A)({onEntering:(e,t)=>{A.current&&A.current.adjustStyleForScrollbar(e,{direction:k?"rtl":"ltr"}),g&&g(e,t)}},x),ownerState:S},w,{classes:f,children:(0,Be.jsx)(ooe,(0,Fe.A)({onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),d&&d(e,"tabKeyDown"))},actions:A,autoFocus:a&&(-1===E||l),autoFocusItem:C,variant:v},u,{className:(0,cw.A)(I.list,u.className),children:s}))}))})),ioe=aoe;function soe(e){return(0,Aw.Ay)("MuiNativeSelect",e)}const coe=(0,vw.A)("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),loe=["className","disabled","error","IconComponent","inputRef","variant"],uoe=e=>{let{ownerState:t,theme:n}=e;return(0,Fe.A)({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":(0,Fe.A)({},n.vars?{backgroundColor:"rgba(".concat(n.vars.palette.common.onBackgroundChannel," / 0.05)")}:{backgroundColor:"light"===n.palette.mode?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},["&.".concat(coe.disabled)]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(n.vars||n).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},"filled"===t.variant&&{"&&&":{paddingRight:32}},"outlined"===t.variant&&{borderRadius:(n.vars||n).shape.borderRadius,"&:focus":{borderRadius:(n.vars||n).shape.borderRadius},"&&&":{paddingRight:32}})},doe=(0,Iw.Ay)("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:jk.A,overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.select,t[n.variant],n.error&&t.error,{["&.".concat(coe.multiple)]:t.multiple}]}})(uoe),hoe=e=>{let{ownerState:t,theme:n}=e;return(0,Fe.A)({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(n.vars||n).palette.action.active,["&.".concat(coe.disabled)]:{color:(n.vars||n).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},"filled"===t.variant&&{right:7},"outlined"===t.variant&&{right:7})},poe=(0,Iw.Ay)("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t["icon".concat((0,$k.A)(n.variant))],n.open&&t.iconOpen]}})(hoe),foe=i.forwardRef((function(e,t){const{className:n,disabled:r,error:o,IconComponent:a,inputRef:s,variant:c="standard"}=e,l=(0,Me.A)(e,loe),u=(0,Fe.A)({},e,{disabled:r,variant:c,error:o}),d=(e=>{const{classes:t,variant:n,disabled:r,multiple:o,open:a,error:i}=e,s={select:["select",n,r&&"disabled",o&&"multiple",i&&"error"],icon:["icon","icon".concat((0,$k.A)(n)),a&&"iconOpen",r&&"disabled"]};return(0,kw.A)(s,soe,t)})(u);return(0,Be.jsxs)(i.Fragment,{children:[(0,Be.jsx)(doe,(0,Fe.A)({ownerState:u,className:(0,cw.A)(d.select,n),disabled:r,ref:s||t},l)),e.multiple?null:(0,Be.jsx)(poe,{as:a,ownerState:u,className:d.icon})]})})),moe=foe;var goe=n(7123),voe=n(5420);function yoe(e){return(0,Aw.Ay)("MuiSelect",e)}const boe=(0,vw.A)("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var xoe;const woe=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],koe=(0,Iw.Ay)("div",{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{["&.".concat(boe.select)]:t.select},{["&.".concat(boe.select)]:t[n.variant]},{["&.".concat(boe.error)]:t.error},{["&.".concat(boe.multiple)]:t.multiple}]}})(uoe,{["&.".concat(boe.select)]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Soe=(0,Iw.Ay)("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t["icon".concat((0,$k.A)(n.variant))],n.open&&t.iconOpen]}})(hoe),Ioe=(0,Iw.Ay)("input",{shouldForwardProp:e=>(0,goe.A)(e)&&"classes"!==e,name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function Coe(e,t){return"object"===typeof t&&null!==t?e===t:String(e)===String(t)}function Aoe(e){return null==e||"string"===typeof e&&!e.trim()}const Eoe=i.forwardRef((function(e,t){var n;const{"aria-describedby":r,"aria-label":o,autoFocus:a,autoWidth:s,children:c,className:l,defaultOpen:u,defaultValue:d,disabled:h,displayEmpty:p,error:f=!1,IconComponent:m,inputRef:g,labelId:v,MenuProps:y={},multiple:b,name:x,onBlur:w,onChange:k,onClose:S,onFocus:I,onOpen:C,open:A,readOnly:E,renderValue:T,SelectDisplayProps:N={},tabIndex:R,value:_,variant:D="standard"}=e,O=(0,Me.A)(e,woe),[F,M]=(0,voe.A)({controlled:_,default:d,name:"Select"}),[P,L]=(0,voe.A)({controlled:A,default:u,name:"Select"}),z=i.useRef(null),B=i.useRef(null),[U,W]=i.useState(null),{current:j}=i.useRef(null!=A),[V,G]=i.useState(),H=(0,Uw.A)(t,g),q=i.useCallback((e=>{B.current=e,e&&W(e)}),[]),K=null==U?void 0:U.parentNode;i.useImperativeHandle(H,(()=>({focus:()=>{B.current.focus()},node:z.current,value:F})),[F]),i.useEffect((()=>{u&&P&&U&&!j&&(G(s?null:K.clientWidth),B.current.focus())}),[U,s]),i.useEffect((()=>{a&&B.current.focus()}),[a]),i.useEffect((()=>{if(!v)return;const e=(0,_te.A)(B.current).getElementById(v);if(e){const t=()=>{getSelection().isCollapsed&&B.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}}),[v]);const X=(e,t)=>{e?C&&C(t):S&&S(t),j||(G(s?null:K.clientWidth),L(e))},Y=i.Children.toArray(c),Q=e=>t=>{let n;if(t.currentTarget.hasAttribute("tabindex")){if(b){n=Array.isArray(F)?F.slice():[];const t=F.indexOf(e.props.value);-1===t?n.push(e.props.value):n.splice(t,1)}else n=e.props.value;if(e.props.onClick&&e.props.onClick(t),F!==n&&(M(n),k)){const r=t.nativeEvent||t,o=new r.constructor(r.type,r);Object.defineProperty(o,"target",{writable:!0,value:{value:n,name:x}}),k(o,e)}b||X(!1,t)}},J=null!==U&&P;let $,Z;delete O["aria-invalid"];const ee=[];let te=!1,ne=!1;(yne({value:F})||p)&&(T?$=T(F):te=!0);const re=Y.map((e=>{if(!i.isValidElement(e))return null;let t;if(b){if(!Array.isArray(F))throw new Error((0,rne.A)(2));t=F.some((t=>Coe(t,e.props.value))),t&&te&&ee.push(e.props.children)}else t=Coe(F,e.props.value),t&&te&&(Z=e.props.children);return t&&(ne=!0),i.cloneElement(e,{"aria-selected":t?"true":"false",onClick:Q(e),onKeyUp:t=>{" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:t,value:void 0,"data-value":e.props.value})}));te&&($=b?0===ee.length?null:ee.reduce(((e,t,n)=>(e.push(t),n<ee.length-1&&e.push(", "),e)),[]):Z);let oe,ae=V;!s&&j&&U&&(ae=K.clientWidth),oe="undefined"!==typeof R?R:h?null:0;const ie=N.id||(x?"mui-component-select-".concat(x):void 0),se=(0,Fe.A)({},e,{variant:D,value:F,open:J,error:f}),ce=(e=>{const{classes:t,variant:n,disabled:r,multiple:o,open:a,error:i}=e,s={select:["select",n,r&&"disabled",o&&"multiple",i&&"error"],icon:["icon","icon".concat((0,$k.A)(n)),a&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return(0,kw.A)(s,yoe,t)})(se),le=(0,Fe.A)({},y.PaperProps,null==(n=y.slotProps)?void 0:n.paper),ue=(0,nne.A)();return(0,Be.jsxs)(i.Fragment,{children:[(0,Be.jsx)(koe,(0,Fe.A)({ref:q,tabIndex:oe,role:"combobox","aria-controls":ue,"aria-disabled":h?"true":void 0,"aria-expanded":J?"true":"false","aria-haspopup":"listbox","aria-label":o,"aria-labelledby":[v,ie].filter(Boolean).join(" ")||void 0,"aria-describedby":r,onKeyDown:e=>{if(!E){-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),X(!0,e))}},onMouseDown:h||E?null:e=>{0===e.button&&(e.preventDefault(),B.current.focus(),X(!0,e))},onBlur:e=>{!J&&w&&(Object.defineProperty(e,"target",{writable:!0,value:{value:F,name:x}}),w(e))},onFocus:I},N,{ownerState:se,className:(0,cw.A)(N.className,ce.select,l),id:ie,children:Aoe($)?xoe||(xoe=(0,Be.jsx)("span",{className:"notranslate",children:"\u200b"})):$})),(0,Be.jsx)(Ioe,(0,Fe.A)({"aria-invalid":f,value:Array.isArray(F)?F.join(","):F,name:x,ref:z,"aria-hidden":!0,onChange:e=>{const t=Y.find((t=>t.props.value===e.target.value));void 0!==t&&(M(t.props.value),k&&k(e,t))},tabIndex:-1,disabled:h,className:ce.nativeInput,autoFocus:a,ownerState:se},O)),(0,Be.jsx)(Soe,{as:m,className:ce.icon,ownerState:se}),(0,Be.jsx)(ioe,(0,Fe.A)({id:"menu-".concat(x||""),anchorEl:K,open:J,onClose:e=>{X(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},y,{MenuListProps:(0,Fe.A)({"aria-labelledby":v,role:"listbox","aria-multiselectable":b?"true":void 0,disableListWrap:!0,id:ue},y.MenuListProps),slotProps:(0,Fe.A)({},y.slotProps,{paper:(0,Fe.A)({},le,{style:(0,Fe.A)({minWidth:ae},null!=le?le.style:null)})}),children:re}))]})})),Toe=Eoe,Noe=(0,hS.A)((0,Be.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Roe=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],_oe=["root"],Doe={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>(0,jk.A)(e)&&"variant"!==e,slot:"Root"},Ooe=(0,Iw.Ay)(Mne,Doe)(""),Foe=(0,Iw.Ay)(ere,Doe)(""),Moe=(0,Iw.Ay)(jne,Doe)(""),Poe=i.forwardRef((function(e,t){const n=(0,Cw.b)({name:"MuiSelect",props:e}),{autoWidth:r=!1,children:o,classes:a={},className:s,defaultOpen:c=!1,displayEmpty:l=!1,IconComponent:u=Noe,id:d,input:h,inputProps:p,label:f,labelId:m,MenuProps:g,multiple:v=!1,native:y=!1,onClose:b,onOpen:x,open:w,renderValue:k,SelectDisplayProps:S,variant:I="outlined"}=n,C=(0,Me.A)(n,Roe),A=y?moe:Toe,E=dne({props:n,muiFormControl:pne(),states:["variant","error"]}),T=E.variant||I,N=(0,Fe.A)({},n,{variant:T,classes:a}),R=(e=>{const{classes:t}=e;return t})(N),_=(0,Me.A)(R,_oe),D=h||{standard:(0,Be.jsx)(Ooe,{ownerState:N}),outlined:(0,Be.jsx)(Foe,{label:f,ownerState:N}),filled:(0,Be.jsx)(Moe,{ownerState:N})}[T],O=(0,Uw.A)(t,fI(D));return(0,Be.jsx)(i.Fragment,{children:i.cloneElement(D,(0,Fe.A)({inputComponent:A,inputProps:(0,Fe.A)({children:o,error:E.error,IconComponent:u,variant:T,type:void 0,multiple:v},y?{id:d}:{autoWidth:r,defaultOpen:c,displayEmpty:l,labelId:m,MenuProps:g,onClose:b,onOpen:x,open:w,renderValue:k,SelectDisplayProps:(0,Fe.A)({id:d},S)},p,{classes:p?(0,PC.A)(_,p.classes):_},h?h.props.inputProps:{})},(v&&y||l)&&"outlined"===T?{notched:!0}:{},{ref:O,className:(0,cw.A)(D.props.className,s,R.root)},!h&&{variant:T},C))})}));Poe.muiName="Select";const Loe=Poe;function zoe(e){return(0,Aw.Ay)("MuiTextField",e)}(0,vw.A)("MuiTextField",["root"]);const Boe=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Uoe={standard:Mne,filled:jne,outlined:ere},Woe=(0,Iw.Ay)(vre,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),joe=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiTextField"}),{autoComplete:r,autoFocus:o=!1,children:a,className:i,color:s="primary",defaultValue:c,disabled:l=!1,error:u=!1,FormHelperTextProps:d,fullWidth:h=!1,helperText:p,id:f,InputLabelProps:m,inputProps:g,InputProps:v,inputRef:y,label:b,maxRows:x,minRows:w,multiline:k=!1,name:S,onBlur:I,onChange:C,onFocus:A,placeholder:E,required:T=!1,rows:N,select:R=!1,SelectProps:_,type:D,value:O,variant:F="outlined"}=n,M=(0,Me.A)(n,Boe),P=(0,Fe.A)({},n,{autoFocus:o,color:s,disabled:l,error:u,fullWidth:h,multiline:k,required:T,select:R,variant:F}),L=(e=>{const{classes:t}=e;return(0,kw.A)({root:["root"]},zoe,t)})(P);const z={};"outlined"===F&&(m&&"undefined"!==typeof m.shrink&&(z.notched=m.shrink),z.label=b),R&&(_&&_.native||(z.id=void 0),z["aria-describedby"]=void 0);const B=(0,nne.A)(f),U=p&&B?"".concat(B,"-helper-text"):void 0,W=b&&B?"".concat(B,"-label"):void 0,j=Uoe[F],V=(0,Be.jsx)(j,(0,Fe.A)({"aria-describedby":U,autoComplete:r,autoFocus:o,defaultValue:c,fullWidth:h,multiline:k,name:S,rows:N,maxRows:x,minRows:w,type:D,value:O,id:B,inputRef:y,onBlur:I,onChange:C,onFocus:A,placeholder:E,inputProps:g},z,v));return(0,Be.jsxs)(Woe,(0,Fe.A)({className:(0,cw.A)(L.root,i),disabled:l,error:u,fullWidth:h,ref:t,required:T,color:s,variant:F,ownerState:P},M,{children:[null!=b&&""!==b&&(0,Be.jsx)(hre,(0,Fe.A)({htmlFor:B,id:W},m,{children:b})),R?(0,Be.jsx)(Loe,(0,Fe.A)({"aria-describedby":U,id:B,labelId:W,value:O,input:V},_,{children:a})):V,p&&(0,Be.jsx)(Ire,(0,Fe.A)({id:U},d,{children:p}))]}))})),Voe=joe,Goe=()=>{const e=ne(),[t,n]=(0,i.useState)({email:"",password:""}),[r,o]=(0,i.useState)(""),[a,s]=(0,i.useState)(!1),c=e=>{const{name:t,value:r}=e.target;n((e=>ot(ot({},e),{},{[t]:r})))};return(0,Be.jsx)(ZC,{maxWidth:"sm",children:(0,Be.jsx)(ww,{sx:{mt:8,mb:4},children:(0,Be.jsxs)(PS,{elevation:3,sx:{p:4},children:[(0,Be.jsx)(ww,{sx:{textAlign:"center",mb:0},children:(0,Be.jsx)(ww,{component:"img",src:"/Agroscan/assets/logo.png",alt:"AgroScan Logo",sx:{height:180,width:"auto"}})}),(0,Be.jsx)(aS,{variant:"h4",component:"h1",align:"center",gutterBottom:!0,children:"Masuk"}),r&&(0,Be.jsx)(iE,{severity:"error",sx:{mb:2},children:r}),(0,Be.jsxs)("form",{onSubmit:async n=>{n.preventDefault(),o(""),s(!0);try{await Nv(tw,t.email,t.password),e("/")}catch(r){let t="Terjadi kesalahan saat login";switch(r.code){case"auth/user-not-found":t="Email tidak terdaftar";break;case"auth/wrong-password":t="Password salah";break;case"auth/invalid-email":t="Email tidak valid";break;case"auth/too-many-requests":t="Terlalu banyak percobaan login. Silakan coba lagi nanti";break;default:t=r.message}o(t)}finally{s(!1)}},children:[(0,Be.jsx)(Voe,{fullWidth:!0,label:"Email",name:"email",type:"email",value:t.email,onChange:c,margin:"normal",required:!0}),(0,Be.jsx)(Voe,{fullWidth:!0,label:"Password",name:"password",type:"password",value:t.password,onChange:c,margin:"normal",required:!0}),(0,Be.jsx)(aI,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",size:"large",sx:{mt:3},disabled:a,children:a?"Memproses...":"Masuk"})]}),(0,Be.jsx)(ww,{sx:{mt:2,textAlign:"center"},children:(0,Be.jsxs)(aS,{variant:"body2",children:["Belum punya akun?"," ",(0,Be.jsx)(_e,{to:"/register",style:{textDecoration:"none"},children:"Daftar di sini"})]})})]})})})},Hoe=()=>{const e=ne(),[t,n]=(0,i.useState)({name:"",email:"",password:"",confirmPassword:""}),[r,o]=(0,i.useState)(""),[a,s]=(0,i.useState)(!1),c=e=>{const{name:t,value:r}=e.target;n((e=>ot(ot({},e),{},{[t]:r})))};return(0,Be.jsx)(ZC,{maxWidth:"sm",children:(0,Be.jsx)(ww,{sx:{mt:8,mb:4},children:(0,Be.jsxs)(PS,{elevation:3,sx:{p:4},children:[(0,Be.jsx)(ww,{sx:{textAlign:"center",mb:0},children:(0,Be.jsx)(ww,{component:"img",src:"/Agroscan/assets/logo.png",alt:"AgroScan Logo",sx:{height:180,width:"auto"}})}),(0,Be.jsx)(aS,{variant:"h4",component:"h1",align:"center",gutterBottom:!0,children:"Daftar Akun"}),r&&(0,Be.jsx)(iE,{severity:"error",sx:{mb:2},children:r}),(0,Be.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),o(""),s(!0),t.password!==t.confirmPassword)return o("Password tidak cocok"),void s(!1);if(t.password.length<6)return o("Password minimal 6 karakter"),void s(!1);try{const n=await Tv(tw,t.email,t.password);await Rv(n.user,{displayName:t.name}),e("/")}catch(r){let t="Terjadi kesalahan saat mendaftar";switch(r.code){case"auth/email-already-in-use":t="Email sudah terdaftar";break;case"auth/invalid-email":t="Email tidak valid";break;case"auth/weak-password":t="Password terlalu lemah";break;default:t=r.message}o(t)}finally{s(!1)}},children:[(0,Be.jsx)(Voe,{fullWidth:!0,label:"Nama Lengkap",name:"name",value:t.name,onChange:c,margin:"normal",required:!0}),(0,Be.jsx)(Voe,{fullWidth:!0,label:"Email",name:"email",type:"email",value:t.email,onChange:c,margin:"normal",required:!0}),(0,Be.jsx)(Voe,{fullWidth:!0,label:"Password",name:"password",type:"password",value:t.password,onChange:c,margin:"normal",required:!0}),(0,Be.jsx)(Voe,{fullWidth:!0,label:"Konfirmasi Password",name:"confirmPassword",type:"password",value:t.confirmPassword,onChange:c,margin:"normal",required:!0}),(0,Be.jsx)(aI,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",size:"large",sx:{mt:3},disabled:a,children:a?"Mendaftar...":"Daftar"})]}),(0,Be.jsx)(ww,{sx:{mt:2,textAlign:"center"},children:(0,Be.jsxs)(aS,{variant:"body2",children:["Sudah punya akun?"," ",(0,Be.jsx)(_e,{to:"/login",style:{textDecoration:"none"},children:"Masuk di sini"})]})})]})})})};function qoe(e){return(0,Aw.Ay)("MuiCardHeader",e)}const Koe=(0,vw.A)("MuiCardHeader",["root","avatar","action","content","title","subheader"]),Xoe=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],Yoe=(0,Iw.Ay)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,Fe.A)({["& .".concat(Koe.title)]:t.title,["& .".concat(Koe.subheader)]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),Qoe=(0,Iw.Ay)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),Joe=(0,Iw.Ay)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),$oe=(0,Iw.Ay)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"}),Zoe=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiCardHeader"}),{action:r,avatar:o,className:a,component:i="div",disableTypography:s=!1,subheader:c,subheaderTypographyProps:l,title:u,titleTypographyProps:d}=n,h=(0,Me.A)(n,Xoe),p=(0,Fe.A)({},n,{component:i,disableTypography:s}),f=(e=>{const{classes:t}=e;return(0,kw.A)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},qoe,t)})(p);let m=u;null==m||m.type===aS||s||(m=(0,Be.jsx)(aS,(0,Fe.A)({variant:o?"body2":"h5",className:f.title,component:"span",display:"block"},d,{children:m})));let g=c;return null==g||g.type===aS||s||(g=(0,Be.jsx)(aS,(0,Fe.A)({variant:o?"body2":"body1",className:f.subheader,color:"text.secondary",component:"span",display:"block"},l,{children:g}))),(0,Be.jsxs)(Yoe,(0,Fe.A)({className:(0,cw.A)(f.root,a),as:i,ref:t,ownerState:p},h,{children:[o&&(0,Be.jsx)(Qoe,{className:f.avatar,ownerState:p,children:o}),(0,Be.jsxs)($oe,{className:f.content,ownerState:p,children:[m,g]}),r&&(0,Be.jsx)(Joe,{className:f.action,ownerState:p,children:r})]}))})),eae=Zoe;function tae(e){return(0,Aw.Ay)("MuiCardMedia",e)}(0,vw.A)("MuiCardMedia",["root","media","img"]);const nae=["children","className","component","image","src","style"],rae=(0,Iw.Ay)("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{isMediaComponent:r,isImageComponent:o}=n;return[t.root,r&&t.media,o&&t.img]}})((e=>{let{ownerState:t}=e;return(0,Fe.A)({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},t.isMediaComponent&&{width:"100%"},t.isImageComponent&&{objectFit:"cover"})})),oae=["video","audio","picture","iframe","img"],aae=["picture","img"],iae=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiCardMedia"}),{children:r,className:o,component:a="div",image:i,src:s,style:c}=n,l=(0,Me.A)(n,nae),u=-1!==oae.indexOf(a),d=!u&&i?(0,Fe.A)({backgroundImage:'url("'.concat(i,'")')},c):c,h=(0,Fe.A)({},n,{component:a,isMediaComponent:u,isImageComponent:-1!==aae.indexOf(a)}),p=(e=>{const{classes:t,isMediaComponent:n,isImageComponent:r}=e,o={root:["root",n&&"media",r&&"img"]};return(0,kw.A)(o,tae,t)})(h);return(0,Be.jsx)(rae,(0,Fe.A)({className:(0,cw.A)(p.root,o),as:a,role:!u&&i?"img":void 0,ref:t,style:d,ownerState:h,src:u?i||s:void 0},l,{children:r}))})),sae=iae;function cae(e){return(0,Aw.Ay)("MuiCardContent",e)}(0,vw.A)("MuiCardContent",["root"]);const lae=["className","component"],uae=(0,Iw.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),dae=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiCardContent"}),{className:r,component:o="div"}=n,a=(0,Me.A)(n,lae),i=(0,Fe.A)({},n,{component:o}),s=(e=>{const{classes:t}=e;return(0,kw.A)({root:["root"]},cae,t)})(i);return(0,Be.jsx)(uae,(0,Fe.A)({as:o,className:(0,cw.A)(s.root,r),ownerState:i,ref:t},a))})),hae=dae;var pae=n(4327),fae=n(4802);const mae=function(){const[e,t]=(0,i.useState)([]),[n,r]=(0,i.useState)(!0),[o,a]=(0,i.useState)(null),[s,c]=(0,i.useState)(!1),[l,u]=(0,i.useState)(""),[d,h]=(0,i.useState)(null),[p,f]=(0,i.useState)(null),[m,g]=(0,i.useState)(!1),[v,y]=(0,i.useState)(null),b=ne(),{currentUser:x}=aw(),w=async()=>{try{r(!0),a(null);const e=vm(Df(nw,"communityPosts"),wm("createdAt","desc")),n=(await Mm(e)).docs.map((e=>{var t;return ot(ot({id:e.id},e.data()),{},{createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate().toISOString())||null,userProfileImage:null})})),o=await Promise.all(n.map((async e=>{if(e.userId)try{const t=Of(nw,"users",e.userId),n=await Om(t);if(n.exists())return ot(ot({},e),{},{userProfileImage:n.data().profileImage})}catch(t){console.error("Error fetching user profile for post:",e.userId,t)}return e})));t(o)}catch(Dse){a("Gagal memuat postingan. Silakan coba lagi nanti.")}finally{r(!1)}};(0,i.useEffect)((()=>{w()}),[]);const k=()=>{c(!1),u(""),h(null),f(null),y(null)};return(0,Be.jsxs)(ZC,{maxWidth:"md",sx:{py:6,minHeight:"80vh"},children:[(0,Be.jsxs)(ww,{sx:{textAlign:"center",mt:4,mb:4},children:[(0,Be.jsx)(aS,{variant:"h4",sx:{fontWeight:800,color:"#219653",mb:2},children:"Komunitas AgroScan"}),(0,Be.jsx)(aS,{sx:{color:"#555",mb:4},children:"Berbagi pengalaman, bertanya, dan berdiskusi dengan petani lainnya."}),x?(0,Be.jsx)(aI,{variant:"contained",sx:{bgcolor:"#219653","&:hover":{bgcolor:"#17643b"},borderRadius:"50px",px:4,py:1},onClick:()=>c(!0),children:"Buat Postingan Baru"}):(0,Be.jsx)(iE,{severity:"info",children:"Silakan login untuk membuat postingan."})]}),n&&(0,Be.jsx)(ww,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,Be.jsx)(IE,{})}),o&&(0,Be.jsx)(iE,{severity:"error",sx:{mt:4},children:o}),!n&&!o&&0===e.length&&(0,Be.jsx)(iE,{severity:"info",sx:{mt:4},children:"Belum ada postingan di komunitas."}),!n&&!o&&e.length>0&&(0,Be.jsx)(ww,{sx:{mt:4},children:e.map((e=>{var t,n,r;return(0,Be.jsxs)(FA,{sx:{mb:3,borderRadius:2,boxShadow:3,bgcolor:"#fff"},children:[(0,Be.jsx)(eae,{avatar:(0,Be.jsx)(RS,{src:e.userProfileImage,alt:null===(t=e.authorName)||void 0===t?void 0:t.charAt(0),sx:{bgcolor:"#219653"},children:!e.userProfileImage&&(null===(n=e.authorName)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.toUpperCase())||"A"}),title:(0,Be.jsx)(aS,{variant:"subtitle1",sx:{fontWeight:700},children:e.authorName}),subheader:(0,Be.jsx)(aS,{variant:"caption",color:"text.secondary",children:e.createdAt?new Date(e.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown date"}),sx:{pb:1}}),e.image&&(0,Be.jsx)(sae,{component:"img",sx:{maxHeight:400,objectFit:"cover",width:"100%"},image:e.image,alt:"Post image"}),(0,Be.jsx)(hae,{sx:{pt:e.image?0:2},children:(0,Be.jsxs)(ww,{onClick:()=>{return t=e.id,void b("/community/posts/".concat(t));var t},sx:{cursor:"pointer"},children:[(0,Be.jsxs)(aS,{variant:"body2",color:"text.primary",sx:{mb:1},children:[(0,Be.jsx)(aS,{component:"span",variant:"subtitle2",sx:{fontWeight:700,mr:1},children:e.authorName}),e.content]}),(0,Be.jsx)(aS,{variant:"body2",color:"text.secondary",sx:{fontWeight:500},children:"Lihat semua komentar"})]})})]},e.id)}))}),(0,Be.jsx)(sC,{open:s,onClose:k,children:(0,Be.jsxs)(ww,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"90%",md:500},bgcolor:"background.paper",borderRadius:2,boxShadow:24,p:4},children:[(0,Be.jsxs)(ww,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,Be.jsx)(aS,{variant:"h6",component:"h2",children:"Buat Postingan Baru"}),(0,Be.jsx)(dI,{onClick:k,size:"small",children:(0,Be.jsx)(fae.A,{})})]}),(0,Be.jsxs)(ww,{component:"form",onSubmit:async e=>{if(e.preventDefault(),l.trim())if(x){g(!0),y(null);try{await Lm(Df(nw,"communityPosts"),{content:l,image:p,userId:x.uid,authorName:x.displayName||"Anonymous",authorPhotoURL:x.photoURL||null,createdAt:Um(),updatedAt:Um()});k(),w()}catch(Dse){y("Gagal membuat postingan.")}finally{g(!1)}}else y("Anda harus login untuk membuat postingan.");else y("Konten postingan tidak boleh kosong.")},children:[(0,Be.jsx)(Voe,{fullWidth:!0,label:"Konten Postingan",multiline:!0,rows:4,value:l,onChange:e=>u(e.target.value),margin:"normal",required:!0}),(0,Be.jsxs)(ww,{sx:{mt:2,mb:2},children:[(0,Be.jsx)("input",{accept:"image/*",style:{display:"none"},id:"image-upload",type:"file",onChange:async e=>{const t=e.target.files[0];if(t){if(t.size>2097152)return void y("Ukuran gambar maksimal 2MB");try{h(t);const e=await(e=>new Promise(((t,n)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=e=>{const r=new Image;r.src=e.target.result,r.onload=()=>{const e=document.createElement("canvas");let n=r.width,o=r.height;const a=800;n>o&&n>a?(o=Math.round(o*a/n),n=a):o>a&&(n=Math.round(n*a/o),o=a),e.width=n,e.height=o,e.getContext("2d").drawImage(r,0,0,n,o);const i=e.toDataURL("image/jpeg",.7);t(i)},r.onerror=n},r.onerror=n})))(t);f(e)}catch(Dse){y("Gagal memproses gambar")}}}}),(0,Be.jsx)("label",{htmlFor:"image-upload",children:(0,Be.jsx)(aI,{component:"span",startIcon:(0,Be.jsx)(pae.A,{}),sx:{color:"#219653"},children:"Tambahkan Gambar"})})]}),p&&(0,Be.jsxs)(ww,{sx:{position:"relative",mb:2},children:[(0,Be.jsx)("img",{src:p,alt:"Preview",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px"}}),(0,Be.jsx)(dI,{size:"small",sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(0,0,0,0.5)",color:"white","&:hover":{bgcolor:"rgba(0,0,0,0.7)"}},onClick:()=>{h(null),f(null)},children:(0,Be.jsx)(fae.A,{})})]}),v&&(0,Be.jsx)(iE,{severity:"error",sx:{mb:2},children:v}),(0,Be.jsx)(aI,{type:"submit",variant:"contained",fullWidth:!0,sx:{mt:2,bgcolor:"#219653","&:hover":{bgcolor:"#17643b"},borderRadius:"50px",py:1},disabled:m,children:m?"Membuat...":"Publish Postingan"})]})]})})]})};const gae=function(){var e,t;const{postId:n}=function(){let{matches:e}=i.useContext(J),t=e[e.length-1];return t?t.params:{}}(),r=ne(),{currentUser:o}=aw(),[a,s]=(0,i.useState)(null),[c,l]=(0,i.useState)(!0),[u,d]=(0,i.useState)(null),[h,p]=(0,i.useState)(""),[f,m]=(0,i.useState)(!1),[g,v]=(0,i.useState)(null),y=async()=>{try{var e;l(!0),d(null);const r=await Om(Of(nw,"communityPosts",n));if(!r.exists())throw new Error("Postingan tidak ditemukan");const o=ot(ot({id:r.id},r.data()),{},{createdAt:(null===(e=r.data().createdAt)||void 0===e?void 0:e.toDate().toISOString())||null,userProfileImage:null});if(o.userId)try{const e=Of(nw,"users",o.userId),t=await Om(e);t.exists()&&(o.userProfileImage=t.data().profileImage)}catch(t){console.error("Error fetching post author profile:",o.userId,t)}const a=vm(Df(nw,"communityPosts",n,"comments"),wm("createdAt","asc")),i=await Mm(a),c=await Promise.all(i.docs.map((async e=>{var t;return ot(ot({id:e.id},e.data()),{},{createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate().toISOString())||null,commentAuthorProfileImage:null})}))),u=await Promise.all(c.map((async e=>{if(e.userId)try{const t=Of(nw,"users",e.userId),n=await Om(t);n.exists()&&(e.commentAuthorProfileImage=n.data().profileImage)}catch(t){console.error("Error fetching comment author profile:",e.userId,t)}return e})));s(ot(ot({},o),{},{comments:u}))}catch(Dse){d("Gagal memuat detail postingan.")}finally{l(!1)}};return(0,i.useEffect)((()=>{y()}),[n]),c?(0,Be.jsx)(ww,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:(0,Be.jsx)(IE,{})}):u?(0,Be.jsx)(ZC,{maxWidth:"md",sx:{py:6},children:(0,Be.jsx)(iE,{severity:"error",children:u})}):a?(0,Be.jsxs)(ZC,{maxWidth:"md",sx:{py:6,minHeight:"80vh"},children:[(0,Be.jsxs)(ww,{sx:{display:"flex",alignItems:"center",mb:3},children:[(0,Be.jsx)(dI,{onClick:()=>r("/community"),sx:{mr:1},children:(0,Be.jsx)(pte.A,{})}),(0,Be.jsx)(aS,{variant:"h5",sx:{fontWeight:800,color:"#219653"},children:"Detail Postingan"})]}),(0,Be.jsxs)(PS,{elevation:2,sx:{p:3,borderRadius:4,boxShadow:2,mb:4},children:[(0,Be.jsxs)(ww,{sx:{display:"flex",alignItems:"flex-start",mb:2},children:[(0,Be.jsx)(RS,{src:a.userProfileImage,alt:null===(e=a.authorName)||void 0===e?void 0:e.charAt(0),sx:{width:40,height:40,mr:2,bgcolor:"#219653",flexShrink:0},children:!a.userProfileImage&&(null===(t=a.authorName)||void 0===t?void 0:t.charAt(0))}),(0,Be.jsxs)(ww,{sx:{flexGrow:1},children:[(0,Be.jsx)(aS,{variant:"subtitle1",sx:{fontWeight:700,color:"#222",mb:.5},children:a.authorName}),(0,Be.jsx)(aS,{variant:"caption",color:"text.secondary",children:a.createdAt?new Date(a.createdAt).toLocaleString():"-"})]})]}),(0,Be.jsx)(Dw,{sx:{mb:2}}),a.image&&(0,Be.jsx)(ww,{sx:{mb:2,width:"100%",display:"flex",justifyContent:"center"},children:(0,Be.jsx)("img",{src:a.image,alt:"Post content",style:{maxWidth:"100%",maxHeight:"400px",objectFit:"contain",borderRadius:"8px"}})}),(0,Be.jsx)(aS,{variant:"body1",sx:{color:"#555"},children:a.content})]}),(0,Be.jsxs)(ww,{children:[(0,Be.jsxs)(aS,{variant:"h6",sx:{fontWeight:700,color:"#219653",mb:2},children:["Komentar (",a.comments?a.comments.length:0,")"]}),o?(0,Be.jsxs)(ww,{component:"form",onSubmit:async e=>{if(e.preventDefault(),h.trim())if(o){m(!0),v(null);try{await Lm(Df(nw,"communityPosts",n,"comments"),{content:h,userId:o.uid,authorName:o.displayName||"Anonymous",authorPhotoURL:o.photoURL||null,createdAt:Um()}),p(""),y()}catch(Dse){console.error("Error adding comment:",Dse),v("Gagal menambahkan komentar.")}finally{m(!1)}}else v("Anda harus login untuk berkomentar.");else v("Komentar tidak boleh kosong.")},sx:{mb:4},children:[(0,Be.jsx)(Voe,{fullWidth:!0,label:"Tambahkan Komentar",multiline:!0,rows:3,value:h,onChange:e=>p(e.target.value),variant:"outlined",sx:{mb:2},required:!0}),g&&(0,Be.jsx)(iE,{severity:"error",sx:{mb:2},children:g}),(0,Be.jsx)(aI,{type:"submit",variant:"contained",sx:{bgcolor:"#219653","&:hover":{bgcolor:"#17643b"}},disabled:f,children:f?"Mengirim...":"Kirim Komentar"})]}):(0,Be.jsx)(iE,{severity:"info",sx:{mb:2},children:"Silakan login untuk menambahkan komentar."}),a.comments&&a.comments.length>0?(0,Be.jsx)(zw,{disablePadding:!0,children:a.comments.map((e=>{var t,n;return(0,Be.jsxs)(ww,{sx:{mb:2},children:[(0,Be.jsxs)(ww,{sx:{display:"flex",alignItems:"flex-start",mb:.5},children:[(0,Be.jsx)(RS,{src:e.commentAuthorProfileImage,alt:null===(t=e.authorName)||void 0===t?void 0:t.charAt(0),sx:{width:32,height:32,mr:1.5,bgcolor:"#219653",flexShrink:0},children:!e.commentAuthorProfileImage&&(null===(n=e.authorName)||void 0===n?void 0:n.charAt(0))}),(0,Be.jsxs)(ww,{sx:{flexGrow:1},children:[(0,Be.jsx)(aS,{variant:"subtitle2",sx:{fontWeight:700,display:"inline"},children:e.authorName}),(0,Be.jsx)(aS,{variant:"caption",color:"text.secondary",sx:{ml:1},children:e.createdAt?new Date(e.createdAt).toLocaleString():"-"}),(0,Be.jsx)(aS,{variant:"body2",sx:{color:"#555",mt:.5},children:e.content})]})]}),(0,Be.jsx)(Dw,{variant:"inset",component:"li",sx:{ml:"48px",mt:1}})]},e.id)}))}):!c&&(0,Be.jsx)(aS,{variant:"body2",color:"text.secondary",children:"Belum ada komentar."})]})]}):(0,Be.jsx)(ZC,{maxWidth:"md",sx:{py:6},children:(0,Be.jsx)(iE,{severity:"info",children:"Postingan tidak ditemukan."})})};var vae=n(2374);function yae(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function bae(e){return e instanceof yae(e).Element||e instanceof Element}function xae(e){return e instanceof yae(e).HTMLElement||e instanceof HTMLElement}function wae(e){return"undefined"!==typeof ShadowRoot&&(e instanceof yae(e).ShadowRoot||e instanceof ShadowRoot)}var kae=Math.max,Sae=Math.min,Iae=Math.round;function Cae(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function Aae(){return!/^((?!chrome|android).)*safari/i.test(Cae())}function Eae(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),o=1,a=1;t&&xae(e)&&(o=e.offsetWidth>0&&Iae(r.width)/e.offsetWidth||1,a=e.offsetHeight>0&&Iae(r.height)/e.offsetHeight||1);var i=(bae(e)?yae(e):window).visualViewport,s=!Aae()&&n,c=(r.left+(s&&i?i.offsetLeft:0))/o,l=(r.top+(s&&i?i.offsetTop:0))/a,u=r.width/o,d=r.height/a;return{width:u,height:d,top:l,right:c+u,bottom:l+d,left:c,x:c,y:l}}function Tae(e){var t=yae(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Nae(e){return e?(e.nodeName||"").toLowerCase():null}function Rae(e){return((bae(e)?e.ownerDocument:e.document)||window.document).documentElement}function _ae(e){return Eae(Rae(e)).left+Tae(e).scrollLeft}function Dae(e){return yae(e).getComputedStyle(e)}function Oae(e){var t=Dae(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Fae(e,t,n){void 0===n&&(n=!1);var r=xae(t),o=xae(t)&&function(e){var t=e.getBoundingClientRect(),n=Iae(t.width)/e.offsetWidth||1,r=Iae(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),a=Rae(t),i=Eae(e,o,n),s={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(r||!r&&!n)&&(("body"!==Nae(t)||Oae(a))&&(s=function(e){return e!==yae(e)&&xae(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:Tae(e);var t}(t)),xae(t)?((c=Eae(t,!0)).x+=t.clientLeft,c.y+=t.clientTop):a&&(c.x=_ae(a))),{x:i.left+s.scrollLeft-c.x,y:i.top+s.scrollTop-c.y,width:i.width,height:i.height}}function Mae(e){var t=Eae(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Pae(e){return"html"===Nae(e)?e:e.assignedSlot||e.parentNode||(wae(e)?e.host:null)||Rae(e)}function Lae(e){return["html","body","#document"].indexOf(Nae(e))>=0?e.ownerDocument.body:xae(e)&&Oae(e)?e:Lae(Pae(e))}function zae(e,t){var n;void 0===t&&(t=[]);var r=Lae(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),a=yae(r),i=o?[a].concat(a.visualViewport||[],Oae(r)?r:[]):r,s=t.concat(i);return o?s:s.concat(zae(Pae(i)))}function Bae(e){return["table","td","th"].indexOf(Nae(e))>=0}function Uae(e){return xae(e)&&"fixed"!==Dae(e).position?e.offsetParent:null}function Wae(e){for(var t=yae(e),n=Uae(e);n&&Bae(n)&&"static"===Dae(n).position;)n=Uae(n);return n&&("html"===Nae(n)||"body"===Nae(n)&&"static"===Dae(n).position)?t:n||function(e){var t=/firefox/i.test(Cae());if(/Trident/i.test(Cae())&&xae(e)&&"fixed"===Dae(e).position)return null;var n=Pae(e);for(wae(n)&&(n=n.host);xae(n)&&["html","body"].indexOf(Nae(n))<0;){var r=Dae(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var jae="top",Vae="bottom",Gae="right",Hae="left",qae="auto",Kae=[jae,Vae,Gae,Hae],Xae="start",Yae="end",Qae="viewport",Jae="popper",$ae=Kae.reduce((function(e,t){return e.concat([t+"-"+Xae,t+"-"+Yae])}),[]),Zae=[].concat(Kae,[qae]).reduce((function(e,t){return e.concat([t,t+"-"+Xae,t+"-"+Yae])}),[]),eie=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function tie(e){var t=new Map,n=new Set,r=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&o(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),r}function nie(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}var rie={placement:"bottom",modifiers:[],strategy:"absolute"};function oie(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function aie(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,o=t.defaultOptions,a=void 0===o?rie:o;return function(e,t,n){void 0===n&&(n=a);var o={placement:"bottom",orderedModifiers:[],options:Object.assign({},rie,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},i=[],s=!1,c={state:o,setOptions:function(n){var s="function"===typeof n?n(o.options):n;l(),o.options=Object.assign({},a,o.options,s),o.scrollParents={reference:bae(e)?zae(e):e.contextElement?zae(e.contextElement):[],popper:zae(t)};var u=function(e){var t=tie(e);return eie.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,o.options.modifiers)));return o.orderedModifiers=u.filter((function(e){return e.enabled})),o.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,a=e.effect;if("function"===typeof a){var s=a({state:o,name:t,instance:c,options:r}),l=function(){};i.push(s||l)}})),c.update()},forceUpdate:function(){if(!s){var e=o.elements,t=e.reference,n=e.popper;if(oie(t,n)){o.rects={reference:Fae(t,Wae(n),"fixed"===o.options.strategy),popper:Mae(n)},o.reset=!1,o.placement=o.options.placement,o.orderedModifiers.forEach((function(e){return o.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<o.orderedModifiers.length;r++)if(!0!==o.reset){var a=o.orderedModifiers[r],i=a.fn,l=a.options,u=void 0===l?{}:l,d=a.name;"function"===typeof i&&(o=i({state:o,options:u,name:d,instance:c})||o)}else o.reset=!1,r=-1}}},update:nie((function(){return new Promise((function(e){c.forceUpdate(),e(o)}))})),destroy:function(){l(),s=!0}};if(!oie(e,t))return c;function l(){i.forEach((function(e){return e()})),i=[]}return c.setOptions(n).then((function(e){!s&&n.onFirstUpdate&&n.onFirstUpdate(e)})),c}}var iie={passive:!0};function sie(e){return e.split("-")[0]}function cie(e){return e.split("-")[1]}function lie(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function uie(e){var t,n=e.reference,r=e.element,o=e.placement,a=o?sie(o):null,i=o?cie(o):null,s=n.x+n.width/2-r.width/2,c=n.y+n.height/2-r.height/2;switch(a){case jae:t={x:s,y:n.y-r.height};break;case Vae:t={x:s,y:n.y+n.height};break;case Gae:t={x:n.x+n.width,y:c};break;case Hae:t={x:n.x-r.width,y:c};break;default:t={x:n.x,y:n.y}}var l=a?lie(a):null;if(null!=l){var u="y"===l?"height":"width";switch(i){case Xae:t[l]=t[l]-(n[u]/2-r[u]/2);break;case Yae:t[l]=t[l]+(n[u]/2-r[u]/2)}}return t}var die={top:"auto",right:"auto",bottom:"auto",left:"auto"};function hie(e){var t,n=e.popper,r=e.popperRect,o=e.placement,a=e.variation,i=e.offsets,s=e.position,c=e.gpuAcceleration,l=e.adaptive,u=e.roundOffsets,d=e.isFixed,h=i.x,p=void 0===h?0:h,f=i.y,m=void 0===f?0:f,g="function"===typeof u?u({x:p,y:m}):{x:p,y:m};p=g.x,m=g.y;var v=i.hasOwnProperty("x"),y=i.hasOwnProperty("y"),b=Hae,x=jae,w=window;if(l){var k=Wae(n),S="clientHeight",I="clientWidth";if(k===yae(n)&&"static"!==Dae(k=Rae(n)).position&&"absolute"===s&&(S="scrollHeight",I="scrollWidth"),o===jae||(o===Hae||o===Gae)&&a===Yae)x=Vae,m-=(d&&k===w&&w.visualViewport?w.visualViewport.height:k[S])-r.height,m*=c?1:-1;if(o===Hae||(o===jae||o===Vae)&&a===Yae)b=Gae,p-=(d&&k===w&&w.visualViewport?w.visualViewport.width:k[I])-r.width,p*=c?1:-1}var C,A=Object.assign({position:s},l&&die),E=!0===u?function(e,t){var n=e.x,r=e.y,o=t.devicePixelRatio||1;return{x:Iae(n*o)/o||0,y:Iae(r*o)/o||0}}({x:p,y:m},yae(n)):{x:p,y:m};return p=E.x,m=E.y,c?Object.assign({},A,((C={})[x]=y?"0":"",C[b]=v?"0":"",C.transform=(w.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",C)):Object.assign({},A,((t={})[x]=y?m+"px":"",t[b]=v?p+"px":"",t.transform="",t))}const pie={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];xae(o)&&Nae(o)&&(Object.assign(o.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],o=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});xae(r)&&Nae(r)&&(Object.assign(r.style,a),Object.keys(o).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]};const fie={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,a=void 0===o?[0,0]:o,i=Zae.reduce((function(e,n){return e[n]=function(e,t,n){var r=sie(e),o=[Hae,jae].indexOf(r)>=0?-1:1,a="function"===typeof n?n(Object.assign({},t,{placement:e})):n,i=a[0],s=a[1];return i=i||0,s=(s||0)*o,[Hae,Gae].indexOf(r)>=0?{x:s,y:i}:{x:i,y:s}}(n,t.rects,a),e}),{}),s=i[t.placement],c=s.x,l=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=l),t.modifiersData[r]=i}};var mie={left:"right",right:"left",bottom:"top",top:"bottom"};function gie(e){return e.replace(/left|right|bottom|top/g,(function(e){return mie[e]}))}var vie={start:"end",end:"start"};function yie(e){return e.replace(/start|end/g,(function(e){return vie[e]}))}function bie(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&wae(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function xie(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function wie(e,t,n){return t===Qae?xie(function(e,t){var n=yae(e),r=Rae(e),o=n.visualViewport,a=r.clientWidth,i=r.clientHeight,s=0,c=0;if(o){a=o.width,i=o.height;var l=Aae();(l||!l&&"fixed"===t)&&(s=o.offsetLeft,c=o.offsetTop)}return{width:a,height:i,x:s+_ae(e),y:c}}(e,n)):bae(t)?function(e,t){var n=Eae(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):xie(function(e){var t,n=Rae(e),r=Tae(e),o=null==(t=e.ownerDocument)?void 0:t.body,a=kae(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),i=kae(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-r.scrollLeft+_ae(e),c=-r.scrollTop;return"rtl"===Dae(o||n).direction&&(s+=kae(n.clientWidth,o?o.clientWidth:0)-a),{width:a,height:i,x:s,y:c}}(Rae(e)))}function kie(e,t,n,r){var o="clippingParents"===t?function(e){var t=zae(Pae(e)),n=["absolute","fixed"].indexOf(Dae(e).position)>=0&&xae(e)?Wae(e):e;return bae(n)?t.filter((function(e){return bae(e)&&bie(e,n)&&"body"!==Nae(e)})):[]}(e):[].concat(t),a=[].concat(o,[n]),i=a[0],s=a.reduce((function(t,n){var o=wie(e,n,r);return t.top=kae(o.top,t.top),t.right=Sae(o.right,t.right),t.bottom=Sae(o.bottom,t.bottom),t.left=kae(o.left,t.left),t}),wie(e,i,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Sie(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Iie(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function Cie(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=void 0===r?e.placement:r,a=n.strategy,i=void 0===a?e.strategy:a,s=n.boundary,c=void 0===s?"clippingParents":s,l=n.rootBoundary,u=void 0===l?Qae:l,d=n.elementContext,h=void 0===d?Jae:d,p=n.altBoundary,f=void 0!==p&&p,m=n.padding,g=void 0===m?0:m,v=Sie("number"!==typeof g?g:Iie(g,Kae)),y=h===Jae?"reference":Jae,b=e.rects.popper,x=e.elements[f?y:h],w=kie(bae(x)?x:x.contextElement||Rae(e.elements.popper),c,u,i),k=Eae(e.elements.reference),S=uie({reference:k,element:b,strategy:"absolute",placement:o}),I=xie(Object.assign({},b,S)),C=h===Jae?I:k,A={top:w.top-C.top+v.top,bottom:C.bottom-w.bottom+v.bottom,left:w.left-C.left+v.left,right:C.right-w.right+v.right},E=e.modifiersData.offset;if(h===Jae&&E){var T=E[o];Object.keys(A).forEach((function(e){var t=[Gae,Vae].indexOf(e)>=0?1:-1,n=[jae,Vae].indexOf(e)>=0?"y":"x";A[e]+=T[n]*t}))}return A}const Aie={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,a=void 0===o||o,i=n.altAxis,s=void 0===i||i,c=n.fallbackPlacements,l=n.padding,u=n.boundary,d=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,f=void 0===p||p,m=n.allowedAutoPlacements,g=t.options.placement,v=sie(g),y=c||(v===g||!f?[gie(g)]:function(e){if(sie(e)===qae)return[];var t=gie(e);return[yie(e),t,yie(t)]}(g)),b=[g].concat(y).reduce((function(e,n){return e.concat(sie(n)===qae?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=n.boundary,a=n.rootBoundary,i=n.padding,s=n.flipVariations,c=n.allowedAutoPlacements,l=void 0===c?Zae:c,u=cie(r),d=u?s?$ae:$ae.filter((function(e){return cie(e)===u})):Kae,h=d.filter((function(e){return l.indexOf(e)>=0}));0===h.length&&(h=d);var p=h.reduce((function(t,n){return t[n]=Cie(e,{placement:n,boundary:o,rootBoundary:a,padding:i})[sie(n)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:n,boundary:u,rootBoundary:d,padding:l,flipVariations:f,allowedAutoPlacements:m}):n)}),[]),x=t.rects.reference,w=t.rects.popper,k=new Map,S=!0,I=b[0],C=0;C<b.length;C++){var A=b[C],E=sie(A),T=cie(A)===Xae,N=[jae,Vae].indexOf(E)>=0,R=N?"width":"height",_=Cie(t,{placement:A,boundary:u,rootBoundary:d,altBoundary:h,padding:l}),D=N?T?Gae:Hae:T?Vae:jae;x[R]>w[R]&&(D=gie(D));var O=gie(D),F=[];if(a&&F.push(_[E]<=0),s&&F.push(_[D]<=0,_[O]<=0),F.every((function(e){return e}))){I=A,S=!1;break}k.set(A,F)}if(S)for(var M=function(e){var t=b.find((function(t){var n=k.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return I=t,"break"},P=f?3:1;P>0;P--){if("break"===M(P))break}t.placement!==I&&(t.modifiersData[r]._skip=!0,t.placement=I,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Eie(e,t,n){return kae(e,Sae(t,n))}const Tie={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,a=void 0===o||o,i=n.altAxis,s=void 0!==i&&i,c=n.boundary,l=n.rootBoundary,u=n.altBoundary,d=n.padding,h=n.tether,p=void 0===h||h,f=n.tetherOffset,m=void 0===f?0:f,g=Cie(t,{boundary:c,rootBoundary:l,padding:d,altBoundary:u}),v=sie(t.placement),y=cie(t.placement),b=!y,x=lie(v),w="x"===x?"y":"x",k=t.modifiersData.popperOffsets,S=t.rects.reference,I=t.rects.popper,C="function"===typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,A="number"===typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),E=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(k){if(a){var N,R="y"===x?jae:Hae,_="y"===x?Vae:Gae,D="y"===x?"height":"width",O=k[x],F=O+g[R],M=O-g[_],P=p?-I[D]/2:0,L=y===Xae?S[D]:I[D],z=y===Xae?-I[D]:-S[D],B=t.elements.arrow,U=p&&B?Mae(B):{width:0,height:0},W=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},j=W[R],V=W[_],G=Eie(0,S[D],U[D]),H=b?S[D]/2-P-G-j-A.mainAxis:L-G-j-A.mainAxis,q=b?-S[D]/2+P+G+V+A.mainAxis:z+G+V+A.mainAxis,K=t.elements.arrow&&Wae(t.elements.arrow),X=K?"y"===x?K.clientTop||0:K.clientLeft||0:0,Y=null!=(N=null==E?void 0:E[x])?N:0,Q=O+q-Y,J=Eie(p?Sae(F,O+H-Y-X):F,O,p?kae(M,Q):M);k[x]=J,T[x]=J-O}if(s){var $,Z="x"===x?jae:Hae,ee="x"===x?Vae:Gae,te=k[w],ne="y"===w?"height":"width",re=te+g[Z],oe=te-g[ee],ae=-1!==[jae,Hae].indexOf(v),ie=null!=($=null==E?void 0:E[w])?$:0,se=ae?re:te-S[ne]-I[ne]-ie+A.altAxis,ce=ae?te+S[ne]+I[ne]-ie-A.altAxis:oe,le=p&&ae?function(e,t,n){var r=Eie(e,t,n);return r>n?n:r}(se,te,ce):Eie(p?se:re,te,p?ce:oe);k[w]=le,T[w]=le-te}t.modifiersData[r]=T}},requiresIfExists:["offset"]};const Nie={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,o=e.options,a=n.elements.arrow,i=n.modifiersData.popperOffsets,s=sie(n.placement),c=lie(s),l=[Hae,Gae].indexOf(s)>=0?"height":"width";if(a&&i){var u=function(e,t){return Sie("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Iie(e,Kae))}(o.padding,n),d=Mae(a),h="y"===c?jae:Hae,p="y"===c?Vae:Gae,f=n.rects.reference[l]+n.rects.reference[c]-i[c]-n.rects.popper[l],m=i[c]-n.rects.reference[c],g=Wae(a),v=g?"y"===c?g.clientHeight||0:g.clientWidth||0:0,y=f/2-m/2,b=u[h],x=v-d[l]-u[p],w=v/2-d[l]/2+y,k=Eie(b,w,x),S=c;n.modifiersData[r]=((t={})[S]=k,t.centerOffset=k-w,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!==typeof r||(r=t.elements.popper.querySelector(r)))&&bie(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Rie(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function _ie(e){return[jae,Gae,Vae,Hae].some((function(t){return e[t]>=0}))}var Die=aie({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,a=void 0===o||o,i=r.resize,s=void 0===i||i,c=yae(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&l.forEach((function(e){e.addEventListener("scroll",n.update,iie)})),s&&c.addEventListener("resize",n.update,iie),function(){a&&l.forEach((function(e){e.removeEventListener("scroll",n.update,iie)})),s&&c.removeEventListener("resize",n.update,iie)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=uie({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,a=n.adaptive,i=void 0===a||a,s=n.roundOffsets,c=void 0===s||s,l={placement:sie(t.placement),variation:cie(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,hie(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:c})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,hie(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},pie,fie,Aie,Tie,Nie,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,a=t.modifiersData.preventOverflow,i=Cie(t,{elementContext:"reference"}),s=Cie(t,{altBoundary:!0}),c=Rie(i,r),l=Rie(s,o,a),u=_ie(c),d=_ie(l);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}}]});function Oie(e){return(0,Aw.Ay)("MuiPopper",e)}(0,vw.A)("MuiPopper",["root"]);const Fie=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],Mie=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function Pie(e){return"function"===typeof e?e():e}function Lie(e){return void 0!==e.nodeType}const zie={},Bie=i.forwardRef((function(e,t){var n;const{anchorEl:r,children:o,direction:a,disablePortal:s,modifiers:c,open:l,placement:u,popperOptions:d,popperRef:h,slotProps:p={},slots:f={},TransitionProps:m}=e,g=(0,Me.A)(e,Fie),v=i.useRef(null),y=(0,mS.A)(v,t),b=i.useRef(null),x=(0,mS.A)(b,h),w=i.useRef(x);(0,xI.A)((()=>{w.current=x}),[x]),i.useImperativeHandle(h,(()=>b.current),[]);const k=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(u,a),[S,I]=i.useState(k),[C,A]=i.useState(Pie(r));i.useEffect((()=>{b.current&&b.current.forceUpdate()})),i.useEffect((()=>{r&&A(Pie(r))}),[r]),(0,xI.A)((()=>{if(!C||!l)return;let e=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:e=>{let{state:t}=e;(e=>{I(e.placement)})(t)}}];null!=c&&(e=e.concat(c)),d&&null!=d.modifiers&&(e=e.concat(d.modifiers));const t=Die(C,v.current,(0,Fe.A)({placement:k},d,{modifiers:e}));return w.current(t),()=>{t.destroy(),w.current(null)}}),[C,s,c,l,d,k]);const E={placement:S};null!==m&&(E.TransitionProps=m);const T=(e=>{const{classes:t}=e;return(0,kw.A)({root:["root"]},Oie,t)})(e),N=null!=(n=f.root)?n:"div",R=pI({elementType:N,externalSlotProps:p.root,externalForwardedProps:g,additionalProps:{role:"tooltip",ref:y},ownerState:e,className:T.root});return(0,Be.jsx)(N,(0,Fe.A)({},R,{children:"function"===typeof o?o(E):o}))})),Uie=i.forwardRef((function(e,t){const{anchorEl:n,children:r,container:o,direction:a="ltr",disablePortal:s=!1,keepMounted:c=!1,modifiers:l,open:u,placement:d="bottom",popperOptions:h=zie,popperRef:p,style:f,transition:m=!1,slotProps:g={},slots:v={}}=e,y=(0,Me.A)(e,Mie),[b,x]=i.useState(!0);if(!c&&!u&&(!m||b))return null;let w;if(o)w=o;else if(n){const e=Pie(n);w=e&&Lie(e)?(0,mI.A)(e).body:(0,mI.A)(null).body}const k=u||!c||m&&!b?void 0:"none",S=m?{in:u,onEnter:()=>{x(!1)},onExited:()=>{x(!0)}}:void 0;return(0,Be.jsx)(kI,{disablePortal:s,container:w,children:(0,Be.jsx)(Bie,(0,Fe.A)({anchorEl:n,direction:a,disablePortal:s,modifiers:l,ref:t,open:m?!b:u,placement:d,popperOptions:h,popperRef:p,slotProps:g,slots:v},y,{style:(0,Fe.A)({position:"fixed",top:0,left:0,display:k},f),TransitionProps:S,children:r}))})})),Wie=Uie,jie=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],Vie=(0,Iw.Ay)(Wie,{name:"MuiPopper",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Gie=i.forwardRef((function(e,t){var n;const r=(0,vae.A)(),o=(0,Cw.b)({props:e,name:"MuiPopper"}),{anchorEl:a,component:i,components:s,componentsProps:c,container:l,disablePortal:u,keepMounted:d,modifiers:h,open:p,placement:f,popperOptions:m,popperRef:g,transition:v,slots:y,slotProps:b}=o,x=(0,Me.A)(o,jie),w=null!=(n=null==y?void 0:y.root)?n:null==s?void 0:s.Root,k=(0,Fe.A)({anchorEl:a,container:l,disablePortal:u,keepMounted:d,modifiers:h,open:p,placement:f,popperOptions:m,popperRef:g,transition:v},x);return(0,Be.jsx)(Vie,(0,Fe.A)({as:i,direction:null==r?void 0:r.direction,slots:{root:w},slotProps:null!=b?b:c},k,{ref:t}))})),Hie=Gie;var qie=n(5879);function Kie(e){return(0,Aw.Ay)("MuiTooltip",e)}const Xie=(0,vw.A)("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),Yie=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];const Qie=(0,Iw.Ay)(Hie,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.popper,!n.disableInteractive&&t.popperInteractive,n.arrow&&t.popperArrow,!n.open&&t.popperClose]}})((e=>{let{theme:t,ownerState:n,open:r}=e;return(0,Fe.A)({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none"},!n.disableInteractive&&{pointerEvents:"auto"},!r&&{pointerEvents:"none"},n.arrow&&{['&[data-popper-placement*="bottom"] .'.concat(Xie.arrow)]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},['&[data-popper-placement*="top"] .'.concat(Xie.arrow)]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},['&[data-popper-placement*="right"] .'.concat(Xie.arrow)]:(0,Fe.A)({},n.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),['&[data-popper-placement*="left"] .'.concat(Xie.arrow)]:(0,Fe.A)({},n.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})})),Jie=(0,Iw.Ay)("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.tooltip,n.touch&&t.touch,n.arrow&&t.tooltipArrow,t["tooltipPlacement".concat((0,$k.A)(n.placement.split("-")[0]))]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:(0,Sw.X4)(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium},n.arrow&&{position:"relative",margin:0},n.touch&&{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:"".concat((r=16/14,Math.round(1e5*r)/1e5),"em"),fontWeight:t.typography.fontWeightRegular},{[".".concat(Xie.popper,'[data-popper-placement*="left"] &')]:(0,Fe.A)({transformOrigin:"right center"},n.isRtl?(0,Fe.A)({marginLeft:"14px"},n.touch&&{marginLeft:"24px"}):(0,Fe.A)({marginRight:"14px"},n.touch&&{marginRight:"24px"})),[".".concat(Xie.popper,'[data-popper-placement*="right"] &')]:(0,Fe.A)({transformOrigin:"left center"},n.isRtl?(0,Fe.A)({marginRight:"14px"},n.touch&&{marginRight:"24px"}):(0,Fe.A)({marginLeft:"14px"},n.touch&&{marginLeft:"24px"})),[".".concat(Xie.popper,'[data-popper-placement*="top"] &')]:(0,Fe.A)({transformOrigin:"center bottom",marginBottom:"14px"},n.touch&&{marginBottom:"24px"}),[".".concat(Xie.popper,'[data-popper-placement*="bottom"] &')]:(0,Fe.A)({transformOrigin:"center top",marginTop:"14px"},n.touch&&{marginTop:"24px"})});var r})),$ie=(0,Iw.Ay)("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(e,t)=>t.arrow})((e=>{let{theme:t}=e;return{overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:(0,Sw.X4)(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}}));let Zie=!1;const ese=new ek.E;let tse={x:0,y:0};function nse(e,t){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];t&&t(n,...o),e(n,...o)}}const rse=i.forwardRef((function(e,t){var n,r,o,a,s,c,l,u,d,h,p,f,m,g,v,y,b,x,w;const k=(0,Cw.b)({props:e,name:"MuiTooltip"}),{arrow:S=!1,children:I,components:C={},componentsProps:A={},describeChild:E=!1,disableFocusListener:T=!1,disableHoverListener:N=!1,disableInteractive:R=!1,disableTouchListener:_=!1,enterDelay:D=100,enterNextDelay:O=0,enterTouchDelay:F=700,followCursor:M=!1,id:P,leaveDelay:L=0,leaveTouchDelay:z=1500,onClose:B,onOpen:U,open:W,placement:j="bottom",PopperComponent:V,PopperProps:G={},slotProps:H={},slots:q={},title:K,TransitionComponent:X=zre,TransitionProps:Y}=k,Q=(0,Me.A)(k,Yie),J=i.isValidElement(I)?I:(0,Be.jsx)("span",{children:I}),$=OI(),Z=He(),[ee,te]=i.useState(),[ne,re]=i.useState(null),oe=i.useRef(!1),ae=R||M,ie=(0,ek.A)(),se=(0,ek.A)(),ce=(0,ek.A)(),le=(0,ek.A)(),[ue,de]=(0,voe.A)({controlled:W,default:!1,name:"Tooltip",state:"open"});let he=ue;const pe=(0,qie.A)(P),fe=i.useRef(),me=(0,Ww.A)((()=>{void 0!==fe.current&&(document.body.style.WebkitUserSelect=fe.current,fe.current=void 0),le.clear()}));i.useEffect((()=>me),[me]);const ge=e=>{ese.clear(),Zie=!0,de(!0),U&&!he&&U(e)},ve=(0,Ww.A)((e=>{ese.start(800+L,(()=>{Zie=!1})),de(!1),B&&he&&B(e),ie.start($.transitions.duration.shortest,(()=>{oe.current=!1}))})),ye=e=>{oe.current&&"touchstart"!==e.type||(ee&&ee.removeAttribute("title"),se.clear(),ce.clear(),D||Zie&&O?se.start(Zie?O:D,(()=>{ge(e)})):ge(e))},be=e=>{se.clear(),ce.start(L,(()=>{ve(e)}))},{isFocusVisibleRef:xe,onBlur:we,onFocus:ke,ref:Se}=(0,jw.A)(),[,Ie]=i.useState(!1),Ce=e=>{we(e),!1===xe.current&&(Ie(!1),be(e))},Ae=e=>{ee||te(e.currentTarget),ke(e),!0===xe.current&&(Ie(!0),ye(e))},Ee=e=>{oe.current=!0;const t=J.props;t.onTouchStart&&t.onTouchStart(e)},Te=e=>{Ee(e),ce.clear(),ie.clear(),me(),fe.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",le.start(F,(()=>{document.body.style.WebkitUserSelect=fe.current,ye(e)}))},Ne=e=>{J.props.onTouchEnd&&J.props.onTouchEnd(e),me(),ce.start(z,(()=>{ve(e)}))};i.useEffect((()=>{if(he)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){"Escape"!==e.key&&"Esc"!==e.key||ve(e)}}),[ve,he]);const Re=(0,Uw.A)(fI(J),Se,te,t);K||0===K||(he=!1);const _e=i.useRef(),De={},Oe="string"===typeof K;E?(De.title=he||!Oe||N?null:K,De["aria-describedby"]=he?pe:null):(De["aria-label"]=Oe?K:null,De["aria-labelledby"]=he&&!Oe?pe:null);const Pe=(0,Fe.A)({},De,Q,J.props,{className:(0,cw.A)(Q.className,J.props.className),onTouchStart:Ee,ref:Re},M?{onMouseMove:e=>{const t=J.props;t.onMouseMove&&t.onMouseMove(e),tse={x:e.clientX,y:e.clientY},_e.current&&_e.current.update()}}:{});const Le={};_||(Pe.onTouchStart=Te,Pe.onTouchEnd=Ne),N||(Pe.onMouseOver=nse(ye,Pe.onMouseOver),Pe.onMouseLeave=nse(be,Pe.onMouseLeave),ae||(Le.onMouseOver=ye,Le.onMouseLeave=be)),T||(Pe.onFocus=nse(Ae,Pe.onFocus),Pe.onBlur=nse(Ce,Pe.onBlur),ae||(Le.onFocus=Ae,Le.onBlur=Ce));const ze=i.useMemo((()=>{var e;let t=[{name:"arrow",enabled:Boolean(ne),options:{element:ne,padding:4}}];return null!=(e=G.popperOptions)&&e.modifiers&&(t=t.concat(G.popperOptions.modifiers)),(0,Fe.A)({},G.popperOptions,{modifiers:t})}),[ne,G]),Ue=(0,Fe.A)({},k,{isRtl:Z,arrow:S,disableInteractive:ae,placement:j,PopperComponentProp:V,touch:oe.current}),We=(e=>{const{classes:t,disableInteractive:n,arrow:r,touch:o,placement:a}=e,i={popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",o&&"touch","tooltipPlacement".concat((0,$k.A)(a.split("-")[0]))],arrow:["arrow"]};return(0,kw.A)(i,Kie,t)})(Ue),je=null!=(n=null!=(r=q.popper)?r:C.Popper)?n:Qie,Ve=null!=(o=null!=(a=null!=(s=q.transition)?s:C.Transition)?a:X)?o:zre,Ge=null!=(c=null!=(l=q.tooltip)?l:C.Tooltip)?c:Jie,qe=null!=(u=null!=(d=q.arrow)?d:C.Arrow)?u:$ie,Ke=gS(je,(0,Fe.A)({},G,null!=(h=H.popper)?h:A.popper,{className:(0,cw.A)(We.popper,null==G?void 0:G.className,null==(p=null!=(f=H.popper)?f:A.popper)?void 0:p.className)}),Ue),Xe=gS(Ve,(0,Fe.A)({},Y,null!=(m=H.transition)?m:A.transition),Ue),Ye=gS(Ge,(0,Fe.A)({},null!=(g=H.tooltip)?g:A.tooltip,{className:(0,cw.A)(We.tooltip,null==(v=null!=(y=H.tooltip)?y:A.tooltip)?void 0:v.className)}),Ue),Qe=gS(qe,(0,Fe.A)({},null!=(b=H.arrow)?b:A.arrow,{className:(0,cw.A)(We.arrow,null==(x=null!=(w=H.arrow)?w:A.arrow)?void 0:x.className)}),Ue);return(0,Be.jsxs)(i.Fragment,{children:[i.cloneElement(J,Pe),(0,Be.jsx)(je,(0,Fe.A)({as:null!=V?V:Hie,placement:j,anchorEl:M?{getBoundingClientRect:()=>({top:tse.y,left:tse.x,right:tse.x,bottom:tse.y,width:0,height:0})}:ee,popperRef:_e,open:!!ee&&he,id:pe,transition:!0},Le,Ke,{popperOptions:ze,children:e=>{let{TransitionProps:t}=e;return(0,Be.jsx)(Ve,(0,Fe.A)({timeout:$.transitions.duration.shorter},t,Xe,{children:(0,Be.jsxs)(Ge,(0,Fe.A)({},Ye,{children:[K,S?(0,Be.jsx)(qe,(0,Fe.A)({},Qe,{ref:re})):null]}))}))}}))]})})),ose=rse;const ase=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoHideDuration:t=null,disableWindowBlurListener:n=!1,onClose:r,open:o,resumeHideDuration:a}=e,s=(0,ek.A)();i.useEffect((()=>{if(o)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){e.defaultPrevented||"Escape"!==e.key&&"Esc"!==e.key||null==r||r(e,"escapeKeyDown")}}),[o,r]);const c=(0,HI.A)(((e,t)=>{null==r||r(e,t)})),l=(0,HI.A)((e=>{r&&null!=e&&s.start(e,(()=>{c(null,"timeout")}))}));i.useEffect((()=>(o&&l(t),s.clear)),[o,t,l,s]);const u=s.clear,d=i.useCallback((()=>{null!=t&&l(null!=a?a:.5*t)}),[t,a,l]),h=e=>t=>{const n=e.onFocus;null==n||n(t),u()},p=e=>t=>{const n=e.onMouseEnter;null==n||n(t),u()},f=e=>t=>{const n=e.onMouseLeave;null==n||n(t),d()};return i.useEffect((()=>{if(!n&&o)return window.addEventListener("focus",d),window.addEventListener("blur",u),()=>{window.removeEventListener("focus",d),window.removeEventListener("blur",u)}}),[n,o,d,u]),{getRootProps:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=(0,Fe.A)({},yS(e),yS(t));return(0,Fe.A)({role:"presentation"},t,n,{onBlur:(r=n,e=>{const t=r.onBlur;null==t||t(e),d()}),onFocus:h(n),onMouseEnter:p(n),onMouseLeave:f(n)});var r},onClickAway:e=>{null==r||r(e,"clickaway")}}};function ise(e){return e.substring(2).toLowerCase()}function sse(e){const{children:t,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:o,touchEvent:a="onTouchEnd"}=e,s=i.useRef(!1),c=i.useRef(null),l=i.useRef(!1),u=i.useRef(!1);i.useEffect((()=>(setTimeout((()=>{l.current=!0}),0),()=>{l.current=!1})),[]);const d=(0,mS.A)(fI(t),c),h=(0,HI.A)((e=>{const t=u.current;u.current=!1;const r=(0,mI.A)(c.current);if(!l.current||!c.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,r))return;if(s.current)return void(s.current=!1);let a;a=e.composedPath?e.composedPath().indexOf(c.current)>-1:!r.documentElement.contains(e.target)||c.current.contains(e.target),a||!n&&t||o(e)})),p=e=>n=>{u.current=!0;const r=t.props[e];r&&r(n)},f={ref:d};return!1!==a&&(f[a]=p(a)),i.useEffect((()=>{if(!1!==a){const e=ise(a),t=(0,mI.A)(c.current),n=()=>{s.current=!0};return t.addEventListener(e,h),t.addEventListener("touchmove",n),()=>{t.removeEventListener(e,h),t.removeEventListener("touchmove",n)}}}),[h,a]),!1!==r&&(f[r]=p(r)),i.useEffect((()=>{if(!1!==r){const e=ise(r),t=(0,mI.A)(c.current);return t.addEventListener(e,h),()=>{t.removeEventListener(e,h)}}}),[h,r]),(0,Be.jsx)(i.Fragment,{children:i.cloneElement(t,f)})}function cse(e){return(0,Aw.Ay)("MuiSnackbarContent",e)}(0,vw.A)("MuiSnackbarContent",["root","message","action"]);const lse=["action","className","message","role"],use=(0,Iw.Ay)(PS,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;const n="light"===t.palette.mode?.8:.98,r=(0,Sw.tL)(t.palette.background.default,n);return(0,Fe.A)({},t.typography.body2,{color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(r),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:r,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})})),dse=(0,Iw.Ay)("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0"}),hse=(0,Iw.Ay)("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),pse=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiSnackbarContent"}),{action:r,className:o,message:a,role:i="alert"}=n,s=(0,Me.A)(n,lse),c=n,l=(e=>{const{classes:t}=e;return(0,kw.A)({root:["root"],action:["action"],message:["message"]},cse,t)})(c);return(0,Be.jsxs)(use,(0,Fe.A)({role:i,square:!0,elevation:6,className:(0,cw.A)(l.root,o),ownerState:c,ref:t},s,{children:[(0,Be.jsx)(dse,{className:l.message,ownerState:c,children:a}),r?(0,Be.jsx)(hse,{className:l.action,ownerState:c,children:r}):null]}))})),fse=pse;function mse(e){return(0,Aw.Ay)("MuiSnackbar",e)}(0,vw.A)("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const gse=["onEnter","onExited"],vse=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],yse=(0,Iw.Ay)("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["anchorOrigin".concat((0,$k.A)(n.anchorOrigin.vertical)).concat((0,$k.A)(n.anchorOrigin.horizontal))]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,Fe.A)({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},"top"===n.anchorOrigin.vertical?{top:8}:{bottom:8},"left"===n.anchorOrigin.horizontal&&{justifyContent:"flex-start"},"right"===n.anchorOrigin.horizontal&&{justifyContent:"flex-end"},{[t.breakpoints.up("sm")]:(0,Fe.A)({},"top"===n.anchorOrigin.vertical?{top:24}:{bottom:24},"center"===n.anchorOrigin.horizontal&&{left:"50%",right:"auto",transform:"translateX(-50%)"},"left"===n.anchorOrigin.horizontal&&{left:24,right:"auto"},"right"===n.anchorOrigin.horizontal&&{right:24,left:"auto"})})})),bse=i.forwardRef((function(e,t){const n=(0,Cw.b)({props:e,name:"MuiSnackbar"}),r=OI(),o={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{action:a,anchorOrigin:{vertical:s,horizontal:c}={vertical:"bottom",horizontal:"left"},autoHideDuration:l=null,children:u,className:d,ClickAwayListenerProps:h,ContentProps:p,disableWindowBlurListener:f=!1,message:m,open:g,TransitionComponent:v=zre,transitionDuration:y=o,TransitionProps:{onEnter:b,onExited:x}={}}=n,w=(0,Me.A)(n.TransitionProps,gse),k=(0,Me.A)(n,vse),S=(0,Fe.A)({},n,{anchorOrigin:{vertical:s,horizontal:c},autoHideDuration:l,disableWindowBlurListener:f,TransitionComponent:v,transitionDuration:y}),I=(e=>{const{classes:t,anchorOrigin:n}=e,r={root:["root","anchorOrigin".concat((0,$k.A)(n.vertical)).concat((0,$k.A)(n.horizontal))]};return(0,kw.A)(r,mse,t)})(S),{getRootProps:C,onClickAway:A}=ase((0,Fe.A)({},S)),[E,T]=i.useState(!0),N=pI({elementType:yse,getSlotProps:C,externalForwardedProps:k,ownerState:S,additionalProps:{ref:t},className:[I.root,d]});return!g&&E?null:(0,Be.jsx)(sse,(0,Fe.A)({onClickAway:A},h,{children:(0,Be.jsx)(yse,(0,Fe.A)({},N,{children:(0,Be.jsx)(v,(0,Fe.A)({appear:!0,in:g,timeout:y,direction:"top"===s?"down":"up",onEnter:(e,t)=>{T(!1),b&&b(e,t)},onExited:e=>{T(!0),x&&x(e)}},w,{children:u||(0,Be.jsx)(fse,(0,Fe.A)({message:m,action:a},p))}))}))}))})),xse=bse;var wse=n(1702),kse=n(4545);const Sse=()=>{var e,t;const{currentUser:n,logout:r}=aw(),[o,a]=(0,i.useState)(null),[s,c]=(0,i.useState)(!1),[l,u]=(0,i.useState)(null),d=(0,i.useRef)(null);(0,i.useEffect)((()=>{(async()=>{if(null!==n&&void 0!==n&&n.uid)try{const e=await Om(Of(nw,"users",n.uid));e.exists()&&e.data().profileImage&&a(e.data().profileImage)}catch(l){console.error("Error fetching profile image:",l),u("Failed to load profile image")}})()}),[n]);const h=()=>{d.current.click()},p=()=>{u(null)};return(0,Be.jsxs)(ZC,{maxWidth:"md",sx:{py:4},children:[(0,Be.jsx)(PS,{elevation:0,sx:{p:4,borderRadius:2},children:(0,Be.jsxs)(kA,{container:!0,spacing:4,children:[(0,Be.jsxs)(kA,{item:!0,xs:12,md:4,sx:{textAlign:"center"},children:[(0,Be.jsxs)(ww,{sx:{position:"relative",display:"inline-block"},children:[(0,Be.jsx)(RS,{src:o,sx:{width:120,height:120,mx:"auto",mb:2,bgcolor:"#219653",fontSize:"3rem",cursor:"pointer"},onClick:h,children:!o&&((null===n||void 0===n||null===(e=n.email)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toUpperCase())||"U")}),(0,Be.jsx)("input",{type:"file",accept:"image/*",hidden:!0,ref:d,onChange:async e=>{const t=e.target.files[0];if(t&&null!==n&&void 0!==n&&n.uid)try{if(c(!0),u(null),t.size>2097152)throw new Error("File size should be less than 2MB");if(!t.type.startsWith("image/"))throw new Error("File must be an image");const e=await(e=>new Promise(((t,n)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=e=>{const r=new Image;r.src=e.target.result,r.onload=()=>{const e=document.createElement("canvas");let n=r.width,o=r.height;n>o?n>200&&(o*=200/n,n=200):o>200&&(n*=200/o,o=200),e.width=n,e.height=o,e.getContext("2d").drawImage(r,0,0,n,o);const a=e.toDataURL("image/jpeg",.7);t(a)},r.onerror=n},r.onerror=n})))(t),r=Of(nw,"users",n.uid);(await Om(r)).exists()?await function(e,t,n){e=Af(e,Nf);const r=Af(e.firestore,Pf),o=Yf(r);let a;for(var i=arguments.length,s=new Array(i>3?i-3:0),c=3;c<i;c++)s[c-3]=arguments[c];return a="string"==typeof(t=Ot(t))||t instanceof Uf?em(o,"updateDoc",e._key,t,n,s):Zf(o,"updateDoc",e._key,t),zm(r,[a.toMutation(e._key,_u.exists(!0))])}(r,{profileImage:e,updatedAt:(new Date).toISOString()}):await Pm(r,{email:n.email,createdAt:(new Date).toISOString(),profileImage:e,updatedAt:(new Date).toISOString()}),a(e)}catch(l){console.error("Error uploading profile image:",l),u(l.message||"Failed to upload profile image")}finally{c(!1)}}}),(0,Be.jsx)(ose,{title:"Change Profile Picture",children:(0,Be.jsx)(dI,{sx:{position:"absolute",bottom:16,right:0,bgcolor:"white",boxShadow:1,"&:hover":{bgcolor:"grey.100"}},onClick:h,disabled:s,children:s?(0,Be.jsx)(IE,{size:24,sx:{color:"#219653"}}):(0,Be.jsx)(kse.A,{sx:{color:"#219653"}})})})]}),(0,Be.jsx)(aS,{variant:"h6",gutterBottom:!0,children:(null===n||void 0===n?void 0:n.email)||"User"}),(0,Be.jsx)(aI,{variant:"outlined",color:"error",startIcon:(0,Be.jsx)(wse.A,{}),onClick:r,sx:{mt:2},children:"Logout"})]}),(0,Be.jsxs)(kA,{item:!0,xs:12,md:8,children:[(0,Be.jsx)(aS,{variant:"h5",gutterBottom:!0,children:"Profile Information"}),(0,Be.jsx)(Dw,{sx:{mb:3}}),(0,Be.jsxs)(ww,{sx:{mb:3},children:[(0,Be.jsx)(aS,{variant:"subtitle2",color:"text.secondary",children:"Email"}),(0,Be.jsx)(aS,{variant:"body1",children:(null===n||void 0===n?void 0:n.email)||"Not available"})]}),(0,Be.jsxs)(ww,{sx:{mb:3},children:[(0,Be.jsx)(aS,{variant:"subtitle2",color:"text.secondary",children:"Account Type"}),(0,Be.jsx)(aS,{variant:"body1",children:null!==n&&void 0!==n&&n.isAdmin?"Administrator":"Regular User"})]}),(0,Be.jsxs)(ww,{children:[(0,Be.jsx)(aS,{variant:"subtitle2",color:"text.secondary",children:"Member Since"}),(0,Be.jsx)(aS,{variant:"body1",children:null!==n&&void 0!==n&&n.createdAt?new Date(n.createdAt).toLocaleDateString():"Not available"})]})]})]})}),(0,Be.jsx)(xse,{open:!!l,autoHideDuration:6e3,onClose:p,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,Be.jsx)(iE,{onClose:p,severity:"error",sx:{width:"100%"},children:l})})]})},Ise=e=>{let{children:t}=e;const{currentUser:n}=aw();return n?t:(0,Be.jsx)(ve,{to:"/login"})};const Cse=function(){return(0,Be.jsx)(Ze,{theme:sw,children:(0,Be.jsx)(ow,{children:(0,Be.jsxs)(Te,{children:[(0,Be.jsx)(OC,{}),(0,Be.jsxs)(xe,{children:[(0,Be.jsx)(ye,{path:"/",element:(0,Be.jsx)(PA,{})}),(0,Be.jsx)(ye,{path:"/scan",element:(0,Be.jsx)(Ise,{children:(0,Be.jsx)(rte,{})})}),(0,Be.jsx)(ye,{path:"/history",element:(0,Be.jsx)(Ise,{children:(0,Be.jsx)(fte,{})})}),(0,Be.jsx)(ye,{path:"/education",element:(0,Be.jsx)(tne,{})}),(0,Be.jsx)(ye,{path:"/login",element:(0,Be.jsx)(Goe,{})}),(0,Be.jsx)(ye,{path:"/register",element:(0,Be.jsx)(Hoe,{})}),(0,Be.jsx)(ye,{path:"/community",element:(0,Be.jsx)(mae,{})}),(0,Be.jsx)(ye,{path:"/community/posts/:postId",element:(0,Be.jsx)(gae,{})}),(0,Be.jsx)(ye,{path:"/profile",element:(0,Be.jsx)(Ise,{children:(0,Be.jsx)(Sse,{})})})]}),(0,Be.jsx)(lA,{})]})})})},Ase=(e,t)=>(0,Fe.A)({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},t&&!e.vars&&{colorScheme:e.palette.mode}),Ese=e=>(0,Fe.A)({color:(e.vars||e).palette.text.primary},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.default,"@media print":{backgroundColor:(e.vars||e).palette.common.white}});const Tse=function(e){const t=(0,Cw.b)({props:e,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=t;return(0,Be.jsxs)(i.Fragment,{children:[(0,Be.jsx)(gne,{styles:e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n;const r={};t&&e.colorSchemes&&Object.entries(e.colorSchemes).forEach((t=>{let[n,o]=t;var a;r[e.getColorSchemeSelector(n).replace(/\s*&/,"")]={colorScheme:null==(a=o.palette)?void 0:a.mode}}));let o=(0,Fe.A)({html:Ase(e,t),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:(0,Fe.A)({margin:0},Ese(e),{"&::backdrop":{backgroundColor:(e.vars||e).palette.background.default}})},r);const a=null==(n=e.components)||null==(n=n.MuiCssBaseline)?void 0:n.styleOverrides;return a&&(o=[o,a]),o}(e,r)}),n]})},Nse=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Rse(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const n=e.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}c.createRoot(document.getElementById("root")).render((0,Be.jsxs)(i.StrictMode,{children:[(0,Be.jsx)(Tse,{}),(0,Be.jsx)(Cse,{})]})),function(e){if("serviceWorker"in navigator){if(new URL("/Agroscan",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="".concat("/Agroscan","/service-worker.js");Nse?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((n=>{const r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):Rse(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Rse(t,e)}))}}()})()})();
//# sourceMappingURL=main.cd8768c8.js.map